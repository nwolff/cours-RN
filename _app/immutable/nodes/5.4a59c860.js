import{S as h,i as ee,s as te,y as g,a as D,e as U,z as w,c as T,A as b,b as v,d as l,f as re,g as _,B as d,h as S,T as V,o as se,q as O,r as W,v as ne,R as $e}from"../chunks/index.491fcb99.js";import{D as fe,a as X}from"../chunks/DrawBox.60a8a71d.js";import{S as N,N as ae}from"../chunks/NetworkGraph.58df50e6.js";import{g as oe,t as Y,m as Z,f as ie,b as me,r as pe,s as x,L as ue,c as le,d as _e}from"../chunks/stores.dd7b147c.js";import{T as R,D as B}from"../chunks/Title.b4fe08e7.js";import{G as I}from"../chunks/combinator.f7f17c0e.js";const ce=!1,Ce=Object.freeze(Object.defineProperty({__proto__:null,ssr:ce},Symbol.toStringTag,{value:"Module"}));function ge(f){let t;return{c(){t=O("Reconnaître des chiffres")},l(s){t=W(s,"Reconnaître des chiffres")},m(s,r){v(s,t,r)},d(s){s&&S(t)}}}function we(f){let t,s;return t=new I({props:{cols:4,$$slots:{default:[Me]},$$scope:{ctx:f}}}),{c(){g(t.$$.fragment)},l(r){w(t.$$.fragment,r)},m(r,a){b(t,r,a),s=!0},p(r,a){const n={};a&16407&&(n.$$scope={dirty:a,ctx:r}),t.$set(n)},i(r){s||(_(t.$$.fragment,r),s=!0)},o(r){l(t.$$.fragment,r),s=!1},d(r){d(t,r)}}}function be(f){let t,s;return t=new ue({props:{size:"xl"}}),{c(){g(t.$$.fragment)},l(r){w(t.$$.fragment,r)},m(r,a){b(t,r,a),s=!0},p:$e,i(r){s||(_(t.$$.fragment,r),s=!0)},o(r){l(t.$$.fragment,r),s=!1},d(r){d(t,r)}}}function de(f){let t;return{c(){t=O("Modèle qui apprend")},l(s){t=W(s,"Modèle qui apprend")},m(s,r){v(s,t,r)},d(s){s&&S(t)}}}function ke(f){let t;return{c(){t=O("Modèle déja entraîné")},l(s){t=W(s,"Modèle déja entraîné")},m(s,r){v(s,t,r)},d(s){s&&S(t)}}}function ve(f){let t,s,r,a,n,i,c,M,L,k,q,$,p,j,P,C,m,u,y,F,A,G,z,H;return t=new N({props:{h:"lg"}}),r=new fe({}),r.$on("imageData",f[7]),n=new N({props:{h:"sm"}}),c=new B({}),L=new R({props:{order:4,$$slots:{default:[de]},$$scope:{ctx:f}}}),q=new N({props:{h:"sm"}}),p=new X({props:{labels:f[6],values:f[0],color:"#0000ff"}}),P=new N({props:{h:"sm"}}),m=new B({}),y=new R({props:{order:4,$$slots:{default:[ke]},$$scope:{ctx:f}}}),A=new N({props:{h:"sm"}}),z=new X({props:{labels:f[6],values:f[1],color:"orange"}}),{c(){g(t.$$.fragment),s=D(),g(r.$$.fragment),a=D(),g(n.$$.fragment),i=D(),g(c.$$.fragment),M=D(),g(L.$$.fragment),k=D(),g(q.$$.fragment),$=D(),g(p.$$.fragment),j=D(),g(P.$$.fragment),C=D(),g(m.$$.fragment),u=D(),g(y.$$.fragment),F=D(),g(A.$$.fragment),G=D(),g(z.$$.fragment)},l(e){w(t.$$.fragment,e),s=T(e),w(r.$$.fragment,e),a=T(e),w(n.$$.fragment,e),i=T(e),w(c.$$.fragment,e),M=T(e),w(L.$$.fragment,e),k=T(e),w(q.$$.fragment,e),$=T(e),w(p.$$.fragment,e),j=T(e),w(P.$$.fragment,e),C=T(e),w(m.$$.fragment,e),u=T(e),w(y.$$.fragment,e),F=T(e),w(A.$$.fragment,e),G=T(e),w(z.$$.fragment,e)},m(e,o){b(t,e,o),v(e,s,o),b(r,e,o),v(e,a,o),b(n,e,o),v(e,i,o),b(c,e,o),v(e,M,o),b(L,e,o),v(e,k,o),b(q,e,o),v(e,$,o),b(p,e,o),v(e,j,o),b(P,e,o),v(e,C,o),b(m,e,o),v(e,u,o),b(y,e,o),v(e,F,o),b(A,e,o),v(e,G,o),b(z,e,o),H=!0},p(e,o){const E={};o&16384&&(E.$$scope={dirty:o,ctx:e}),L.$set(E);const J={};o&1&&(J.values=e[0]),p.$set(J);const K={};o&16384&&(K.$$scope={dirty:o,ctx:e}),y.$set(K);const Q={};o&2&&(Q.values=e[1]),z.$set(Q)},i(e){H||(_(t.$$.fragment,e),_(r.$$.fragment,e),_(n.$$.fragment,e),_(c.$$.fragment,e),_(L.$$.fragment,e),_(q.$$.fragment,e),_(p.$$.fragment,e),_(P.$$.fragment,e),_(m.$$.fragment,e),_(y.$$.fragment,e),_(A.$$.fragment,e),_(z.$$.fragment,e),H=!0)},o(e){l(t.$$.fragment,e),l(r.$$.fragment,e),l(n.$$.fragment,e),l(c.$$.fragment,e),l(L.$$.fragment,e),l(q.$$.fragment,e),l(p.$$.fragment,e),l(P.$$.fragment,e),l(m.$$.fragment,e),l(y.$$.fragment,e),l(A.$$.fragment,e),l(z.$$.fragment,e),H=!1},d(e){d(t,e),e&&S(s),d(r,e),e&&S(a),d(n,e),e&&S(i),d(c,e),e&&S(M),d(L,e),e&&S(k),d(q,e),e&&S($),d(p,e),e&&S(j),d(P,e),e&&S(C),d(m,e),e&&S(u),d(y,e),e&&S(F),d(A,e),e&&S(G),d(z,e)}}}function Se(f){let t,s;return t=new ae({props:{networkShape:f[5],activations:f[2],weights:f[4],linkFilter:f[8]}}),{c(){g(t.$$.fragment)},l(r){w(t.$$.fragment,r)},m(r,a){b(t,r,a),s=!0},p(r,a){const n={};a&4&&(n.activations=r[2]),a&16&&(n.weights=r[4]),t.$set(n)},i(r){s||(_(t.$$.fragment,r),s=!0)},o(r){l(t.$$.fragment,r),s=!1},d(r){d(t,r)}}}function Me(f){let t,s,r,a;return t=new I.Col({props:{span:1,$$slots:{default:[ve]},$$scope:{ctx:f}}}),r=new I.Col({props:{span:3,$$slots:{default:[Se]},$$scope:{ctx:f}}}),{c(){g(t.$$.fragment),s=D(),g(r.$$.fragment)},l(n){w(t.$$.fragment,n),s=T(n),w(r.$$.fragment,n)},m(n,i){b(t,n,i),v(n,s,i),b(r,n,i),a=!0},p(n,i){const c={};i&16387&&(c.$$scope={dirty:i,ctx:n}),t.$set(c);const M={};i&16404&&(M.$$scope={dirty:i,ctx:n}),r.$set(M)},i(n){a||(_(t.$$.fragment,n),_(r.$$.fragment,n),a=!0)},o(n){l(t.$$.fragment,n),l(r.$$.fragment,n),a=!1},d(n){d(t,n),n&&S(s),d(r,n)}}}function Le(f){let t,s,r,a,n,i,c,M;t=new R({props:{order:1,$$slots:{default:[ge]},$$scope:{ctx:f}}}),r=new B({});const L=[be,we],k=[];function q($,p){return $[3]?0:1}return n=q(f),i=k[n]=L[n](f),{c(){g(t.$$.fragment),s=D(),g(r.$$.fragment),a=D(),i.c(),c=U()},l($){w(t.$$.fragment,$),s=T($),w(r.$$.fragment,$),a=T($),i.l($),c=U()},m($,p){b(t,$,p),v($,s,p),b(r,$,p),v($,a,p),k[n].m($,p),v($,c,p),M=!0},p($,[p]){const j={};p&16384&&(j.$$scope={dirty:p,ctx:$}),t.$set(j);let P=n;n=q($),n===P?k[n].p($,p):(ne(),l(k[P],1,1,()=>{k[P]=null}),re(),i=k[n],i?i.p($,p):(i=k[n]=L[n]($),i.c()),_(i,1),i.m(c.parentNode,c))},i($){M||(_(t.$$.fragment,$),_(r.$$.fragment,$),_(i),M=!0)},o($){l(t.$$.fragment,$),l(r.$$.fragment,$),l(i),M=!1},d($){d(t,$),$&&S(s),d(r,$),$&&S(a),k[n].d($),$&&S(c)}}}function ye(f){const t=f.length;return t<=500?f:[...f].sort((r,a)=>Math.abs(a.weight)-Math.abs(r.weight)).slice(0,Math.min(500,.1*t))}function De(f,t,s){let r,a,n;V(f,Z,m=>s(9,a=m)),V(f,Y,m=>s(10,n=m));const i=oe(),c=i.outputLayer.labels;let M,L,k,q=!0;se(async()=>{await Y.load(),await Z.load(),s(3,q=!1)});function $(m){const u=m.detail.image,y=ie(u,1);j(y)}function p(m){const u=[];for(const y of m.layers)u.push(y.output);return le({inputs:m.input,outputs:u.flat()})}function j(m){const u=me(()=>pe(m,[1,784]).toFloat().div(255));s(1,L=x(n.predict(u)).dataSync());const y=p(a).predict(u);s(2,k=[u,...y].map(F=>x(F).dataSync())),s(0,M=k[k.length-1])}function P(m){return m.find(u=>u.a.activation)?m.map(u=>new _e(u.a,u.b,u.weight*(1+.5*u.a.activation))):m}function C(m){const u=P(m);return ye(u)}return f.$$.update=()=>{f.$$.dirty&512&&s(4,r=a==null?void 0:a.weights)},[M,L,k,q,r,i,c,$,C,a]}class Fe extends h{constructor(t){super(),ee(this,t,De,Le,te,{})}}export{Fe as component,Ce as universal};
