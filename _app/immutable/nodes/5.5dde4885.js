import{S as Y,i as Z,s as x,y as l,a as M,z as g,c as L,A as _,b as v,g as w,d as c,B as b,h as d,T as U,q as R,r as W}from"../chunks/index.70d9aeb1.js";import{D as h,a as V}from"../chunks/DrawBox.1df56dcb.js";import{S as z,N as ee}from"../chunks/NetworkGraph.ca456787.js";import{g as te,m as re,t as $e,f as se,b as ne,r as fe,s as X,c as ae,d as ie}from"../chunks/stores.adf6e4c9.js";import{T as B,D as I}from"../chunks/Title.4a55d181.js";import{G as O}from"../chunks/combinator.95544f7d.js";const me=!1,De=Object.freeze(Object.defineProperty({__proto__:null,ssr:me},Symbol.toStringTag,{value:"Module"}));function oe(f){let t;return{c(){t=R("Reconnaître des chiffres")},l($){t=W($,"Reconnaître des chiffres")},m($,r){v($,t,r)},d($){$&&d(t)}}}function pe(f){let t;return{c(){t=R("Modèle qui apprend")},l($){t=W($,"Modèle qui apprend")},m($,r){v($,t,r)},d($){$&&d(t)}}}function ue(f){let t;return{c(){t=R("Modèle déja entraîné")},l($){t=W($,"Modèle déja entraîné")},m($,r){v($,t,r)},d($){$&&d(t)}}}function le(f){let t,$,r,i,s,o,n,p,S,k,P,C,D,F,j,u,m,T,q,G,A,H,y,N;return t=new z({props:{h:"lg"}}),r=new h({}),r.$on("imageData",f[6]),s=new z({props:{h:"sm"}}),n=new I({}),S=new B({props:{order:4,$$slots:{default:[pe]},$$scope:{ctx:f}}}),P=new z({props:{h:"sm"}}),D=new V({props:{labels:f[5],values:f[0],color:"#0000ff"}}),j=new z({props:{h:"sm"}}),m=new I({}),q=new B({props:{order:4,$$slots:{default:[ue]},$$scope:{ctx:f}}}),A=new z({props:{h:"sm"}}),y=new V({props:{labels:f[5],values:f[1],color:"orange"}}),{c(){l(t.$$.fragment),$=M(),l(r.$$.fragment),i=M(),l(s.$$.fragment),o=M(),l(n.$$.fragment),p=M(),l(S.$$.fragment),k=M(),l(P.$$.fragment),C=M(),l(D.$$.fragment),F=M(),l(j.$$.fragment),u=M(),l(m.$$.fragment),T=M(),l(q.$$.fragment),G=M(),l(A.$$.fragment),H=M(),l(y.$$.fragment)},l(e){g(t.$$.fragment,e),$=L(e),g(r.$$.fragment,e),i=L(e),g(s.$$.fragment,e),o=L(e),g(n.$$.fragment,e),p=L(e),g(S.$$.fragment,e),k=L(e),g(P.$$.fragment,e),C=L(e),g(D.$$.fragment,e),F=L(e),g(j.$$.fragment,e),u=L(e),g(m.$$.fragment,e),T=L(e),g(q.$$.fragment,e),G=L(e),g(A.$$.fragment,e),H=L(e),g(y.$$.fragment,e)},m(e,a){_(t,e,a),v(e,$,a),_(r,e,a),v(e,i,a),_(s,e,a),v(e,o,a),_(n,e,a),v(e,p,a),_(S,e,a),v(e,k,a),_(P,e,a),v(e,C,a),_(D,e,a),v(e,F,a),_(j,e,a),v(e,u,a),_(m,e,a),v(e,T,a),_(q,e,a),v(e,G,a),_(A,e,a),v(e,H,a),_(y,e,a),N=!0},p(e,a){const E={};a&8192&&(E.$$scope={dirty:a,ctx:e}),S.$set(E);const J={};a&1&&(J.values=e[0]),D.$set(J);const K={};a&8192&&(K.$$scope={dirty:a,ctx:e}),q.$set(K);const Q={};a&2&&(Q.values=e[1]),y.$set(Q)},i(e){N||(w(t.$$.fragment,e),w(r.$$.fragment,e),w(s.$$.fragment,e),w(n.$$.fragment,e),w(S.$$.fragment,e),w(P.$$.fragment,e),w(D.$$.fragment,e),w(j.$$.fragment,e),w(m.$$.fragment,e),w(q.$$.fragment,e),w(A.$$.fragment,e),w(y.$$.fragment,e),N=!0)},o(e){c(t.$$.fragment,e),c(r.$$.fragment,e),c(s.$$.fragment,e),c(n.$$.fragment,e),c(S.$$.fragment,e),c(P.$$.fragment,e),c(D.$$.fragment,e),c(j.$$.fragment,e),c(m.$$.fragment,e),c(q.$$.fragment,e),c(A.$$.fragment,e),c(y.$$.fragment,e),N=!1},d(e){b(t,e),e&&d($),b(r,e),e&&d(i),b(s,e),e&&d(o),b(n,e),e&&d(p),b(S,e),e&&d(k),b(P,e),e&&d(C),b(D,e),e&&d(F),b(j,e),e&&d(u),b(m,e),e&&d(T),b(q,e),e&&d(G),b(A,e),e&&d(H),b(y,e)}}}function ge(f){let t,$;return t=new ee({props:{networkShape:f[4],activations:f[2],weights:f[3],linkFilter:f[7]}}),{c(){l(t.$$.fragment)},l(r){g(t.$$.fragment,r)},m(r,i){_(t,r,i),$=!0},p(r,i){const s={};i&4&&(s.activations=r[2]),i&8&&(s.weights=r[3]),t.$set(s)},i(r){$||(w(t.$$.fragment,r),$=!0)},o(r){c(t.$$.fragment,r),$=!1},d(r){b(t,r)}}}function _e(f){let t,$,r,i;return t=new O.Col({props:{span:1,$$slots:{default:[le]},$$scope:{ctx:f}}}),r=new O.Col({props:{span:3,$$slots:{default:[ge]},$$scope:{ctx:f}}}),{c(){l(t.$$.fragment),$=M(),l(r.$$.fragment)},l(s){g(t.$$.fragment,s),$=L(s),g(r.$$.fragment,s)},m(s,o){_(t,s,o),v(s,$,o),_(r,s,o),i=!0},p(s,o){const n={};o&8195&&(n.$$scope={dirty:o,ctx:s}),t.$set(n);const p={};o&8204&&(p.$$scope={dirty:o,ctx:s}),r.$set(p)},i(s){i||(w(t.$$.fragment,s),w(r.$$.fragment,s),i=!0)},o(s){c(t.$$.fragment,s),c(r.$$.fragment,s),i=!1},d(s){b(t,s),s&&d($),b(r,s)}}}function we(f){let t,$,r,i,s,o;return t=new B({props:{order:1,$$slots:{default:[oe]},$$scope:{ctx:f}}}),r=new I({}),s=new O({props:{cols:4,$$slots:{default:[_e]},$$scope:{ctx:f}}}),{c(){l(t.$$.fragment),$=M(),l(r.$$.fragment),i=M(),l(s.$$.fragment)},l(n){g(t.$$.fragment,n),$=L(n),g(r.$$.fragment,n),i=L(n),g(s.$$.fragment,n)},m(n,p){_(t,n,p),v(n,$,p),_(r,n,p),v(n,i,p),_(s,n,p),o=!0},p(n,[p]){const S={};p&8192&&(S.$$scope={dirty:p,ctx:n}),t.$set(S);const k={};p&8207&&(k.$$scope={dirty:p,ctx:n}),s.$set(k)},i(n){o||(w(t.$$.fragment,n),w(r.$$.fragment,n),w(s.$$.fragment,n),o=!0)},o(n){c(t.$$.fragment,n),c(r.$$.fragment,n),c(s.$$.fragment,n),o=!1},d(n){b(t,n),n&&d($),b(r,n),n&&d(i),b(s,n)}}}function ce(f){const t=f.length;return t<=500?f:[...f].sort((r,i)=>Math.abs(i.weight)-Math.abs(r.weight)).slice(0,Math.min(500,.1*t))}function be(f,t,$){let r,i,s;U(f,re,u=>$(8,i=u)),U(f,$e,u=>$(9,s=u));const o=te(),n=o.outputLayer.labels;let p,S,k;function P(u){const m=u.detail.image,T=se(m,1);D(T)}function C(u){const m=[];for(const T of u.layers)m.push(T.output);return ae({inputs:u.input,outputs:m.flat()})}function D(u){const m=ne(()=>fe(u,[1,784]).toFloat().div(255));$(1,S=X(s.predict(m)).dataSync());const T=C(i).predict(m);$(2,k=[m,...T].map(q=>X(q).dataSync())),$(0,p=k[k.length-1])}function F(u){return u.find(m=>m.a.activation)?u.map(m=>new ie(m.a,m.b,m.weight*(1+.5*m.a.activation))):u}function j(u){const m=F(u);return ce(m)}return f.$$.update=()=>{f.$$.dirty&256&&$(3,r=i==null?void 0:i.weights)},[p,S,k,r,o,n,P,j,i]}class Te extends Y{constructor(t){super(),Z(this,t,be,we,x,{})}}export{Te as component,De as universal};
