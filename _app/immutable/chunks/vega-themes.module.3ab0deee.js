import{g as yp}from"./_commonjsHelpers.042e6b4d.js";/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var Ij=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),Uj=Object.prototype.hasOwnProperty;function tb(e,t){return Uj.call(e,t)}function nb(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)tb(e,r)&&i.push(r);return i}function Mn(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function ib(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function zo(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function $O(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function rb(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(rb(e[t]))return!0}else if(typeof e=="object"){for(var i=nb(e),r=i.length,s=0;s<r;s++)if(rb(e[i[s]]))return!0}}return!1}function W$(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var _O=function(e){Ij(t,e);function t(n,i,r,s,o){var a=this.constructor,u=e.call(this,W$(n,{name:i,index:r,operation:s,tree:o}))||this;return u.name=i,u.index=r,u.operation=s,u.tree=o,Object.setPrototypeOf(u,a.prototype),u.message=W$(n,{name:i,index:r,operation:s,tree:o}),u}return t}(Error),qe=_O,qj=Mn,cu={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=Eg(n,this.path);i&&(i=Mn(i));var r=na(n,{op:"remove",path:this.from}).removed;return na(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=Eg(n,this.from);return na(n,{op:"add",path:this.path,value:Mn(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:lf(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},Wj={add:function(e,t,n){return ib(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:cu.move,copy:cu.copy,test:cu.test,_get:cu._get};function Eg(e,t){if(t=="")return e;var n={op:"_get",path:t};return na(e,n),n.value}function na(e,t,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):$g(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=Eg(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=lf(e,t.value),o.test===!1)throw new qe("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new qe("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{i||(e=Mn(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,g=void 0;for(typeof n=="function"?g=n:g=$g;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=$O(h)),r&&(h=="__proto__"||h=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&g(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!ib(h))throw new qe("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);ib(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new qe("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=Wj[t.op].call(t,l,h,e);if(o.test===!1)throw new qe("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=f){var o=cu[t.op].call(t,l,h,e);if(o.test===!1)throw new qe("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new qe("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function px(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new qe("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=Mn(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=na(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function Hj(e,t,n){var i=na(e,t);if(i.test===!1)throw new qe("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function $g(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new qe("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(cu[e.op]){if(typeof e.path!="string")throw new qe("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new qe('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new qe("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new qe("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&rb(e.value))throw new qe("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new qe("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new qe("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=SO([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new qe("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new qe("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function SO(e,t,n){try{if(!Array.isArray(e))throw new qe("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)px(Mn(t),Mn(e),n||!0);else{n=n||$g;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof qe)return r;throw r}}function lf(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,s,o;if(n&&i){if(s=e.length,s!=t.length)return!1;for(r=s;r--!==0;)if(!lf(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(r=s;r--!==0;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;r--!==0;)if(o=a[r],!lf(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}const Gj=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:qe,_areEquals:lf,applyOperation:na,applyPatch:px,applyReducer:Hj,deepClone:qj,getValueByPointer:Eg,validate:SO,validator:$g},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var mx=new WeakMap,Yj=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),Vj=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function Xj(e){return mx.get(e)}function Kj(e,t){return e.observers.get(t)}function Jj(e,t){e.observers.delete(t.callback)}function Qj(e,t){t.unobserve()}function Zj(e,t){var n=[],i,r=Xj(e);if(!r)r=new Yj(e),mx.set(e,r);else{var s=Kj(r,t);i=s&&s.observer}if(i)return i;if(i={},r.value=Mn(e),t){i.callback=t,i.next=null;var o=function(){sb(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=n,i.object=e,i.unobserve=function(){sb(i),clearTimeout(i.next),Jj(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new Vj(t,i)),i}function sb(e,t){t===void 0&&(t=!1);var n=mx.get(e.object);yx(n.value,e.object,e.patches,"",t),e.patches.length&&px(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function yx(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=nb(t),o=nb(e),a=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(tb(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?yx(c,f,n,i+"/"+zo(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+zo(l),value:Mn(c)}),n.push({op:"replace",path:i+"/"+zo(l),value:Mn(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+zo(l),value:Mn(c)}),n.push({op:"remove",path:i+"/"+zo(l)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!a&&s.length==o.length))for(var u=0;u<s.length;u++){var l=s[u];!tb(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+zo(l),value:Mn(t[l])})}}}function eR(e,t,n){n===void 0&&(n=!1);var i=[];return yx(e,t,i,"",n),i}const tR=Object.freeze(Object.defineProperty({__proto__:null,compare:eR,generate:sb,observe:Zj,unobserve:Qj},Symbol.toStringTag,{value:"Module"}));Object.assign({},Gj,tR,{JsonPatchError:_O,deepClone:Mn,escapePathComponent:zo,unescapePathComponent:$O});var nR=/("(?:[^\\"]|\\.)*")|[:,]/g,iR=function(t,n){var i,r,s;return n=n||{},i=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),r=i===""?1/0:n.maxLength===void 0?80:n.maxLength,s=n.replacer,function o(a,u,l){var c,f,d,h,g,p,m,y,b,v,x,A;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),x=JSON.stringify(a,s),x===void 0)return x;if(m=r-u.length-l,x.length<=m&&(b=x.replace(nR,function(E,w){return w||E+" "}),b.length<=m))return b;if(s!=null&&(a=JSON.parse(x),s=void 0),typeof a=="object"&&a!==null){if(y=u+i,d=[],f=0,Array.isArray(a))for(v="[",c="]",m=a.length;f<m;f++)d.push(o(a[f],y,f===m-1?0:1)||"null");else for(v="{",c="}",p=Object.keys(a),m=p.length;f<m;f++)h=p[f],g=JSON.stringify(h)+": ",A=o(a[h],y,g.length+(f===m-1?0:1)),A!==void 0&&d.push(g+A);if(d.length>0)return[v,i+d.join(`,
`+y),c].join(`
`+u)}return x}(t,"",0)};const Ive=yp(iR);function es(e,t,n){return e.fields=t||[],e.fname=n,e}function rR(e){return e==null?null:e.fname}function CO(e){return e==null?null:e.fields}function kO(e){return e.length===1?sR(e[0]):oR(e)}const sR=e=>function(t){return t[e]},oR=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Wh(e){throw Error(e)}function bx(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Wh("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Wh("Access path missing closing bracket: "+e),i&&Wh("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function vx(e,t,n){const i=bx(e);return e=i.length===1?i[0]:e,es((n&&n.get||kO)(i),[e],t||e)}const aR=vx("id"),xx=es(e=>e,[],"identity"),uR=es(()=>0,[],"zero"),lR=es(()=>1,[],"one"),cR=es(()=>!0,[],"true"),fR=es(()=>!1,[],"false");function dR(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const FO=0,OO=1,DO=2,MO=3,TO=4;function hR(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:dR,i=e||FO;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=OO&&n(t||"error","ERROR",arguments),this},warn(){return i>=DO&&n(t||"warn","WARN",arguments),this},info(){return i>=MO&&n(t||"log","INFO",arguments),this},debug(){return i>=TO&&n(t||"log","DEBUG",arguments),this}}}var bp=Array.isArray;function _g(e){return e===Object(e)}const H$=e=>e!=="__proto__";function gR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const s in r)if(s==="signals")i.signals=pR(i.signals,r.signals);else{const o=s==="legend"?{layout:1}:s==="style"?!0:null;wx(i,s,r[s],o)}return i},{})}function wx(e,t,n,i){if(!H$(t))return;let r,s;if(_g(n)&&!bp(n)){s=_g(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?wx(s,r,n[r]):H$(r)&&(s[r]=n[r])}else e[t]=n}function pR(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function nl(e){return e[e.length-1]}function Ax(e){return e==null||e===""?null:+e}const NO=e=>t=>e*Math.exp(t),jO=e=>t=>Math.log(e*t),RO=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),BO=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Sg=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function vp(e,t,n,i){const r=n(e[0]),s=n(nl(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function mR(e,t){return vp(e,t,Ax,xx)}function yR(e,t){var n=Math.sign(e[0]);return vp(e,t,jO(n),NO(n))}function bR(e,t,n){return vp(e,t,Sg(n),Sg(1/n))}function vR(e,t,n){return vp(e,t,RO(n),BO(n))}function xp(e,t,n,i,r){const s=i(e[0]),o=i(nl(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function xR(e,t,n){return xp(e,t,n,Ax,xx)}function wR(e,t,n){const i=Math.sign(e[0]);return xp(e,t,n,jO(i),NO(i))}function AR(e,t,n,i){return xp(e,t,n,Sg(i),Sg(1/i))}function ER(e,t,n,i){return xp(e,t,n,RO(i),BO(i))}function $R(e){return 1+~~(new Date(e).getMonth()/3)}function _R(e){return 1+~~(new Date(e).getUTCMonth()/3)}function cf(e){return e!=null?bp(e)?e:[e]:[]}function SR(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function wp(e){return typeof e=="function"}const CR="descending";function kR(e,t,n){n=n||{},t=cf(t)||[];const i=[],r=[],s={},o=n.comparator||FR;return cf(e).forEach((a,u)=>{a!=null&&(i.push(t[u]===CR?-1:1),r.push(a=wp(a)?a:vx(a,null,n)),(CO(a)||[]).forEach(l=>s[l]=1))}),r.length===0?null:es(o(r,i),Object.keys(s))}const Ex=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),FR=(e,t)=>e.length===1?OR(e[0],t[0]):DR(e,t,e.length),OR=(e,t)=>function(n,i){return Ex(e(n),e(i))*t},DR=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=Ex(s(i),s(r));return o*t[a]});function MR(e){return wp(e)?e:()=>e}function TR(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function $x(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function NR(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function jR(e,t){const n=e.length;let i=-1,r,s,o,a,u;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}return[a,u]}const RR=Object.prototype.hasOwnProperty;function qo(e,t){return RR.call(e,t)}const eh={};function BR(e){let t={},n;function i(s){return qo(t,s)&&t[s]!==eh}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===eh&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=eh),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==eh&&(!n||!n(u))&&(s[a]=u,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function PR(e,t,n,i,r,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=nl(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?i:c<=o?r:s}function zR(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),$x(i,n)}function LR(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function IR(e){return typeof e=="boolean"}function PO(e){return Object.prototype.toString.call(e)==="[object Date]"}function UR(e){return e&&wp(e[Symbol.iterator])}function zO(e){return typeof e=="number"}function qR(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function LO(e){return typeof e=="string"}function WR(e,t,n){e&&(e=t?cf(e).map(a=>a.replace(/\\(.)/g,"$1")):cf(e));const i=e&&e.length,r=n&&n.get||kO,s=a=>r(t?[a]:bx(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<i;)l+="|"+a[c](u);return l}}return es(o,e,"key")}function HR(e,t){const n=e[0],i=nl(e),r=+t;return r?r===1?i:n+r*(i-n):n}const GR=1e4;function YR(e){e=+e||GR;let t,n,i;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>qo(t,o)||qo(n,o),get:o=>qo(t,o)?t[o]:qo(n,o)?s(o,n[o]):void 0,set:(o,a)=>qo(t,o)?t[o]=a:s(o,a)}}function VR(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,u=0,l=0;for(;a<r&&u<s;++l)o[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<r;++a,++l)o[l]=t[a];for(;u<s;++u,++l)o[l]=n[u];return o}function bc(e,t){let n="";for(;--t>=0;)n+=e;return n}function XR(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:i==="left"?bc(r,o)+s:i==="center"?bc(r,~~(o/2))+s+bc(r,Math.ceil(o/2)):s+bc(r,o)}function KR(e){return e&&nl(e)-e[0]||0}function IO(e){return bp(e)?"["+e.map(IO)+"]":_g(e)||LO(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function JR(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const QR=e=>zO(e)||PO(e)?e:Date.parse(e);function ZR(e,t){return t=t||QR,e==null||e===""?null:t(e)}function eB(e){return e==null||e===""?null:e+""}function tB(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function nB(e,t,n,i){const r=i??"…",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:n==="left"?r+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function iB(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}function il(e,t,n){return e.fields=t||[],e.fname=n,e}function rB(e){return e.length===1?sB(e[0]):oB(e)}const sB=e=>function(t){return t[e]},oB=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function ia(e){throw Error(e)}function aB(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||ia("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&ia("Access path missing closing bracket: "+e),i&&ia("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function uB(e,t,n){const i=aB(e);return e=i.length===1?i[0]:e,il((n&&n.get||rB)(i),[e],t||e)}const Ap=uB("id"),UO=il(e=>e,[],"identity");il(()=>0,[],"zero");il(()=>1,[],"one");const ob=il(()=>!0,[],"true");il(()=>!1,[],"false");function lB(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const cB=0,qO=1,fB=2,dB=3,hB=4;function gB(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:lB,i=e||cB;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=qO&&n(t||"error","ERROR",arguments),this},warn(){return i>=fB&&n(t||"warn","WARN",arguments),this},info(){return i>=dB&&n(t||"log","INFO",arguments),this},debug(){return i>=hB&&n(t||"log","DEBUG",arguments),this}}}var Us=Array.isArray;function Cg(e){return e!=null?Us(e)?e:[e]:[]}function Ts(e){return typeof e=="function"}function _x(e){return Ts(e)?e:()=>e}function pB(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function WO(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const mB=Object.prototype.hasOwnProperty;function yB(e,t){return mB.call(e,t)}function HO(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),WO(i,n)}function Lo(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}function rl(e,t,n){return e.fields=t||[],e.fname=n,e}function bB(e){return e.length===1?vB(e[0]):xB(e)}const vB=e=>function(t){return t[e]},xB=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Ui(e){throw Error(e)}function wB(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Ui("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Ui("Access path missing closing bracket: "+e),i&&Ui("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function GO(e,t,n){const i=wB(e);return e=i.length===1?i[0]:e,rl((n&&n.get||bB)(i),[e],t||e)}GO("id");const YO=rl(e=>e,[],"identity");rl(()=>0,[],"zero");rl(()=>1,[],"one");rl(()=>!0,[],"true");rl(()=>!1,[],"false");var VO=Array.isArray;function XO(e){return e===Object(e)}function G$(e){return e==null||e===""?null:+e}function Sx(e){return typeof e=="function"}function Cx(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const AB=Object.prototype.hasOwnProperty;function KO(e,t){return AB.call(e,t)}function EB(e){return Object.prototype.toString.call(e)==="[object Date]"}function $B(e){return e&&Sx(e[Symbol.iterator])}function _B(e){return typeof e=="number"}function SB(e){return typeof e=="string"}function kx(e){return VO(e)?"["+e.map(kx)+"]":XO(e)||SB(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function CB(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const kB=e=>_B(e)||EB(e)?e:Date.parse(e);function FB(e,t){return t=t||kB,e==null||e===""?null:t(e)}function OB(e){return e==null||e===""?null:e+""}var Y$={},S1={},C1=34,Yl=10,k1=13;function JO(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function DB(e,t){var n=JO(e);return function(i,r){return t(n(i),r,e)}}function V$(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function un(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function MB(e){return e<0?"-"+un(-e,6):e>9999?"+"+un(e,6):un(e,4)}function TB(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":MB(e.getUTCFullYear())+"-"+un(e.getUTCMonth()+1,2)+"-"+un(e.getUTCDate(),2)+(r?"T"+un(t,2)+":"+un(n,2)+":"+un(i,2)+"."+un(r,3)+"Z":i?"T"+un(t,2)+":"+un(n,2)+":"+un(i,2)+"Z":n||t?"T"+un(t,2)+":"+un(n,2)+"Z":"")}function NB(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var h,g,p=r(f,function(m,y){if(h)return h(m,y-1);g=m,h=d?DB(m,d):JO(m)});return p.columns=g||[],p}function r(f,d){var h=[],g=f.length,p=0,m=0,y,b=g<=0,v=!1;f.charCodeAt(g-1)===Yl&&--g,f.charCodeAt(g-1)===k1&&--g;function x(){if(b)return S1;if(v)return v=!1,Y$;var E,w=p,$;if(f.charCodeAt(w)===C1){for(;p++<g&&f.charCodeAt(p)!==C1||f.charCodeAt(++p)===C1;);return(E=p)>=g?b=!0:($=f.charCodeAt(p++))===Yl?v=!0:$===k1&&(v=!0,f.charCodeAt(p)===Yl&&++p),f.slice(w+1,E-1).replace(/""/g,'"')}for(;p<g;){if(($=f.charCodeAt(E=p++))===Yl)v=!0;else if($===k1)v=!0,f.charCodeAt(p)===Yl&&++p;else if($!==n)continue;return f.slice(w,E)}return b=!0,f.slice(w,g)}for(;(y=x())!==S1;){for(var A=[];y!==Y$&&y!==S1;)A.push(y),y=x();d&&(A=d(A,m++))==null||h.push(A)}return h}function s(f,d){return f.map(function(h){return d.map(function(g){return c(h[g])}).join(e)})}function o(f,d){return d==null&&(d=V$(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function a(f,d){return d==null&&(d=V$(f)),s(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?TB(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:o,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function jB(e){return e}function RB(e){if(e==null)return jB;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*i+s,f[1]=(n+=a[1])*r+o;l<c;)f[l]=a[l],++l;return f}}function BB(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function PB(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return X$(e,n)})}:X$(e,t)}function X$(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=QO(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function QO(e,t){var n=RB(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,g=d.length;h<g;++h)f.push(n(d[h],h));c<0&&BB(f,g)}function s(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function zB(e,t){var n={},i={},r={},s=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,g;if(h=r[f])if(delete r[h.end],h.push(l),h.end=d,g=i[d]){delete i[g.start];var p=g===h?h:h.concat(g);i[p.start=h.start]=r[p.end=g.end]=p}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(l),h.start=f,g=r[f]){delete r[g.end];var m=g===h?h:g.concat(h);i[m.start=g.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else h=[l],i[h.start=f]=r[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),s.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function LB(e){return QO(e,IB.apply(this,arguments))}function IB(e,t,n){var i,r,s;if(arguments.length>1)i=UB(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:zB(e,i)}}function UB(e,t,n){var i=[],r=[],s;function o(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:s})}function a(f){f.forEach(o)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}function zr(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function qB(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function id(e){let t,n,i;e.length!==2?(t=zr,n=(a,u)=>zr(e(a),u),i=(a,u)=>e(a)-u):(t=e===zr||e===qB?e:WB,n=e,i=e);function r(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){const f=r(a,u,l,c-1);return f>l&&i(a[f-1],u)>-i(a[f],u)?f-1:f}return{left:r,center:o,right:s}}function WB(){return 0}function ZO(e){return e===null?NaN:+e}function*HB(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const e3=id(zr),kg=e3.right,GB=e3.left;id(ZO).center;const rd=kg;function YB(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}function VB(e,t){const n=YB(e,t);return n&&Math.sqrt(n)}class Zt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}class K$ extends Map{constructor(t,n=i3){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(ab(this,t))}has(t){return super.has(ab(this,t))}set(t,n){return super.set(t3(this,t),n)}delete(t){return super.delete(n3(this,t))}}class Fg extends Set{constructor(t,n=i3){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const i of t)this.add(i)}has(t){return super.has(ab(this,t))}add(t){return super.add(t3(this,t))}delete(t){return super.delete(n3(this,t))}}function ab({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function t3({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function n3({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function i3(e){return e!==null&&typeof e=="object"?e.valueOf():e}function XB(e,t){return Array.from(t,n=>e[n])}function KB(e=zr){if(e===zr)return r3;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function r3(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const JB=Math.sqrt(50),QB=Math.sqrt(10),ZB=Math.sqrt(2);function Og(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=JB?10:s>=QB?5:s>=ZB?2:1;let a,u,l;return r<0?(l=Math.pow(10,-r)/o,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,r)*o,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?Og(e,t,n*2):[a,u,l]}function ub(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,s,o]=i?Og(t,e,n):Og(e,t,n);if(!(s>=r))return[];const a=s-r+1,u=new Array(a);if(i)if(o<0)for(let l=0;l<a;++l)u[l]=(s-l)/-o;else for(let l=0;l<a;++l)u[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)u[l]=(r+l)/-o;else for(let l=0;l<a;++l)u[l]=(r+l)*o;return u}function lb(e,t,n){return t=+t,e=+e,n=+n,Og(e,t,n)[2]}function qs(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?lb(t,e,n):lb(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function ra(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function cb(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function s3(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=r===void 0?r3:KB(r);i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(i,Math.floor(t+(u-l)*f/u+d));s3(e,t,h,g,r)}const s=e[t];let o=n,a=i;for(Vl(e,n,t),r(e[i],s)>0&&Vl(e,n,i);o<a;){for(Vl(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}r(e[n],s)===0?Vl(e,n,a):(++a,Vl(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function Vl(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function fb(e,t,n){if(e=Float64Array.from(HB(e,n)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return cb(e);if(t>=1)return ra(e);var i,r=(i-1)*t,s=Math.floor(r),o=ra(s3(e,s).subarray(0,s+1)),a=cb(e.subarray(s+1));return o+(a-o)*(r-s)}}function o3(e,t,n=ZO){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(r-s)}}function eP(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function a3(e,t){return fb(e,.5,t)}function*tP(e){for(const t of e)yield*t}function u3(e){return Array.from(tP(e))}function Tn(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function l3(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function nP(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Dg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function _u(e){return e=Dg(Math.abs(e)),e?e[1]:NaN}function iP(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),s.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function rP(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var sP=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ff(e){if(!(t=sP.exec(e)))throw new Error("invalid format: "+e);var t;return new Fx({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ff.prototype=Fx.prototype;function Fx(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Fx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oP(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var c3;function aP(e,t){var n=Dg(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(c3=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Dg(e,Math.max(0,t+s-1))[0]}function J$(e,t){var n=Dg(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const Q$={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:nP,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>J$(e*100,t),r:J$,s:aP,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Z$(e){return e}var e_=Array.prototype.map,t_=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function f3(e){var t=e.grouping===void 0||e.thousands===void 0?Z$:iP(e_.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Z$:rP(e_.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=ff(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,b=f.comma,v=f.precision,x=f.trim,A=f.type;A==="n"?(b=!0,A="g"):Q$[A]||(v===void 0&&(v=12),x=!0,A="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=p==="$"?n:p==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",w=p==="$"?i:/[%p]/.test(A)?o:"",$=Q$[A],S=/[defgprs%]/.test(A);v=v===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function _(C){var M=E,F=w,O,k,j;if(A==="c")F=$(C)+F,C="";else{C=+C;var B=C<0||1/C<0;if(C=isNaN(C)?u:$(Math.abs(C),v),x&&(C=oP(C)),B&&+C==0&&g!=="+"&&(B=!1),M=(B?g==="("?g:a:g==="-"||g==="("?"":g)+M,F=(A==="s"?t_[8+c3/3]:"")+F+(B&&g==="("?")":""),S){for(O=-1,k=C.length;++O<k;)if(j=C.charCodeAt(O),48>j||j>57){F=(j===46?r+C.slice(O+1):C.slice(O))+F,C=C.slice(0,O);break}}}b&&!m&&(C=t(C,1/0));var I=M.length+C.length+F.length,q=I<y?new Array(y-I+1).join(d):"";switch(b&&m&&(C=t(q+C,q.length?y-F.length:1/0),q=""),h){case"<":C=M+C+F+q;break;case"=":C=M+q+C+F;break;case"^":C=q.slice(0,I=q.length>>1)+M+C+F+q.slice(I);break;default:C=q+M+C+F;break}return s(C)}return _.toString=function(){return f+""},_}function c(f,d){var h=l((f=ff(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(_u(d)/3)))*3,p=Math.pow(10,-g),m=t_[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var th,d3,h3;uP({thousands:",",grouping:[3],currency:["$",""]});function uP(e){return th=f3(e),d3=th.format,h3=th.formatPrefix,th}function lP(e){return Math.max(0,-_u(Math.abs(e)))}function cP(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(_u(t)/3)))*3-_u(Math.abs(e)))}function fP(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,_u(t)-_u(e))+1}function sl(e,t,n){return e.fields=t||[],e.fname=n,e}function dP(e){return e.length===1?hP(e[0]):gP(e)}const hP=e=>function(t){return t[e]},gP=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function mu(e){throw Error(e)}function pP(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||mu("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&mu("Access path missing closing bracket: "+e),i&&mu("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function mP(e,t,n){const i=pP(e);return e=i.length===1?i[0]:e,sl((n&&n.get||dP)(i),[e],t||e)}mP("id");sl(e=>e,[],"identity");const Xl=sl(()=>0,[],"zero"),yP=sl(()=>1,[],"one");sl(()=>!0,[],"true");sl(()=>!1,[],"false");var bP=Array.isArray;function g3(e){return e[e.length-1]}function vP(e){return e!=null?bP(e)?e:[e]:[]}function xP(e){return typeof e=="function"}function wP(e){return xP(e)?e:()=>e}function AP(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const EP=Object.prototype.hasOwnProperty;function $P(e,t){return EP.call(e,t)}function _P(e){return e&&g3(e)-e[0]||0}function SP(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}const F1=new Date,O1=new Date;function at(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(e(s=new Date(+s)),s),r.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),r.round=s=>{const o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),r.range=(s,o,a)=>{const u=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;let l;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},r.filter=s=>at(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(r.count=(s,o)=>(F1.setTime(+s),O1.setTime(+o),e(F1),e(O1),Math.floor(n(F1,O1))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?o=>i(o)%s===0:o=>r.count(0,o)%s===0):r)),r}const Su=at(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Su.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?at(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Su);Su.range;const Nr=1e3,qn=Nr*60,jr=qn*60,Vr=jr*24,Ox=Vr*7,n_=Vr*30,D1=Vr*365,Rr=at(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Nr)},(e,t)=>(t-e)/Nr,e=>e.getUTCSeconds());Rr.range;const Ep=at(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Nr)},(e,t)=>{e.setTime(+e+t*qn)},(e,t)=>(t-e)/qn,e=>e.getMinutes());Ep.range;const $p=at(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*qn)},(e,t)=>(t-e)/qn,e=>e.getUTCMinutes());$p.range;const _p=at(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Nr-e.getMinutes()*qn)},(e,t)=>{e.setTime(+e+t*jr)},(e,t)=>(t-e)/jr,e=>e.getHours());_p.range;const Sp=at(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*jr)},(e,t)=>(t-e)/jr,e=>e.getUTCHours());Sp.range;const Lr=at(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*qn)/Vr,e=>e.getDate()-1);Lr.range;const Ns=at(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Vr,e=>e.getUTCDate()-1);Ns.range;const p3=at(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Vr,e=>Math.floor(e/Vr));p3.range;function Ta(e){return at(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*qn)/Ox)}const ol=Ta(0),Mg=Ta(1),CP=Ta(2),kP=Ta(3),Cu=Ta(4),FP=Ta(5),OP=Ta(6);ol.range;Mg.range;CP.range;kP.range;Cu.range;FP.range;OP.range;function Na(e){return at(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Ox)}const al=Na(0),Tg=Na(1),DP=Na(2),MP=Na(3),ku=Na(4),TP=Na(5),NP=Na(6);al.range;Tg.range;DP.range;MP.range;ku.range;TP.range;NP.range;const df=at(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());df.range;const hf=at(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());hf.range;const Ji=at(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ji.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:at(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Ji.range;const Qi=at(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Qi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:at(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Qi.range;function m3(e,t,n,i,r,s){const o=[[Rr,1,Nr],[Rr,5,5*Nr],[Rr,15,15*Nr],[Rr,30,30*Nr],[s,1,qn],[s,5,5*qn],[s,15,15*qn],[s,30,30*qn],[r,1,jr],[r,3,3*jr],[r,6,6*jr],[r,12,12*jr],[i,1,Vr],[i,2,2*Vr],[n,1,Ox],[t,1,n_],[t,3,3*n_],[e,1,D1]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),g=h?h.range(l,+c+1):[];return d?g.reverse():g}function u(l,c,f){const d=Math.abs(c-l)/f,h=id(([,,m])=>m).right(o,d);if(h===o.length)return e.every(qs(l/D1,c/D1,f));if(h===0)return Su.every(Math.max(qs(l,c,f),1));const[g,p]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return g.every(p)}return[a,u]}const[jP,RP]=m3(Qi,hf,al,p3,Sp,$p),[BP,PP]=m3(Ji,df,ol,Lr,_p,Ep),At="year",vn="quarter",Bt="month",it="week",xn="date",Tt="day",Zi="dayofyear",Rn="hours",Bn="minutes",Xn="seconds",Ai="milliseconds",Dx=[At,vn,Bt,it,xn,Tt,Zi,Rn,Bn,Xn,Ai],M1=Dx.reduce((e,t,n)=>(e[t]=1+n,e),{});function Mx(e){const t=vP(e).slice(),n={};return t.length||mu("Missing time unit."),t.forEach(r=>{$P(M1,r)?n[r]=1:mu(`Invalid time unit: ${r}.`)}),(n[it]||n[Tt]?1:0)+(n[vn]||n[Bt]||n[xn]?1:0)+(n[Zi]?1:0)>1&&mu(`Incompatible time units: ${e}`),t.sort((r,s)=>M1[r]-M1[s]),t}const zP={[At]:"%Y ",[vn]:"Q%q ",[Bt]:"%b ",[xn]:"%d ",[it]:"W%U ",[Tt]:"%a ",[Zi]:"%j ",[Rn]:"%H:00",[Bn]:"00:%M",[Xn]:":%S",[Ai]:".%L",[`${At}-${Bt}`]:"%Y-%m ",[`${At}-${Bt}-${xn}`]:"%Y-%m-%d ",[`${Rn}-${Bn}`]:"%H:%M"};function y3(e,t){const n=AP({},zP,t),i=Mx(e),r=i.length;let s="",o=0,a,u;for(o=0;o<r;)for(a=i.length;a>o;--a)if(u=i.slice(o,a).join("-"),n[u]!=null){s+=n[u],o=a;break}return s.trim()}const Wo=new Date;function Tx(e){return Wo.setFullYear(e),Wo.setMonth(0),Wo.setDate(1),Wo.setHours(0,0,0,0),Wo}function b3(e){return x3(new Date(e))}function v3(e){return db(new Date(e))}function x3(e){return Lr.count(Tx(e.getFullYear())-1,e)}function db(e){return ol.count(Tx(e.getFullYear())-1,e)}function hb(e){return Tx(e).getDay()}function LP(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function w3(e){return E3(new Date(e))}function A3(e){return gb(new Date(e))}function E3(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Ns.count(t-1,e)}function gb(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return al.count(t-1,e)}function pb(e){return Wo.setTime(Date.UTC(e,0,1)),Wo.getUTCDay()}function IP(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function $3(e,t,n,i,r){const s=t||1,o=g3(e),a=(y,b,v)=>(v=v||y,UP(n[v],i[v],y===o&&s,b)),u=new Date,l=SP(e),c=l[At]?a(At):wP(2012),f=l[Bt]?a(Bt):l[vn]?a(vn):Xl,d=l[it]&&l[Tt]?a(Tt,1,it+Tt):l[it]?a(it,1):l[Tt]?a(Tt,1):l[xn]?a(xn,1):l[Zi]?a(Zi,1):yP,h=l[Rn]?a(Rn):Xl,g=l[Bn]?a(Bn):Xl,p=l[Xn]?a(Xn):Xl,m=l[Ai]?a(Ai):Xl;return function(y){u.setTime(+y);const b=c(u);return r(b,f(u),d(u,b),h(u),g(u),p(u),m(u))}}function UP(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}function Fu(e,t,n){return t+e*7-(n+6)%7}const qP={[At]:e=>e.getFullYear(),[vn]:e=>Math.floor(e.getMonth()/3),[Bt]:e=>e.getMonth(),[xn]:e=>e.getDate(),[Rn]:e=>e.getHours(),[Bn]:e=>e.getMinutes(),[Xn]:e=>e.getSeconds(),[Ai]:e=>e.getMilliseconds(),[Zi]:e=>x3(e),[it]:e=>db(e),[it+Tt]:(e,t)=>Fu(db(e),e.getDay(),hb(t)),[Tt]:(e,t)=>Fu(1,e.getDay(),hb(t))},WP={[vn]:e=>3*e,[it]:(e,t)=>Fu(e,0,hb(t))};function _3(e,t){return $3(e,t||1,qP,WP,LP)}const HP={[At]:e=>e.getUTCFullYear(),[vn]:e=>Math.floor(e.getUTCMonth()/3),[Bt]:e=>e.getUTCMonth(),[xn]:e=>e.getUTCDate(),[Rn]:e=>e.getUTCHours(),[Bn]:e=>e.getUTCMinutes(),[Xn]:e=>e.getUTCSeconds(),[Ai]:e=>e.getUTCMilliseconds(),[Zi]:e=>E3(e),[it]:e=>gb(e),[Tt]:(e,t)=>Fu(1,e.getUTCDay(),pb(t)),[it+Tt]:(e,t)=>Fu(gb(e),e.getUTCDay(),pb(t))},GP={[vn]:e=>3*e,[it]:(e,t)=>Fu(e,0,pb(t))};function S3(e,t){return $3(e,t||1,HP,GP,IP)}const YP={[At]:Ji,[vn]:df.every(3),[Bt]:df,[it]:ol,[xn]:Lr,[Tt]:Lr,[Zi]:Lr,[Rn]:_p,[Bn]:Ep,[Xn]:Rr,[Ai]:Su},VP={[At]:Qi,[vn]:hf.every(3),[Bt]:hf,[it]:al,[xn]:Ns,[Tt]:Ns,[Zi]:Ns,[Rn]:Sp,[Bn]:$p,[Xn]:Rr,[Ai]:Su};function ul(e){return YP[e]}function ll(e){return VP[e]}function C3(e,t,n){return e?e.offset(t,n):void 0}function k3(e,t,n){return C3(ul(e),t,n)}function F3(e,t,n){return C3(ll(e),t,n)}function O3(e,t,n,i){return e?e.range(t,n,i):void 0}function D3(e,t,n,i){return O3(ul(e),t,n,i)}function M3(e,t,n,i){return O3(ll(e),t,n,i)}const vc=1e3,xc=vc*60,wc=xc*60,Cp=wc*24,XP=Cp*7,i_=Cp*30,mb=Cp*365,T3=[At,Bt,xn,Rn,Bn,Xn,Ai],Ac=T3.slice(0,-1),Ec=Ac.slice(0,-1),$c=Ec.slice(0,-1),KP=$c.slice(0,-1),JP=[At,it],r_=[At,Bt],N3=[At],Kl=[[Ac,1,vc],[Ac,5,5*vc],[Ac,15,15*vc],[Ac,30,30*vc],[Ec,1,xc],[Ec,5,5*xc],[Ec,15,15*xc],[Ec,30,30*xc],[$c,1,wc],[$c,3,3*wc],[$c,6,6*wc],[$c,12,12*wc],[KP,1,Cp],[JP,1,XP],[r_,1,i_],[r_,3,3*i_],[N3,1,mb]];function j3(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(_P(t))/n;let r=id(a=>a[2]).right(Kl,i),s,o;return r===Kl.length?(s=N3,o=qs(t[0]/mb,t[1]/mb,n)):r?(r=Kl[i/Kl[r-1][2]<Kl[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=T3,o=Math.max(qs(t[0],t[1],n),1)),{units:s,step:o}}function cl(e,t,n){return e.fields=t||[],e.fname=n,e}function QP(e){return e.length===1?ZP(e[0]):ez(e)}const ZP=e=>function(t){return t[e]},ez=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Lc(e){throw Error(e)}function tz(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Lc("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Lc("Access path missing closing bracket: "+e),i&&Lc("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function nz(e,t,n){const i=tz(e);return e=i.length===1?i[0]:e,cl((n&&n.get||QP)(i),[e],t||e)}nz("id");cl(e=>e,[],"identity");cl(()=>0,[],"zero");cl(()=>1,[],"one");cl(()=>!0,[],"true");cl(()=>!1,[],"false");function iz(e){return e===Object(e)}function rz(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function s_(e){return typeof e=="string"}function T1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function N1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Jl(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function R3(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=Ql(r),c=Zl(r),f=Ql(s),d=Zl(s),h=Ql(o),g=Zl(o),p=Ql(a),m=Zl(a),y=Ql(u),b=Zl(u),v={a:B,A:I,b:q,B:ue,c:null,d:f_,e:f_,f:Cz,g:Bz,G:zz,H:$z,I:_z,j:Sz,L:B3,m:kz,M:Fz,p:Pe,q:tt,Q:g_,s:p_,S:Oz,u:Dz,U:Mz,V:Tz,w:Nz,W:jz,x:null,X:null,y:Rz,Y:Pz,Z:Lz,"%":h_},x={a:lt,A:Ut,b:Ie,B:ii,c:null,d:d_,e:d_,f:Wz,g:eL,G:nL,H:Iz,I:Uz,j:qz,L:z3,m:Hz,M:Gz,p:_o,q:ds,Q:g_,s:p_,S:Yz,u:Vz,U:Xz,V:Kz,w:Jz,W:Qz,x:null,X:null,y:Zz,Y:tL,Z:iL,"%":h_},A={a:_,A:C,b:M,B:F,c:O,d:l_,e:l_,f:xz,g:u_,G:a_,H:c_,I:c_,j:mz,L:vz,m:pz,M:yz,p:S,q:gz,Q:Az,s:Ez,S:bz,u:lz,U:cz,V:fz,w:uz,W:dz,x:k,X:j,y:u_,Y:a_,Z:hz,"%":wz};v.x=E(n,v),v.X=E(i,v),v.c=E(t,v),x.x=E(n,x),x.X=E(i,x),x.c=E(t,x);function E(W,se){return function(oe){var P=[],an=-1,Oe=0,Sn=W.length,Cn,So,q$;for(oe instanceof Date||(oe=new Date(+oe));++an<Sn;)W.charCodeAt(an)===37&&(P.push(W.slice(Oe,an)),(So=o_[Cn=W.charAt(++an)])!=null?Cn=W.charAt(++an):So=Cn==="e"?" ":"0",(q$=se[Cn])&&(Cn=q$(oe,So)),P.push(Cn),Oe=an+1);return P.push(W.slice(Oe,an)),P.join("")}}function w(W,se){return function(oe){var P=Jl(1900,void 0,1),an=$(P,W,oe+="",0),Oe,Sn;if(an!=oe.length)return null;if("Q"in P)return new Date(P.Q);if("s"in P)return new Date(P.s*1e3+("L"in P?P.L:0));if(se&&!("Z"in P)&&(P.Z=0),"p"in P&&(P.H=P.H%12+P.p*12),P.m===void 0&&(P.m="q"in P?P.q:0),"V"in P){if(P.V<1||P.V>53)return null;"w"in P||(P.w=1),"Z"in P?(Oe=N1(Jl(P.y,0,1)),Sn=Oe.getUTCDay(),Oe=Sn>4||Sn===0?Tg.ceil(Oe):Tg(Oe),Oe=Ns.offset(Oe,(P.V-1)*7),P.y=Oe.getUTCFullYear(),P.m=Oe.getUTCMonth(),P.d=Oe.getUTCDate()+(P.w+6)%7):(Oe=T1(Jl(P.y,0,1)),Sn=Oe.getDay(),Oe=Sn>4||Sn===0?Mg.ceil(Oe):Mg(Oe),Oe=Lr.offset(Oe,(P.V-1)*7),P.y=Oe.getFullYear(),P.m=Oe.getMonth(),P.d=Oe.getDate()+(P.w+6)%7)}else("W"in P||"U"in P)&&("w"in P||(P.w="u"in P?P.u%7:"W"in P?1:0),Sn="Z"in P?N1(Jl(P.y,0,1)).getUTCDay():T1(Jl(P.y,0,1)).getDay(),P.m=0,P.d="W"in P?(P.w+6)%7+P.W*7-(Sn+5)%7:P.w+P.U*7-(Sn+6)%7);return"Z"in P?(P.H+=P.Z/100|0,P.M+=P.Z%100,N1(P)):T1(P)}}function $(W,se,oe,P){for(var an=0,Oe=se.length,Sn=oe.length,Cn,So;an<Oe;){if(P>=Sn)return-1;if(Cn=se.charCodeAt(an++),Cn===37){if(Cn=se.charAt(an++),So=A[Cn in o_?se.charAt(an++):Cn],!So||(P=So(W,oe,P))<0)return-1}else if(Cn!=oe.charCodeAt(P++))return-1}return P}function S(W,se,oe){var P=l.exec(se.slice(oe));return P?(W.p=c.get(P[0].toLowerCase()),oe+P[0].length):-1}function _(W,se,oe){var P=h.exec(se.slice(oe));return P?(W.w=g.get(P[0].toLowerCase()),oe+P[0].length):-1}function C(W,se,oe){var P=f.exec(se.slice(oe));return P?(W.w=d.get(P[0].toLowerCase()),oe+P[0].length):-1}function M(W,se,oe){var P=y.exec(se.slice(oe));return P?(W.m=b.get(P[0].toLowerCase()),oe+P[0].length):-1}function F(W,se,oe){var P=p.exec(se.slice(oe));return P?(W.m=m.get(P[0].toLowerCase()),oe+P[0].length):-1}function O(W,se,oe){return $(W,t,se,oe)}function k(W,se,oe){return $(W,n,se,oe)}function j(W,se,oe){return $(W,i,se,oe)}function B(W){return o[W.getDay()]}function I(W){return s[W.getDay()]}function q(W){return u[W.getMonth()]}function ue(W){return a[W.getMonth()]}function Pe(W){return r[+(W.getHours()>=12)]}function tt(W){return 1+~~(W.getMonth()/3)}function lt(W){return o[W.getUTCDay()]}function Ut(W){return s[W.getUTCDay()]}function Ie(W){return u[W.getUTCMonth()]}function ii(W){return a[W.getUTCMonth()]}function _o(W){return r[+(W.getUTCHours()>=12)]}function ds(W){return 1+~~(W.getUTCMonth()/3)}return{format:function(W){var se=E(W+="",v);return se.toString=function(){return W},se},parse:function(W){var se=w(W+="",!1);return se.toString=function(){return W},se},utcFormat:function(W){var se=E(W+="",x);return se.toString=function(){return W},se},utcParse:function(W){var se=w(W+="",!0);return se.toString=function(){return W},se}}}var o_={"-":"",_:" ",0:"0"},bt=/^\s*\d+/,sz=/^%/,oz=/[\\^$*+?|[\]().{}]/g;function be(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function az(e){return e.replace(oz,"\\$&")}function Ql(e){return new RegExp("^(?:"+e.map(az).join("|")+")","i")}function Zl(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function uz(e,t,n){var i=bt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function lz(e,t,n){var i=bt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function cz(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function fz(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function dz(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function a_(e,t,n){var i=bt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function u_(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function hz(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function gz(e,t,n){var i=bt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function pz(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function l_(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function mz(e,t,n){var i=bt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function c_(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function yz(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function bz(e,t,n){var i=bt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function vz(e,t,n){var i=bt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function xz(e,t,n){var i=bt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function wz(e,t,n){var i=sz.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function Az(e,t,n){var i=bt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function Ez(e,t,n){var i=bt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function f_(e,t){return be(e.getDate(),t,2)}function $z(e,t){return be(e.getHours(),t,2)}function _z(e,t){return be(e.getHours()%12||12,t,2)}function Sz(e,t){return be(1+Lr.count(Ji(e),e),t,3)}function B3(e,t){return be(e.getMilliseconds(),t,3)}function Cz(e,t){return B3(e,t)+"000"}function kz(e,t){return be(e.getMonth()+1,t,2)}function Fz(e,t){return be(e.getMinutes(),t,2)}function Oz(e,t){return be(e.getSeconds(),t,2)}function Dz(e){var t=e.getDay();return t===0?7:t}function Mz(e,t){return be(ol.count(Ji(e)-1,e),t,2)}function P3(e){var t=e.getDay();return t>=4||t===0?Cu(e):Cu.ceil(e)}function Tz(e,t){return e=P3(e),be(Cu.count(Ji(e),e)+(Ji(e).getDay()===4),t,2)}function Nz(e){return e.getDay()}function jz(e,t){return be(Mg.count(Ji(e)-1,e),t,2)}function Rz(e,t){return be(e.getFullYear()%100,t,2)}function Bz(e,t){return e=P3(e),be(e.getFullYear()%100,t,2)}function Pz(e,t){return be(e.getFullYear()%1e4,t,4)}function zz(e,t){var n=e.getDay();return e=n>=4||n===0?Cu(e):Cu.ceil(e),be(e.getFullYear()%1e4,t,4)}function Lz(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+be(t/60|0,"0",2)+be(t%60,"0",2)}function d_(e,t){return be(e.getUTCDate(),t,2)}function Iz(e,t){return be(e.getUTCHours(),t,2)}function Uz(e,t){return be(e.getUTCHours()%12||12,t,2)}function qz(e,t){return be(1+Ns.count(Qi(e),e),t,3)}function z3(e,t){return be(e.getUTCMilliseconds(),t,3)}function Wz(e,t){return z3(e,t)+"000"}function Hz(e,t){return be(e.getUTCMonth()+1,t,2)}function Gz(e,t){return be(e.getUTCMinutes(),t,2)}function Yz(e,t){return be(e.getUTCSeconds(),t,2)}function Vz(e){var t=e.getUTCDay();return t===0?7:t}function Xz(e,t){return be(al.count(Qi(e)-1,e),t,2)}function L3(e){var t=e.getUTCDay();return t>=4||t===0?ku(e):ku.ceil(e)}function Kz(e,t){return e=L3(e),be(ku.count(Qi(e),e)+(Qi(e).getUTCDay()===4),t,2)}function Jz(e){return e.getUTCDay()}function Qz(e,t){return be(Tg.count(Qi(e)-1,e),t,2)}function Zz(e,t){return be(e.getUTCFullYear()%100,t,2)}function eL(e,t){return e=L3(e),be(e.getUTCFullYear()%100,t,2)}function tL(e,t){return be(e.getUTCFullYear()%1e4,t,4)}function nL(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ku(e):ku.ceil(e),be(e.getUTCFullYear()%1e4,t,4)}function iL(){return"+0000"}function h_(){return"%"}function g_(e){return+e}function p_(e){return Math.floor(+e/1e3)}var Qa,Nx,I3,jx,U3;rL({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function rL(e){return Qa=R3(e),Nx=Qa.format,I3=Qa.parse,jx=Qa.utcFormat,U3=Qa.utcParse,Qa}function _c(e){const t={};return n=>t[n]||(t[n]=e(n))}function sL(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=oL(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function oL(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function q3(e){const t=_c(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=ff(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return sL(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,s,o){o=ff(o??",f");const a=qs(i,r,s),u=Math.max(Math.abs(i),Math.abs(r));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=cP(a,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=fP(a,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=lP(a))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let yb;W3();function W3(){return yb=q3({format:d3,formatPrefix:h3})}function H3(e){return q3(f3(e))}function Ng(e){return arguments.length?yb=H3(e):yb}function m_(e,t,n){n=n||{},iz(n)||Lc(`Invalid time multi-format specifier: ${n}`);const i=t(Xn),r=t(Bn),s=t(Rn),o=t(xn),a=t(it),u=t(Bt),l=t(vn),c=t(At),f=e(n[Ai]||".%L"),d=e(n[Xn]||":%S"),h=e(n[Bn]||"%I:%M"),g=e(n[Rn]||"%I %p"),p=e(n[xn]||n[Tt]||"%a %d"),m=e(n[it]||"%b %d"),y=e(n[Bt]||"%B"),b=e(n[vn]||"%B"),v=e(n[At]||"%Y");return x=>(i(x)<x?f:r(x)<x?d:s(x)<x?h:o(x)<x?g:u(x)<x?a(x)<x?p:m:c(x)<x?l(x)<x?y:b:v)(x)}function G3(e){const t=_c(e.format),n=_c(e.utcFormat);return{timeFormat:i=>s_(i)?t(i):m_(t,ul,i),utcFormat:i=>s_(i)?n(i):m_(n,ll,i),timeParse:_c(e.parse),utcParse:_c(e.utcParse)}}let bb;Y3();function Y3(){return bb=G3({format:Nx,parse:I3,utcFormat:jx,utcParse:U3})}function V3(e){return G3(R3(e))}function gf(e){return arguments.length?bb=V3(e):bb}const vb=(e,t)=>rz({},e,t);function X3(e,t){const n=e?H3(e):Ng(),i=t?V3(t):gf();return vb(n,i)}function Rx(e,t){const n=arguments.length;return n&&n!==2&&Lc("defaultLocale expects either zero or two arguments."),n?vb(Ng(e),gf(t)):vb(Ng(),gf())}function aL(){return W3(),Y3(),Rx()}const uL=/^(data:|([A-Za-z]+:)?\/\/)/,lL=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,cL=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,y_="file://";function fL(e,t){return n=>({options:n||{},sanitize:hL,load:dL,fileAccess:!!t,file:gL(t),http:mL(e)})}async function dL(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function hL(e,t){t=Cx({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=lL.test(e.replace(cL,""));(e==null||typeof e!="string"||!a)&&Ui("Sanitize failure, invalid URI: "+kx(e));const u=uL.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(y_))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(y_.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function gL(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):pL}async function pL(){Ui("No file system access.")}function mL(e){return e?async function(t,n){const i=Cx({},this.options.http,n),r=n&&n.response,s=await e(t,i);return s.ok?Sx(s[r])?s[r]():s.text():Ui(s.status+""+s.statusText)}:yL}async function yL(){Ui("No HTTP fetch method available.")}const bL=e=>e!=null&&e===e,vL=e=>e==="true"||e==="false"||e===!0||e===!1,xL=e=>!Number.isNaN(Date.parse(e)),K3=e=>!Number.isNaN(+e)&&!(e instanceof Date),wL=e=>K3(e)&&Number.isInteger(+e),xb={boolean:CB,integer:G$,number:G$,date:FB,string:OB,unknown:YO},nh=[vL,wL,K3,xL],AL=["boolean","integer","number","date"];function J3(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=nh.length,r=nh.map((s,o)=>o+1);for(let s=0,o=0,a,u;s<n;++s)for(u=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&bL(u)&&!nh[a](u)&&(r[a]=0,++o,o===nh.length))return"string";return AL[r.reduce((s,o)=>s===0?o:s,0)-1]}function Q3(e,t){return t.reduce((n,i)=>(n[i]=J3(e,i),n),{})}function b_(e){const t=function(n,i){const r={delimiter:e};return Bx(n,i?Cx(i,r):r)};return t.responseType="text",t}function Bx(e,t){return t.header&&(e=t.header.map(kx).join(t.delimiter)+`
`+e),NB(t.delimiter).parse(e+"")}Bx.responseType="text";function EL(e){return typeof Buffer=="function"&&Sx(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Px(e,t){const n=t&&t.property?GO(t.property):YO;return XO(e)&&!EL(e)?$L(n(e),t):n(JSON.parse(e))}Px.responseType="json";function $L(e,t){return!VO(e)&&$B(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const _L={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function Z3(e,t){let n,i,r,s;return e=Px(e,t),t&&t.feature?(n=PB,r=t.feature):t&&t.mesh?(n=LB,r=t.mesh,s=_L[t.filter]):Ui("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):Ui("Invalid TopoJSON object: "+r),i&&i.features||[i]}Z3.responseType="json";const Hh={dsv:Bx,csv:b_(","),tsv:b_("	"),json:Px,topojson:Z3};function zx(e,t){return arguments.length>1?(Hh[e]=t,this):KO(Hh,e)?Hh[e]:null}function eD(e){const t=zx(e);return t&&t.responseType||"text"}function tD(e,t,n,i){t=t||{};const r=zx(t.type||"json");return r||Ui("Unknown data format type: "+t.type),e=r(e,t),t.parse&&SL(e,t.parse,n,i),KO(e,"columns")&&delete e.columns,e}function SL(e,t,n,i){if(!e.length)return;const r=gf();n=n||r.timeParse,i=i||r.utcParse;let s=e.columns||Object.keys(e[0]),o,a,u,l,c,f;t==="auto"&&(t=Q3(e,s)),s=Object.keys(t);const d=s.map(h=>{const g=t[h];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?i:n)(m);if(!xb[g])throw Error("Illegal format pattern: "+h+":"+g);return xb[g]});for(u=0,c=e.length,f=s.length;u<c;++u)for(o=e[u],l=0;l<f;++l)a=s[l],o[a]=d[l](o[a])}const kp=fL(typeof fetch<"u"&&fetch,null);function Fp(e){const t=e||UO,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}async function Gh(e,t){try{await t(e)}catch(n){e.error(n)}}const nD=Symbol("vega_id");let CL=1;function Op(e){return!!(e&&V(e))}function V(e){return e[nD]}function iD(e,t){return e[nD]=t,e}function we(e){const t=e===Object(e)?e:{data:e};return V(t)?t:iD(t,CL++)}function Lx(e){return Dp(e,we({}))}function Dp(e,t){for(const n in e)t[n]=e[n];return t}function rD(e,t){return iD(t,V(e))}function ja(e,t){return e?t?(n,i)=>e(n,i)||V(t(n))-V(t(i)):(n,i)=>e(n,i)||V(n)-V(i):null}function sD(e){return e&&e.constructor===Ra}function Ra(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:Ra,insert(a){const u=Cg(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=Ts(a)?i:t,l=Cg(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:_x(l)};return Ts(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return Ts(a)?r.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,u){const l={},c={};let f,d,h,g,p,m;for(f=0,d=u.length;f<d;++f)l[V(u[f])]=1;for(f=0,d=t.length;f<d;++f)p=t[f],l[V(p)]=-1;for(f=0,d=i.length;f<d;++f)g=i[f],u.forEach(b=>{g(b)&&(l[V(b)]=-1)});for(f=0,d=e.length;f<d;++f)p=e[f],m=V(p),l[m]?l[m]=1:a.add.push(we(e[f]));for(f=0,d=u.length;f<d;++f)p=u[f],l[V(p)]<0&&a.rem.push(p);function y(b,v,x){x?b[v]=x(b):a.encode=v,o||(c[V(b)]=b)}for(f=0,d=n.length;f<d;++f)h=n[f],p=h.tuple,g=h.field,m=l[V(p)],m>0&&(y(p,g,h.value),a.modifies(g));for(f=0,d=r.length;f<d;++f)h=r[f],g=h.filter,u.forEach(b=>{g(b)&&l[V(b)]>0&&y(b,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=t.length||i.length?u.filter(b=>l[V(b)]>0):u.slice();else for(m in c)a.mod.push(c[m]);return(s||s==null&&(t.length||i.length))&&a.clean(!0),a}}}const Yh="_:mod:_";function Mp(){Object.defineProperty(this,Yh,{writable:!0,value:{}})}Mp.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[Yh];return t!=null&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=Us(n)?1+n.length:-1),r},modified(e,t){const n=this[Yh];if(arguments.length){if(Us(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Yh]={},this}};let kL=0;const FL="pulse",OL=new Mp,DL=1,ML=2;function ke(e,t,n,i){this.id=++kL,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function v_(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}ke.prototype={targets(){return this._targets||(this._targets=Fp(Ap))},set(e){return this.value!==e?(this.value=e,1):0},skip:v_(DL),modified:v_(ML),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new Mp,r=this._argops=this._argops||[],s=[];let o,a,u,l;const c=(f,d,h)=>{h instanceof ke?(h!==this&&(t&&h.targets().add(this),s.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(o in e)if(a=e[o],o===FL)Cg(a).forEach(f=>{f instanceof ke?f!==this&&(f.targets().add(this),s.push(f)):ia("Pulse parameters must be operator instances.")}),this.source=a;else if(Us(a))for(i.set(o,-1,Array(u=a.length)),l=0;l<u;++l)c(o,l,a[l]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||OL,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function TL(e,t,n,i){let r=1,s;return e instanceof ke?s=e:e&&e.prototype instanceof ke?s=new e:Ts(e)?s=new ke(null,e):(r=0,s=new ke(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s}function NL(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let jL=0;function Tp(e,t,n){this.id=++jL,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function ps(e,t,n){return new Tp(e,t,n)}Tp.prototype={_filter:ob,_apply:UO,targets(){return this._targets||(this._targets=Fp(Ap))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=ps(e);return this.targets().add(t),t},apply(e){const t=ps(null,e);return this.targets().add(t),t},merge(){const e=ps();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=ps();return this.targets().add(ps(null,null,pB(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(ps(null,null,()=>n=!0)),t.targets().add(ps(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=ob,this._targets=null}};function RL(e,t,n,i){const r=this,s=ps(n,i),o=function(l){l.dataflow=r;try{s.receive(l)}catch(c){r.error(c)}finally{r.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=Cg(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,o);return s}function BL(e,t){const n=this.locale();return tD(e,t,n.timeParse,n.utcParse)}function PL(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function zL(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:eD(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}async function LL(e,t,n){const i=this,r=i._pending||IL(i);r.requests+=1;const s=await i.request(t,n);return i.pulse(e,i.changeset().remove(ob).insert(s.data||[])),r.done(),s}function IL(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const UL={skip:!0};function qL(e,t,n,i,r){return(e instanceof ke?HL:WL)(this,e,t,n,i,r),this}function WL(e,t,n,i,r,s){const o=WO({},s,UL);let a,u;Ts(n)||(n=_x(n)),i===void 0?a=l=>e.touch(n(l)):Ts(i)?(u=new ke(null,i,r,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;sD(f)?e.pulse(c,f,s):e.update(c,f,o)}):a=l=>e.update(n(l),i,o),t.apply(a)}function HL(e,t,n,i,r,s){if(i===void 0)t.targets().add(n);else{const o=s||{},a=new ke(null,GL(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function GL(e,t){return t=Ts(t)?t:_x(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function YL(e){e.rank=++this._rank}function VL(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&ia("Cycle detected in dataflow graph.")}const jg={},Ri=1,ys=2,kr=4,XL=Ri|ys,x_=Ri|kr,Za=Ri|ys|kr,w_=8,ec=16,A_=32,E_=64;function js(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function j1(e,t){const n=[];return Lo(e,t,i=>n.push(i)),n}function $_(e,t){const n={};return e.visit(t,i=>{n[V(i)]=1}),i=>n[V(i)]?null:i}function ih(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}js.prototype={StopPropagation:jg,ADD:Ri,REM:ys,MOD:kr,ADD_REM:XL,ADD_MOD:x_,ALL:Za,REFLOW:w_,SOURCE:ec,NO_SOURCE:A_,NO_FIELDS:E_,fork(e){return new js(this.dataflow).init(this,e)},clone(){const e=this.fork(Za);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Za|ec)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new js(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&E_)&&(n.fields=e.fields),t&Ri?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&ys?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&kr?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&A_?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Za;return t&Ri&&this.add.length||t&ys&&this.rem.length||t&kr&&this.mod.length},reflow(e){if(e)return this.fork(Za).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(kr,$_(this,Ri))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Us(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?Us(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Ri&&(n.addF=ih(n.addF,t)),e&ys&&(n.remF=ih(n.remF,t)),e&kr&&(n.modF=ih(n.modF,t)),e&ec&&(n.srcF=ih(n.srcF,t)),n},materialize(e){e=e||Za;const t=this;return e&Ri&&t.addF&&(t.add=j1(t.add,t.addF),t.addF=null),e&ys&&t.remF&&(t.rem=j1(t.rem,t.remF),t.remF=null),e&kr&&t.modF&&(t.mod=j1(t.mod,t.modF),t.modF=null),e&ec&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&ec)return Lo(n.source,n.srcF,i),n;e&Ri&&Lo(n.add,n.addF,i),e&ys&&Lo(n.rem,n.remF,i),e&kr&&Lo(n.mod,n.modF,i);const r=n.source;if(e&w_&&r){const s=n.add.length+n.mod.length;s===r.length||(s?Lo(r,$_(n,x_),i):Lo(r,n.srcF,i))}return n}};function Ix(e,t,n,i){const r=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(const o of n)if(o.stamp===t){if(o.fields){const a=r.fields||(r.fields={});for(const u in o.fields)a[u]=1}o.changed(r.ADD)&&(s|=r.ADD),o.changed(r.REM)&&(s|=r.REM),o.changed(r.MOD)&&(s|=r.MOD)}this.changes=s}HO(Ix,js,{fork(e){const t=new js(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Us(e)?e.some(i=>n[i]):n[e]:0},filter(){ia("MultiPulse does not support filtering.")},materialize(){ia("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});async function KL(e,t,n){const i=this,r=[];if(i._pulse)return oD(i);if(i._pending&&await i._pending,t&&await Gh(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new js(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=Fp(Ap);let o=0,a,u,l;try{for(;i._heap.size()>0;){if(a=i._heap.pop(),a.rank!==a.qrank){i._enqueue(a,!0);continue}u=a.run(i._getPulse(a,e)),u.then?u=await u:u.async&&(r.push(u.async),u=jg),u!==jg&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await Gh(i,c[f].callback)}return n&&await Gh(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function JL(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function QL(e,t,n){return this._pulse?oD(this):(this.evaluate(e,t,n),this)}function ZL(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function oD(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function eI(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function tI(e,t){const n=e.source,i=this._clock;return n&&Us(n)?new Ix(this,i,n.map(r=>r.pulse),t):this._input[e.id]||nI(this._pulse,n&&n.pulse)}function nI(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==jg&&(e.source=t.source),e)}const Ux={skip:!1,force:!1};function iI(e,t){const n=t||Ux;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function rI(e,t,n){const i=n||Ux;return(e.set(t)||i.force)&&this.touch(e,i),this}function sI(e,t,n){this.touch(e,n||Ux);const i=new js(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function oI(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),aD(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,aI(t,0,e)):i=n,i}}}function aD(e,t,n,i){let r,s;const o=e[n];for(;n>t;){if(s=n-1>>1,r=e[s],i(o,r)<0){e[n]=r,n=s;continue}break}return e[n]=o}function aI(e,t,n){const i=t,r=e.length,s=e[t];let o=(t<<1)+1,a;for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=s,aD(e,i,t,n)}function yu(){this.logger(gB()),this.logLevel(qO),this._clock=0,this._rank=0,this._locale=Rx();try{this._loader=kp()}catch{}this._touched=Fp(Ap),this._input={},this._pulse=null,this._heap=oI((e,t)=>e.qrank-t.qrank),this._postrun=[]}function tc(e){return function(){return this._log[e].apply(this,arguments)}}yu.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:tc("error"),warn:tc("warn"),info:tc("info"),debug:tc("debug"),logLevel:tc("level"),cleanThreshold:1e4,add:TL,connect:NL,rank:YL,rerank:VL,pulse:sI,touch:iI,update:rI,changeset:Ra,ingest:PL,parse:BL,preload:LL,request:zL,events:RL,on:qL,evaluate:KL,run:QL,runAsync:JL,runAfter:ZL,_enqueue:eI,_getPulse:tI};function D(e,t){ke.call(this,e,null,t)}HO(D,ke,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Ou={};function uD(e){const t=lD(e);return t&&t.Definition||null}function lD(e){return e=e&&e.toLowerCase(),yB(Ou,e)?Ou[e]:null}function _i(e,t,n){return e.fields=t||[],e.fname=n,e}function yn(e){return e==null?null:e.fname}function er(e){return e==null?null:e.fields}function cD(e){return e.length===1?uI(e[0]):lI(e)}const uI=e=>function(t){return t[e]},lI=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Et(e){throw Error(e)}function fD(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Et("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Et("Access path missing closing bracket: "+e),i&&Et("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function pf(e,t,n){const i=fD(e);return e=i.length===1?i[0]:e,_i((n&&n.get||cD)(i),[e],t||e)}pf("id");const dD=_i(e=>e,[],"identity"),cI=_i(()=>0,[],"zero");_i(()=>1,[],"one");const fI=_i(()=>!0,[],"true");_i(()=>!1,[],"false");var hD=Array.isArray;function gD(e){return e[e.length-1]}function pD(e){return e==null||e===""?null:+e}function dn(e){return e!=null?hD(e)?e:[e]:[]}function mD(e){return typeof e=="function"}const dI="descending";function hI(e,t,n){n=n||{},t=dn(t)||[];const i=[],r=[],s={},o=n.comparator||gI;return dn(e).forEach((a,u)=>{a!=null&&(i.push(t[u]===dI?-1:1),r.push(a=mD(a)?a:pf(a,null,n)),(er(a)||[]).forEach(l=>s[l]=1))}),r.length===0?null:_i(o(r,i),Object.keys(s))}const qx=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),gI=(e,t)=>e.length===1?pI(e[0],t[0]):mI(e,t,e.length),pI=(e,t)=>function(n,i){return qx(e(n),e(i))*t},mI=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=qx(s(i),s(r));return o*t[a]});function yI(e){return mD(e)?e:()=>e}function Wx(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function mf(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function bI(e,t){const n=e.length;let i=-1,r,s,o,a,u;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}return[a,u]}const vI=Object.prototype.hasOwnProperty;function sd(e,t){return vI.call(e,t)}const rh={};function Hx(e){let t={},n;function i(s){return sd(t,s)&&t[s]!==rh}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===rh&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=rh),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==rh&&(!n||!n(u))&&(s[a]=u,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function ae(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Wx(i,n)}function xI(e,t,n){e&&(e=t?dn(e).map(a=>a.replace(/\\(.)/g,"$1")):dn(e));const i=e&&e.length,r=n&&n.get||cD,s=a=>r(t?[a]:fD(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<i;)l+="|"+a[c](u);return l}}return _i(o,e,"key")}function wI(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,u=0,l=0;for(;a<r&&u<s;++l)o[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<r;++a,++l)o[l]=t[a];for(;u<s;++u,++l)o[l]=n[u];return o}function AI(e){return e&&gD(e)-e[0]||0}function*yD(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function Gx(e,t,n){const i=Float64Array.from(yD(e,n));return i.sort(zr),t.map(r=>o3(i,r))}function Yx(e,t){return Gx(e,[.25,.5,.75],t)}function Vx(e,t){const n=e.length,i=VB(e,t),r=Yx(e,t),s=(r[2]-r[0])/1.34;return 1.06*(Math.min(i,s)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function bD(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,u,l,c,f,d;const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/i)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=r.length;f<d;++f)c=a/r[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const g=c>=0?0:~~(-c/i)+1,p=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+p)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var Kn=Math.random;function EI(e){Kn=e}function vD(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(yD(e,i)),s=r.length,o=t;let a,u,l,c;for(l=0,c=Array(o);l<o;++l){for(a=0,u=0;u<s;++u)a+=r[~~(Kn()*s)];c[l]=a/s}return c.sort(zr),[fb(c,n/2),fb(c,1-n/2)]}function xD(e,t,n,i){i=i||(d=>d);const r=e.length,s=new Float64Array(r);let o=0,a=1,u=i(e[0]),l=u,c=u+t,f;for(;a<r;++a){if(f=i(e[a]),f>=c){for(l=(u+l)/2;o<a;++o)s[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<a;++o)s[o]=l;return n?$I(s,t+t/4):s}function $I(e,t){const n=e.length;let i=0,r=1,s,o;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}function _I(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function SI(e,t){t==null&&(t=e,e=0);let n,i,r;const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample(){return n+Math.floor(r*Kn())},pdf(o){return o===Math.floor(o)&&o>=n&&o<i?1/r:0},cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*r):NaN}};return s.min(e).max(t)}const wD=Math.sqrt(2*Math.PI),CI=Math.SQRT2;let nc=NaN;function Np(e,t){e=e||0,t=t??1;let n=0,i=0,r,s;if(nc===nc)n=nc,nc=NaN;else{do n=Kn()*2-1,i=Kn()*2-1,r=n*n+i*i;while(r===0||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,nc=i*s}return e+n*t}function Xx(e,t,n){n=n??1;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*wD)}function jp(e,t,n){t=t||0,n=n??1;const i=(e-t)/n,r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s=s/a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function Rp(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*CI*kI(2*e-1)}function kI(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Kx(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>Np(n,i),pdf:s=>Xx(s,n,i),cdf:s=>jp(s,n,i),icdf:s=>Rp(s,n,i)};return r.mean(e).stdev(t)}function Jx(e,t){const n=Kx();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=Vx(e)),r):t},sample(){return e[~~(Kn()*i)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function Qx(e,t){return e=e||0,t=t??1,Math.exp(e+Np()*t)}function Zx(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*wD*e)}function e2(e,t,n){return jp(Math.log(e),t,n)}function t2(e,t,n){return Math.exp(Rp(e,t,n))}function AD(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>Qx(n,i),pdf:s=>Zx(s,n,i),cdf:s=>e2(s,n,i),icdf:s=>t2(s,n,i)};return r.mean(e).stdev(t)}function ED(e,t){let n=0,i;function r(o){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)a[l]/=u;return a}const s={weights(o){return arguments.length?(i=r(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=Kn();let a=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(o<u){a=e[l];break}return a.sample()},pdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].pdf(o);return a},cdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function n2(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Kn()}function i2(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function r2(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function s2(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function $D(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=s??1,r):i},sample:()=>n2(n,i),pdf:s=>i2(s,n,i),cdf:s=>r2(s,n,i),icdf:s=>s2(s,n,i)};return t==null&&(t=e??1,e=0),r.min(e).max(t)}function o2(e,t,n){let i=0,r=0;for(const s of e){const o=n(s);t(s)==null||o==null||isNaN(o)||(i+=(o-i)/++r)}return{coef:[i],predict:()=>i,rSquared:0}}function od(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function Bp(e,t,n,i){e=e.filter(h=>{let g=t(h),p=n(h);return g!=null&&(g=+g)>=g&&p!=null&&(p=+p)>=p}),i&&e.sort((h,g)=>t(h)-t(g));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let a=0,u=0,l=0,c,f,d;for(d of e)s[a]=c=+t(d),o[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<r;++a)s[a]-=u,o[a]-=l;return[s,o,u,l]}function ad(e,t,n,i){let r=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&i(s,o,++r)}function fl(e,t,n,i,r){let s=0,o=0;return ad(e,t,n,(a,u)=>{const l=u-r(a),c=u-i;s+=l*l,o+=c*c}),1-s/o}function a2(e,t,n){let i=0,r=0,s=0,o=0,a=0;ad(e,t,n,(c,f)=>{++a,i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=od(i,r,s,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:fl(e,t,n,r,l)}}function _D(e,t,n){let i=0,r=0,s=0,o=0,a=0;ad(e,t,n,(c,f)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=od(i,r,s,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:fl(e,t,n,r,l)}}function SD(e,t,n){const[i,r,s,o]=Bp(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,g;ad(e,t,n,(b,v)=>{d=i[f++],h=Math.log(v),g=d*v,a+=(v*h-a)/f,u+=(g-u)/f,l+=(g*h-l)/f,c+=(d*g-c)/f});const[p,m]=od(u/o,a/o,l/o,c/o),y=b=>Math.exp(p+m*(b-s));return{coef:[Math.exp(p-m*s),m],predict:y,rSquared:fl(e,t,n,o,y)}}function CD(e,t,n){let i=0,r=0,s=0,o=0,a=0,u=0;ad(e,t,n,(f,d)=>{const h=Math.log(f),g=Math.log(d);++u,i+=(h-i)/u,r+=(g-r)/u,s+=(h*g-s)/u,o+=(h*h-o)/u,a+=(d-a)/u});const l=od(i,r,s,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:fl(e,t,n,a,c)}}function u2(e,t,n){const[i,r,s,o]=Bp(e,t,n),a=i.length;let u=0,l=0,c=0,f=0,d=0,h,g,p,m;for(h=0;h<a;)g=i[h],p=r[h++],m=g*g,u+=(m-u)/h,l+=(m*g-l)/h,c+=(m*m-c)/h,f+=(g*p-f)/h,d+=(m*p-d)/h;const y=c-u*u,b=u*y-l*l,v=(d*u-f*l)/b,x=(f*y-d*l)/b,A=-v*u,E=w=>(w=w-s,v*w*w+x*w+A+o);return{coef:[A-x*s+v*s*s+o,x-2*v*s,v],predict:E,rSquared:fl(e,t,n,o,E)}}function kD(e,t,n,i){if(i===0)return o2(e,t,n);if(i===1)return a2(e,t,n);if(i===2)return u2(e,t,n);const[r,s,o,a]=Bp(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,h,g,p,m;for(d=0;d<f;++d){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d)*s[g];for(l.push(p),m=new Float64Array(f),h=0;h<f;++h){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d+h);m[h]=p}c.push(m)}c.push(l);const y=OI(c),b=v=>{v-=o;let x=a+y[0]+y[1]*v+y[2]*v*v;for(d=3;d<f;++d)x+=y[d]*Math.pow(v,d);return x};return{coef:FI(f,y,-o,a),predict:b,rSquared:fl(e,t,n,a,b)}}function FI(e,t,n,i){const r=Array(e);let s,o,a,u;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],u=1,r[s]+=a,o=1;o<=s;++o)u*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*u;return r[0]+=i,r}function OI(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}const __=2,S_=1e-12;function FD(e,t,n,i){const[r,s,o,a]=Bp(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=__;){const g=[0,l-1];for(let m=0;m<u;++m){const y=r[m],b=g[0],v=g[1],x=y-r[b]>r[v]-y?b:v;let A=0,E=0,w=0,$=0,S=0;const _=1/Math.abs(r[x]-y||1);for(let F=b;F<=v;++F){const O=r[F],k=s[F],j=DI(Math.abs(y-O)*_)*d[F],B=O*j;A+=j,E+=B,w+=k*j,$+=k*B,S+=O*B}const[C,M]=od(E/A,w/A,$/A,S/A);c[m]=C+M*y,f[m]=Math.abs(s[m]-c[m]),MI(r,m+1,g)}if(h===__)break;const p=a3(f);if(Math.abs(p)<S_)break;for(let m=0,y,b;m<u;++m)y=f[m]/(6*p),d[m]=y>=1?S_:(b=1-y*y)*b}return TI(r,c,o,a)}function DI(e){return(e=1-e*e*e)*e*e}function MI(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}function TI(e,t,n,i){const r=e.length,s=[];let o=0,a=0,u=[],l;for(;o<r;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++a:(a=0,u[1]+=i,u=[l,t[o]],s.push(u));return u[1]+=i,s}const NI=.5*Math.PI/180;function Pp(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=p=>[p,e(p)],s=t[0],o=t[1],a=o-s,u=a/i,l=[r(s)],c=[];if(n===i){for(let p=1;p<i;++p)l.push(r(s+p/n*a));return l.push(r(o)),l}else{c.push(r(o));for(let p=n;--p>0;)c.push(r(s+p/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,g=jI(f[1],c);for(;d;){const p=r((f[0]+d[0])/2);p[0]-f[0]>=u&&RI(f,p,d,h,g)>NI?c.push(p):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function jI(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}function RI(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function BI(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function wb(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:BI(e)}function OD(e,t,n){return n||e+(t?"_"+t:"")}const R1=()=>{},PI={init:R1,add:R1,rem:R1,idx:0},yf={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},ud=Object.keys(yf).filter(e=>e!=="__count__");function zI(e,t){return n=>Wx({name:e,out:n||e},PI,t)}[...ud,"__count__"].forEach(e=>{yf[e]=zI(e,yf[e])});function DD(e,t){return yf[e](t)}function MD(e,t){return e.idx-t.idx}function LI(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{i.req&&i.req.forEach(r=>{t[r]||n(t[r]=yf[r]())})};return e.forEach(n),Object.values(t).sort(MD)}function II(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function UI(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function qI(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function WI(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function TD(e,t){const n=t||dD,i=LI(e),r=e.slice().sort(MD);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=II,s.prototype.add=UI,s.prototype.rem=qI,s.prototype.set=WI,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function l2(e){this._key=e?pf(e):V,this.reset()}const _t=l2.prototype;_t.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};_t.add=function(e){this._add.push(e)};_t.rem=function(e){this._rem.push(e)};_t.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,u,l;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,u=0;a<i;++a)o[n(l=e[a])]?o[n(l)]=0:s[u++]=l;return this._rem=[],this._add=s};_t.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,s;for(;--i>=0;)s=e(t[i])+"",sd(n,s)||(n[s]=1,++r);return r};_t.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=bI(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};_t.argmin=function(e){return this.extent(e)[0]||{}};_t.argmax=function(e){return this.extent(e)[1]||{}};_t.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};_t.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};_t.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Yx(this.values(),e),this._get=e),this._q};_t.q1=function(e){return this.quartile(e)[0]};_t.q2=function(e){return this.quartile(e)[1]};_t.q3=function(e){return this.quartile(e)[2]};_t.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=vD(this.values(),1e3,.05,e),this._get=e),this._ci};_t.ci0=function(e){return this.ci(e)[0]};_t.ci1=function(e){return this.ci(e)[1]};function Ws(e){D.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Ws.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ud},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};ae(Ws,D,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):Object.create(null),t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}s(e._prev),s(t);function o(a,u,l){const c=n[l],f=i[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<r?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const y=dn(er(m)),b=y.length;let v=0,x;for(;v<b;++v)i[x=y[v]]||(i[x]=1,t.push(x))}this._dims=dn(e.groupby),this._dnames=this._dims.map(m=>{const y=yn(m);return r(m),n.push(y),y}),this.cellkey=e.key?e.key:wb(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.as||[],u=s.length,l={};let c,f,d,h,g,p;for(u!==o.length&&Et("Unmatched number of fields and aggregate ops."),p=0;p<u;++p){if(c=s[p],f=o[p],c==null&&f!=="count"&&Et("Null aggregate field specified."),h=yn(c),g=OD(f,h,a[p]),n.push(g),f==="count"){this._counts.push(g);continue}d=l[h],d||(r(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(DD(f,g))}return this._measures=this._measures.map(m=>TD(m,m.field)),Object.create(null)},cellkey:wb(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new l2),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?rD(t.tuple,s):we(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?o:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const HI=1e-14;function c2(e){D.call(this,null,e)}c2.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};ae(c2,D,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(er(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[a]=f,c[u]=f==null?null:r+s*(1+(f-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=bD(e),i=n.step;let r=n.start,s=r+Math.ceil((n.stop-r)/i)*i,o,a;(o=e.anchor)!=null&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const u=function(l){let c=pD(t(l));return c==null?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(HI+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=_i(u,er(t),e.name||"bin_"+yn(t))}});function ND(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:u=>s.push(u),remove:u=>o[i(u)]=++a,size:()=>r.length,data:(u,l)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),l&&u&&r.sort(u),s.length&&(r=u?wI(u,r,s.sort(u)):r.concat(s),s=[]),r)}}function f2(e){D.call(this,[],e)}f2.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};ae(f2,D,{transform(e,t){const n=t.fork(t.ALL),i=ND(V,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(ja(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function jD(e){ke.call(this,null,GI,e)}ae(jD,ke);function GI(e){return this.value&&!e.modified()?this.value:hI(e.fields,e.orders)}function d2(e){D.call(this,null,e)}d2.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function YI(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}ae(d2,D,{transform(e,t){const n=f=>d=>{for(var h=YI(a(d),e.case,s)||[],g,p=0,m=h.length;p<m;++p)o.test(g=h[p])||f(g)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=i[a],l=n[a]||0,!u&&l?(i[a]=u=we({}),u[r]=a,u[s]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[a]=null,i[a]=null):u[s]!==l&&(u[s]=l,o.mod.push(u));return o.modifies(t)}});function h2(e){D.call(this,null,e)}h2.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};ae(h2,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=VI(a,r,s,e.filter||fI)):n.mod=a,n.source=this.value,n.modifies(i)}});function VI(e,t,n,i){for(var r=[],s={},o=e.length,a=0,u,l;a<o;++a)for(s[t]=l=e[a],u=0;u<o;++u)s[n]=e[u],i(s)&&(r.push(we(s)),s={},s[t]=l);return r}const C_={kde:Jx,mixture:ED,normal:Kx,lognormal:AD,uniform:$D},XI="distributions",k_="function",KI="field";function RD(e,t){const n=e[k_];sd(C_,n)||Et("Unknown distribution function: "+n);const i=C_[n]();for(const r in e)r===KI?i.data((e.from||t()).map(e[r])):r===XI?i[r](e[r].map(s=>RD(s,t))):typeof i[r]===k_&&i[r](e[r]);return i}function g2(e){D.call(this,null,e)}const BD=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],JI={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:BD},{name:"weights",type:"number",array:!0}]};g2.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:BD.concat(JI)},{name:"as",type:"string",array:!0,default:["value","density"]}]};ae(g2,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=RD(e.distribution,QI(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&Et("Invalid density method: "+o),!e.extent&&!i.data&&Et("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],u=e.extent||mf(i.data()),l=Pp(o,u,r,s).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],we(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function QI(e){return()=>e.materialize(e.SOURCE).source}function PD(e,t){return e?e.map((n,i)=>t[i]||yn(n)):null}function p2(e,t,n){const i=[],r=f=>f(u);let s,o,a,u,l,c;if(t==null)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)u=e[o],l=t.map(r),c=s[l],c||(s[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const zD="bin";function m2(e){D.call(this,null,e)}m2.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:zD}]};const ZI=(e,t)=>AI(mf(e,t))/30;ae(m2,D,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=p2(t.source,e.groupby,dD),r=e.smooth||!1,s=e.field,o=e.step||ZI(n,s),a=ja((g,p)=>s(g)-s(p)),u=e.as||zD,l=i.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const g=i[d].sort(a);h=-1;for(const p of xD(g,o,r,s))p<c&&(c=p),p>f&&(f=p),g[++h][u]=p}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function LD(e){ke.call(this,null,eU,e),this.modified(!0)}ae(LD,ke);function eU(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:_i(n=>t(n,e),er(t),yn(t))}function y2(e){D.call(this,[void 0,void 0],e)}y2.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};ae(y2,D,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||s==null)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const u=pD(i(a));u!=null&&(u<s&&(s=u),u>o&&(o=u))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=yn(i);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${s}, ${o}]`),s=o=void 0}this.value=[s,o]}});function b2(e,t){ke.call(this,e),this.parent=t,this.count=0}ae(b2,ke,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function zp(e){D.call(this,{},e),this._keys=Hx();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}ae(zp,D,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let s=sd(r,e)&&r[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new b2(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=V(u),c=s.get(l);c!==void 0&&(s.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);s.set(V(u),l),a(l).add(u)}),o||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=V(u),c=s.get(l),f=i(u);c===f?a(f).mod(u):(s.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(s.get(V(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=V(u),c=s.get(l),f=i(u);c!==f&&(s.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function ID(e){ke.call(this,null,tU,e)}ae(ID,ke);function tU(e){return this.value&&!e.modified()?this.value:hD(e.name)?dn(e.name).map(t=>pf(t)):pf(e.name,e.as)}function v2(e){D.call(this,Hx(),e)}v2.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};ae(v2,D,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=V(f);i.has(d)?i.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?s.push(f):i.set(V(f),1)});function c(f){const d=V(f),h=u(f,e),g=i.get(d);h&&g?(i.delete(d),s.push(f)):!h&&!g?(i.set(d,1),o.push(f)):l&&h&&!g&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function x2(e){D.call(this,[],e)}x2.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};ae(x2,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=PD(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=i.map(g=>g(a)),l=u.reduce((g,p)=>Math.max(g,p.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Lx(a),f=0;f<o;++f)d[r[f]]=(h=u[f][c])==null?null:h;s&&(d[s]=c),n.add.push(d)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}});function w2(e){D.call(this,[],e)}w2.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};ae(w2,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(yn),s=e.as||["key","value"],o=s[0],a=s[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Lx(l),f[o]=r[c],f[a]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function A2(e){D.call(this,null,e)}A2.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};ae(A2,D,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}});function UD(e){D.call(this,[],e)}ae(UD,D,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,s=e.size-r.length,o,a,u;if(s>0){for(o=[];--s>=0;)o.push(u=we(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const sh={value:"value",median:a3,mean:eP,min:cb,max:ra},nU=[];function E2(e){D.call(this,[],e)}E2.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function iU(e){var t=e.method||sh.value,n;if(sh[t]==null)Et("Unrecognized imputation method: "+t);else return t===sh.value?(n=e.value!==void 0?e.value:0,()=>n):sh[t]}function rU(e){const t=e.field;return n=>n?t(n):NaN}ae(E2,D,{transform(e,t){var n=t.fork(t.ALL),i=iU(e),r=rU(e),s=yn(e.field),o=yn(e.key),a=(e.groupby||[]).map(yn),u=sU(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,g,p,m,y,b,v,x,A;for(m=0,v=u.length;m<v;++m)for(d=u[m],g=d.values,h=NaN,b=0;b<f;++b)if(d[b]==null){for(p=u.domain[b],A={_impute:!0},y=0,x=g.length;y<x;++y)A[a[y]]=g[y];A[o]=p,A[s]=Number.isNaN(h)?h=i(d,r):h,l.push(we(A))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function sU(e,t,n,i){var r=y=>y(m),s=[],o=i?i.slice():[],a={},u={},l,c,f,d,h,g,p,m;for(o.forEach((y,b)=>a[y]=b+1),d=0,p=e.length;d<p;++d)m=e[d],g=n(m),h=a[g]||(a[g]=o.push(g)),c=(l=t?t.map(r):nU)+"",(f=u[c])||(f=u[c]=[],s.push(f),f.values=l),f[h-1]=m;return s.domain=o,s}function $2(e){Ws.call(this,e)}$2.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ud},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};ae($2,Ws,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{Wx(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function _2(e){D.call(this,null,e)}_2.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};ae(_2,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=p2(i,e.groupby,e.field),s=(e.groupby||[]).map(yn),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&Et("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=mf(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const g=Jx(h,o)[a],p=e.counts?h.length:1,m=c||mf(h);Pp(g,m,f,d).forEach(y=>{const b={};for(let v=0;v<s.length;++v)b[s[v]]=h.dims[v];b[u[0]]=y[0],b[u[1]]=y[1]*p,l.push(we(b))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function qD(e){ke.call(this,null,oU,e)}ae(qD,ke);function oU(e){return this.value&&!e.modified()?this.value:xI(e.fields,e.flat)}function WD(e){D.call(this,[],e),this._pending=null}ae(WD,D,{transform(e,t){const n=t.dataflow;return this._pending?B1(this,t,this._pending):aU(e)?t.StopPropagation:e.values?B1(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=dn(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>B1(this,t,dn(i.data)))}});function aU(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function B1(e,t,n){n.forEach(we);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function S2(e){D.call(this,{},e)}S2.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};ae(S2,D,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=e.default==null?null:e.default,o=e.modified(),a=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return r?(d=r.length,a>1&&!c&&Et('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&Et('The "as" parameter has too few output field names.'),c=c||r.map(yn),f=function(g){for(var p=0,m=0,y,b;p<a;++p)if(b=i.get(n[p](g)),b==null)for(y=0;y<d;++y,++m)g[c[m]]=s;else for(y=0;y<d;++y,++m)g[c[m]]=r[y](b)}):(c||Et("Missing output field names."),f=function(g){for(var p=0,m;p<a;++p)m=i.get(n[p](g)),g[c[p]]=m??s}),o?l=t.reflow(!0):(h=n.some(g=>t.modified(g.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function HD(e){ke.call(this,null,uU,e)}ae(HD,ke);function uU(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,s,o;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function GD(e){ke.call(this,null,lU,e)}ae(GD,ke);function lU(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function YD(e){D.call(this,null,e)}ae(YD,D,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function C2(e){Ws.call(this,e)}C2.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ud,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};ae(C2,Ws,{_transform:Ws.prototype.transform,transform(e,t){return this._transform(cU(e,t),t)}});function cU(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",s=er(n).concat(er(i)),o=dU(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>fU(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}function fU(e,t,n,i){return _i(r=>t(r)===e?n(r):NaN,i,e+"")}function dU(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(qx),t?r.slice(0,t):r}function VD(e){zp.call(this,e)}ae(VD,zp,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(V(s),n,t,s);return(e.modified("field")||i&&t.modified(er(i)))&&Et("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(we(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function k2(e){D.call(this,null,e)}k2.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};ae(k2,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=PD(e.fields,e.as||[]),s=i?(a,u)=>hU(a,u,i,r):Dp;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const u=V(a);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,a=>{const u=s(a,we({}));o[V(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[V(a)]))}),n}});function hU(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}function XD(e){D.call(this,null,e)}ae(XD,D,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function F2(e){D.call(this,null,e)}F2.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const gU=1e-14;ae(F2,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,s=p2(r,e.groupby,e.field),o=(e.groupby||[]).map(yn),a=[],u=e.step||.01,l=e.probs||Tn(u/2,1-gU,u),c=l.length;return s.forEach(f=>{const d=Gx(f,l);for(let h=0;h<c;++h){const g={};for(let p=0;p<o.length;++p)g[o[p]]=f.dims[p];g[i[0]]=l[h],g[i[1]]=d[h],a.push(we(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function KD(e){D.call(this,null,e)}ae(KD,D,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=V(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=Lx(r);i[V(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[V(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}});function O2(e){D.call(this,[],e),this.count=0}O2.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};ae(O2,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,f)=>(c[V(f)]=1,c),{});let o=this.value,a=this.count,u=0;function l(c){let f,d;o.length<r?o.push(c):(d=~~((a+1)*Kn()),d<o.length&&d>=u&&(f=o[d],s[V(f)]&&n.rem.push(f),o[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=V(c);s[f]&&(s[f]=-1,n.rem.push(c)),--a}),o=o.filter(c=>s[V(c)]!==-1)),(t.rem.length||i)&&o.length<r&&t.source&&(u=a=o.length,t.visit(t.SOURCE,c=>{s[V(c)]||l(c)}),u=-1),i&&o.length>r){const c=o.length-r;for(let f=0;f<c;++f)s[V(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[V(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!s[V(c)])),this.count=a,this.value=n.source=o,n}});function D2(e){D.call(this,null,e)}D2.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};ae(D2,D,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Tn(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,we(s)}),n.add=t.add.concat(this.value),n}});function JD(e){D.call(this,null,e),this.modified(!0)}ae(JD,D,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function M2(e){D.call(this,null,e)}const QD=["unit0","unit1"];M2.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Dx,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:QD}]};ae(M2,D,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",s=this._floor(e,t),o=(r?ll:ul)(s.unit).offset,a=e.as||QD,u=a[0],l=a[1],c=s.step;let f=s.start||1/0,d=s.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(er(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,g=>{const p=n(g);let m,y;p==null?(g[u]=null,i&&(g[l]=null)):(g[u]=m=y=s(p),i&&(g[l]=y=o(m,c)),m<f&&(f=m),y>d&&(d=y))}),s.start=f,s.stop=d,t.modifies(i?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:j3({extent:e.extent||mf(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=Mx(i),o=this.value||{},a=(n?S3:_3)(s,r);return a.unit=gD(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}});function ZD(e){D.call(this,Hx(),e)}ae(ZD,D,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function e5(e){D.call(this,null,e)}ae(e5,D,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(ja(e.sort)):t.source).map(e.field))}});function pU(e,t,n,i){const r=bf[e](t,n);return{init:r.init||cI,update:function(s,o){o[i]=r.next(s)}}}const bf={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=bf.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||Et("ntile num must be greater than zero.");const n=bf.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Et("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=mU(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function mU(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const yU=Object.keys(bf);function t5(e){const t=dn(e.ops),n=dn(e.fields),i=dn(e.params),r=dn(e.as),s=this.outputs=[],o=this.windows=[],a={},u={},l=[],c=[];let f=!0;function d(h){dn(er(h)).forEach(g=>a[g]=1)}d(e.sort),t.forEach((h,g)=>{const p=n[g],m=yn(p),y=OD(h,m,r[g]);if(d(p),s.push(y),sd(bf,h))o.push(pU(h,n[g],i[g],y));else{if(p==null&&h!=="count"&&Et("Null aggregate field specified."),h==="count"){l.push(y);return}f=!1;let b=u[m];b||(b=u[m]=[],b.field=p,c.push(b)),b.push(DD(h,y))}}),(l.length||c.length)&&(this.cell=bU(c,l,f)),this.inputs=Object.keys(a)}const n5=t5.prototype;n5.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};n5.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)};function bU(e,t,n){e=e.map(u=>TD(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new l2;return i.add=function(u){if(i.num+=1,!n){a&&a.add(u);for(let l=0;l<r;++l)s[l].add(s[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){a&&a.rem(u);for(let l=0;l<r;++l)s[l].rem(s[l].get(u),u)}},i.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=s.length;l<c;++l)s[l].set(u)},i.init=function(){i.num=0,a&&a.reset();for(let u=0;u<r;++u)s[u].init()},i}function T2(e){D.call(this,{},e),this._mlen=0,this._mods=[]}T2.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:yU.concat(ud)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};ae(T2,D,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=ja(e.sort),r=wb(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new t5(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)vU(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=ND(V),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function vU(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),u=a.length,l=s?id(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||yI(-1)};t.init();for(let f=0;f<u;++f)xU(c,o,f,u),s&&wU(c,l),t.update(c,a[f])}function xU(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function wU(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}const AU=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Ws,bin:c2,collect:f2,compare:jD,countpattern:d2,cross:h2,density:g2,dotbin:m2,expression:LD,extent:y2,facet:zp,field:ID,filter:v2,flatten:x2,fold:w2,formula:A2,generate:UD,impute:E2,joinaggregate:$2,kde:_2,key:qD,load:WD,lookup:S2,multiextent:HD,multivalues:GD,params:YD,pivot:C2,prefacet:VD,project:k2,proxy:XD,quantile:F2,relay:KD,sample:O2,sequence:D2,sieve:JD,subflow:b2,timeunit:M2,tupleindex:ZD,values:e5,window:T2},Symbol.toStringTag,{value:"Module"}));function dl(e,t,n){return e.fields=t||[],e.fname=n,e}function EU(e){return e.length===1?$U(e[0]):_U(e)}const $U=e=>function(t){return t[e]},_U=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Ic(e){throw Error(e)}function SU(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Ic("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Ic("Access path missing closing bracket: "+e),i&&Ic("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function CU(e,t,n){const i=SU(e);return e=i.length===1?i[0]:e,dl((n&&n.get||EU)(i),[e],t||e)}CU("id");dl(e=>e,[],"identity");dl(()=>0,[],"zero");dl(()=>1,[],"one");const i5=dl(()=>!0,[],"true");dl(()=>!1,[],"false");var uo=Array.isArray;function F_(e){return e===Object(e)}function r5(e){return e[e.length-1]}function s5(e){return e!=null?uo(e)?e:[e]:[]}function N2(e){return typeof e=="function"}function o5(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const kU=Object.prototype.hasOwnProperty;function Mr(e,t){return kU.call(e,t)}function hl(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),o5(i,n)}function O_(e){return typeof e=="number"}const FU=1e4;function OU(e){e=+e||FU;let t,n,i;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>Mr(t,o)||Mr(n,o),get:o=>Mr(t,o)?t[o]:Mr(n,o)?s(o,n[o]):void 0,set:(o,a)=>Mr(t,o)?t[o]=a:s(o,a)}}function DU(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function Ae(e){return function(){return e}}const D_=Math.abs,St=Math.atan2,Co=Math.cos,MU=Math.max,P1=Math.min,Ti=Math.sin,Xo=Math.sqrt,kt=1e-12,Du=Math.PI,Rg=Du/2,a5=2*Du;function TU(e){return e>1?0:e<-1?Du:Math.acos(e)}function M_(e){return e>=1?Rg:e<=-1?-Rg:Math.asin(e)}const Ab=Math.PI,Eb=2*Ab,Io=1e-6,NU=Eb-Io;function u5(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function jU(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return u5;const n=10**t;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let j2=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?u5:jU(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,r){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,n,i,r,s,o){this._append`C${+t},${+n},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,i,r,s){if(t=+t,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,u=i-t,l=r-n,c=o-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>Io)if(!(Math.abs(f*u-l*c)>Io)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let h=i-o,g=r-a,p=u*u+l*l,m=h*h+g*g,y=Math.sqrt(p),b=Math.sqrt(d),v=s*Math.tan((Ab-Math.acos((p+d-m)/(2*y*b)))/2),x=v/b,A=v/y;Math.abs(x-1)>Io&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*h>c*g)},${this._x1=t+A*u},${this._y1=n+A*l}`}}arc(t,n,i,r,s,o){if(t=+t,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),u=i*Math.sin(r),l=t+a,c=n+u,f=1^o,d=o?r-s:s-r;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Io||Math.abs(this._y1-c)>Io)&&this._append`L${l},${c}`,i&&(d<0&&(d=d%Eb+Eb),d>NU?this._append`A${i},${i},0,1,${f},${t-a},${n-u}A${i},${i},0,1,${f},${this._x1=l},${this._y1=c}`:d>Io&&this._append`A${i},${i},0,${+(d>=Ab)},${f},${this._x1=t+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(t,n,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function Lp(){return new j2}Lp.prototype=j2.prototype;function Ip(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new j2(t)}function RU(e){return e.innerRadius}function BU(e){return e.outerRadius}function PU(e){return e.startAngle}function zU(e){return e.endAngle}function LU(e){return e&&e.padAngle}function IU(e,t,n,i,r,s,o,a){var u=n-e,l=i-t,c=o-r,f=a-s,d=f*u-c*l;if(!(d*d<kt))return d=(c*(t-s)-f*(e-r))/d,[e+d*u,t+d*l]}function oh(e,t,n,i,r,s,o){var a=e-n,u=t-i,l=(o?s:-s)/Xo(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,g=n+c,p=i+f,m=(d+g)/2,y=(h+p)/2,b=g-d,v=p-h,x=b*b+v*v,A=r-s,E=d*p-g*h,w=(v<0?-1:1)*Xo(MU(0,A*A*x-E*E)),$=(E*v-b*w)/x,S=(-E*b-v*w)/x,_=(E*v+b*w)/x,C=(-E*b+v*w)/x,M=$-m,F=S-y,O=_-m,k=C-y;return M*M+F*F>O*O+k*k&&($=_,S=C),{cx:$,cy:S,x01:-c,y01:-f,x11:$*(r/A-1),y11:S*(r/A-1)}}function UU(){var e=RU,t=BU,n=Ae(0),i=null,r=PU,s=zU,o=LU,a=null,u=Ip(l);function l(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),g=r.apply(this,arguments)-Rg,p=s.apply(this,arguments)-Rg,m=D_(p-g),y=p>g;if(a||(a=c=u()),h<d&&(f=h,h=d,d=f),!(h>kt))a.moveTo(0,0);else if(m>a5-kt)a.moveTo(h*Co(g),h*Ti(g)),a.arc(0,0,h,g,p,!y),d>kt&&(a.moveTo(d*Co(p),d*Ti(p)),a.arc(0,0,d,p,g,y));else{var b=g,v=p,x=g,A=p,E=m,w=m,$=o.apply(this,arguments)/2,S=$>kt&&(i?+i.apply(this,arguments):Xo(d*d+h*h)),_=P1(D_(h-d)/2,+n.apply(this,arguments)),C=_,M=_,F,O;if(S>kt){var k=M_(S/d*Ti($)),j=M_(S/h*Ti($));(E-=k*2)>kt?(k*=y?1:-1,x+=k,A-=k):(E=0,x=A=(g+p)/2),(w-=j*2)>kt?(j*=y?1:-1,b+=j,v-=j):(w=0,b=v=(g+p)/2)}var B=h*Co(b),I=h*Ti(b),q=d*Co(A),ue=d*Ti(A);if(_>kt){var Pe=h*Co(v),tt=h*Ti(v),lt=d*Co(x),Ut=d*Ti(x),Ie;if(m<Du)if(Ie=IU(B,I,lt,Ut,Pe,tt,q,ue)){var ii=B-Ie[0],_o=I-Ie[1],ds=Pe-Ie[0],W=tt-Ie[1],se=1/Ti(TU((ii*ds+_o*W)/(Xo(ii*ii+_o*_o)*Xo(ds*ds+W*W)))/2),oe=Xo(Ie[0]*Ie[0]+Ie[1]*Ie[1]);C=P1(_,(d-oe)/(se-1)),M=P1(_,(h-oe)/(se+1))}else C=M=0}w>kt?M>kt?(F=oh(lt,Ut,B,I,h,M,y),O=oh(Pe,tt,q,ue,h,M,y),a.moveTo(F.cx+F.x01,F.cy+F.y01),M<_?a.arc(F.cx,F.cy,M,St(F.y01,F.x01),St(O.y01,O.x01),!y):(a.arc(F.cx,F.cy,M,St(F.y01,F.x01),St(F.y11,F.x11),!y),a.arc(0,0,h,St(F.cy+F.y11,F.cx+F.x11),St(O.cy+O.y11,O.cx+O.x11),!y),a.arc(O.cx,O.cy,M,St(O.y11,O.x11),St(O.y01,O.x01),!y))):(a.moveTo(B,I),a.arc(0,0,h,b,v,!y)):a.moveTo(B,I),!(d>kt)||!(E>kt)?a.lineTo(q,ue):C>kt?(F=oh(q,ue,Pe,tt,d,-C,y),O=oh(B,I,lt,Ut,d,-C,y),a.lineTo(F.cx+F.x01,F.cy+F.y01),C<_?a.arc(F.cx,F.cy,C,St(F.y01,F.x01),St(O.y01,O.x01),!y):(a.arc(F.cx,F.cy,C,St(F.y01,F.x01),St(F.y11,F.x11),!y),a.arc(0,0,d,St(F.cy+F.y11,F.cx+F.x11),St(O.cy+O.y11,O.cx+O.x11),y),a.arc(O.cx,O.cy,C,St(O.y11,O.x11),St(O.y01,O.x01),!y))):a.arc(0,0,d,A,x,y)}if(a.closePath(),c)return a=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Du/2;return[Co(f)*c,Ti(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Ae(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Ae(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Ae(+c),l):n},l.padRadius=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:Ae(+c),l):i},l.startAngle=function(c){return arguments.length?(r=typeof c=="function"?c:Ae(+c),l):r},l.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Ae(+c),l):s},l.padAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Ae(+c),l):o},l.context=function(c){return arguments.length?(a=c??null,l):a},l}function l5(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function c5(e){this._context=e}c5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function R2(e){return new c5(e)}function f5(e){return e[0]}function d5(e){return e[1]}function h5(e,t){var n=Ae(!0),i=null,r=R2,s=null,o=Ip(a);e=typeof e=="function"?e:e===void 0?f5:Ae(e),t=typeof t=="function"?t:t===void 0?d5:Ae(t);function a(u){var l,c=(u=l5(u)).length,f,d=!1,h;for(i==null&&(s=r(h=o())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(f,l,u),+t(f,l,u));if(h)return s=null,h+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:Ae(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:Ae(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:Ae(!!u),a):n},a.curve=function(u){return arguments.length?(r=u,i!=null&&(s=r(i)),a):r},a.context=function(u){return arguments.length?(u==null?i=s=null:s=r(i=u),a):i},a}function g5(e,t,n){var i=null,r=Ae(!0),s=null,o=R2,a=null,u=Ip(l);e=typeof e=="function"?e:e===void 0?f5:Ae(+e),t=typeof t=="function"?t:Ae(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?d5:Ae(+n);function l(f){var d,h,g,p=(f=l5(f)).length,m,y=!1,b,v=new Array(p),x=new Array(p);for(s==null&&(a=o(b=u())),d=0;d<=p;++d){if(!(d<p&&r(m=f[d],d,f))===y)if(y=!y)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),g=d-1;g>=h;--g)a.point(v[g],x[g]);a.lineEnd(),a.areaEnd()}y&&(v[d]=+e(m,d,f),x[d]=+t(m,d,f),a.point(i?+i(m,d,f):v[d],n?+n(m,d,f):x[d]))}if(b)return a=null,b+""||null}function c(){return h5().defined(r).curve(o).context(s)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Ae(+f),i=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Ae(+f),l):e},l.x1=function(f){return arguments.length?(i=f==null?null:typeof f=="function"?f:Ae(+f),l):i},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Ae(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Ae(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Ae(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(i).y(t)},l.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Ae(!!f),l):r},l.curve=function(f){return arguments.length?(o=f,s!=null&&(a=o(s)),l):o},l.context=function(f){return arguments.length?(f==null?s=a=null:a=o(s=f),l):s},l}const qU={draw(e,t){const n=Xo(t/Du);e.moveTo(n,0),e.arc(0,0,n,0,a5)}};function WU(e,t){let n=null,i=Ip(r);e=typeof e=="function"?e:Ae(e||qU),t=typeof t=="function"?t:Ae(t===void 0?64:+t);function r(){let s;if(n||(n=s=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(e=typeof s=="function"?s:Ae(s),r):e},r.size=function(s){return arguments.length?(t=typeof s=="function"?s:Ae(+s),r):t},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function Hs(){}function Bg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Up(e){this._context=e}Up.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Bg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Bg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function HU(e){return new Up(e)}function p5(e){this._context=e}p5.prototype={areaStart:Hs,areaEnd:Hs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Bg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function GU(e){return new p5(e)}function m5(e){this._context=e}m5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Bg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function YU(e){return new m5(e)}function y5(e,t){this._basis=new Up(e),this._beta=t}y5.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+u*s),this._beta*t[a]+(1-this._beta)*(r+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const VU=function e(t){function n(i){return t===1?new Up(i):new y5(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function Pg(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function B2(e,t){this._context=e,this._k=(1-t)/6}B2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Pg(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Pg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const XU=function e(t){function n(i){return new B2(i,t)}return n.tension=function(i){return e(+i)},n}(0);function P2(e,t){this._context=e,this._k=(1-t)/6}P2.prototype={areaStart:Hs,areaEnd:Hs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Pg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const KU=function e(t){function n(i){return new P2(i,t)}return n.tension=function(i){return e(+i)},n}(0);function z2(e,t){this._context=e,this._k=(1-t)/6}z2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Pg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const JU=function e(t){function n(i){return new z2(i,t)}return n.tension=function(i){return e(+i)},n}(0);function L2(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>kt){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>kt){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function b5(e,t){this._context=e,this._alpha=t}b5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:L2(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const QU=function e(t){function n(i){return t?new b5(i,t):new B2(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function v5(e,t){this._context=e,this._alpha=t}v5.prototype={areaStart:Hs,areaEnd:Hs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:L2(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ZU=function e(t){function n(i){return t?new v5(i,t):new P2(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function x5(e,t){this._context=e,this._alpha=t}x5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:L2(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const eq=function e(t){function n(i){return t?new x5(i,t):new z2(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function w5(e){this._context=e}w5.prototype={areaStart:Hs,areaEnd:Hs,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function tq(e){return new w5(e)}function T_(e){return e<0?-1:1}function N_(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(T_(s)+T_(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function j_(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function z1(e,t,n){var i=e._x0,r=e._y0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,r+a*t,s-a,o-a*n,s,o)}function zg(e){this._context=e}zg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:z1(this,this._t0,j_(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,z1(this,j_(this,n=N_(this,e,t)),n);break;default:z1(this,this._t0,n=N_(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function A5(e){this._context=new E5(e)}(A5.prototype=Object.create(zg.prototype)).point=function(e,t){zg.prototype.point.call(this,t,e)};function E5(e){this._context=e}E5.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function nq(e){return new zg(e)}function iq(e){return new A5(e)}function $5(e){this._context=e}$5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=R_(e),r=R_(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function R_(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function rq(e){return new $5(e)}function qp(e,t){this._context=e,this._t=t}qp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function sq(e){return new qp(e,.5)}function oq(e){return new qp(e,0)}function aq(e){return new qp(e,1)}function Rs(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const uq=()=>typeof Image<"u"?Image:null;function gl(e,t,n){return e.fields=t||[],e.fname=n,e}function lq(e){return e.length===1?cq(e[0]):fq(e)}const cq=e=>function(t){return t[e]},fq=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Vh(e){throw Error(e)}function dq(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Vh("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Vh("Access path missing closing bracket: "+e),i&&Vh("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function hq(e,t,n){const i=dq(e);return e=i.length===1?i[0]:e,gl((n&&n.get||lq)(i),[e],t||e)}hq("id");gl(e=>e,[],"identity");gl(()=>0,[],"zero");gl(()=>1,[],"one");gl(()=>!0,[],"true");gl(()=>!1,[],"false");var _5=Array.isArray;function gq(e){return e===Object(e)}function Gs(e){return e[e.length-1]}function pq(e){return e==null||e===""?null:+e}function mq(e){return e!=null?_5(e)?e:[e]:[]}function yq(e){return typeof e=="function"}function bq(e){return yq(e)?e:()=>e}function vq(e){return typeof e=="number"}function S5(e){return typeof e=="string"}function xq(e){return e&&Gs(e)-e[0]||0}function wq(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function ur(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function lo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const $b=Symbol("implicit");function I2(){var e=new K$,t=[],n=[],i=$b;function r(s){let o=e.get(s);if(o===void 0){if(i!==$b)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new K$;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return I2(t,n).unknown(i)},ur.apply(r,arguments),r}function pl(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ld(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function co(){}var ma=.7,Mu=1/ma,bu="\\s*([+-]?\\d+)\\s*",vf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Aq=/^#([0-9a-f]{3,8})$/,Eq=new RegExp(`^rgb\\(${bu},${bu},${bu}\\)$`),$q=new RegExp(`^rgb\\(${qi},${qi},${qi}\\)$`),_q=new RegExp(`^rgba\\(${bu},${bu},${bu},${vf}\\)$`),Sq=new RegExp(`^rgba\\(${qi},${qi},${qi},${vf}\\)$`),Cq=new RegExp(`^hsl\\(${vf},${qi},${qi}\\)$`),kq=new RegExp(`^hsla\\(${vf},${qi},${qi},${vf}\\)$`),B_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pl(co,xf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:P_,formatHex:P_,formatHex8:Fq,formatHsl:Oq,formatRgb:z_,toString:z_});function P_(){return this.rgb().formatHex()}function Fq(){return this.rgb().formatHex8()}function Oq(){return C5(this).formatHsl()}function z_(){return this.rgb().formatRgb()}function xf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Aq.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?L_(t):n===3?new ft(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ah(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ah(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Eq.exec(e))?new ft(t[1],t[2],t[3],1):(t=$q.exec(e))?new ft(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=_q.exec(e))?ah(t[1],t[2],t[3],t[4]):(t=Sq.exec(e))?ah(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Cq.exec(e))?q_(t[1],t[2]/100,t[3]/100,1):(t=kq.exec(e))?q_(t[1],t[2]/100,t[3]/100,t[4]):B_.hasOwnProperty(e)?L_(B_[e]):e==="transparent"?new ft(NaN,NaN,NaN,0):null}function L_(e){return new ft(e>>16&255,e>>8&255,e&255,1)}function ah(e,t,n,i){return i<=0&&(e=t=n=NaN),new ft(e,t,n,i)}function U2(e){return e instanceof co||(e=xf(e)),e?(e=e.rgb(),new ft(e.r,e.g,e.b,e.opacity)):new ft}function Ys(e,t,n,i){return arguments.length===1?U2(e):new ft(e,t,n,i??1)}function ft(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}pl(ft,Ys,ld(co,{brighter(e){return e=e==null?Mu:Math.pow(Mu,e),new ft(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ma:Math.pow(ma,e),new ft(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ft(sa(this.r),sa(this.g),sa(this.b),Lg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:I_,formatHex:I_,formatHex8:Dq,formatRgb:U_,toString:U_}));function I_(){return`#${Ko(this.r)}${Ko(this.g)}${Ko(this.b)}`}function Dq(){return`#${Ko(this.r)}${Ko(this.g)}${Ko(this.b)}${Ko((isNaN(this.opacity)?1:this.opacity)*255)}`}function U_(){const e=Lg(this.opacity);return`${e===1?"rgb(":"rgba("}${sa(this.r)}, ${sa(this.g)}, ${sa(this.b)}${e===1?")":`, ${e})`}`}function Lg(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function sa(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ko(e){return e=sa(e),(e<16?"0":"")+e.toString(16)}function q_(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ci(e,t,n,i)}function C5(e){if(e instanceof ci)return new ci(e.h,e.s,e.l,e.opacity);if(e instanceof co||(e=xf(e)),!e)return new ci;if(e instanceof ci)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,u=(s+r)/2;return a?(t===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+r:2-s-r,o*=60):a=u>0&&u<1?0:o,new ci(o,a,u,e.opacity)}function Ig(e,t,n,i){return arguments.length===1?C5(e):new ci(e,t,n,i??1)}function ci(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}pl(ci,Ig,ld(co,{brighter(e){return e=e==null?Mu:Math.pow(Mu,e),new ci(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ma:Math.pow(ma,e),new ci(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new ft(L1(e>=240?e-240:e+120,r,i),L1(e,r,i),L1(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new ci(W_(this.h),uh(this.s),uh(this.l),Lg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Lg(this.opacity);return`${e===1?"hsl(":"hsla("}${W_(this.h)}, ${uh(this.s)*100}%, ${uh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function W_(e){return e=(e||0)%360,e<0?e+360:e}function uh(e){return Math.max(0,Math.min(1,e||0))}function L1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const k5=Math.PI/180,F5=180/Math.PI,Ug=18,O5=.96422,D5=1,M5=.82521,T5=4/29,vu=6/29,N5=3*vu*vu,Mq=vu*vu*vu;function j5(e){if(e instanceof Wi)return new Wi(e.l,e.a,e.b,e.opacity);if(e instanceof Br)return R5(e);e instanceof ft||(e=U2(e));var t=W1(e.r),n=W1(e.g),i=W1(e.b),r=I1((.2225045*t+.7168786*n+.0606169*i)/D5),s,o;return t===n&&n===i?s=o=r:(s=I1((.4360747*t+.3850649*n+.1430804*i)/O5),o=I1((.0139322*t+.0971045*n+.7141733*i)/M5)),new Wi(116*r-16,500*(s-r),200*(r-o),e.opacity)}function qg(e,t,n,i){return arguments.length===1?j5(e):new Wi(e,t,n,i??1)}function Wi(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}pl(Wi,qg,ld(co,{brighter(e){return new Wi(this.l+Ug*(e??1),this.a,this.b,this.opacity)},darker(e){return new Wi(this.l-Ug*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=O5*U1(t),e=D5*U1(e),n=M5*U1(n),new ft(q1(3.1338561*t-1.6168667*e-.4906146*n),q1(-.9787684*t+1.9161415*e+.033454*n),q1(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function I1(e){return e>Mq?Math.pow(e,1/3):e/N5+T5}function U1(e){return e>vu?e*e*e:N5*(e-T5)}function q1(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function W1(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Tq(e){if(e instanceof Br)return new Br(e.h,e.c,e.l,e.opacity);if(e instanceof Wi||(e=j5(e)),e.a===0&&e.b===0)return new Br(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*F5;return new Br(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Wg(e,t,n,i){return arguments.length===1?Tq(e):new Br(e,t,n,i??1)}function Br(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function R5(e){if(isNaN(e.h))return new Wi(e.l,0,0,e.opacity);var t=e.h*k5;return new Wi(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}pl(Br,Wg,ld(co,{brighter(e){return new Br(this.h,this.c,this.l+Ug*(e??1),this.opacity)},darker(e){return new Br(this.h,this.c,this.l-Ug*(e??1),this.opacity)},rgb(){return R5(this).rgb()}}));var B5=-.14861,q2=1.78277,W2=-.29227,Wp=-.90649,wf=1.97294,H_=wf*Wp,G_=wf*q2,Y_=q2*W2-Wp*B5;function Nq(e){if(e instanceof oa)return new oa(e.h,e.s,e.l,e.opacity);e instanceof ft||(e=U2(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(Y_*i+H_*t-G_*n)/(Y_+H_-G_),s=i-r,o=(wf*(n-r)-W2*s)/Wp,a=Math.sqrt(o*o+s*s)/(wf*r*(1-r)),u=a?Math.atan2(o,s)*F5-120:NaN;return new oa(u<0?u+360:u,a,r,e.opacity)}function _b(e,t,n,i){return arguments.length===1?Nq(e):new oa(e,t,n,i??1)}function oa(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}pl(oa,_b,ld(co,{brighter(e){return e=e==null?Mu:Math.pow(Mu,e),new oa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ma:Math.pow(ma,e),new oa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*k5,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new ft(255*(t+n*(B5*i+q2*r)),255*(t+n*(W2*i+Wp*r)),255*(t+n*(wf*i)),this.opacity)}}));function P5(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function z5(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return P5((n-i/t)*t,o,r,s,a)}}function L5(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return P5((n-i/t)*t,r,s,o,a)}}const Hp=e=>()=>e;function I5(e,t){return function(n){return e+n*t}}function jq(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function Gp(e,t){var n=t-e;return n?I5(e,n>180||n<-180?n-360*Math.round(n/360):n):Hp(isNaN(e)?t:e)}function Rq(e){return(e=+e)==1?dt:function(t,n){return n-t?jq(t,n,e):Hp(isNaN(t)?n:t)}}function dt(e,t){var n=t-e;return n?I5(e,n):Hp(isNaN(e)?t:e)}const Sb=function e(t){var n=Rq(t);function i(r,s){var o=n((r=Ys(r)).r,(s=Ys(s)).r),a=n(r.g,s.g),u=n(r.b,s.b),l=dt(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function U5(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Ys(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(u){return a.r=i(u),a.g=r(u),a.b=s(u),a+""}}}var Bq=U5(z5),Pq=U5(L5);function H2(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function q5(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function zq(e,t){return(q5(t)?H2:W5)(e,t)}function W5(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=fo(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function H5(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function ui(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function G5(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=fo(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var Cb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,H1=new RegExp(Cb.source,"g");function Lq(e){return function(){return e}}function Iq(e){return function(t){return e(t)+""}}function Y5(e,t){var n=Cb.lastIndex=H1.lastIndex=0,i,r,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(i=Cb.exec(e))&&(r=H1.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,u.push({i:o,x:ui(i,r)})),n=H1.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?Iq(u[0].x):Lq(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function fo(e,t){var n=typeof t,i;return t==null||n==="boolean"?Hp(t):(n==="number"?ui:n==="string"?(i=xf(t))?(t=i,Sb):Y5:t instanceof xf?Sb:t instanceof Date?H5:q5(t)?H2:Array.isArray(t)?W5:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?G5:ui)(e,t)}function Uq(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function qq(e,t){var n=Gp(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function cd(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var V_=180/Math.PI,kb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function V5(e,t,n,i,r,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),e*i<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*V_,skewX:Math.atan(u)*V_,scaleX:o,scaleY:a}}var lh;function Wq(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?kb:V5(t.a,t.b,t.c,t.d,t.e,t.f)}function Hq(e){return e==null||(lh||(lh=document.createElementNS("http://www.w3.org/2000/svg","g")),lh.setAttribute("transform",e),!(e=lh.transform.baseVal.consolidate()))?kb:(e=e.matrix,V5(e.a,e.b,e.c,e.d,e.e,e.f))}function X5(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:ui(l,f)},{i:p-2,x:ui(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:ui(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function a(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:ui(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(r(h)+"scale(",null,",",null,")");g.push({i:p-4,x:ui(l,f)},{i:p-2,x:ui(c,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var Gq=X5(Wq,"px, ","px)","deg)"),Yq=X5(Hq,", ",")",")"),Vq=1e-12;function X_(e){return((e=Math.exp(e))+1/e)/2}function Xq(e){return((e=Math.exp(e))-1/e)/2}function Kq(e){return((e=Math.exp(2*e))-1)/(e+1)}const Jq=function e(t,n,i){function r(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],d=o[2],h=c-a,g=f-u,p=h*h+g*g,m,y;if(p<Vq)y=Math.log(d/l)/t,m=function(w){return[a+w*h,u+w*g,l*Math.exp(t*w*y)]};else{var b=Math.sqrt(p),v=(d*d-l*l+i*p)/(2*l*n*b),x=(d*d-l*l-i*p)/(2*d*n*b),A=Math.log(Math.sqrt(v*v+1)-v),E=Math.log(Math.sqrt(x*x+1)-x);y=(E-A)/t,m=function(w){var $=w*y,S=X_(A),_=l/(n*b)*(S*Kq(t*$+A)-Xq(A));return[a+_*h,u+_*g,l*S/X_(t*$+A)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},r}(Math.SQRT2,2,4);function K5(e){return function(t,n){var i=e((t=Ig(t)).h,(n=Ig(n)).h),r=dt(t.s,n.s),s=dt(t.l,n.l),o=dt(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const Qq=K5(Gp);var Zq=K5(dt);function eW(e,t){var n=dt((e=qg(e)).l,(t=qg(t)).l),i=dt(e.a,t.a),r=dt(e.b,t.b),s=dt(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function J5(e){return function(t,n){var i=e((t=Wg(t)).h,(n=Wg(n)).h),r=dt(t.c,n.c),s=dt(t.l,n.l),o=dt(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const tW=J5(Gp);var nW=J5(dt);function Q5(e){return function t(n){n=+n;function i(r,s){var o=e((r=_b(r)).h,(s=_b(s)).h),a=dt(r.s,s.s),u=dt(r.l,s.l),l=dt(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}const iW=Q5(Gp);var rW=Q5(dt);function G2(e,t){t===void 0&&(t=e,e=fo);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function sW(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}const oW=Object.freeze(Object.defineProperty({__proto__:null,interpolate:fo,interpolateArray:zq,interpolateBasis:z5,interpolateBasisClosed:L5,interpolateCubehelix:iW,interpolateCubehelixLong:rW,interpolateDate:H5,interpolateDiscrete:Uq,interpolateHcl:tW,interpolateHclLong:nW,interpolateHsl:Qq,interpolateHslLong:Zq,interpolateHue:qq,interpolateLab:eW,interpolateNumber:ui,interpolateNumberArray:H2,interpolateObject:G5,interpolateRgb:Sb,interpolateRgbBasis:Bq,interpolateRgbBasisClosed:Pq,interpolateRound:cd,interpolateString:Y5,interpolateTransformCss:Gq,interpolateTransformSvg:Yq,interpolateZoom:Jq,piecewise:G2,quantize:sW},Symbol.toStringTag,{value:"Module"}));function aW(e){return function(){return e}}function Fb(e){return+e}var K_=[0,1];function mn(e){return e}function Ob(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:aW(isNaN(t)?NaN:.5)}function uW(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function lW(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=Ob(r,i),s=n(o,s)):(i=Ob(i,r),s=n(s,o)),function(a){return s(i(a))}}function cW(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=Ob(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=rd(e,a,1,i)-1;return s[u](r[u](a))}}function fd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Yp(){var e=K_,t=K_,n=fo,i,r,s,o=mn,a,u,l;function c(){var d=Math.min(e.length,t.length);return o!==mn&&(o=uW(e[0],e[d-1])),a=d>2?cW:lW,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=a(e.map(i),t,n)))(i(o(d)))}return f.invert=function(d){return o(r((l||(l=a(t,e.map(i),ui)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Fb),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=cd,c()},f.clamp=function(d){return arguments.length?(o=d?!0:mn,c()):o!==mn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return i=d,r=h,c()}}function Z5(){return Yp()(mn,mn)}function Hg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Tu(e){return e=Hg(Math.abs(e)),e?e[1]:NaN}function fW(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),s.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function dW(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var hW=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Af(e){return new Y2(e)}Af.prototype=Y2.prototype;function Y2(e){if(!(t=hW.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}Y2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gW(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(i>0){if(!+e[n])break e;i=0}break}return i>0?e.slice(0,i)+e.slice(r+1):e}var eM;function pW(e,t){var n=Hg(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(eM=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Hg(e,Math.max(0,t+s-1))[0]}function J_(e,t){var n=Hg(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const Q_={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return J_(e*100,t)},r:J_,s:pW,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Z_(e){return e}var eS=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function mW(e){var t=e.grouping&&e.thousands?fW(e.grouping,e.thousands):Z_,n=e.currency,i=e.decimal,r=e.numerals?dW(e.numerals):Z_,s=e.percent||"%";function o(u){u=Af(u);var l=u.fill,c=u.align,f=u.sign,d=u.symbol,h=u.zero,g=u.width,p=u.comma,m=u.precision,y=u.trim,b=u.type;b==="n"?(p=!0,b="g"):Q_[b]||(m==null&&(m=12),y=!0,b="g"),(h||l==="0"&&c==="=")&&(h=!0,l="0",c="=");var v=d==="$"?n[0]:d==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x=d==="$"?n[1]:/[%p]/.test(b)?s:"",A=Q_[b],E=/[defgprs%]/.test(b);m=m==null?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function w($){var S=v,_=x,C,M,F;if(b==="c")_=A($)+_,$="";else{$=+$;var O=$<0;if($=A(Math.abs($),m),y&&($=gW($)),O&&+$==0&&(O=!1),S=(O?f==="("?f:"-":f==="-"||f==="("?"":f)+S,_=(b==="s"?eS[8+eM/3]:"")+_+(O&&f==="("?")":""),E){for(C=-1,M=$.length;++C<M;)if(F=$.charCodeAt(C),48>F||F>57){_=(F===46?i+$.slice(C+1):$.slice(C))+_,$=$.slice(0,C);break}}}p&&!h&&($=t($,1/0));var k=S.length+$.length+_.length,j=k<g?new Array(g-k+1).join(l):"";switch(p&&h&&($=t(j+$,j.length?g-_.length:1/0),j=""),c){case"<":$=S+$+_+j;break;case"=":$=S+j+$+_;break;case"^":$=j.slice(0,k=j.length>>1)+S+$+_+j.slice(k);break;default:$=j+S+$+_;break}return r($)}return w.toString=function(){return u+""},w}function a(u,l){var c=o((u=Af(u),u.type="f",u)),f=Math.max(-8,Math.min(8,Math.floor(Tu(l)/3)))*3,d=Math.pow(10,-f),h=eS[8+f/3];return function(g){return c(d*g)+h}}return{format:o,formatPrefix:a}}var ch,V2,tM;yW({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function yW(e){return ch=mW(e),V2=ch.format,tM=ch.formatPrefix,ch}function bW(e){return Math.max(0,-Tu(Math.abs(e)))}function vW(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Tu(t)/3)))*3-Tu(Math.abs(e)))}function xW(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Tu(t)-Tu(e))+1}function nM(e,t,n,i){var r=qs(e,t,n),s;switch(i=Af(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=vW(r,o))&&(i.precision=s),tM(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=xW(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=bW(r))&&(i.precision=s-(i.type==="%")*2);break}}return V2(i)}function Ba(e){var t=e.domain;return e.ticks=function(n){var i=t();return ub(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return nM(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=r,r=s,s=l);c-- >0;){if(l=lb(o,a,n),l===u)return i[r]=o,i[s]=a,t(i);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function iM(){var e=Z5();return e.copy=function(){return fd(e,iM())},ur.apply(e,arguments),Ba(e)}function rM(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,Fb),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return rM(e).unknown(t)},e=arguments.length?Array.from(e,Fb):[0,1],Ba(n)}function sM(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function tS(e){return Math.log(e)}function nS(e){return Math.exp(e)}function wW(e){return-Math.log(-e)}function AW(e){return-Math.exp(-e)}function EW(e){return isFinite(e)?+("1e"+e):e<0?0:e}function $W(e){return e===10?EW:e===Math.E?Math.exp:t=>Math.pow(e,t)}function _W(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function iS(e){return(t,n)=>-e(-t,n)}function X2(e){const t=e(tS,nS),n=t.domain;let i=10,r,s;function o(){return r=_W(i),s=$W(i),n()[0]<0?(r=iS(r),s=iS(s),e(wW,AW)):e(tS,nS),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=r(l),h=r(c),g,p;const m=a==null?10:+a;let y=[];if(!(i%1)&&h-d<m){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(g=1;g<i;++g)if(p=d<0?g/s(-d):g*s(d),!(p<l)){if(p>c)break;y.push(p)}}else for(;d<=h;++d)for(g=i-1;g>=1;--g)if(p=d>0?g/s(-d):g*s(d),!(p<l)){if(p>c)break;y.push(p)}y.length*2<m&&(y=ub(l,c,m))}else y=ub(d,h,Math.min(h-d,m)).map(s);return f?y.reverse():y},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=i===10?"s":","),typeof u!="function"&&(!(i%1)&&(u=Af(u)).precision==null&&(u.trim=!0),u=V2(u)),a===1/0)return u;const l=Math.max(1,i*a/t.ticks().length);return c=>{let f=c/s(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=()=>n(sM(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function oM(){const e=X2(Yp()).domain([1,10]);return e.copy=()=>fd(e,oM()).base(e.base()),ur.apply(e,arguments),e}function rS(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function sS(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function K2(e){var t=1,n=e(rS(t),sS(t));return n.constant=function(i){return arguments.length?e(rS(t=+i),sS(t)):t},Ba(n)}function aM(){var e=K2(Yp());return e.copy=function(){return fd(e,aM()).constant(e.constant())},ur.apply(e,arguments)}function oS(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function SW(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function CW(e){return e<0?-e*e:e*e}function J2(e){var t=e(mn,mn),n=1;function i(){return n===1?e(mn,mn):n===.5?e(SW,CW):e(oS(n),oS(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},Ba(t)}function Q2(){var e=J2(Yp());return e.copy=function(){return fd(e,Q2()).exponent(e.exponent())},ur.apply(e,arguments),e}function kW(){return Q2.apply(null,arguments).exponent(.5)}function uM(){var e=[],t=[],n=[],i;function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=o3(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:t[rd(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(zr),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return uM().domain(e).range(t).unknown(i)},ur.apply(s,arguments)}function lM(){var e=0,t=1,n=1,i=[.5],r=[0,1],s;function o(u){return u!=null&&u<=u?r[rd(i,u,0,n)]:s}function a(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,a()):r.slice()},o.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return i.slice()},o.copy=function(){return lM().domain([e,t]).range(r).unknown(s)},ur.apply(Ba(o),arguments)}function cM(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[rd(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return cM().domain(e).range(t).unknown(n)},ur.apply(r,arguments)}function FW(e){return new Date(e)}function OW(e){return e instanceof Date?+e:+new Date(+e)}function Z2(e,t,n,i,r,s,o,a,u,l){var c=Z5(),f=c.invert,d=c.domain,h=l(".%L"),g=l(":%S"),p=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),b=l("%b %d"),v=l("%B"),x=l("%Y");function A(E){return(u(E)<E?h:a(E)<E?g:o(E)<E?p:s(E)<E?m:i(E)<E?r(E)<E?y:b:n(E)<E?v:x)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?d(Array.from(E,OW)):d().map(FW)},c.ticks=function(E){var w=d();return e(w[0],w[w.length-1],E??10)},c.tickFormat=function(E,w){return w==null?A:l(w)},c.nice=function(E){var w=d();return(!E||typeof E.range!="function")&&(E=t(w[0],w[w.length-1],E??10)),E?d(sM(w,E)):c},c.copy=function(){return fd(c,Z2(e,t,n,i,r,s,o,a,u,l))},c}function DW(){return ur.apply(Z2(BP,PP,Ji,df,ol,Lr,_p,Ep,Rr,Nx).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function MW(){return ur.apply(Z2(jP,RP,Qi,hf,al,Ns,Sp,$p,Rr,jx).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Vp(){var e=0,t=1,n,i,r,s,o=mn,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(r===0?.5:(f=(s(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,g;return arguments.length?([h,g]=d,o=f(h,g),l):[o(0),o(1)]}}return l.range=c(fo),l.rangeRound=c(cd),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function ho(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ew(){var e=Ba(Vp()(mn));return e.copy=function(){return ho(e,ew())},lo.apply(e,arguments)}function fM(){var e=X2(Vp()).domain([1,10]);return e.copy=function(){return ho(e,fM()).base(e.base())},lo.apply(e,arguments)}function dM(){var e=K2(Vp());return e.copy=function(){return ho(e,dM()).constant(e.constant())},lo.apply(e,arguments)}function tw(){var e=J2(Vp());return e.copy=function(){return ho(e,tw()).exponent(e.exponent())},lo.apply(e,arguments)}function TW(){return tw.apply(null,arguments).exponent(.5)}function Xp(){var e=0,t=.5,n=1,i=1,r,s,o,a,u,l=mn,c,f=!1,d;function h(p){return isNaN(p=+p)?d:(p=.5+((p=+c(p))-s)*(i*p<i*s?a:u),l(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,n]=p,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,h):[e,t,n]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(l=p,h):l};function g(p){return function(m){var y,b,v;return arguments.length?([y,b,v]=m,l=G2(p,[y,b,v]),h):[l(0),l(.5),l(1)]}}return h.range=g(fo),h.rangeRound=g(cd),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return c=p,r=p(e),s=p(t),o=p(n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,h}}function hM(){var e=Ba(Xp()(mn));return e.copy=function(){return ho(e,hM())},lo.apply(e,arguments)}function gM(){var e=X2(Xp()).domain([.1,1,10]);return e.copy=function(){return ho(e,gM()).base(e.base())},lo.apply(e,arguments)}function pM(){var e=K2(Xp());return e.copy=function(){return ho(e,pM()).constant(e.constant())},lo.apply(e,arguments)}function nw(){var e=J2(Xp());return e.copy=function(){return ho(e,nw()).exponent(e.exponent())},lo.apply(e,arguments)}function NW(){return nw.apply(null,arguments).exponent(.5)}function iw(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const jW="identity",Nu="linear",Xr="log",dd="pow",hd="sqrt",Kp="symlog",ya="time",ba="utc",Hi="sequential",ml="diverging",ju="quantile",Jp="quantize",Qp="threshold",rw="ordinal",Db="point",mM="band",sw="bin-ordinal",ut="continuous",gd="discrete",pd="discretizing",ti="interpolating",ow="temporal";function RW(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function BW(e){return function(t){const n=e.range();let i=t[0],r=t[1],s=-1,o,a,u,l;for(r<i&&(a=i,i=r,r=a),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(s<0&&(s=u),o=u);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function aw(){const e=I2().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],g=iw(f,a,u);let p=i[d-0];r=(h-p)/(g||1),o&&(r=Math.floor(r)),p+=(h-p-r*(f-a))*l,s=r*(1-a),o&&(p=Math.round(p),s=Math.round(s));const m=Tn(f).map(y=>p+r*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],h=d?n().reverse():n(),g=h.length-1;let p=+f[0],m=+f[1],y,b,v;if(!(p!==p||m!==m)&&(m<p&&(v=p,p=m,m=v),!(m<h[0]||p>i[1-d])))return y=Math.max(0,kg(h,p)-1),b=p===m?y:kg(h,m)-1,p-h[y]>s+1e-10&&++y,d&&(v=y,y=g-b,b=g-v),y>b?void 0:t().slice(y,b+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return aw().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function yM(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return yM(t())},e}function PW(){return yM(aw().paddingInner(1))}var zW=Array.prototype.map;function LW(e){return zW.call(e,pq)}const IW=Array.prototype.slice;function bM(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(rd(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=LW(i),n):e.slice()},n.range=function(i){return arguments.length?(t=IW.call(i),n):t.slice()},n.tickFormat=function(i,r){return nM(e[0],Gs(e),i??10,r)},n.copy=function(){return bM().domain(n.domain()).range(n.range())},n}const Gg=new Map,vM=Symbol("vega_scale");function xM(e){return e[vM]=!0,e}function UW(e){return e&&e[vM]===!0}function qW(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?RW(s):s.invertExtent?BW(s):void 0),s.type=e,xM(s)};return i.metadata=wq(mq(n)),i}function ve(e,t,n){return arguments.length>1?(Gg.set(e,qW(e,t,n)),this):wM(e)?Gg.get(e):void 0}ve(jW,rM);ve(Nu,iM,ut);ve(Xr,oM,[ut,Xr]);ve(dd,Q2,ut);ve(hd,kW,ut);ve(Kp,aM,ut);ve(ya,DW,[ut,ow]);ve(ba,MW,[ut,ow]);ve(Hi,ew,[ut,ti]);ve(`${Hi}-${Nu}`,ew,[ut,ti]);ve(`${Hi}-${Xr}`,fM,[ut,ti,Xr]);ve(`${Hi}-${dd}`,tw,[ut,ti]);ve(`${Hi}-${hd}`,TW,[ut,ti]);ve(`${Hi}-${Kp}`,dM,[ut,ti]);ve(`${ml}-${Nu}`,hM,[ut,ti]);ve(`${ml}-${Xr}`,gM,[ut,ti,Xr]);ve(`${ml}-${dd}`,nw,[ut,ti]);ve(`${ml}-${hd}`,NW,[ut,ti]);ve(`${ml}-${Kp}`,pM,[ut,ti]);ve(ju,uM,[pd,ju]);ve(Jp,lM,pd);ve(Qp,cM,pd);ve(sw,bM,[gd,pd]);ve(rw,I2,gd);ve(mM,aw,gd);ve(Db,PW,gd);function wM(e){return Gg.has(e)}function Pa(e,t){const n=Gg.get(e);return n&&n.metadata[t]}function uw(e){return Pa(e,ut)}function Ru(e){return Pa(e,gd)}function Mb(e){return Pa(e,pd)}function AM(e){return Pa(e,Xr)}function WW(e){return Pa(e,ow)}function EM(e){return Pa(e,ti)}function $M(e){return Pa(e,ju)}const HW=["clamp","base","constant","exponent"];function _M(e,t){const n=t[0],i=Gs(t)-n;return function(r){return e(n+r*i)}}function Zp(e,t,n){return G2(lw(t||"rgb",n),e)}function SM(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function CM(e,t,n){const i=n-t;let r,s,o;return!i||!Number.isFinite(i)?bq(.5):(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=ve(s)().domain([t,n]).range([0,1]),HW.forEach(a=>e[a]?o[a](e[a]()):0),o)}function lw(e,t){const n=oW[GW(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function GW(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const YW={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},VW={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function kM(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function FM(e,t){for(const n in e)cw(n,t(e[n]))}const aS={};FM(VW,kM);FM(YW,e=>Zp(kM(e)));function cw(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(aS[e]=t,this):aS[e]}const Xh="symbol",XW="discrete",KW="gradient",JW=e=>_5(e)?e.map(t=>String(t)):String(e),QW=(e,t)=>e[1]-t[1],ZW=(e,t)=>t[1]-e[1];function fw(e,t,n){let i;return vq(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(xq(e.domain())/n||1)))),gq(t)&&(i=t.step,t=t.interval),S5(t)&&(t=e.type===ya?ul(t):e.type==ba?ll(t):Vh("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function OM(e,t,n){let i=e.range(),r=i[0],s=Gs(i),o=QW;if(r>s&&(i=s,s=r,r=i,o=ZW),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],Gs(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function dw(e,t){return e.bins?OM(e,e.bins):e.ticks?e.ticks(t):e.domain()}function DM(e,t,n,i,r,s){const o=t.type;let a=JW;if(o===ya||r===ya)a=e.timeFormat(i);else if(o===ba||r===ba)a=e.utcFormat(i);else if(AM(o)){const u=e.formatFloat(i);if(s||t.bins)a=u;else{const l=MM(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(a=e.format(i));return a}function MM(e,t,n){const i=dw(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/s));return l*r<r-.5&&(l*=r),l<=o};return n?i.filter(a):a}const Tb={[ju]:"quantiles",[Jp]:"thresholds",[Qp]:"domain"},TM={[ju]:"quantiles",[Jp]:"domain"};function NM(e,t){return e.bins?nH(e.bins):e.type===Xr?MM(e,t,!0):Tb[e.type]?tH(e[Tb[e.type]]()):dw(e,t)}function eH(e,t,n){const i=t[TM[t.type]](),r=i.length;let s=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,3*10,n)}function tH(e){const t=[-1/0].concat(e);return t.max=1/0,t}function nH(e){const t=e.slice(0,-1);return t.max=Gs(e),t}const iH=e=>Tb[e.type]||e.bins;function jM(e,t,n,i,r,s,o){const a=TM[t.type]&&s!==ya&&s!==ba?eH(e,t,r):DM(e,t,n,r,s,o);return i===Xh&&iH(t)?rH(a):i===XW?sH(a):oH(a)}const rH=e=>(t,n,i)=>{const r=uS(i[n+1],uS(i.max,1/0)),s=lS(t,e),o=lS(r,e);return s&&o?s+" – "+o:o?"< "+o:"≥ "+s},uS=(e,t)=>e??t,sH=e=>(t,n)=>n?e(t):null,oH=e=>t=>e(t),lS=(e,t)=>Number.isFinite(e)?t(e):null;function aH(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+Gs(t),s=r-i;if(e.type===Qp){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}function uH(e,t,n,i){const r=i||t.type;return S5(n)&&WW(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===ya?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===ba?e.utcFormat("%A, %d %B %Y, %X UTC"):jM(e,t,5,null,n,i,!0)}function RM(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=uH(e,t,n.format,n.formatType);if(Mb(t.type)){const s=NM(t).slice(1).map(r),o=s.length;return`${o} boundar${o===1?"y":"ies"}: ${s.join(", ")}`}else if(Ru(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return`${o} value${o===1?"":"s"}: ${a}`}else{const s=t.domain();return`values from ${r(s[0])} to ${r(Gs(s))}`}}let BM=0;function lH(){BM=0}const Yg="p_";function hw(e){return e&&e.gradient}function PM(e,t,n){const i=e.gradient;let r=e.id,s=i==="radial"?Yg:"";return r||(r=e.id="gradient_"+BM++,i==="radial"?(e.x1=Ni(e.x1,.5),e.y1=Ni(e.y1,.5),e.r1=Ni(e.r1,0),e.x2=Ni(e.x2,.5),e.y2=Ni(e.y2,.5),e.r2=Ni(e.r2,.5),s=Yg):(e.x1=Ni(e.x1,0),e.y1=Ni(e.y1,0),e.x2=Ni(e.x2,1),e.y2=Ni(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function Ni(e,t){return e??t}function zM(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const cS={basis:{curve:HU},"basis-closed":{curve:GU},"basis-open":{curve:YU},bundle:{curve:VU,tension:"beta",value:.85},cardinal:{curve:XU,tension:"tension",value:0},"cardinal-open":{curve:JU,tension:"tension",value:0},"cardinal-closed":{curve:KU,tension:"tension",value:0},"catmull-rom":{curve:QU,tension:"alpha",value:.5},"catmull-rom-closed":{curve:ZU,tension:"alpha",value:.5},"catmull-rom-open":{curve:eq,tension:"alpha",value:.5},linear:{curve:R2},"linear-closed":{curve:tq},monotone:{horizontal:iq,vertical:nq},natural:{curve:rq},step:{curve:sq},"step-after":{curve:aq},"step-before":{curve:oq}};function gw(e,t,n){var i=Mr(cS,e)&&cS[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const cH={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},fH=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,dH=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,hH=/^((\s+,?\s*)|(,\s*))/,gH=/^[01]/;function Bu(e){const t=[];return(e.match(fH)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),o=cH[s],a=pH(s,o,i.slice(1).trim()),u=a.length;if(u<o||u&&u%o!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...a.slice(0,o)]),u!==o){s==="m"&&(r=r==="M"?"L":"l");for(let l=o;l<u;l+=o)t.push([r,...a.slice(l,l+o)])}}),t}function pH(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const o=e==="a"&&(s===3||s===4)?gH:dH,a=n.slice(r).match(o);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");r+=a[0].length,i.push(+a[0]);const u=n.slice(r).match(hH);u!==null&&(r+=u[0].length)}return i}const Vs=Math.PI/180,mH=1e-14,Ho=Math.PI/2,Pi=Math.PI*2,eu=Math.sqrt(3)/2;var G1={},Y1={},LM=[].join;function yH(e,t,n,i,r,s,o,a,u){const l=LM.call(arguments);if(G1[l])return G1[l];const c=o*Vs,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const h=d*(a-e)*.5+f*(u-t)*.5,g=d*(u-t)*.5-f*(a-e)*.5;let p=h*h/(n*n)+g*g/(i*i);p>1&&(p=Math.sqrt(p),n*=p,i*=p);const m=d/n,y=f/n,b=-f/i,v=d/i,x=m*a+y*u,A=b*a+v*u,E=m*e+y*t,w=b*e+v*t;let S=1/((E-x)*(E-x)+(w-A)*(w-A))-.25;S<0&&(S=0);let _=Math.sqrt(S);s==r&&(_=-_);const C=.5*(x+E)-_*(w-A),M=.5*(A+w)+_*(E-x),F=Math.atan2(A-M,x-C);let k=Math.atan2(w-M,E-C)-F;k<0&&s===1?k+=Pi:k>0&&s===0&&(k-=Pi);const j=Math.ceil(Math.abs(k/(Ho+.001))),B=[];for(let I=0;I<j;++I){const q=F+I*k/j,ue=F+(I+1)*k/j;B[I]=[C,M,q,ue,n,i,f,d]}return G1[l]=B}function bH(e){const t=LM.call(e);if(Y1[t])return Y1[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7];const c=l*o,f=-u*a,d=u*o,h=l*a,g=Math.cos(r),p=Math.sin(r),m=Math.cos(s),y=Math.sin(s),b=.5*(s-r),v=Math.sin(b*.5),x=8/3*v*v/Math.sin(b),A=n+g-x*p,E=i+p+x*g,w=n+m,$=i+y,S=w+x*y,_=$-x*m;return Y1[t]=[c*A+f*E,d*A+h*E,c*S+f*_,d*S+h*_,c*w+f*$,d*w+h*$]}const In=["l",0,0,0,0,0,0,0];function vH(e,t,n){const i=In[0]=e[0];if(i==="a"||i==="A")In[1]=t*e[1],In[2]=n*e[2],In[3]=e[3],In[4]=e[4],In[5]=e[5],In[6]=t*e[6],In[7]=n*e[7];else if(i==="h"||i==="H")In[1]=t*e[1];else if(i==="v"||i==="V")In[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)In[r]=(r%2==1?t:n)*e[r];return In}function Ef(e,t,n,i,r,s){var o,a=null,u=0,l=0,c=0,f=0,d,h,g,p,m=0,y=0;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),e.beginPath&&e.beginPath();for(var b=0,v=t.length;b<v;++b){switch(o=t[b],(r!==1||s!==1)&&(o=vH(o,r,s)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+i);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+i);break;case"h":u+=o[1],e.lineTo(u+n,l+i);break;case"H":u=o[1],e.lineTo(u+n,l+i);break;case"v":l+=o[1],e.lineTo(u+n,l+i);break;case"V":l=o[1],e.lineTo(u+n,l+i);break;case"m":u+=o[1],l+=o[2],m=u,y=l,e.moveTo(u+n,l+i);break;case"M":u=o[1],l=o[2],m=u,y=l,e.moveTo(u+n,l+i);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+i,c+n,f+i,d+n,h+i),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+o[1]+n,l+o[2]+i,d+n,h+i),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,o[1]+n,o[2]+i,d+n,h+i),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+i,d+n,h+i),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-g,f=2*l-p):a[0]==="q"&&(c=2*u-c,f=2*l-f),g=c,p=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"a":fS(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+i]),u+=o[6],l+=o[7];break;case"A":fS(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),u=o[6],l=o[7];break;case"z":case"Z":u=m,l=y,e.closePath();break}a=o}}function fS(e,t,n,i){const r=yH(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=bH(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const dS=.5773502691896257,hS={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Pi)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=eu*n,r=i-n*dS,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=eu*n,r=i-n*dS;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=eu*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=eu*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=eu*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=eu*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function IM(e){return Mr(hS,e)?hS[e]:xH(e)}var V1={};function xH(e){if(!Mr(V1,e)){const t=Bu(e);V1[e]={draw:function(n,i){Ef(n,t,0,0,Math.sqrt(i)/2)}}}return V1[e]}const hs=.448084975506;function wH(e){return e.x}function AH(e){return e.y}function EH(e){return e.width}function $H(e){return e.height}function $r(e){return typeof e=="function"?e:()=>+e}function fh(e,t,n){return Math.max(t,Math.min(e,n))}function UM(){var e=wH,t=AH,n=EH,i=$H,r=$r(0),s=r,o=r,a=r,u=null;function l(c,f,d){var h,g=f??+e.call(this,c),p=d??+t.call(this,c),m=+n.call(this,c),y=+i.call(this,c),b=Math.min(m,y)/2,v=fh(+r.call(this,c),0,b),x=fh(+s.call(this,c),0,b),A=fh(+o.call(this,c),0,b),E=fh(+a.call(this,c),0,b);if(u||(u=h=Lp()),v<=0&&x<=0&&A<=0&&E<=0)u.rect(g,p,m,y);else{var w=g+m,$=p+y;u.moveTo(g+v,p),u.lineTo(w-x,p),u.bezierCurveTo(w-hs*x,p,w,p+hs*x,w,p+x),u.lineTo(w,$-E),u.bezierCurveTo(w,$-hs*E,w-hs*E,$,w-E,$),u.lineTo(g+A,$),u.bezierCurveTo(g+hs*A,$,g,$-hs*A,g,$-A),u.lineTo(g,p+v),u.bezierCurveTo(g,p+hs*v,g+hs*v,p,g+v,p),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=$r(c),l):e},l.y=function(c){return arguments.length?(t=$r(c),l):t},l.width=function(c){return arguments.length?(n=$r(c),l):n},l.height=function(c){return arguments.length?(i=$r(c),l):i},l.cornerRadius=function(c,f,d,h){return arguments.length?(r=$r(c),s=f!=null?$r(f):r,a=d!=null?$r(d):r,o=h!=null?$r(h):s,l):r},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function qM(){var e,t,n,i,r=null,s,o,a,u;function l(f,d,h){const g=h/2;if(s){var p=a-d,m=f-o;if(p||m){var y=Math.sqrt(p*p+m*m),b=(p/=y)*u,v=(m/=y)*u,x=Math.atan2(m,p);r.moveTo(o-b,a-v),r.lineTo(f-p*g,d-m*g),r.arc(f,d,g,x-Math.PI,x),r.lineTo(o+b,a+v),r.arc(o,a,u,x,x+Math.PI)}else r.arc(f,d,g,0,Pi);r.closePath()}else s=1;o=f,a=d,u=g}function c(f){var d,h=f.length,g,p=!1,m;for(r==null&&(r=m=Lp()),d=0;d<=h;++d)!(d<h&&i(g=f[d],d,f))===p&&(p=!p)&&(s=0),p&&l(+e(g,d,f),+t(g,d,f),+n(g,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function md(e,t){return e??t}const yd=e=>e.x||0,bd=e=>e.y||0,_H=e=>e.width||0,SH=e=>e.height||0,CH=e=>(e.x||0)+(e.width||0),kH=e=>(e.y||0)+(e.height||0),FH=e=>e.startAngle||0,OH=e=>e.endAngle||0,DH=e=>e.padAngle||0,MH=e=>e.innerRadius||0,TH=e=>e.outerRadius||0,NH=e=>e.cornerRadius||0,jH=e=>md(e.cornerRadiusTopLeft,e.cornerRadius)||0,RH=e=>md(e.cornerRadiusTopRight,e.cornerRadius)||0,BH=e=>md(e.cornerRadiusBottomRight,e.cornerRadius)||0,PH=e=>md(e.cornerRadiusBottomLeft,e.cornerRadius)||0,zH=e=>md(e.size,64),LH=e=>e.size||1,em=e=>e.defined!==!1,IH=e=>IM(e.shape||"circle"),UH=UU().startAngle(FH).endAngle(OH).padAngle(DH).innerRadius(MH).outerRadius(TH).cornerRadius(NH),qH=g5().x(yd).y1(bd).y0(kH).defined(em),WH=g5().y(bd).x1(yd).x0(CH).defined(em),HH=h5().x(yd).y(bd).defined(em),GH=UM().x(yd).y(bd).width(_H).height(SH).cornerRadius(jH,RH,BH,PH),YH=WU().type(IH).size(zH),VH=qM().x(yd).y(bd).defined(em).size(LH);function pw(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function XH(e,t){return UH.context(e)(t)}function KH(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?WH:qH).curve(gw(i,n.orient,n.tension)).context(e)(t)}function JH(e,t){const n=t[0],i=n.interpolate||"linear";return HH.curve(gw(i,n.orient,n.tension)).context(e)(t)}function yl(e,t,n,i){return GH.context(e)(t,n,i)}function QH(e,t){return(t.mark.shape||t.shape).context(e)(t)}function ZH(e,t){return YH.context(e)(t)}function eG(e,t){return VH.context(e)(t)}var WM=1;function HM(){WM=1}function mw(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+WM++),o=r.clipping[s]||(r.clipping[s]={id:s});return N2(i)?o.path=i(null):pw(n)?o.path=yl(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function Je(e){this.clear(),e&&this.union(e)}Je.prototype={clone(){return new Je(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*i-u*r+l,u*i+a*r+c,a*i-u*o+l,u*i+a*o+c,a*s-u*r+l,u*s+a*r+c,a*s-u*o+l,u*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function tm(e){this.mark=e,this.bounds=this.bounds||new Je}function nm(e){tm.call(this,e),this.items=this.items||[]}hl(nm,tm);function yw(e){this._pending=0,this._loader=e||kp()}function gS(e){e._pending+=1}function ic(e){e._pending-=1}yw.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return gS(t),t._loader.sanitize(e,{context:"href"}).then(n=>(ic(t),n)).catch(()=>(ic(t),null))},loadImage(e){const t=this,n=uq();return gS(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const s=new n,o=Mr(i,"crossOrigin")?i.crossOrigin:"anonymous";return o!=null&&(s.crossOrigin=o),s.onload=()=>ic(t),s.onerror=()=>ic(t),s.src=r,s}).catch(i=>(ic(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}n(!1)})}};function ts(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?tG(t,i):0))}return e}function tG(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const nG=Pi-1e-8;let im,Kh,Jh,Jo,Nb,Qh,jb,Rb;const Es=(e,t)=>im.add(e,t),Zh=(e,t)=>Es(Kh=e,Jh=t),pS=e=>Es(e,im.y1),mS=e=>Es(im.x1,e),Go=(e,t)=>Nb*e+jb*t,Yo=(e,t)=>Qh*e+Rb*t,X1=(e,t)=>Es(Go(e,t),Yo(e,t)),K1=(e,t)=>Zh(Go(e,t),Yo(e,t));function vd(e,t){return im=e,t?(Jo=t*Vs,Nb=Rb=Math.cos(Jo),Qh=Math.sin(Jo),jb=-Qh):(Nb=Rb=1,Jo=Qh=jb=0),iG}const iG={beginPath(){},closePath(){},moveTo:K1,lineTo:K1,rect(e,t,n,i){Jo?(X1(e+n,t),X1(e+n,t+i),X1(e,t+i),K1(e,t)):(Es(e+n,t+i),Zh(e,t))},quadraticCurveTo(e,t,n,i){const r=Go(e,t),s=Yo(e,t),o=Go(n,i),a=Yo(n,i);yS(Kh,r,o,pS),yS(Jh,s,a,mS),Zh(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=Go(e,t),a=Yo(e,t),u=Go(n,i),l=Yo(n,i),c=Go(r,s),f=Yo(r,s);bS(Kh,o,u,c,pS),bS(Jh,a,l,f,mS),Zh(c,f)},arc(e,t,n,i,r,s){if(i+=Jo,r+=Jo,Kh=n*Math.cos(r)+e,Jh=n*Math.sin(r)+t,Math.abs(r-i)>nG)Es(e-n,t-n),Es(e+n,t+n);else{const o=l=>Es(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(o(i),o(r),r!==i)if(i=i%Pi,i<0&&(i+=Pi),r=r%Pi,r<0&&(r+=Pi),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=Pi,a=i-i%Ho,u=0;u<4&&a>r;++u,a-=Ho)o(a);else for(a=i-i%Ho+Ho,u=0;u<4&&a<r;++u,a=a+Ho)o(a)}}};function yS(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function bS(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(s)>mH?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),u=(-o+c)/s,l=(-o-c)/s)):u=.5*a/o,0<u&&u<1&&r(vS(u,e,t,n,i)),0<l&&l<1&&r(vS(l,e,t,n,i))}function vS(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var Bs=(Bs=Rs(1,1))?Bs.getContext("2d"):null;const Bb=new Je;function bw(e){return function(t,n){if(!Bs)return!0;e(Bs,t),Bb.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=Bb;for(let a=r;a<=o;++a)for(let u=i;u<=s;++u)if(Bs.isPointInPath(u,a))return!0;return!1}}function vw(e,t){return t.contains(e.x||0,e.y||0)}function GM(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,s=e.height||0;return t.intersects(Bb.set(n,i,n+r,i+s))}function YM(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:i;return fu(t,n,i,r,s)}function fu(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,h,g,p,m;for(m=0;m<4;++m){if(m===0&&(h=-l,g=-(s-t)),m===1&&(h=l,g=a-t),m===2&&(h=-c,g=-(o-n)),m===3&&(h=c,g=u-n),Math.abs(h)<1e-10&&g<0)return!1;if(p=g/h,h<0){if(p>d)return!1;p>f&&(f=p)}else if(h>0){if(p<f)return!1;p<d&&(d=p)}}return!0}function Pu(e,t){e.globalCompositeOperation=t.blend||"source-over"}function si(e,t){return e??t}function xS(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function rG(e,t,n){const i=n.width(),r=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+si(t.x1,.5)*i,n.y1+si(t.y1,.5)*r,Math.max(i,r)*si(t.r1,0),n.x1+si(t.x2,.5)*i,n.y1+si(t.y2,.5)*r,Math.max(i,r)*si(t.r2,.5));else{const o=si(t.x1,0),a=si(t.y1,0),u=si(t.x2,1),l=si(t.y2,0);if(o===u||a===l||i===r)s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+u*i,n.y1+l*r);else{const c=Rs(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=xS(f.createLinearGradient(o,a,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return xS(s,t.stops)}function VM(e,t,n){return hw(n)?rG(e,n,t.bounds):n}function Vg(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=VM(e,t,t.fill),!0):!1}var sG=[];function zu(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=VM(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||sG),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function oG(e,t){return e.zindex-t.zindex||e.index-t.index}function xw(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,s;for(r=0,s=t.length;r<s;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(oG)}function Ei(e,t){var n=e.items,i,r;if(!n||!n.length)return;const s=xw(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function Xg(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const s=xw(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function ww(e){return function(t,n,i){Ei(n,r=>{(!i||i.intersects(r.bounds))&&XM(e,t,r,r)})}}function aG(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&XM(e,t,n.items[0],n.items)}}function XM(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(Pu(t,n),n.fill&&Vg(t,n,r)&&t.fill(),n.stroke&&zu(t,n,r)&&t.stroke()))}function rm(e){return e=e||i5,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,Xg(n,a=>{const u=a.bounds;if(!(u&&!u.contains(s,o)||!u)&&e(t,a,i,r,s,o))return a})}}function xd(e,t){return function(n,i,r,s){var o=Array.isArray(i)?i[0]:i,a=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,i)?!1:a&&n.isPointInPath(r,s)||u&&n.isPointInStroke(r,s)}}function Aw(e){return rm(xd(e))}function aa(e,t){return"translate("+e+","+t+")"}function Ew(e){return"rotate("+e+")"}function uG(e,t){return"scale("+e+","+t+")"}function KM(e){return aa(e.x||0,e.y||0)}function lG(e){return aa(e.x||0,e.y||0)+(e.angle?" "+Ew(e.angle):"")}function cG(e){return aa(e.x||0,e.y||0)+(e.angle?" "+Ew(e.angle):"")+(e.scaleX||e.scaleY?" "+uG(e.scaleX||1,e.scaleY||1):"")}function $w(e,t,n){function i(o,a){o("transform",lG(a)),o("d",t(null,a))}function r(o,a){return t(vd(o,a.angle),a),ts(o,a).translate(a.x||0,a.y||0)}function s(o,a){var u=a.x||0,l=a.y||0,c=a.angle||0;o.translate(u,l),c&&o.rotate(c*=Vs),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:ww(s),pick:Aw(s),isect:n||bw(s)}}var fG=$w("arc",XH);function dG(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,s=1/0,o,a;--r>=0;)e[r].defined!==!1&&(a=Math.abs(e[r][i]-n),a<s&&(s=a,o=e[r]));return o}function hG(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,s,o;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],s=e[i].y-t[1],o=r*r+s*s,o<n))return e[i];return null}function gG(e,t){for(var n=e.length,i,r,s;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],s=i*i+r*r,i=e[n].size||1,s<i*i))return e[n];return null}function _w(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(vd(u),c),ts(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}const o=xd(s);function a(u,l,c,f,d,h){var g=l.items,p=l.bounds;return!g||!g.length||p&&!p.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,g,c,f)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:aG(s),pick:a,isect:vw,tip:n}}var pG=_w("area",KH,dG);function mG(e,t){var n=t.clip;e.save(),N2(n)?(e.beginPath(),n(e),e.clip()):JM(e,t.group)}function JM(e,t){e.beginPath(),pw(t)?yl(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function QM(e){const t=si(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function yG(e,t){e("transform",KM(t))}function ZM(e,t){const n=QM(t);e("d",yl(null,t,n,n))}function bG(e,t){e("class","background"),e("aria-hidden",!0),ZM(e,t)}function vG(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?ZM(e,t):e("d","")}function xG(e,t,n){const i=t.clip?mw(n,t,t):null;e("clip-path",i)}function wG(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),ts(e,t),e.translate(t.x||0,t.y||0)}function $f(e,t,n,i){const r=QM(t);e.beginPath(),yl(e,t,(n||0)+r,(i||0)+r)}const AG=xd($f),EG=xd($f,!1),$G=xd($f,!0);function _G(e,t,n){Ei(t,i=>{const r=i.x||0,s=i.y||0,o=i.strokeForeground,a=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&a&&($f(e,i,r,s),Pu(e,i),i.fill&&Vg(e,i,a)&&e.fill(),i.stroke&&!o&&zu(e,i,a)&&e.stroke()),e.save(),e.translate(r,s),i.clip&&JM(e,i),n&&n.translate(-r,-s),Ei(i,u=>{this.draw(e,u,n)}),n&&n.translate(r,s),e.restore(),o&&i.stroke&&a&&($f(e,i,r,s),Pu(e,i),zu(e,i,a)&&e.stroke())})}function SG(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return Xg(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,s))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),g=f+(u.height||0),p=u.clip;if(p&&(r<c||r>h||s<f||s>g))return;if(e.save(),e.translate(c,f),c=r-c,f=s-f,p&&pw(u)&&!$G(e,u,o,a))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&EG(e,u,o,a)?(e.restore(),u):(l=Xg(u,b=>CG(b,c,f)?this.pick(b,n,i,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&AG(e,u,o,a)&&(l=u),e.restore(),l||null)})}function CG(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var kG={type:"group",tag:"g",nested:!1,attr:yG,bound:wG,draw:_G,pick:SG,isect:GM,content:xG,background:bG,foreground:vG},_f={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Sw(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function Cw(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function kw(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function sm(e,t){return e==="center"?t/2:e==="right"?t:0}function om(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function FG(e,t,n){const i=Sw(t,n),r=Cw(t,i),s=kw(t,i),o=(t.x||0)-sm(t.align,r),a=(t.y||0)-om(t.baseline,s),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,_f["xmlns:xlink"],"xlink:href"),e("transform",aa(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function OG(e,t){const n=t.image,i=Cw(t,n),r=kw(t,n),s=(t.x||0)-sm(t.align,i),o=(t.y||0)-om(t.baseline,r);return e.set(s,o,s+i,o+r)}function DG(e,t,n){Ei(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=Sw(i,this);let s=Cw(i,r),o=kw(i,r);if(s===0||o===0)return;let a=(i.x||0)-sm(i.align,s),u=(i.y||0)-om(i.baseline,o),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=s/c,u+=(o-d)/2,o=d):(d=o*c,a+=(s-d)/2,s=d))),(r.complete||r.toDataURL)&&(Pu(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,a,u,s,o))})}var MG={type:"image",tag:"image",nested:!1,attr:FG,bound:OG,draw:DG,pick:rm(),isect:i5,get:Sw,xOffset:sm,yOffset:om},TG=_w("line",JH,hG);function NG(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",cG(t)),e("d",t.path)}function eg(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*Vs,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Bu(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Ef(e,u,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):Ef(e,u,i,r,s,o)}function jG(e,t){return eg(vd(e,t.angle),t)?e.set(0,0,0,0):ts(e,t,!0)}var RG={type:"path",tag:"path",nested:!1,attr:NG,bound:jG,draw:ww(eg),pick:Aw(eg),isect:bw(eg)};function BG(e,t){e("d",yl(null,t))}function PG(e,t){var n,i;return ts(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function wS(e,t){e.beginPath(),yl(e,t)}var zG={type:"rect",tag:"path",nested:!1,attr:BG,bound:PG,draw:ww(wS),pick:Aw(wS),isect:GM};function LG(e,t){e("transform",KM(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function IG(e,t){var n,i;return ts(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function e6(e,t,n){var i,r,s,o;return t.stroke&&zu(e,t,n)?(i=t.x||0,r=t.y||0,s=t.x2!=null?t.x2:i,o=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),!0):!1}function UG(e,t,n){Ei(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&e6(e,i,r)&&(Pu(e,i),e.stroke())}})}function qG(e,t,n,i){return e.isPointInStroke?e6(e,t,1)&&e.isPointInStroke(n,i):!1}var WG={type:"rule",tag:"line",nested:!1,attr:LG,bound:IG,draw:UG,pick:rm(qG),isect:YM},HG=$w("shape",QH),GG=$w("symbol",ZH,vw);const AS=OU();var bi={height:lr,measureWidth:Fw,estimateWidth:Pb,width:Pb,canvas:t6};t6(!0);function t6(e){bi.width=e&&Bs?Fw:Pb}function Pb(e,t){return n6(Ks(e,t),lr(e))}function n6(e,t){return~~(.8*e.length*t)}function Fw(e,t){return lr(e)<=0||!(t=Ks(e,t))?0:i6(t,am(e))}function i6(e,t){const n=`(${t}) ${e}`;let i=AS.get(n);return i===void 0&&(Bs.font=t,i=Bs.measureText(e).width,AS.set(n,i)),i}function lr(e){return e.fontSize!=null?+e.fontSize||0:11}function Xs(e){return e.lineHeight!=null?e.lineHeight:lr(e)+2}function YG(e){return uo(e)?e.length>1?e:e[0]:e}function wd(e){return YG(e.lineBreak&&e.text&&!uo(e.text)?e.text.split(e.lineBreak):e.text)}function Ow(e){const t=wd(e);return(uo(t)?t.length-1:0)*Xs(e)}function Ks(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?XG(e,n):n}function VG(e){if(bi.width===Fw){const t=am(e);return n=>i6(n,t)}else{const t=lr(e);return n=>n6(n,t)}}function XG(e,t){var n=+e.limit,i=VG(e);if(i(t)<n)return t;var r=e.ellipsis||"…",s=e.dir==="rtl",o=0,a=t.length,u;if(n-=i(r),s){for(;o<a;)u=o+a>>>1,i(t.slice(u))>n?o=u+1:a=u;return r+t.slice(o)}else{for(;o<a;)u=1+(o+a>>>1),i(t.slice(0,u))<n?o=u:a=u-1;return t.slice(0,o)+r}}function Ad(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function am(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+lr(e)+"px "+Ad(e,t)}function Dw(e){var t=e.baseline,n=lr(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Xs(e):t==="line-bottom"?.29*n-.5*Xs(e):0)}const KG={left:"start",center:"middle",right:"end"},Uc=new Je;function um(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-Ho,t+=i*Math.cos(r),n+=i*Math.sin(r)),Uc.x1=t,Uc.y1=n,Uc}function JG(e,t){var n=t.dx||0,i=(t.dy||0)+Dw(t),r=um(t),s=r.x1,o=r.y1,a=t.angle||0,u;e("text-anchor",KG[t.align]||"start"),a?(u=aa(s,o)+" "+Ew(a),(n||i)&&(u+=" "+aa(n,i))):u=aa(s+n,o+i),e("transform",u)}function Mw(e,t,n){var i=bi.height(t),r=t.align,s=um(t),o=s.x1,a=s.y1,u=t.dx||0,l=(t.dy||0)+Dw(t)-Math.round(.8*i),c=wd(t),f;if(uo(c)?(i+=Xs(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,bi.width(t,h)),0)):f=bi.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=o,l+=a,u+f,l+i),t.angle&&!n)e.rotate(t.angle*Vs,o,a);else if(n===2)return e.rotatedPoints(t.angle*Vs,o,a);return e}function QG(e,t,n){Ei(t,i=>{var r=i.opacity==null?1:i.opacity,s,o,a,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=am(i),e.textAlign=i.align||"left",s=um(i),o=s.x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*Vs),o=a=0),o+=i.dx||0,a+=(i.dy||0)+Dw(i),c=wd(i),Pu(e,i),uo(c))for(l=Xs(i),u=0;u<c.length;++u)f=Ks(i,c[u]),i.fill&&Vg(e,i,r)&&e.fillText(f,o,a),i.stroke&&zu(e,i,r)&&e.strokeText(f,o,a),a+=l;else f=Ks(i,c),i.fill&&Vg(e,i,r)&&e.fillText(f,o,a),i.stroke&&zu(e,i,r)&&e.strokeText(f,o,a);i.angle&&e.restore()}})}function ZG(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=um(t),a=o.x1,u=o.y1,l=Mw(Uc,t,1),c=-t.angle*Vs,f=Math.cos(c),d=Math.sin(c),h=f*r-d*s+(a-f*a+d*u),g=d*r+f*s+(u-d*a-f*u);return l.contains(h,g)}function eY(e,t){const n=Mw(Uc,e,2);return fu(t,n[0],n[1],n[2],n[3])||fu(t,n[0],n[1],n[4],n[5])||fu(t,n[4],n[5],n[6],n[7])||fu(t,n[2],n[3],n[6],n[7])}var tY={type:"text",tag:"text",nested:!1,attr:JG,bound:Mw,draw:QG,pick:rm(ZG),isect:eY},nY=_w("trail",eG,gG),Pn={arc:fG,area:pG,group:kG,image:MG,line:TG,path:RG,rect:zG,rule:WG,shape:HG,symbol:GG,text:tY,trail:nY};function zb(e,t,n){var i=Pn[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new Je),e,n)}var ES={mark:null};function r6(e,t,n){var i=Pn[e.marktype],r=i.bound,s=e.items,o=s&&s.length,a,u,l,c;if(i.nested)return o?l=s[0]:(ES.mark=e,l=ES),c=zb(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Je,o)for(a=0,u=s.length;a<u;++a)t.union(zb(s[a],r,n));return e.bounds=t}const iY=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function s6(e,t){return JSON.stringify(e,iY,t)}function o6(e){const t=typeof e=="string"?JSON.parse(e):e;return a6(t)}function a6(e){var t=e.marktype,n=e.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&a6(n[r]);return t&&r6(e),e}function Tw(e){arguments.length?this.root=o6(e):(this.root=u6({marktype:"group",name:"root",role:"frame"}),this.root.items=[new nm(this.root)])}Tw.prototype={toJSON(e){return s6(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const i=u6(e,t);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function u6(e,t){const n={bounds:new Je,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function $s(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Nw(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function hn(e,t,n,i){var r=e.childNodes[t],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=$s(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function fi(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function l6(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function lm(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function rY(e,t,n,i){var r=e&&e.mark,s,o;if(r&&(s=Pn[r.marktype]).tip){for(o=lm(t,n),o[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}function Js(e,t){this._active=null,this._handlers={},this._loader=e||kp(),this._tooltip=t||sY}function sY(e,t,n,i){e.element().setAttribute("title",i||"")}Js.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),s=$s(null,"a");for(const o in i)s.setAttribute(o,i[o]);s.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=rY(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,s=r.width(),o=r.height();let a=r.x1+i[0]+n.left,u=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,u+=e.y||0;return{x:a,y:u,width:s,height:o,left:a,top:u,right:a+s,bottom:u+o}}};function cr(e){this._el=null,this._bgcolor=null,this._loader=new yw(e)}cr.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(s=>{s&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const oY="keydown",aY="keypress",uY="keyup",c6="dragenter",tg="dragleave",f6="dragover",Lb="mousedown",lY="mouseup",Kg="mousemove",qc="mouseout",d6="mouseover",Jg="click",cY="dblclick",fY="wheel",h6="mousewheel",Qg="touchstart",Zg="touchmove",e0="touchend",dY=[oY,aY,uY,c6,tg,f6,Lb,lY,Kg,qc,d6,Jg,cY,fY,h6,Qg,Zg,e0],Ib=Kg,Sf=qc,Ub=Jg;function Ed(e,t){Js.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const hY=e=>e===Qg||e===Zg||e===e0?[Qg,Zg,e0]:[e];function $S(e,t){hY(t).forEach(n=>gY(e,n))}function gY(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function _S(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?this.fire(e,i):((!r||!r.exit)&&this.fire(n,i),this._active=s,this.fire(t,i),this.fire(e,i))}}function SS(e){return function(t){this.fire(e,t),this._active=null}}hl(Ed,Js,{initialize(e,t,n){return this._canvas=e&&Nw(e,"canvas"),[Jg,Lb,Kg,qc,tg].forEach(i=>$S(this,i)),Js.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:dY,DOMMouseScroll(e){this.fire(h6,e)},mousemove:_S(Kg,d6,qc),dragover:_S(f6,c6,tg),mouseout:SS(qc),dragleave:SS(tg),mousedown(e){this._down=this._active,this.fire(Lb,e)},click(e){this._down===this._active&&(this.fire(Jg,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Qg,e,!0)},touchmove(e){this.fire(Zg,e,!0)},touchend(e){this.fire(e0,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===Ub&&i&&i.href?this.handleHref(t,i,i.href):(e===Ib||e===Sf)&&this.handleTooltip(t,i,e!==Sf),r)for(let s=0,o=r.length;s<o;++s)r[s].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&($S(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=lm(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const s=this.context();return Pn[e.marktype].pick.call(this,s,e,t,n,i,r)}});function pY(){return typeof window<"u"&&window.devicePixelRatio||1}var mY=pY();function yY(e,t,n,i,r,s){const o=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=o?mY:r;e.width=t*u,e.height=n*u;for(const l in s)a[l]=s[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*i[0],u*i[1]),e}function t0(e){cr.call(this,e),this._options={},this._redraw=!1,this._dirty=new Je,this._tempb=new Je}const CS=cr.prototype,bY=(e,t,n)=>new Je().set(0,0,t,n).translate(-e[0],-e[1]);function vY(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}hl(t0,cr,{initialize(e,t,n,i,r,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Rs(1,1,this._options.type),e&&this._canvas&&(fi(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),CS.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(CS.resize.call(this,e,t,n,i),this._canvas)yY(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||Ic("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,s=this._dirty,o=bY(n,i,r);t.save();const a=this._redraw||s.empty()?(this._redraw=!1,o.expand(1)):vY(t,o.intersect(s),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,a),t.restore(),s.clear(),this},draw(e,t,n){const i=Pn[t.marktype];t.clip&&mG(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,s=this.context();r.type!=="pdf"&&!r.externalContext&&s.clearRect(e,t,n,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,i))}});function jw(e,t){Js.call(this,e,t);const n=this;n._hrefHandler=qb(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=qb(n,(i,r)=>{n.handleTooltip(i,r,i.type!==Sf)})}const qb=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};hl(jw,Js,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(Ub,this._hrefHandler),i.removeEventListener(Ib,this._tooltipHandler),i.removeEventListener(Sf,this._tooltipHandler)),this._svg=i=e&&Nw(e,"svg"),i&&(i.addEventListener(Ub,this._hrefHandler),i.addEventListener(Ib,this._tooltipHandler),i.addEventListener(Sf,this._tooltipHandler)),Js.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const s={type:e,handler:t,listener:qb(this,t)};(i[n]||(i[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const g6="aria-hidden",Rw="aria-label",Bw="role",Pw="aria-roledescription",p6="graphics-object",zw="graphics-symbol",m6=(e,t,n)=>({[Bw]:e,[Pw]:t,[Rw]:n||void 0}),xY=DU(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),kS={axis:{desc:"axis",caption:EY},legend:{desc:"legend",caption:$Y},"title-text":{desc:"title",caption:e=>`Title text '${OS(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${OS(e)}'`}},FS={ariaRole:Bw,ariaRoleDescription:Pw,description:Rw};function y6(e,t){const n=t.aria===!1;if(e(g6,n||void 0),n||t.description==null)for(const i in FS)e(FS[i],void 0);else{const i=t.mark.marktype;e(Rw,t.description),e(Bw,t.ariaRole||(i==="group"?p6:zw)),e(Pw,t.ariaRoleDescription||`${i} mark`)}}function b6(e){return e.aria===!1?{[g6]:!0}:xY[e.role]?null:kS[e.role]?AY(e,kS[e.role]):wY(e)}function wY(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return m6(n?p6:zw,`${t} mark container`,e.description)}function AY(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return m6(t.role||zw,t.desc,n.description||i(n))}catch{return null}}function OS(e){return s5(e.text).join(" ")}function EY(e){const t=e.datum,n=e.orient,i=t.title?v6(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Ru(a)?"discrete":a} scale with ${RM(o,s,e)}`}function $Y(e){const t=e.datum,n=t.title?v6(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,u=o.dataflow.locale();return SY(i)+(n?` titled '${n}'`:"")+` for ${_Y(s)} with ${RM(u,a,e)}`}function v6(e){try{return s5(r5(e.items).items[0].text).join(" ")}catch{return null}}function _Y(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+r5(e)}function SY(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const x6=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),CY=e=>x6(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Lw(){let e="",t="",n="";const i=[],r=()=>t=n="",s=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${CY(l)}"`),a),a={open(u){s(u),t="<"+u;for(var l=arguments.length,c=new Array(l>1?l-1:0),f=1;f<l;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)o(h,d[h]);return a},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),a},attr:o,text:u=>(n+=x6(u),a),toString:()=>e};return a}const w6=e=>A6(Lw(),e)+"";function A6(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)i.nodeType===3?e.text(i.nodeValue):A6(e,i)}return e.close()}const n0={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},i0={blend:"mix-blend-mode"},E6={fill:"none","stroke-miterlimit":10},rc=0,DS="http://www.w3.org/2000/xmlns/",nt=_f.xmlns;function Iw(e){cr.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const J1=cr.prototype;hl(Iw,cr,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=hn(e,0,"svg",nt),this._svg.setAttributeNS(DS,"xmlns",nt),this._svg.setAttributeNS(DS,"xmlns:xlink",_f["xmlns:xlink"]),this._svg.setAttribute("version",_f.version),this._svg.setAttribute("class","marks"),fi(e,1),this._root=hn(this._svg,rc,"g",nt),_s(this._root,E6),fi(this._svg,rc+1)),this.background(this._bgcolor),J1.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),J1.background.apply(this,arguments)},resize(e,t,n,i){return J1.resize.call(this,e,t,n,i),this._svg&&(_s(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=hn(e,rc,"rect",nt),_s(n,{width:this._width,height:this._height,fill:t}));const i=w6(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),fi(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,s,o,a,u;for(o=0,a=e.length;o<a;++o)if(n=e[o],i=n.mark,i.marktype!==r&&(r=i.marktype,s=Pn[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,MS(n,t),i.items.forEach(l=>{l.dirty=t})),!i.zdirty){if(n.exit){s.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(s,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=s.nested?i.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,MS(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=Pn[t.marktype],s=t.interactive===!1?"none":null,o=r.tag==="g",a=TS(t,e,n,"g",i);a.setAttribute("class",l6(t));const u=b6(t);for(const d in u)Ht(a,d,u[d]);o||Ht(a,"pointer-events",s),Ht(a,"clip-path",t.clip?mw(this,t,t.group):null);let l=null,c=0;const f=d=>{const h=this.isDirty(d),g=TS(d,a,l,r.tag,i);h&&(this._update(r,g,d),o&&OY(this,g,d)),l=g,++c};return r.nested?t.items.length&&f(t.items[0]):Ei(t,f),fi(a,c),a},_update(e,t,n){Pr=t,Ot=t.__values__,y6(Wc,n),e.attr(Wc,n,this);const i=MY[e.type];i&&i.call(this,e,t,n),Pr&&this.style(Pr,n)},style(e,t){if(t!=null){for(const n in n0){let i=n==="font"?Ad(t):t[n];if(i===Ot[n])continue;const r=n0[n];i==null?e.removeAttribute(r):(hw(i)&&(i=PM(i,this._defs.gradient,$6())),e.setAttribute(r,i+"")),Ot[n]=i}for(const n in i0)ng(e,i0[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=hn(e,rc+1,"defs",nt)),i=kY(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=hn(e,rc+1,"defs",nt)),i=FY(n,t.clipping[r],i);n&&(i===0?(e.removeChild(n),t.el=null):fi(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function MS(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function kY(e,t,n){let i,r,s;if(t.gradient==="radial"){let o=hn(e,n++,"pattern",nt);_s(o,{id:Yg+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=hn(o,0,"rect",nt),_s(o,{width:1,height:1,fill:`url(${$6()}#${t.id})`}),e=hn(e,n++,"radialGradient",nt),_s(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=hn(e,n++,"linearGradient",nt),_s(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=hn(e,i,"stop",nt),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return fi(e,i),n}function FY(e,t,n){let i;return e=hn(e,n,"clipPath",nt),e.setAttribute("id",t.id),t.path?(i=hn(e,0,"path",nt),i.setAttribute("d",t.path)):(i=hn(e,0,"rect",nt),_s(i,{x:0,y:0,width:t.width,height:t.height})),fi(e,1),n+1}function OY(e,t,n){t=t.lastChild.previousSibling;let i,r=0;Ei(n,s=>{i=e.mark(t,s,i),++r}),fi(t,1+r)}function TS(e,t,n,i,r){let s=e._svg,o;if(!s&&(o=t.ownerDocument,s=$s(o,i,nt),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},i==="g"))){const a=$s(o,"path",nt);s.appendChild(a),a.__data__=e;const u=$s(o,"g",nt);s.appendChild(u),u.__data__=e;const l=$s(o,"path",nt);s.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(s.ownerSVGElement!==r||DY(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function DY(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Pr=null,Ot=null;const MY={group(e,t,n){const i=Pr=t.childNodes[2];Ot=i.__values__,e.foreground(Wc,n,this),Ot=t.__values__,Pr=t.childNodes[1],e.content(Wc,n,this);const r=Pr=t.childNodes[0];e.background(Wc,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==Ot.events&&(Ht(i,"pointer-events",s),Ht(r,"pointer-events",s),Ot.events=s),n.strokeForeground&&n.stroke){const o=n.fill;Ht(i,"display",null),this.style(r,n),Ht(r,"stroke",null),o&&(n.fill=null),Ot=i.__values__,this.style(i,n),o&&(n.fill=o),Pr=null}else Ht(i,"display","none")},image(e,t,n){n.smooth===!1?(ng(t,"image-rendering","optimizeSpeed"),ng(t,"image-rendering","pixelated")):ng(t,"image-rendering",null)},text(e,t,n){const i=wd(n);let r,s,o,a;uo(i)?(s=i.map(u=>Ks(n,u)),r=s.join(`
`),r!==Ot.text&&(fi(t,0),o=t.ownerDocument,a=Xs(n),s.forEach((u,l)=>{const c=$s(o,"tspan",nt);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Ot.text=r)):(s=Ks(n,i),s!==Ot.text&&(t.textContent=s,Ot.text=s)),Ht(t,"font-family",Ad(n)),Ht(t,"font-size",lr(n)+"px"),Ht(t,"font-style",n.fontStyle),Ht(t,"font-variant",n.fontVariant),Ht(t,"font-weight",n.fontWeight)}};function Wc(e,t,n){t!==Ot[e]&&(n?TY(Pr,e,t,n):Ht(Pr,e,t),Ot[e]=t)}function ng(e,t,n){n!==Ot[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Ot[t]=n)}function _s(e,t){for(const n in t)Ht(e,n,t[n])}function Ht(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function TY(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function $6(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Uw(e){cr.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}hl(Uw,cr,{svg(){return this._text},_render(e){const t=Lw();t.open("svg",o5({},_f,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",E6,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Pn[t.marktype],i=n.tag,r=[y6,n.attr];e.open("g",{class:l6(t),"clip-path":t.clip?mw(this,t,t.group):null},b6(t),{"pointer-events":i!=="g"&&t.interactive===!1?"none":null});const s=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(i,this.attr(t,o,r,i!=="g"?i:null)),i==="text"){const u=wd(o);if(uo(u)){const l={x:0,dy:Xs(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Ks(o,u[c])).close()}else e.text(Ks(o,u))}else if(i==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),Ei(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Ei(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},s=(o,a,u,l)=>{r[l||o]=a};return Array.isArray(n)?n.forEach(o=>o(s,t,this)):n(s,t,this),i&&NY(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const s=t[r],o=s.stops;s.gradient==="radial"?(e.open("pattern",{id:Yg+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:r,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let a=0;a<o.length;++a)e.open("stop",{offset:o[a].offset,"stop-color":o[a].color}).close();e.close()}for(const r in n){const s=n[r];e.open("clipPath",{id:r}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function NY(e,t,n,i,r){let s;if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),i==="text"&&(e["font-family"]=Ad(t),e["font-size"]=lr(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in n0){let a=t[o];const u=n0[o];a==="transparent"&&(u==="fill"||u==="stroke")||a!=null&&(hw(a)&&(a=PM(a,r.gradient,"")),e[u]=a)}for(const o in i0){const a=t[o];a!=null&&(s=s||[],s.push(`${i0[o]}: ${a};`))}return s&&(e.style=s.join(" ")),e}const _6="canvas",S6="png",C6="svg",k6="none",Ss={Canvas:_6,PNG:S6,SVG:C6,None:k6},Lu={};Lu[_6]=Lu[S6]={renderer:t0,headless:t0,handler:Ed};Lu[C6]={renderer:Iw,headless:Uw,handler:jw};Lu[k6]={};function cm(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Lu[e]=t,this):Lu[e]}function F6(e,t,n){const i=[],r=new Je().union(t),s=e.marktype;return s?O6(e,r,n,i):s==="group"?D6(e,r,n,i):Ic("Intersect scene must be mark node or group item.")}function O6(e,t,n,i){if(jY(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if(s==="group")for(;a<o;++a)D6(r[a],t,n,i);else for(const u=Pn[s].isect;a<o;++a){const l=r[a];M6(l,t,u)&&i.push(l)}}return i}function jY(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function D6(e,t,n,i){n&&n(e.mark)&&M6(e,t,Pn.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let u=0;u<s;++u)O6(r[u],t,n,i);t.translate(o,a)}return i}function M6(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const Q1=new Je;function T6(e){const t=e.clip;if(N2(t))t(vd(Q1.clear()));else if(t)Q1.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(Q1)}const RY=1e-9;function qw(e,t,n){return e===t?!0:n==="path"?N6(e,t):e instanceof Date&&t instanceof Date?+e==+t:O_(e)&&O_(t)?Math.abs(e-t)<=RY:!e||!t||!F_(e)&&!F_(t)?e==t:BY(e,t)}function N6(e,t){return qw(Bu(e),Bu(t))}function BY(e,t){var n=Object.keys(e),i=Object.keys(t),r,s;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(r=n[s],!qw(e[r],t[r],r))return!1;return typeof e==typeof t}function PY(){HM(),lH()}function bl(e,t,n){return e.fields=t||[],e.fname=n,e}function zY(e){return e.length===1?LY(e[0]):IY(e)}const LY=e=>function(t){return t[e]},IY=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Z1(e){throw Error(e)}function UY(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Z1("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Z1("Access path missing closing bracket: "+e),i&&Z1("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function qY(e,t,n){const i=UY(e);return e=i.length===1?i[0]:e,bl((n&&n.get||zY)(i),[e],t||e)}qY("id");bl(e=>e,[],"identity");bl(()=>0,[],"zero");bl(()=>1,[],"one");bl(()=>!0,[],"true");bl(()=>!1,[],"false");function WY(e){return e===Object(e)}function ey(e){return e[e.length-1]}function HY(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function vl(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),HY(i,n)}const Iu="top",di="left",gi="right",Qs="bottom",GY="top-left",YY="top-right",VY="bottom-left",XY="bottom-right",Ww="start",Wb="middle",Gt="end",KY="x",JY="y",fm="group",Hw="axis",Gw="title",QY="frame",ZY="scope",Yw="legend",j6="row-header",R6="row-footer",B6="row-title",P6="column-header",z6="column-footer",L6="column-title",eV="padding",tV="symbol",I6="fit",U6="fit-x",q6="fit-y",nV="pad",Vw="none",dh="all",Hb="each",Xw="flush",Cs="column",ks="row";function W6(e){D.call(this,null,e)}vl(W6,D,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=Pn[r],o=s.bound;let a=i.bounds,u;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=hh(i,o),i.items.forEach(l=>{l.bounds.clear().union(a)});else if(r===fm||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),i.items.forEach(l=>a.union(hh(l,o))),i.role){case Hw:case Yw:case Gw:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(hh(l,o))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(hh(l,o))}),u&&(a.clear(),i.items.forEach(l=>a.union(l.bounds)));return T6(i),t.modifies("bounds")}});function hh(e,t,n){return t(e.bounds.clear(),e,n)}const NS=":vega_identifier:";function Kw(e){D.call(this,0,e)}Kw.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};vl(Kw,D,{transform(e,t){const n=iV(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}});function iV(e){return e._signals[NS]||(e._signals[NS]=e.add(0))}function H6(e){D.call(this,null,e)}vl(H6,D,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,rV(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===fm?nm:tm;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function rV(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function G6(e){D.call(this,null,e)}const jS={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!Y6(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},Y6=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),RS=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,s;n<i;r=s,++n)if(Y6(r,s=e[n].bounds,t))return!0},sV=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},oV=(e,t,n)=>{var i=e.range(),r=new Je;return t===Iu||t===Qs?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)},BS=e=>(e.forEach(t=>t.opacity=1),e),PS=(e,t)=>e.reflow(t.modified()).modifies("opacity");vl(G6,D,{transform(e,t){const n=jS[e.method]||jS.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,s,o;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(BS(r),t=PS(t,e)),t;if(r=r.filter(sV),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=BS(r),t=PS(t,e),s.length>=3&&RS(s,i)){do s=n(s,i);while(s.length>=3&&RS(s,i));s.length<3&&!ey(r).opacity&&(s.length>1&&(ey(s).opacity=0),ey(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=oV(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{o(u)||(u.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function V6(e){D.call(this,null,e)}vl(V6,D,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const Ft=new Je;function du(e,t,n){return e[t]===n?0:(e[t]=n,1)}function aV(e){var t=e.items[0].orient;return t===di||t===gi}function uV(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function lV(e,t,n,i){var r=t.items[0],s=r.datum,o=r.translate!=null?r.translate:.5,a=r.orient,u=uV(s),l=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,g=s.title&&r.items[u[2]].items[0],p=r.titlePadding,m=r.bounds,y=g&&Ow(g),b=0,v=0,x,A;switch(Ft.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(r.items[x].bounds),(x=u[1])>-1&&m.union(r.items[x].bounds),a){case Iu:b=f||0,v=-c,A=Math.max(d,Math.min(h,-m.y1)),m.add(0,-A).add(l,0),g&&gh(e,g,A,p,y,0,-1,m);break;case di:b=-c,v=f||0,A=Math.max(d,Math.min(h,-m.x1)),m.add(-A,0).add(0,l),g&&gh(e,g,A,p,y,1,-1,m);break;case gi:b=n+c,v=f||0,A=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(A,l),g&&gh(e,g,A,p,y,1,1,m);break;case Qs:b=f||0,v=i+c,A=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,A),g&&gh(e,g,A,p,0,0,1,m);break;default:b=r.x,v=r.y}return ts(m.translate(b,v),r),du(r,"x",b+o)|du(r,"y",v+o)&&(r.bounds=Ft,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function gh(e,t,n,i,r,s,o,a){const u=t.bounds;if(t.auto){const l=o*(n+r+i);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const zS=(e,t)=>Math.floor(Math.min(e,t)),LS=(e,t)=>Math.ceil(Math.max(e,t));function cV(e){var t=e.items,n=t.length,i=0,r,s;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],s=r.items,r.marktype===fm)switch(r.role){case Hw:case Yw:case Gw:break;case j6:o.rowheaders.push(...s);break;case R6:o.rowfooters.push(...s);break;case P6:o.colheaders.push(...s);break;case z6:o.colfooters.push(...s);break;case B6:o.rowtitle=s[0];break;case L6:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}function fV(e){return new Je().set(0,0,e.width||0,e.height||0)}function dV(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function je(e,t,n){const i=WY(e)?e[t]:e;return i??(n!==void 0?n:0)}function IS(e){return e<0?Math.ceil(-e):0}function X6(e,t,n){var i=!n.nodirty,r=n.bounds===Xw?fV:dV,s=Ft.set(0,0,0,0),o=je(n.align,Cs),a=je(n.align,ks),u=je(n.padding,Cs),l=je(n.padding,ks),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),g=Array(c),p=0,m=Array(d),y=Array(f),b=0,v=Array(d),x=Array(d),A=Array(d),E,w,$,S,_,C,M,F,O,k,j;for(w=0;w<c;++w)g[w]=0;for(w=0;w<f;++w)y[w]=0;for(w=0;w<d;++w)C=t[w],_=A[w]=r(C),C.x=C.x||0,v[w]=0,C.y=C.y||0,x[w]=0,$=w%c,S=~~(w/c),p=Math.max(p,M=Math.ceil(_.x2)),b=Math.max(b,F=Math.ceil(_.y2)),g[$]=Math.max(g[$],M),y[S]=Math.max(y[S],F),h[w]=u+IS(_.x1),m[w]=l+IS(_.y1),i&&e.dirty(t[w]);for(w=0;w<d;++w)w%c===0&&(h[w]=0),w<c&&(m[w]=0);if(o===Hb)for($=1;$<c;++$){for(j=0,w=$;w<d;w+=c)j<h[w]&&(j=h[w]);for(w=$;w<d;w+=c)h[w]=j+g[$-1]}else if(o===dh){for(j=0,w=0;w<d;++w)w%c&&j<h[w]&&(j=h[w]);for(w=0;w<d;++w)w%c&&(h[w]=j+p)}else for(o=!1,$=1;$<c;++$)for(w=$;w<d;w+=c)h[w]+=g[$-1];if(a===Hb)for(S=1;S<f;++S){for(j=0,w=S*c,E=w+c;w<E;++w)j<m[w]&&(j=m[w]);for(w=S*c;w<E;++w)m[w]=j+y[S-1]}else if(a===dh){for(j=0,w=c;w<d;++w)j<m[w]&&(j=m[w]);for(w=c;w<d;++w)m[w]=j+b}else for(a=!1,S=1;S<f;++S)for(w=S*c,E=w+c;w<E;++w)m[w]+=y[S-1];for(O=0,w=0;w<d;++w)O=h[w]+(w%c?O:0),v[w]+=O-t[w].x;for($=0;$<c;++$)for(k=0,w=$;w<d;w+=c)k+=m[w],x[w]+=k-t[w].y;if(o&&je(n.center,Cs)&&f>1)for(w=0;w<d;++w)_=o===dh?p:g[w%c],O=_-A[w].x2-t[w].x-v[w],O>0&&(v[w]+=O/2);if(a&&je(n.center,ks)&&c!==1)for(w=0;w<d;++w)_=a===dh?b:y[~~(w/c)],k=_-A[w].y2-t[w].y-x[w],k>0&&(x[w]+=k/2);for(w=0;w<d;++w)s.union(A[w].translate(v[w],x[w]));switch(O=je(n.anchor,KY),k=je(n.anchor,JY),je(n.anchor,Cs)){case Gt:O-=s.width();break;case Wb:O-=s.width()/2}switch(je(n.anchor,ks)){case Gt:k-=s.height();break;case Wb:k-=s.height()/2}for(O=Math.round(O),k=Math.round(k),s.clear(),w=0;w<d;++w)t[w].mark.bounds.clear();for(w=0;w<d;++w)C=t[w],C.x+=v[w]+=O,C.y+=x[w]+=k,s.union(C.mark.bounds.union(C.bounds.translate(v[w],x[w]))),i&&e.dirty(C);return s}function hV(e,t,n){var i=cV(t),r=i.marks,s=n.bounds===Xw?gV:pV,o=n.offset,a=n.columns||r.length,u=a<=0?1:Math.ceil(r.length/a),l=u*a,c,f,d,h,g,p,m;const y=X6(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(p=je(n.headerBand,ks,null),c=ph(e,i.rowheaders,r,a,u,-je(o,"rowHeader"),zS,0,s,"x1",0,a,1,p)),i.colheaders&&(p=je(n.headerBand,Cs,null),f=ph(e,i.colheaders,r,a,a,-je(o,"columnHeader"),zS,1,s,"y1",0,1,a,p)),i.rowfooters&&(p=je(n.footerBand,ks,null),d=ph(e,i.rowfooters,r,a,u,je(o,"rowFooter"),LS,0,s,"x2",a-1,a,1,p)),i.colfooters&&(p=je(n.footerBand,Cs,null),h=ph(e,i.colfooters,r,a,a,je(o,"columnFooter"),LS,1,s,"y2",l-a,1,a,p)),i.rowtitle&&(g=je(n.titleAnchor,ks),m=je(o,"rowTitle"),m=g===Gt?d+m:c-m,p=je(n.titleBand,ks,.5),US(e,i.rowtitle,m,0,y,p)),i.coltitle&&(g=je(n.titleAnchor,Cs),m=je(o,"columnTitle"),m=g===Gt?h+m:f-m,p=je(n.titleBand,Cs,.5),US(e,i.coltitle,m,1,y,p))}function gV(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function pV(e,t){return e.bounds[t]}function ph(e,t,n,i,r,s,o,a,u,l,c,f,d,h){var g=n.length,p=0,m=0,y,b,v,x,A,E,w,$,S;if(!g)return p;for(y=c;y<g;y+=f)n[y]&&(p=o(p,u(n[y],l)));if(!t.length)return p;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),p+=s,b=0,x=t.length;b<x;++b)e.dirty(t[b]),t[b].mark.bounds.clear();for(y=c,b=0,x=t.length;b<x;++b,y+=f){for(E=t[b],A=E.mark.bounds,v=y;v>=0&&(w=n[v])==null;v-=d);a?($=h==null?w.x:Math.round(w.bounds.x1+h*w.bounds.width()),S=p):($=p,S=h==null?w.y:Math.round(w.bounds.y1+h*w.bounds.height())),A.union(E.bounds.translate($-(E.x||0),S-(E.y||0))),E.x=$,E.y=S,e.dirty(E),m=o(m,A[l])}return m}function US(e,t,n,i,r,s){if(t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function mV(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function yV(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function bV(e,t,n,i,r,s,o){const a=mV(n,t),u=yV(e,a("offset",0)),l=a("anchor",Ww),c=l===Gt?1:l===Wb?.5:0,f={align:Hb,bounds:a("bounds",Xw),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case di:f.anchor={x:Math.floor(i.x1)-u,column:Gt,y:c*(o||i.height()+2*i.y1),row:l};break;case gi:f.anchor={x:Math.ceil(i.x2)+u,y:c*(o||i.height()+2*i.y1),row:l};break;case Iu:f.anchor={y:Math.floor(r.y1)-u,row:Gt,x:c*(s||r.width()+2*r.x1),column:l};break;case Qs:f.anchor={y:Math.ceil(r.y2)+u,x:c*(s||r.width()+2*r.x1),column:l};break;case GY:f.anchor={x:u,y:u};break;case YY:f.anchor={x:s-u,y:u,column:Gt};break;case VY:f.anchor={x:u,y:o-u,row:Gt};break;case XY:f.anchor={x:s-u,y:o-u,column:Gt,row:Gt};break}return f}function vV(e,t){var n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),wV(e,n,n.items[0].items[0]),s=xV(n,s),u=2*n.padding,l=2*n.padding,s.empty()||(u=Math.ceil(s.width()+u),l=Math.ceil(s.height()+l)),i.type===tV&&AV(n.items[0].items[0].items[0].items),r!==Vw&&(n.x=o=0,n.y=a=0),n.width=u,n.height=l,ts(s.set(o,a,o+u,a+l),n),n.mark.bounds.clear().union(s),n}function xV(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function wV(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(!t.datum.title)(r||s)&&sc(e,n,r,s);else{var o=t.items[1].items[0],a=o.anchor,u=t.titlePadding||0,l=i-o.x,c=i-o.y;switch(o.orient){case di:r+=Math.ceil(o.bounds.width())+u;break;case gi:case Qs:break;default:s+=o.bounds.height()+u}switch((r||s)&&sc(e,n,r,s),o.orient){case di:c+=tu(t,n,o,a,1,1);break;case gi:l+=tu(t,n,o,Gt,0,0)+u,c+=tu(t,n,o,a,1,1);break;case Qs:l+=tu(t,n,o,a,0,0),c+=tu(t,n,o,Gt,-1,0,1)+u;break;default:l+=tu(t,n,o,a,0,0)}(l||c)&&sc(e,o,l,c),(l=Math.round(o.bounds.x1-i))<0&&(sc(e,n,-l,0),sc(e,o,-l,0))}}function tu(e,t,n,i,r,s,o){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(s||!u)&&!o?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&s?c:0,d=u&&s?0:c,h=r<=0?0:Ow(n);return Math.round(i===Ww?f:i===Gt?d-h:.5*(c-h))}function sc(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function AV(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function EV(e,t,n,i,r){var s=t.items[0],o=s.frame,a=s.orient,u=s.anchor,l=s.offset,c=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],h=a===di||a===gi?i:n,g=0,p=0,m=0,y=0,b=0,v;if(o!==fm?a===di?(g=r.y2,h=r.y1):a===gi?(g=r.y1,h=r.y2):(g=r.x1,h=r.x2):a===di&&(g=i,h=0),v=u===Ww?g:u===Gt?h:(g+h)/2,d&&d.text){switch(a){case Iu:case Qs:b=f.bounds.height()+c;break;case di:y=f.bounds.width()+c;break;case gi:y=-f.bounds.width()-c;break}Ft.clear().union(d.bounds),Ft.translate(y-(d.x||0),b-(d.y||0)),du(d,"x",y)|du(d,"y",b)&&(e.dirty(d),d.bounds.clear().union(Ft),d.mark.bounds.clear().union(Ft),e.dirty(d)),Ft.clear().union(d.bounds)}else Ft.clear();switch(Ft.union(f.bounds),a){case Iu:p=v,m=r.y1-Ft.height()-l;break;case di:p=r.x1-Ft.width()-l,m=v;break;case gi:p=r.x2+Ft.width()+l,m=v;break;case Qs:p=v,m=r.y2+l;break;default:p=s.x,m=s.y}return du(s,"x",p)|du(s,"y",m)&&(Ft.translate(p,m),e.dirty(s),s.bounds.clear().union(Ft),t.bounds.clear().union(Ft),e.dirty(s)),s.bounds}function K6(e){D.call(this,null,e)}vl(K6,D,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&hV(n,i,e.layout),_V(n,i,e)}),$V(e.mark.group)?t.reflow():t}});function $V(e){return e&&e.mark.role!=="legend-entry"}function _V(e,t,n){var i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new Je().set(0,0,r,s),a=o.clone(),u=o.clone(),l=[],c,f,d,h,g,p;for(g=0,p=i.length;g<p;++g)switch(f=i[g],f.role){case Hw:h=aV(f)?a:u,h.union(lV(e,f,r,s));break;case Gw:c=f;break;case Yw:l.push(vV(e,f));break;case QY:case ZY:case j6:case R6:case B6:case P6:case z6:case L6:a.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||gi,d!==Vw&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const b=m[y];X6(e,b,bV(b,y,n.legends,a,u,r,s))}l.forEach(y=>{const b=y.bounds;if(b.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=b,e.dirty(y)),n.autosize&&(n.autosize.type===I6||n.autosize.type===U6||n.autosize.type===q6))switch(y.orient){case di:case gi:o.add(b.x1,0).add(b.x2,0);break;case Iu:case Qs:o.add(0,b.y1).add(0,b.y2)}else o.union(b)})}o.union(a).union(u),c&&o.union(EV(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),SV(e,t,o,n)}function SV(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(r.contains===eV){const g=e.padding();o-=g.left+g.right,a-=g.top+g.bottom}s===Vw?(l=0,f=0,u=o,c=a):s===I6?(u=Math.max(0,o-l-d),c=Math.max(0,a-f-h)):s===U6?(u=Math.max(0,o-l-d),a=c+f+h):s===q6?(o=u+l+d,c=Math.max(0,a-f-h)):s===nV&&(o=u+l+d,a=c+f+h),e._resizeView(o,a,u,c,[l,f],r.resize)}const CV=Object.freeze(Object.defineProperty({__proto__:null,bound:W6,identifier:Kw,mark:H6,overlap:G6,render:V6,viewlayout:K6},Symbol.toStringTag,{value:"Module"}));function xl(e,t,n){return e.fields=t||[],e.fname=n,e}function kV(e){return e.length===1?FV(e[0]):OV(e)}const FV=e=>function(t){return t[e]},OV=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Ir(e){throw Error(e)}function DV(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Ir("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Ir("Access path missing closing bracket: "+e),i&&Ir("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function MV(e,t,n){const i=DV(e);return e=i.length===1?i[0]:e,xl((n&&n.get||kV)(i),[e],t||e)}MV("id");const TV=xl(e=>e,[],"identity");xl(()=>0,[],"zero");const J6=xl(()=>1,[],"one");xl(()=>!0,[],"true");const ko=xl(()=>!1,[],"false");var $d=Array.isArray;function NV(e){return e===Object(e)}function ua(e){return e[e.length-1]}function jV(e){return e==null||e===""?null:+e}const RV=e=>t=>e*Math.exp(t),BV=e=>t=>Math.log(e*t),PV=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),zV=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,qS=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function dm(e,t,n,i,r){const s=i(e[0]),o=i(ua(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function LV(e,t,n){return dm(e,t,n,jV,TV)}function IV(e,t,n){const i=Math.sign(e[0]);return dm(e,t,n,BV(i),RV(i))}function WS(e,t,n,i){return dm(e,t,n,qS(i),qS(1/i))}function UV(e,t,n,i){return dm(e,t,n,PV(i),zV(i))}function Ps(e){return typeof e=="function"}function qV(e){return Ps(e)?e:()=>e}function WV(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const HV=Object.prototype.hasOwnProperty;function GV(e,t){return HV.call(e,t)}const mh={};function Q6(e){let t={},n;function i(s){return GV(t,s)&&t[s]!==mh}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===mh&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=mh),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==mh&&(!n||!n(u))&&(s[a]=u,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function ns(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),WV(i,n)}function Z6(e){return typeof e=="string"}function e8(e){return $d(e)?"["+e.map(e8)+"]":NV(e)||Z6(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function YV(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function t8(e){D.call(this,null,e)}ns(t8,D,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,a=fw(s,o,e.minstep),u=e.format||DM(n,s,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?OM(s,e.values,a):dw(s,a);return r&&(i.rem=r),r=l.map((c,f)=>we({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(we({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function n8(e){D.call(this,null,e)}function VV(){return we({})}function XV(e){const t=Q6().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}ns(n8,D,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||VV,s=e.key||V,o=this.value;return $d(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&Ir("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=XV(s)),t.visit(t.ADD,a=>{const u=s(a);let l=o.get(u);l?l.exit?(o.empty--,i.add.push(l)):i.mod.push(l):(l=r(a),o.set(u,l),i.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=s(a),l=o.get(u);l&&(l.datum=a,i.mod.push(l))}),t.visit(t.REM,a=>{const u=s(a),l=o.get(u);a===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}});function i8(e){D.call(this,null,e)}ns(i8,D,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if($d(s))if(n.changed()||s.every(f=>r[f]))s=s[0],n.encode=null;else return t.StopPropagation;var o=s==="enter",a=r.update||ko,u=r.enter||ko,l=r.exit||ko,c=(s&&!o?r[s]:a)||ko;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==ko&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==ko&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==ko){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function r8(e){D.call(this,[],e)}ns(r8,D,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||Xh,o=e.scale,a=+e.limit,u=fw(o,e.count==null?5:e.count,e.minstep),l=!!e.values||s===Xh,c=e.format||jM(n,o,u,s,e.formatSpecifier,e.formatType,l),f=e.values||NM(o,u),d,h,g,p,m;return r&&(i.rem=r),s===Xh?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,a-1),m=!0):r=f,Ps(g=e.size)?(!e.values&&o(r[0])===0&&(r=r.slice(1)),p=r.reduce((y,b)=>Math.max(y,g(b,e)),0)):g=qV(p=g||8),r=r.map((y,b)=>we({index:b,label:c(y,b,r),value:y,offset:p,size:g(y,e)})),m&&(m=f[r.length],r.push(we({index:r.length,label:`…${f.length-r.length} entries`,value:m,offset:p,size:g(m,e)})))):s===KW?(d=o.domain(),h=CM(o,d[0],ua(d)),f.length<3&&!e.values&&d[0]!==ua(d)&&(f=[d[0],ua(d)]),r=f.map((y,b)=>we({index:b,label:c(y,b,f),value:y,perc:h(y)}))):(g=f.length-1,h=aH(o),r=f.map((y,b)=>we({index:b,label:c(y,b,f),value:y,perc:b?h(y):0,perc2:b===g?1:h(f[b+1])}))),i.source=r,i.add=r,this.value=r,i}});const KV=e=>e.source.x,JV=e=>e.source.y,QV=e=>e.target.x,ZV=e=>e.target.y;function Jw(e){D.call(this,{},e)}Jw.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};ns(Jw,D,{transform(e,t){var n=e.sourceX||KV,i=e.sourceY||JV,r=e.targetX||QV,s=e.targetY||ZV,o=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=HS.get(u+"-"+a)||HS.get(u);return l||Ir("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const s8=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,eX=(e,t,n,i)=>s8(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),o8=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.hypot(r,s)/2,a=180*Math.atan2(s,r)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+i},tX=(e,t,n,i)=>o8(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),a8=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},nX=(e,t,n,i)=>a8(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),iX=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,rX=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,sX=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},oX=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},aX=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},uX=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*s+"C"+u*r+","+u*s+" "+u*o+","+u*a+" "+i*o+","+i*a},HS=Q6({line:s8,"line-radial":eX,arc:o8,"arc-radial":tX,curve:a8,"curve-radial":nX,"orthogonal-horizontal":iX,"orthogonal-vertical":rX,"orthogonal-radial":sX,"diagonal-horizontal":oX,"diagonal-vertical":aX,"diagonal-radial":uX});function Qw(e){D.call(this,null,e)}Qw.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};ns(Qw,D,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],s=e.field||J6,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(s),c=l.length,f=o,d=(a-o)/l3(l),h=Tn(c),g,p,m;for(e.sort&&h.sort((y,b)=>l[y]-l[b]),g=0;g<c;++g)m=l[h[g]],p=u[h[g]],p[i]=f,p[r]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const lX=5;function cX(e){const t=e.type;return!e.bins&&(t===Nu||t===dd||t===hd)}function u8(e){return uw(e)&&e!==Hi}const fX=YV(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function l8(e){D.call(this,null,e),this.modified(!0)}ns(l8,D,{transform(e,t){var n=t.dataflow,i=this.value,r=dX(e);(!i||r!==i.type)&&(this.value=i=ve(r)());for(r in e)if(!fX[r]){if(r==="padding"&&u8(i.type))continue;Ps(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return bX(i,e,yX(i,e,gX(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function dX(e){var t=e.type,n="",i;return t===Hi?Hi+"-"+Nu:(hX(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?Hi+"-":i===3?ml+"-":""),(n+t||Nu).toLowerCase())}function hX(e){const t=e.type;return uw(t)&&t!==ya&&t!==ba&&(e.scheme||e.range&&e.range.length&&e.range.every(Z6))}function gX(e,t,n){const i=pX(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,s=e.type,o=t.zero||t.zero===void 0&&cX(e),a,u;if(!r)return 0;if(u8(s)&&t.padding&&r[0]!==ua(r)&&(r=mX(s,r,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[a]?a+1:u<r[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return e.domain(c8(s,r,n)),s===rw&&e.unknown(t.domainImplicit?$b:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&fw(e,t.nice)||null),r.length}function pX(e,t,n){return t?(e.domain(c8(e.type,t,n)),t.length):-1}function mX(e,t,n,i,r,s){var o=Math.abs(ua(n)-n[0]),a=o/(o-2*i),u=e===Xr?IV(t,null,a):e===hd?WS(t,null,a,.5):e===dd?WS(t,null,a,r||1):e===Kp?UV(t,null,a,s||1):LV(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function c8(e,t,n){if(AM(e)){var i=Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+e8(t))}return t}function yX(e,t,n){let i=t.bins;if(i&&!$d(i)){const r=e.domain(),s=r[0],o=ua(r),a=i.step;let u=i.start==null?s:i.start,l=i.stop==null?o:i.stop;a||Ir("Scale bins parameter missing step property."),u<s&&(u=a*Math.ceil(s/a)),l>o&&(l=a*Math.floor(o/a)),i=Tn(u,l+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===sw&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function bX(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(t.rangeStep!=null)s=vX(i,t,n);else if(t.scheme&&(s=xX(i,t,n),Ps(s))){if(e.interpolator)return e.interpolator(s);Ir(`Scale type ${i} does not support interpolating color schemes.`)}if(s&&EM(i))return e.interpolator(Zp(Gb(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(lw(t.interpolate,t.interpolateGamma)):Ps(e.round)?e.round(r):Ps(e.rangeRound)&&e.interpolate(r?cd:fo),s&&e.range(Gb(s,t.reverse))}function vX(e,t,n){e!==mM&&e!==Db&&Ir("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===Db?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*iw(n,r,i)]}function xX(e,t,n){var i=t.schemeExtent,r,s;return $d(t.scheme)?s=Zp(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),s=cw(r),s||Ir(`Unrecognized scheme name: ${t.scheme}`)),n=e===Qp?n+1:e===sw?n-1:e===ju||e===Jp?+t.schemeCount||lX:n,EM(e)?GS(s,i,t.reverse):Ps(s)?SM(GS(s,i),n):e===rw?s:s.slice(0,n)}function GS(e,t,n){return Ps(e)&&(t||n)?_M(e,Gb(t||[0,1],n)):e}function Gb(e,t){return t?e.slice().reverse():e}function f8(e){D.call(this,null,e)}ns(f8,D,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(ja(e.sort)),this.modified(n),t}});const YS="zero",d8="center",h8="normalize",g8=["y0","y1"];function Zw(e){D.call(this,null,e)}Zw.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:YS,values:[YS,d8,h8]},{name:"as",type:"string",array:!0,length:2,default:g8}]};ns(Zw,D,{transform(e,t){var n=e.as||g8,i=n[0],r=n[1],s=ja(e.sort),o=e.field||J6,a=e.offset===d8?wX:e.offset===h8?AX:EX,u,l,c,f;for(u=$X(t.source,e.groupby,s,o),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,o,i,r);return t.reflow(e.modified()).modifies(n)}});function wX(e,t,n,i,r){for(var s=(t-e.sum)/2,o=e.length,a=0,u;a<o;++a)u=e[a],u[i]=s,u[r]=s+=Math.abs(n(u))}function AX(e,t,n,i,r){for(var s=1/e.sum,o=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[i]=o,c[r]=o=s*(l+=Math.abs(n(c)))}function EX(e,t,n,i,r){for(var s=0,o=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[i]=o,c[r]=o+=l):(c[i]=s,c[r]=s+=l)}function $X(e,t,n,i){var r=[],s=p=>p(c),o,a,u,l,c,f,d,h,g;if(t==null)r.push(e.slice());else for(o={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(s),d=o[f],d||(o[f]=d=[],r.push(d)),d.push(c);for(f=0,g=0,l=r.length;f<l;++f){for(d=r[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(i(d[a]));d.sum=h,h>g&&(g=h),n&&d.sort(n)}return r.max=g,r}const _X=Object.freeze(Object.defineProperty({__proto__:null,axisticks:t8,datajoin:n8,encode:i8,legendentries:r8,linkpath:Jw,pie:Qw,scale:l8,sortitems:f8,stack:Zw},Symbol.toStringTag,{value:"Module"}));function wl(e,t,n){return e.fields=t||[],e.fname=n,e}function SX(e){return e==null?null:e.fname}function ig(e){return e==null?null:e.fields}function CX(e){return e.length===1?kX(e[0]):FX(e)}const kX=e=>function(t){return t[e]},FX=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function zs(e){throw Error(e)}function OX(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||zs("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&zs("Access path missing closing bracket: "+e),i&&zs("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function p8(e,t,n){const i=OX(e);return e=i.length===1?i[0]:e,wl((n&&n.get||CX)(i),[e],t||e)}p8("id");const Cf=wl(e=>e,[],"identity"),DX=wl(()=>0,[],"zero"),MX=wl(()=>1,[],"one");wl(()=>!0,[],"true");wl(()=>!1,[],"false");var eA=Array.isArray;function tA(e){return e!=null?eA(e)?e:[e]:[]}function Kr(e){return typeof e=="function"}function kf(e){return Kr(e)?e:()=>e}function m8(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function TX(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function fr(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),m8(i,n)}function VS(e){return typeof e=="number"}function NX(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}var J=1e-6,r0=1e-12,de=Math.PI,He=de/2,s0=de/4,tn=de*2,Ye=180/de,le=de/180,he=Math.abs,Al=Math.atan,Jn=Math.atan2,Z=Math.cos,yh=Math.ceil,y8=Math.exp,Yb=Math.hypot,o0=Math.log,ty=Math.pow,K=Math.sin,Wn=Math.sign||function(e){return e>0?1:e<0?-1:0},nn=Math.sqrt,nA=Math.tan;function b8(e){return e>1?0:e<-1?de:Math.acos(e)}function wn(e){return e>1?He:e<-1?-He:Math.asin(e)}function vt(){}function a0(e,t){e&&KS.hasOwnProperty(e.type)&&KS[e.type](e,t)}var XS={Feature:function(e,t){a0(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)a0(n[i].geometry,t)}},KS={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Vb(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Vb(n[i],t,0)},Polygon:function(e,t){JS(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)JS(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)a0(n[i],t)}};function Vb(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function JS(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Vb(e[n],t,1);t.polygonEnd()}function Tr(e,t){e&&XS.hasOwnProperty(e.type)?XS[e.type](e,t):a0(e,t)}var u0=new Zt,l0=new Zt,v8,x8,Xb,Kb,Jb,tr={point:vt,lineStart:vt,lineEnd:vt,polygonStart:function(){u0=new Zt,tr.lineStart=jX,tr.lineEnd=RX},polygonEnd:function(){var e=+u0;l0.add(e<0?tn+e:e),this.lineStart=this.lineEnd=this.point=vt},sphere:function(){l0.add(tn)}};function jX(){tr.point=BX}function RX(){w8(v8,x8)}function BX(e,t){tr.point=w8,v8=e,x8=t,e*=le,t*=le,Xb=e,Kb=Z(t=t/2+s0),Jb=K(t)}function w8(e,t){e*=le,t*=le,t=t/2+s0;var n=e-Xb,i=n>=0?1:-1,r=i*n,s=Z(t),o=K(t),a=Jb*o,u=Kb*s+a*Z(r),l=a*i*K(r);u0.add(Jn(l,u)),Xb=e,Kb=s,Jb=o}function PX(e){return l0=new Zt,Tr(e,tr),l0*2}function c0(e){return[Jn(e[1],e[0]),wn(e[2])]}function va(e){var t=e[0],n=e[1],i=Z(n);return[i*Z(t),i*K(t),K(n)]}function bh(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Uu(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function ny(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function vh(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function f0(e){var t=nn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var ze,fn,Ue,On,Uo,A8,E8,xu,Hc,bs,Jr,Fr={point:Qb,lineStart:QS,lineEnd:ZS,polygonStart:function(){Fr.point=_8,Fr.lineStart=zX,Fr.lineEnd=LX,Hc=new Zt,tr.polygonStart()},polygonEnd:function(){tr.polygonEnd(),Fr.point=Qb,Fr.lineStart=QS,Fr.lineEnd=ZS,u0<0?(ze=-(Ue=180),fn=-(On=90)):Hc>J?On=90:Hc<-J&&(fn=-90),Jr[0]=ze,Jr[1]=Ue},sphere:function(){ze=-(Ue=180),fn=-(On=90)}};function Qb(e,t){bs.push(Jr=[ze=e,Ue=e]),t<fn&&(fn=t),t>On&&(On=t)}function $8(e,t){var n=va([e*le,t*le]);if(xu){var i=Uu(xu,n),r=[i[1],-i[0],0],s=Uu(r,i);f0(s),s=c0(s);var o=e-Uo,a=o>0?1:-1,u=s[0]*Ye*a,l,c=he(o)>180;c^(a*Uo<u&&u<a*e)?(l=s[1]*Ye,l>On&&(On=l)):(u=(u+360)%360-180,c^(a*Uo<u&&u<a*e)?(l=-s[1]*Ye,l<fn&&(fn=l)):(t<fn&&(fn=t),t>On&&(On=t))),c?e<Uo?Fn(ze,e)>Fn(ze,Ue)&&(Ue=e):Fn(e,Ue)>Fn(ze,Ue)&&(ze=e):Ue>=ze?(e<ze&&(ze=e),e>Ue&&(Ue=e)):e>Uo?Fn(ze,e)>Fn(ze,Ue)&&(Ue=e):Fn(e,Ue)>Fn(ze,Ue)&&(ze=e)}else bs.push(Jr=[ze=e,Ue=e]);t<fn&&(fn=t),t>On&&(On=t),xu=n,Uo=e}function QS(){Fr.point=$8}function ZS(){Jr[0]=ze,Jr[1]=Ue,Fr.point=Qb,xu=null}function _8(e,t){if(xu){var n=e-Uo;Hc.add(he(n)>180?n+(n>0?360:-360):n)}else A8=e,E8=t;tr.point(e,t),$8(e,t)}function zX(){tr.lineStart()}function LX(){_8(A8,E8),tr.lineEnd(),he(Hc)>J&&(ze=-(Ue=180)),Jr[0]=ze,Jr[1]=Ue,xu=null}function Fn(e,t){return(t-=e)<0?t+360:t}function IX(e,t){return e[0]-t[0]}function eC(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function UX(e){var t,n,i,r,s,o,a;if(On=Ue=-(ze=fn=1/0),bs=[],Tr(e,Fr),n=bs.length){for(bs.sort(IX),t=1,i=bs[0],s=[i];t<n;++t)r=bs[t],eC(i,r[0])||eC(i,r[1])?(Fn(i[0],r[1])>Fn(i[0],i[1])&&(i[1]=r[1]),Fn(r[0],i[1])>Fn(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,n=s.length-1,t=0,i=s[n];t<=n;i=r,++t)r=s[t],(a=Fn(i[1],r[0]))>o&&(o=a,ze=r[0],Ue=i[1])}return bs=Jr=null,ze===1/0||fn===1/0?[[NaN,NaN],[NaN,NaN]]:[[ze,fn],[Ue,On]]}var Sc,d0,h0,g0,p0,m0,y0,b0,Zb,ev,tv,S8,C8,Yt,Vt,Xt,pi={sphere:vt,point:iA,lineStart:tC,lineEnd:nC,polygonStart:function(){pi.lineStart=HX,pi.lineEnd=GX},polygonEnd:function(){pi.lineStart=tC,pi.lineEnd=nC}};function iA(e,t){e*=le,t*=le;var n=Z(t);_d(n*Z(e),n*K(e),K(t))}function _d(e,t,n){++Sc,h0+=(e-h0)/Sc,g0+=(t-g0)/Sc,p0+=(n-p0)/Sc}function tC(){pi.point=qX}function qX(e,t){e*=le,t*=le;var n=Z(t);Yt=n*Z(e),Vt=n*K(e),Xt=K(t),pi.point=WX,_d(Yt,Vt,Xt)}function WX(e,t){e*=le,t*=le;var n=Z(t),i=n*Z(e),r=n*K(e),s=K(t),o=Jn(nn((o=Vt*s-Xt*r)*o+(o=Xt*i-Yt*s)*o+(o=Yt*r-Vt*i)*o),Yt*i+Vt*r+Xt*s);d0+=o,m0+=o*(Yt+(Yt=i)),y0+=o*(Vt+(Vt=r)),b0+=o*(Xt+(Xt=s)),_d(Yt,Vt,Xt)}function nC(){pi.point=iA}function HX(){pi.point=YX}function GX(){k8(S8,C8),pi.point=iA}function YX(e,t){S8=e,C8=t,e*=le,t*=le,pi.point=k8;var n=Z(t);Yt=n*Z(e),Vt=n*K(e),Xt=K(t),_d(Yt,Vt,Xt)}function k8(e,t){e*=le,t*=le;var n=Z(t),i=n*Z(e),r=n*K(e),s=K(t),o=Vt*s-Xt*r,a=Xt*i-Yt*s,u=Yt*r-Vt*i,l=Yb(o,a,u),c=wn(l),f=l&&-c/l;Zb.add(f*o),ev.add(f*a),tv.add(f*u),d0+=c,m0+=c*(Yt+(Yt=i)),y0+=c*(Vt+(Vt=r)),b0+=c*(Xt+(Xt=s)),_d(Yt,Vt,Xt)}function VX(e){Sc=d0=h0=g0=p0=m0=y0=b0=0,Zb=new Zt,ev=new Zt,tv=new Zt,Tr(e,pi);var t=+Zb,n=+ev,i=+tv,r=Yb(t,n,i);return r<r0&&(t=m0,n=y0,i=b0,d0<J&&(t=h0,n=g0,i=p0),r=Yb(t,n,i),r<r0)?[NaN,NaN]:[Jn(n,t)*Ye,wn(i/r)*Ye]}function nv(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function iv(e,t){return he(e)>de&&(e-=Math.round(e/tn)*tn),[e,t]}iv.invert=iv;function F8(e,t,n){return(e%=tn)?t||n?nv(rC(e),sC(t,n)):rC(e):t||n?sC(t,n):iv}function iC(e){return function(t,n){return t+=e,he(t)>de&&(t-=Math.round(t/tn)*tn),[t,n]}}function rC(e){var t=iC(e);return t.invert=iC(-e),t}function sC(e,t){var n=Z(e),i=K(e),r=Z(t),s=K(t);function o(a,u){var l=Z(u),c=Z(a)*l,f=K(a)*l,d=K(u),h=d*n+c*i;return[Jn(f*r-h*s,c*n-d*i),wn(h*r+f*s)]}return o.invert=function(a,u){var l=Z(u),c=Z(a)*l,f=K(a)*l,d=K(u),h=d*r-f*s;return[Jn(f*r+d*s,c*n+h*i),wn(h*n-c*i)]},o}function XX(e){e=F8(e[0]*le,e[1]*le,e.length>2?e[2]*le:0);function t(n){return n=e(n[0]*le,n[1]*le),n[0]*=Ye,n[1]*=Ye,n}return t.invert=function(n){return n=e.invert(n[0]*le,n[1]*le),n[0]*=Ye,n[1]*=Ye,n},t}function KX(e,t,n,i,r,s){if(n){var o=Z(t),a=K(t),u=i*n;r==null?(r=t+i*tn,s=t-u/2):(r=oC(o,r),s=oC(o,s),(i>0?r<s:r>s)&&(r+=i*tn));for(var l,c=r;i>0?c>s:c<s;c-=u)l=c0([o,-a*Z(c),-a*K(c)]),e.point(l[0],l[1])}}function oC(e,t){t=va(t),t[0]-=e,f0(t);var n=b8(-t[1]);return((-t[2]<0?-n:n)+tn-J)%tn}function O8(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:vt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function rg(e,t){return he(e[0]-t[0])<J&&he(e[1]-t[1])<J}function xh(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function D8(e,t,n,i,r){var s=[],o=[],a,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],b;if(rg(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),a=0;a<p;++a)r.point((m=g[a])[0],m[1]);r.lineEnd();return}y[0]+=2*J}s.push(b=new xh(m,g,null,!0)),o.push(b.o=new xh(m,null,b,!1)),s.push(b=new xh(y,g,null,!1)),o.push(b.o=new xh(y,null,b,!0))}}),!!s.length){for(o.sort(t),aC(s),aC(o),a=0,u=o.length;a<u;++a)o[a].e=n=!n;for(var l=s[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)r.point((f=c[a])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)r.point((f=c[a])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function aC(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function iy(e){return he(e[0])<=de?e[0]:Wn(e[0])*((he(e[0])+de)%tn-de)}function JX(e,t){var n=iy(t),i=t[1],r=K(i),s=[K(n),-Z(n),0],o=0,a=0,u=new Zt;r===1?i=He+J:r===-1&&(i=-He-J);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],g=iy(h),p=h[1]/2+s0,m=K(p),y=Z(p),b=0;b<d;++b,g=x,m=E,y=w,h=v){var v=f[b],x=iy(v),A=v[1]/2+s0,E=K(A),w=Z(A),$=x-g,S=$>=0?1:-1,_=S*$,C=_>de,M=m*E;if(u.add(Jn(M*S*K(_),y*w+M*Z(_))),o+=C?$+S*tn:$,C^g>=n^x>=n){var F=Uu(va(h),va(v));f0(F);var O=Uu(s,F);f0(O);var k=(C^$>=0?-1:1)*wn(O[2]);(i>k||i===k&&(F[0]||F[1]))&&(a+=C^$>=0?1:-1)}}return(o<-J||o<J&&u<-r0)^a&1}function M8(e,t,n,i){return function(r){var s=t(r),o=O8(),a=t(o),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=v,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=u3(c);var x=JX(l,i);c.length?(u||(r.polygonStart(),u=!0),D8(c,ZX,x,n,r)):x&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(x,A){e(x,A)&&r.point(x,A)}function g(x,A){s.point(x,A)}function p(){d.point=g,s.lineStart()}function m(){d.point=h,s.lineEnd()}function y(x,A){f.push([x,A]),a.point(x,A)}function b(){a.lineStart(),f=[]}function v(){y(f[0][0],f[0][1]),a.lineEnd();var x=a.clean(),A=o.result(),E,w=A.length,$,S,_;if(f.pop(),l.push(f),f=null,!!w){if(x&1){if(S=A[0],($=S.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),E=0;E<$;++E)r.point((_=S[E])[0],_[1]);r.lineEnd()}return}w>1&&x&2&&A.push(A.pop().concat(A.shift())),c.push(A.filter(QX))}}return d}}function QX(e){return e.length>1}function ZX(e,t){return((e=e.x)[0]<0?e[1]-He-J:He-e[1])-((t=t.x)[0]<0?t[1]-He-J:He-t[1])}const uC=M8(function(){return!0},eK,nK,[-de,-He]);function eK(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?de:-de,u=he(s-t);he(u-de)<J?(e.point(t,n=(n+o)/2>0?He:-He),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&u>=de&&(he(t-i)<J&&(t-=i*J),he(s-a)<J&&(s-=a*J),n=tK(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function tK(e,t,n,i){var r,s,o=K(e-n);return he(o)>J?Al((K(t)*(s=Z(i))*K(n)-K(i)*(r=Z(t))*K(e))/(r*s*o)):(t+i)/2}function nK(e,t,n,i){var r;if(e==null)r=n*He,i.point(-de,r),i.point(0,r),i.point(de,r),i.point(de,0),i.point(de,-r),i.point(0,-r),i.point(-de,-r),i.point(-de,0),i.point(-de,r);else if(he(e[0]-t[0])>J){var s=e[0]<t[0]?de:-de;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function iK(e){var t=Z(e),n=6*le,i=t>0,r=he(t)>J;function s(c,f,d,h){KX(h,e,n,d,c,f)}function o(c,f){return Z(c)*Z(f)>t}function a(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var b=[m,y],v,x=o(m,y),A=i?x?0:l(m,y):x?l(m+(m<0?de:-de),y):0;if(!f&&(g=h=x)&&c.lineStart(),x!==h&&(v=u(f,b),(!v||rg(f,v)||rg(b,v))&&(b[2]=1)),x!==h)p=0,x?(c.lineStart(),v=u(b,f),c.point(v[0],v[1])):(v=u(f,b),c.point(v[0],v[1],2),c.lineEnd()),f=v;else if(r&&f&&i^x){var E;!(A&d)&&(E=u(b,f,!0))&&(p=0,i?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}x&&(!f||!rg(f,b))&&c.point(b[0],b[1]),f=b,h=x,d=A},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=va(c),g=va(f),p=[1,0,0],m=Uu(h,g),y=bh(m,m),b=m[0],v=y-b*b;if(!v)return!d&&c;var x=t*y/v,A=-t*b/v,E=Uu(p,m),w=vh(p,x),$=vh(m,A);ny(w,$);var S=E,_=bh(w,S),C=bh(S,S),M=_*_-C*(bh(w,w)-1);if(!(M<0)){var F=nn(M),O=vh(S,(-_-F)/C);if(ny(O,w),O=c0(O),!d)return O;var k=c[0],j=f[0],B=c[1],I=f[1],q;j<k&&(q=k,k=j,j=q);var ue=j-k,Pe=he(ue-de)<J,tt=Pe||ue<J;if(!Pe&&I<B&&(q=B,B=I,I=q),tt?Pe?B+I>0^O[1]<(he(O[0]-k)<J?B:I):B<=O[1]&&O[1]<=I:ue>de^(k<=O[0]&&O[0]<=j)){var lt=vh(S,(-_+F)/C);return ny(lt,w),[O,c0(lt)]}}}function l(c,f){var d=i?e:de-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return M8(o,a,s,i?[0,-e]:[-de,e-de])}function rK(e,t,n,i,r,s){var o=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-a,g;if(g=n-o,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=r-o,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=i-a,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=s-a,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=o+c*d,e[1]=a+c*h),f<1&&(t[0]=o+f*d,t[1]=a+f*h),!0}}}}}var Cc=1e9,wh=-Cc;function T8(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function s(l,c,f,d){var h=0,g=0;if(l==null||(h=o(l,f))!==(g=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function o(l,c){return he(l[0]-e)<J?c>0?0:3:he(l[0]-n)<J?c>0?2:1:he(l[1]-t)<J?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=O8(),d,h,g,p,m,y,b,v,x,A,E,w={point:$,lineStart:M,lineEnd:F,polygonStart:_,polygonEnd:C};function $(k,j){r(k,j)&&c.point(k,j)}function S(){for(var k=0,j=0,B=h.length;j<B;++j)for(var I=h[j],q=1,ue=I.length,Pe=I[0],tt,lt,Ut=Pe[0],Ie=Pe[1];q<ue;++q)tt=Ut,lt=Ie,Pe=I[q],Ut=Pe[0],Ie=Pe[1],lt<=i?Ie>i&&(Ut-tt)*(i-lt)>(Ie-lt)*(e-tt)&&++k:Ie<=i&&(Ut-tt)*(i-lt)<(Ie-lt)*(e-tt)&&--k;return k}function _(){c=f,d=[],h=[],E=!0}function C(){var k=S(),j=E&&k,B=(d=u3(d)).length;(j||B)&&(l.polygonStart(),j&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),B&&D8(d,a,k,s,l),l.polygonEnd()),c=l,d=h=g=null}function M(){w.point=O,h&&h.push(g=[]),A=!0,x=!1,b=v=NaN}function F(){d&&(O(p,m),y&&x&&f.rejoin(),d.push(f.result())),w.point=$,x&&c.lineEnd()}function O(k,j){var B=r(k,j);if(h&&g.push([k,j]),A)p=k,m=j,y=B,A=!1,B&&(c.lineStart(),c.point(k,j));else if(B&&x)c.point(k,j);else{var I=[b=Math.max(wh,Math.min(Cc,b)),v=Math.max(wh,Math.min(Cc,v))],q=[k=Math.max(wh,Math.min(Cc,k)),j=Math.max(wh,Math.min(Cc,j))];rK(I,q,e,t,n,i)?(x||(c.lineStart(),c.point(I[0],I[1])),c.point(q[0],q[1]),B||c.lineEnd(),E=!1):B&&(c.lineStart(),c.point(k,j),E=!1)}b=k,v=j,x=B}return w}}function lC(e,t,n){var i=Tn(e,t-J,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function cC(e,t,n){var i=Tn(e,t-J,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function sK(){var e,t,n,i,r,s,o,a,u=10,l=u,c=90,f=360,d,h,g,p,m=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return Tn(yh(i/c)*c,n,c).map(g).concat(Tn(yh(a/f)*f,o,f).map(p)).concat(Tn(yh(t/u)*u,e,u).filter(function(v){return he(v%c)>J}).map(d)).concat(Tn(yh(s/l)*l,r,l).filter(function(v){return he(v%f)>J}).map(h))}return y.lines=function(){return b().map(function(v){return{type:"LineString",coordinates:v}})},y.outline=function(){return{type:"Polygon",coordinates:[g(i).concat(p(o).slice(1),g(n).reverse().slice(1),p(a).reverse().slice(1))]}},y.extent=function(v){return arguments.length?y.extentMajor(v).extentMinor(v):y.extentMinor()},y.extentMajor=function(v){return arguments.length?(i=+v[0][0],n=+v[1][0],a=+v[0][1],o=+v[1][1],i>n&&(v=i,i=n,n=v),a>o&&(v=a,a=o,o=v),y.precision(m)):[[i,a],[n,o]]},y.extentMinor=function(v){return arguments.length?(t=+v[0][0],e=+v[1][0],s=+v[0][1],r=+v[1][1],t>e&&(v=t,t=e,e=v),s>r&&(v=s,s=r,r=v),y.precision(m)):[[t,s],[e,r]]},y.step=function(v){return arguments.length?y.stepMajor(v).stepMinor(v):y.stepMinor()},y.stepMajor=function(v){return arguments.length?(c=+v[0],f=+v[1],y):[c,f]},y.stepMinor=function(v){return arguments.length?(u=+v[0],l=+v[1],y):[u,l]},y.precision=function(v){return arguments.length?(m=+v,d=lC(s,r,90),h=cC(t,e,m),g=lC(a,o,90),p=cC(i,n,m),y):m},y.extentMajor([[-180,-90+J],[180,90-J]]).extentMinor([[-180,-80-J],[180,80+J]])}const Ff=e=>e;var ry=new Zt,rv=new Zt,N8,j8,sv,ov,As={point:vt,lineStart:vt,lineEnd:vt,polygonStart:function(){As.lineStart=oK,As.lineEnd=uK},polygonEnd:function(){As.lineStart=As.lineEnd=As.point=vt,ry.add(he(rv)),rv=new Zt},result:function(){var e=ry/2;return ry=new Zt,e}};function oK(){As.point=aK}function aK(e,t){As.point=R8,N8=sv=e,j8=ov=t}function R8(e,t){rv.add(ov*e-sv*t),sv=e,ov=t}function uK(){R8(N8,j8)}const fC=As;var qu=1/0,v0=qu,Of=-qu,x0=Of,lK={point:cK,lineStart:vt,lineEnd:vt,polygonStart:vt,polygonEnd:vt,result:function(){var e=[[qu,v0],[Of,x0]];return Of=x0=-(v0=qu=1/0),e}};function cK(e,t){e<qu&&(qu=e),e>Of&&(Of=e),t<v0&&(v0=t),t>x0&&(x0=t)}const w0=lK;var av=0,uv=0,kc=0,A0=0,E0=0,hu=0,lv=0,cv=0,Fc=0,B8,P8,zi,Li,hi={point:xa,lineStart:dC,lineEnd:hC,polygonStart:function(){hi.lineStart=hK,hi.lineEnd=gK},polygonEnd:function(){hi.point=xa,hi.lineStart=dC,hi.lineEnd=hC},result:function(){var e=Fc?[lv/Fc,cv/Fc]:hu?[A0/hu,E0/hu]:kc?[av/kc,uv/kc]:[NaN,NaN];return av=uv=kc=A0=E0=hu=lv=cv=Fc=0,e}};function xa(e,t){av+=e,uv+=t,++kc}function dC(){hi.point=fK}function fK(e,t){hi.point=dK,xa(zi=e,Li=t)}function dK(e,t){var n=e-zi,i=t-Li,r=nn(n*n+i*i);A0+=r*(zi+e)/2,E0+=r*(Li+t)/2,hu+=r,xa(zi=e,Li=t)}function hC(){hi.point=xa}function hK(){hi.point=pK}function gK(){z8(B8,P8)}function pK(e,t){hi.point=z8,xa(B8=zi=e,P8=Li=t)}function z8(e,t){var n=e-zi,i=t-Li,r=nn(n*n+i*i);A0+=r*(zi+e)/2,E0+=r*(Li+t)/2,hu+=r,r=Li*e-zi*t,lv+=r*(zi+e),cv+=r*(Li+t),Fc+=r*3,xa(zi=e,Li=t)}const gC=hi;function L8(e){this._context=e}L8.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,tn);break}}},result:vt};var fv=new Zt,sy,I8,U8,Oc,Dc,$0={point:vt,lineStart:function(){$0.point=mK},lineEnd:function(){sy&&q8(I8,U8),$0.point=vt},polygonStart:function(){sy=!0},polygonEnd:function(){sy=null},result:function(){var e=+fv;return fv=new Zt,e}};function mK(e,t){$0.point=q8,I8=Oc=e,U8=Dc=t}function q8(e,t){Oc-=e,Dc-=t,fv.add(nn(Oc*Oc+Dc*Dc)),Oc=e,Dc=t}const pC=$0;let mC,_0,yC,bC;class vC{constructor(t){this._append=t==null?W8:yK(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==yC||this._append!==_0){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,yC=i,_0=this._append,bC=this._,this._=r}this._+=bC;break}}}result(){const t=this._;return this._="",t.length?t:null}}function W8(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function yK(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return W8;if(t!==mC){const n=10**t;mC=t,_0=function(r){let s=1;this._+=r[0];for(const o=r.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}return _0}function H8(e,t){let n=3,i=4.5,r,s;function o(a){return a&&(typeof i=="function"&&s.pointRadius(+i.apply(this,arguments)),Tr(a,r(s))),s.result()}return o.area=function(a){return Tr(a,r(fC)),fC.result()},o.measure=function(a){return Tr(a,r(pC)),pC.result()},o.bounds=function(a){return Tr(a,r(w0)),w0.result()},o.centroid=function(a){return Tr(a,r(gC)),gC.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,Ff):(e=a).stream,o):e},o.context=function(a){return arguments.length?(s=a==null?(t=null,new vC(n)):new L8(t=a),typeof i!="function"&&s.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(s.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(s=new vC(n)),o},o.projection(e).digits(n).context(t)}function hm(e){return function(t){var n=new dv;for(var i in e)n[i]=e[i];return n.stream=t,n}}function dv(){}dv.prototype={constructor:dv,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function rA(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Tr(n,e.stream(w0)),t(w0.result()),i!=null&&e.clipExtent(i),e}function gm(e,t,n){return rA(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,u])},n)}function sA(e,t,n){return gm(e,[[0,0],t],n)}function oA(e,t,n){return rA(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function aA(e,t,n){return rA(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var xC=16,bK=Z(30*le);function wC(e,t){return+t?xK(e,t):vK(e)}function vK(e){return hm({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function xK(e,t){function n(i,r,s,o,a,u,l,c,f,d,h,g,p,m){var y=l-i,b=c-r,v=y*y+b*b;if(v>4*t&&p--){var x=o+d,A=a+h,E=u+g,w=nn(x*x+A*A+E*E),$=wn(E/=w),S=he(he(E)-1)<J||he(s-f)<J?(s+f)/2:Jn(A,x),_=e(S,$),C=_[0],M=_[1],F=C-i,O=M-r,k=b*F-y*O;(k*k/v>t||he((y*F+b*O)/v-.5)>.3||o*d+a*h+u*g<bK)&&(n(i,r,s,o,a,u,C,M,S,x/=w,A/=w,E,p,m),m.point(C,M),n(C,M,S,x,A,E,l,c,f,d,h,g,p,m))}}return function(i){var r,s,o,a,u,l,c,f,d,h,g,p,m={point:y,lineStart:b,lineEnd:x,polygonStart:function(){i.polygonStart(),m.lineStart=A},polygonEnd:function(){i.polygonEnd(),m.lineStart=b}};function y($,S){$=e($,S),i.point($[0],$[1])}function b(){f=NaN,m.point=v,i.lineStart()}function v($,S){var _=va([$,S]),C=e($,S);n(f,d,c,h,g,p,f=C[0],d=C[1],c=$,h=_[0],g=_[1],p=_[2],xC,i),i.point(f,d)}function x(){m.point=y,i.lineEnd()}function A(){b(),m.point=E,m.lineEnd=w}function E($,S){v(r=$,S),s=f,o=d,a=h,u=g,l=p,m.point=v}function w(){n(f,d,c,h,g,p,s,o,r,a,u,l,xC,i),m.lineEnd=x,x()}return m}}var wK=hm({point:function(e,t){this.stream.point(e*le,t*le)}});function AK(e){return hm({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function EK(e,t,n,i,r){function s(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}function AC(e,t,n,i,r,s){if(!s)return EK(e,t,n,i,r);var o=Z(s),a=K(s),u=o*e,l=a*e,c=o/e,f=a/e,d=(a*n-o*t)/e,h=(a*t+o*n)/e;function g(p,m){return p*=i,m*=r,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[i*(c*p-f*m+d),r*(h-f*p-c*m)]},g}function dr(e){return G8(function(){return e})()}function G8(e){var t,n=150,i=480,r=250,s=0,o=0,a=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=uC,m=null,y,b,v,x=Ff,A=.5,E,w,$,S,_;function C(k){return $(k[0]*le,k[1]*le)}function M(k){return k=$.invert(k[0],k[1]),k&&[k[0]*Ye,k[1]*Ye]}C.stream=function(k){return S&&_===k?S:S=wK(AK(c)(p(E(x(_=k)))))},C.preclip=function(k){return arguments.length?(p=k,g=void 0,O()):p},C.postclip=function(k){return arguments.length?(x=k,m=y=b=v=null,O()):x},C.clipAngle=function(k){return arguments.length?(p=+k?iK(g=k*le):(g=null,uC),O()):g*Ye},C.clipExtent=function(k){return arguments.length?(x=k==null?(m=y=b=v=null,Ff):T8(m=+k[0][0],y=+k[0][1],b=+k[1][0],v=+k[1][1]),O()):m==null?null:[[m,y],[b,v]]},C.scale=function(k){return arguments.length?(n=+k,F()):n},C.translate=function(k){return arguments.length?(i=+k[0],r=+k[1],F()):[i,r]},C.center=function(k){return arguments.length?(s=k[0]%360*le,o=k[1]%360*le,F()):[s*Ye,o*Ye]},C.rotate=function(k){return arguments.length?(a=k[0]%360*le,u=k[1]%360*le,l=k.length>2?k[2]%360*le:0,F()):[a*Ye,u*Ye,l*Ye]},C.angle=function(k){return arguments.length?(f=k%360*le,F()):f*Ye},C.reflectX=function(k){return arguments.length?(d=k?-1:1,F()):d<0},C.reflectY=function(k){return arguments.length?(h=k?-1:1,F()):h<0},C.precision=function(k){return arguments.length?(E=wC(w,A=k*k),O()):nn(A)},C.fitExtent=function(k,j){return gm(C,k,j)},C.fitSize=function(k,j){return sA(C,k,j)},C.fitWidth=function(k,j){return oA(C,k,j)},C.fitHeight=function(k,j){return aA(C,k,j)};function F(){var k=AC(n,0,0,d,h,f).apply(null,t(s,o)),j=AC(n,i-k[0],r-k[1],d,h,f);return c=F8(a,u,l),w=nv(t,j),$=nv(c,w),E=wC(w,A),O()}function O(){return S=_=null,C}return function(){return t=e.apply(this,arguments),C.invert=t.invert&&M,F()}}function uA(e){var t=0,n=de/3,i=G8(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*le,n=s[1]*le):[t*Ye,n*Ye]},r}function $K(e){var t=Z(e);function n(i,r){return[i*t,K(r)/t]}return n.invert=function(i,r){return[i/t,wn(r*t)]},n}function _K(e,t){var n=K(e),i=(n+K(t))/2;if(he(i)<J)return $K(e);var r=1+n*(2*i-n),s=nn(r)/i;function o(a,u){var l=nn(r-2*i*K(u))/i;return[l*K(a*=i),s-l*Z(a)]}return o.invert=function(a,u){var l=s-u,c=Jn(a,he(l))*Wn(l);return l*i<0&&(c-=de*Wn(a)*Wn(l)),[c/i,wn((r-(a*a+l*l)*i*i)/(2*i))]},o}function S0(){return uA(_K).scale(155.424).center([0,33.6442])}function Y8(){return S0().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function SK(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function CK(){var e,t,n=Y8(),i,r=S0().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=S0().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],g=d[1];return u=null,i.point(h,g),u||(s.point(h,g),u)||(a.point(h,g),u)}c.invert=function(d){var h=n.scale(),g=n.translate(),p=(d[0]-g[0])/h,m=(d[1]-g[1])/h;return(m>=.12&&m<.234&&p>=-.425&&p<-.214?r:m>=.166&&m<.234&&p>=-.214&&p<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=SK([n.stream(t=d),r.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),g=+d[0],p=+d[1];return i=n.translate(d).clipExtent([[g-.455*h,p-.238*h],[g+.455*h,p+.238*h]]).stream(l),s=r.translate([g-.307*h,p+.201*h]).clipExtent([[g-.425*h+J,p+.12*h+J],[g-.214*h-J,p+.234*h-J]]).stream(l),a=o.translate([g-.205*h,p+.212*h]).clipExtent([[g-.214*h+J,p+.166*h+J],[g-.115*h-J,p+.234*h-J]]).stream(l),f()},c.fitExtent=function(d,h){return gm(c,d,h)},c.fitSize=function(d,h){return sA(c,d,h)},c.fitWidth=function(d,h){return oA(c,d,h)},c.fitHeight=function(d,h){return aA(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function V8(e){return function(t,n){var i=Z(t),r=Z(n),s=e(i*r);return s===1/0?[2,0]:[s*r*K(t),s*K(n)]}}function Sd(e){return function(t,n){var i=nn(t*t+n*n),r=e(i),s=K(r),o=Z(r);return[Jn(t*s,i*o),wn(i&&n*s/i)]}}var X8=V8(function(e){return nn(2/(1+e))});X8.invert=Sd(function(e){return 2*wn(e/2)});function kK(){return dr(X8).scale(124.75).clipAngle(180-.001)}var K8=V8(function(e){return(e=b8(e))&&e/K(e)});K8.invert=Sd(function(e){return e});function FK(){return dr(K8).scale(79.4188).clipAngle(180-.001)}function pm(e,t){return[e,o0(nA((He+t)/2))]}pm.invert=function(e,t){return[e,2*Al(y8(t))-He]};function OK(){return J8(pm).scale(961/tn)}function J8(e){var t=dr(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null,a,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=a=u=l=null:(o=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,a],[u,l]]};function c(){var f=de*i(),d=t(XX(t.rotate()).invert([0,0]));return s(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===pm?[[Math.max(d[0]-f,o),a],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function Ah(e){return nA((He+e)/2)}function DK(e,t){var n=Z(e),i=e===t?K(e):o0(n/Z(t))/o0(Ah(t)/Ah(e)),r=n*ty(Ah(e),i)/i;if(!i)return pm;function s(o,a){r>0?a<-He+J&&(a=-He+J):a>He-J&&(a=He-J);var u=r/ty(Ah(a),i);return[u*K(i*o),r-u*Z(i*o)]}return s.invert=function(o,a){var u=r-a,l=Wn(i)*nn(o*o+u*u),c=Jn(o,he(u))*Wn(u);return u*i<0&&(c-=de*Wn(o)*Wn(u)),[c/i,2*Al(ty(r/l,1/i))-He]},s}function MK(){return uA(DK).scale(109.5).parallels([30,30])}function C0(e,t){return[e,t]}C0.invert=C0;function TK(){return dr(C0).scale(152.63)}function NK(e,t){var n=Z(e),i=e===t?K(e):(n-Z(t))/(t-e),r=n/i+e;if(he(i)<J)return C0;function s(o,a){var u=r-a,l=i*o;return[u*K(l),r-u*Z(l)]}return s.invert=function(o,a){var u=r-a,l=Jn(o,he(u))*Wn(u);return u*i<0&&(l-=de*Wn(o)*Wn(u)),[l/i,r-Wn(i)*nn(o*o+u*u)]},s}function jK(){return uA(NK).scale(131.154).center([0,13.9389])}var Gc=1.340264,Yc=-.081106,Vc=893e-6,Xc=.003796,k0=nn(3)/2,RK=12;function Q8(e,t){var n=wn(k0*K(t)),i=n*n,r=i*i*i;return[e*Z(n)/(k0*(Gc+3*Yc*i+r*(7*Vc+9*Xc*i))),n*(Gc+Yc*i+r*(Vc+Xc*i))]}Q8.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,o,a,u;s<RK&&(a=n*(Gc+Yc*i+r*(Vc+Xc*i))-t,u=Gc+3*Yc*i+r*(7*Vc+9*Xc*i),n-=o=a/u,i=n*n,r=i*i*i,!(he(o)<r0));++s);return[k0*e*(Gc+3*Yc*i+r*(7*Vc+9*Xc*i))/Z(n),wn(K(n)/k0)]};function BK(){return dr(Q8).scale(177.158)}function Z8(e,t){var n=Z(t),i=Z(e)*n;return[n*K(e)/i,K(t)/i]}Z8.invert=Sd(Al);function PK(){return dr(Z8).scale(144.049).clipAngle(60)}function zK(){var e=1,t=0,n=0,i=1,r=1,s=0,o,a,u=null,l,c,f,d=1,h=1,g=hm({point:function(x,A){var E=v([x,A]);this.stream.point(E[0],E[1])}}),p=Ff,m,y;function b(){return d=e*i,h=e*r,m=y=null,v}function v(x){var A=x[0]*d,E=x[1]*h;if(s){var w=E*o-A*a;A=A*o+E*a,E=w}return[A+t,E+n]}return v.invert=function(x){var A=x[0]-t,E=x[1]-n;if(s){var w=E*o+A*a;A=A*o-E*a,E=w}return[A/d,E/h]},v.stream=function(x){return m&&y===x?m:m=g(p(y=x))},v.postclip=function(x){return arguments.length?(p=x,u=l=c=f=null,b()):p},v.clipExtent=function(x){return arguments.length?(p=x==null?(u=l=c=f=null,Ff):T8(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),b()):u==null?null:[[u,l],[c,f]]},v.scale=function(x){return arguments.length?(e=+x,b()):e},v.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],b()):[t,n]},v.angle=function(x){return arguments.length?(s=x%360*le,a=K(s),o=Z(s),b()):s*Ye},v.reflectX=function(x){return arguments.length?(i=x?-1:1,b()):i<0},v.reflectY=function(x){return arguments.length?(r=x?-1:1,b()):r<0},v.fitExtent=function(x,A){return gm(v,x,A)},v.fitSize=function(x,A){return sA(v,x,A)},v.fitWidth=function(x,A){return oA(v,x,A)},v.fitHeight=function(x,A){return aA(v,x,A)},v}function e4(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}e4.invert=function(e,t){var n=t,i=25,r;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(he(r)>J&&--i>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function LK(){return dr(e4).scale(175.295)}function t4(e,t){return[Z(t)*K(e),K(t)]}t4.invert=Sd(wn);function IK(){return dr(t4).scale(249.5).clipAngle(90+J)}function n4(e,t){var n=Z(t),i=1+Z(e)*n;return[n*K(e)/i,K(t)/i]}n4.invert=Sd(function(e){return 2*Al(e)});function UK(){return dr(n4).scale(250).clipAngle(142)}function i4(e,t){return[o0(nA((He+t)/2)),-e]}i4.invert=function(e,t){return[-t,2*Al(y8(e))-He]};function qK(){var e=J8(i4),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var WK=Math.abs,hv=Math.cos,F0=Math.sin,HK=1e-6,r4=Math.PI,gv=r4/2,EC=GK(2);function $C(e){return e>1?gv:e<-1?-gv:Math.asin(e)}function GK(e){return e>0?Math.sqrt(e):0}function YK(e,t){var n=e*F0(t),i=30,r;do t-=r=(t+F0(t)-n)/(1+hv(t));while(WK(r)>HK&&--i>0);return t/2}function VK(e,t,n){function i(r,s){return[e*r*hv(s=YK(n,s)),t*F0(s)]}return i.invert=function(r,s){return s=$C(s/t),[r/(e*hv(s)),$C((2*s+F0(2*s))/n)]},i}var XK=VK(EC/gv,EC,r4);function KK(){return dr(XK).scale(169.529)}const JK=H8(),pv=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function QK(e,t){return function n(){const i=t();return i.type=e,i.path=H8().projection(i),i.copy=i.copy||function(){const r=n();return pv.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},xM(i)}}function lA(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(O0[e]=QK(e,t),this):O0[e]||null}function s4(e){return e&&e.path||JK}const O0={albers:Y8,albersusa:CK,azimuthalequalarea:kK,azimuthalequidistant:FK,conicconformal:MK,conicequalarea:S0,conicequidistant:jK,equalEarth:BK,equirectangular:TK,gnomonic:PK,identity:zK,mercator:OK,mollweide:KK,naturalEarth1:LK,orthographic:IK,stereographic:UK,transversemercator:qK};for(const e in O0)lA(e,O0[e]);function ZK(){}const _r=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function o4(){var e=1,t=1,n=a;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return s(u,l,d=>{n(d,u,l),eJ(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,g=c.length,p;h<g;++h)if(tJ((p=c[h])[0],d)!==-1){p.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function s(u,l,c){var f=new Array,d=new Array,h,g,p,m,y,b;for(h=g=-1,m=u[0]>=l,_r[m<<1].forEach(v);++h<e-1;)p=m,m=u[h+1]>=l,_r[p|m<<1].forEach(v);for(_r[m<<0].forEach(v);++g<t-1;){for(h=-1,m=u[g*e+e]>=l,y=u[g*e]>=l,_r[m<<1|y<<2].forEach(v);++h<e-1;)p=m,m=u[g*e+e+h+1]>=l,b=y,y=u[g*e+h+1]>=l,_r[p|m<<1|y<<2|b<<3].forEach(v);_r[m|y<<3].forEach(v)}for(h=-1,y=u[g*e]>=l,_r[y<<2].forEach(v);++h<e-1;)b=y,y=u[g*e+h+1]>=l,_r[y<<2|b<<3].forEach(v);_r[y<<3].forEach(v);function v(x){var A=[x[0][0]+h,x[0][1]+g],E=[x[1][0]+h,x[1][1]+g],w=o(A),$=o(E),S,_;(S=d[w])?(_=f[$])?(delete d[S.end],delete f[_.start],S===_?(S.ring.push(E),c(S.ring)):f[S.start]=d[_.end]={start:S.start,end:_.end,ring:S.ring.concat(_.ring)}):(delete d[S.end],S.ring.push(E),d[S.end=$]=S):(S=f[$])?(_=d[w])?(delete f[S.start],delete d[_.end],S===_?(S.ring.push(E),c(S.ring)):f[_.start]=d[S.end]={start:_.start,end:S.end,ring:_.ring.concat(S.ring)}):(delete f[S.start],S.ring.unshift(A),f[S.start=w]=S):f[w]=d[$]={start:w,end:$,ring:[A,E]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],g=d|0,p=h|0,m,y=l[p*e+g];d>0&&d<e&&g===d&&(m=l[p*e+g-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&p===h&&(m=l[(p-1)*e+g],f[1]=h+(c-m)/(y-m)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||zs("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?a:ZK,i):n===a},i}function eJ(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function tJ(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=nJ(e,t[n]))return r;return 0}function nJ(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var u=e[s],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(iJ(u,f,t))return 0;c>i!=h>i&&n<(d-l)*(i-c)/(h-c)+l&&(r=-r)}return r}function iJ(e,t,n){var i;return rJ(e,t,n)&&sJ(e[i=+(e[0]===t[0])],n[i],t[i])}function rJ(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function sJ(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function a4(e,t,n){return function(i){var r=TX(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,u=t?qs(s,o,e):a/(e+1);return Tn(s+u,o,u)}}function cA(e){D.call(this,null,e)}cA.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};fr(cA,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||Cf,s=o4().smooth(e.smooth!==!1),o=e.thresholds||oJ(i,r,e),a=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=s.size([c.width,c.height])(c.values,eA(o)?o:o(c.values));aJ(f,c,l,e),f.forEach(d=>{u.push(Dp(l,we(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function oJ(e,t,n){const i=a4(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>ra(t(r).values)))}function aJ(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(Kr(r)&&(r=r(n,i)),Kr(s)&&(s=s(n,i)),(r===1||r==null)&&!s)return;const o=(VS(r)?r:r[0])||1,a=(VS(r)?r:r[1])||1,u=s&&s[0]||0,l=s&&s[1]||0;e.forEach(u4(t,o,a,u,l))}function u4(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+i,f[1]=(f[1]-o)*n+r}return function(f){return f.coordinates.forEach(u),f}}function _C(e,t,n){const i=e>=0?e:Vx(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function oy(e){return Kr(e)?e:kf(+e)}function l4(){var e=u=>u[0],t=u=>u[1],n=MX,i=[-1,-1],r=960,s=500,o=2;function a(u,l){const c=_C(i[0],u,e)>>o,f=_C(i[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,g=2*d+(r>>o),p=2*h+(s>>o),m=new Float32Array(g*p),y=new Float32Array(g*p);let b=m;u.forEach(x=>{const A=d+(+e(x)>>o),E=h+(+t(x)>>o);A>=0&&A<g&&E>=0&&E<p&&(m[A+E*g]+=+n(x))}),c>0&&f>0?(nu(g,p,m,y,c),iu(g,p,y,m,f),nu(g,p,m,y,c),iu(g,p,y,m,f),nu(g,p,m,y,c),iu(g,p,y,m,f)):c>0?(nu(g,p,m,y,c),nu(g,p,y,m,c),nu(g,p,m,y,c),b=y):f>0&&(iu(g,p,m,y,f),iu(g,p,y,m,f),iu(g,p,m,y,f),b=y);const v=l?Math.pow(2,-2*o):1/l3(b);for(let x=0,A=g*p;x<A;++x)b[x]*=v;return{values:b,scale:1<<o,width:g,height:p,x1:d,y1:h,x2:d+(r>>o),y2:h+(s>>o)}}return a.x=function(u){return arguments.length?(e=oy(u),a):e},a.y=function(u){return arguments.length?(t=oy(u),a):t},a.weight=function(u){return arguments.length?(n=oy(u),a):n},a.size=function(u){if(!arguments.length)return[r,s];var l=+u[0],c=+u[1];return l>=0&&c>=0||zs("invalid size"),r=l,s=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||zs("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),a):1<<o},a.bandwidth=function(u){return arguments.length?(u=tA(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&zs("invalid bandwidth"),i=u,a):i},a}function nu(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<t;++o)for(let a=0,u=0;a<e+r;++a)a<e&&(u+=n[a+o*e]),a>=r&&(a>=s&&(u-=n[a-s+o*e]),i[a-r+o*e]=u/Math.min(a+1,e-1+s-a,s))}function iu(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<e;++o)for(let a=0,u=0;a<t+r;++a)a<t&&(u+=n[o+a*e]),a>=r&&(a>=s&&(u-=n[o+(a-s)*e]),i[o+(a-r)*e]=u/Math.min(a+1,t-1+s-a,s))}function fA(e){D.call(this,null,e)}fA.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const uJ=["x","y","weight","size","cellSize","bandwidth"];function c4(e,t){return uJ.forEach(n=>t[n]!=null?e[n](t[n]):0),e}fr(fA,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=lJ(i,e.groupby),s=(e.groupby||[]).map(SX),o=c4(l4(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<s.length;++d)c[s[d]]=f[d];return c}return u=r.map(c=>we(l({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function lJ(e,t){var n=[],i=c=>c(a),r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function dA(e){D.call(this,null,e)}dA.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};fr(dA,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=o4().smooth(e.smooth!==!1),r=e.values,s=e.thresholds||a4(e.count||10,e.nice,!!r),o=e.size,a,u;return r||(r=t.materialize(t.SOURCE).source,a=c4(l4(),e)(r,!0),u=u4(a,a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=eA(s)?s:s(r),r=i.size(o)(r,s),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(we),n}});const mv="Feature",hA="FeatureCollection",cJ="MultiPoint";function gA(e){D.call(this,null,e)}gA.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};fr(gA,D,{transform(e,t){var n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&Cf,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(ig(a))||s&&t.modified(ig(s))||o&&t.modified(ig(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(u,c=>n.push(a(c))),s&&o&&(t.visit(u,c=>{var f=s(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:mv,geometry:{type:cJ,coordinates:i}})),this.value={type:hA,features:n}}});function pA(e){D.call(this,null,e)}pA.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};fr(pA,D,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||Cf,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=s4(e.projection),n.materialize().reflow()):o=r===Cf||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=fJ(i,e.pointRadius);return n.visit(o,u=>u[s]=i(r(u))),i.pointRadius(a),n.modifies(s)}});function fJ(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function mA(e){D.call(this,null,e)}mA.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};fr(mA,D,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[o]=f[0],c[a]=f[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(s)}});function yA(e){D.call(this,null,e)}yA.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};fr(yA,D,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=dJ(s4(e.projection),e.field||p8("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}});function dJ(e,t,n){const i=n==null?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}function bA(e){D.call(this,[],e),this.generator=sK()}bA.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};fr(bA,D,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const s in e)Kr(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(rD(n[0],r)):t.add.push(we(r)),n[0]=r,t}});function vA(e){D.call(this,null,e)}vA.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};fr(vA,D,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||Cf,s=gJ(e.opacity,e),o=hJ(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?ra(n.map(l=>ra(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=m8({},l,u);i||(f.$max=ra(c.values||[])),l[a]=pJ(c,f,o.dep?o:kf(o(f)),s.dep?s:kf(s(f)))}),t.reflow(!0).modifies(a)}});function hJ(e,t){let n;return Kr(e)?(n=i=>Ys(e(i,t)),n.dep=f4(e)):n=kf(Ys(e||"#888")),n}function gJ(e,t){let n;return Kr(e)?(n=i=>e(i,t),n.dep=f4(e)):e?n=kf(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function f4(e){if(!Kr(e))return!1;const t=NX(ig(e));return t.$x||t.$y||t.$value||t.$max}function pJ(e,t,n,i){const r=e.width,s=e.height,o=e.x1||0,a=e.y1||0,u=e.x2||r,l=e.y2||s,c=e.values,f=c?m=>c[m]:DX,d=Rs(u-o,l-a),h=d.getContext("2d"),g=h.getImageData(0,0,u-o,l-a),p=g.data;for(let m=a,y=0;m<l;++m){t.$y=m-a;for(let b=o,v=m*r;b<u;++b,y+=4){t.$x=b-o,t.$value=f(b+v);const x=n(t);p[y+0]=x.r,p[y+1]=x.g,p[y+2]=x.b,p[y+3]=~~(255*i(t))}}return h.putImageData(g,0,0),d}function d4(e){D.call(this,null,e),this.modified(!0)}fr(d4,D,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=yJ(e.type),pv.forEach(i=>{e[i]!=null&&SC(n,i,e[i])})):pv.forEach(i=>{e.modified(i)&&SC(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&mJ(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function mJ(e,t){const n=bJ(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function yJ(e){const t=lA((e||"mercator").toLowerCase());return t||zs("Unrecognized projection type: "+e),t()}function SC(e,t,n){Kr(e[t])&&e[t](n)}function bJ(e){return e=tA(e),e.length===1?e[0]:{type:hA,features:e.reduce((t,n)=>t.concat(vJ(n)),[])}}function vJ(e){return e.type===hA?e.features:tA(e).filter(t=>t!=null).map(t=>t.type===mv?t:{type:mv,geometry:t})}const xJ=Object.freeze(Object.defineProperty({__proto__:null,contour:dA,geojson:gA,geopath:pA,geopoint:mA,geoshape:yA,graticule:bA,heatmap:vA,isocontour:cA,kde2d:fA,projection:d4},Symbol.toStringTag,{value:"Module"}));function El(e,t,n){return e.fields=t||[],e.fname=n,e}function wJ(e){return e==null?null:e.fields}function AJ(e){return e.length===1?EJ(e[0]):$J(e)}const EJ=e=>function(t){return t[e]},$J=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function sg(e){throw Error(e)}function _J(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||sg("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&sg("Access path missing closing bracket: "+e),i&&sg("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function SJ(e,t,n){const i=_J(e);return e=i.length===1?i[0]:e,El((n&&n.get||AJ)(i),[e],t||e)}SJ("id");El(e=>e,[],"identity");El(()=>0,[],"zero");El(()=>1,[],"one");El(()=>!0,[],"true");El(()=>!1,[],"false");var CJ=Array.isArray;function kJ(e){return e!=null?CJ(e)?e:[e]:[]}function xA(e){return typeof e=="function"}function FJ(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const OJ=Object.prototype.hasOwnProperty;function DJ(e,t){return OJ.call(e,t)}function MJ(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),FJ(i,n)}function TJ(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,o=n.length,a,u=0,l=0;for(s=0;s<o;++s)a=n[s],u+=a.x,l+=a.y;for(u=(u/o-e)*i,l=(l/o-t)*i,s=0;s<o;++s)a=n[s],a.x-=u,a.y-=l}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function NJ(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return h4(this.cover(t,n),t,n,e)}function h4(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,o={data:i},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,g,p,m,y,b;if(!s)return e._root=o,e;for(;s.length;)if((p=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,r=s,!(s=s[y=m<<1|p]))return r[y]=o,e;if(h=+e._x.call(null,s.data),g=+e._y.call(null,s.data),t===h&&n===g)return o.next=s,r?r[y]=o:e._root=o,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(p=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|p)===(b=(g>=d)<<1|h>=f));return r[b]=s,r[y]=o,e}function jJ(e){var t,n,i=e.length,r,s,o=new Array(i),a=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<u&&(u=r),r>c&&(c=r),s<l&&(l=s),s>f&&(f=s));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)h4(this,o[n],a[n],e[n]);return this}function RJ(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var o=r-n||1,a=this._root,u,l;n>e||e>=r||i>t||t>=s;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=a,a=u,o*=2,l){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function BJ(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function PJ(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Jt(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function zJ(e,t,n){var i,r=this._x0,s=this._y0,o,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,g,p;for(h&&d.push(new Jt(h,r,s,c,f)),n==null?n=1/0:(r=e-n,s=t-n,c=e+n,f=t+n,n*=n);g=d.pop();)if(!(!(h=g.node)||(o=g.x0)>c||(a=g.y0)>f||(u=g.x1)<r||(l=g.y1)<s))if(h.length){var m=(o+u)/2,y=(a+l)/2;d.push(new Jt(h[3],m,y,u,l),new Jt(h[2],o,y,m,l),new Jt(h[1],m,a,u,y),new Jt(h[0],o,a,m,y)),(p=(t>=y)<<1|e>=m)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-p],d[d.length-1-p]=g)}else{var b=e-+this._x.call(null,h.data),v=t-+this._y.call(null,h.data),x=b*b+v*v;if(x<n){var A=Math.sqrt(n=x);r=e-A,s=t-A,c=e+A,f=t+A,i=h.data}}return i}function LJ(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,s,o=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,g,p,m,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(d=(o+u)/2))?o=d:u=d,(p=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[m=p<<1|g]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,y=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=s,this)}function IJ(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function UJ(){return this._root}function qJ(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function WJ(e){var t=[],n,i=this._root,r,s,o,a,u;for(i&&t.push(new Jt(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,u=n.y1)&&i.length){var l=(s+a)/2,c=(o+u)/2;(r=i[3])&&t.push(new Jt(r,l,c,a,u)),(r=i[2])&&t.push(new Jt(r,s,c,l,u)),(r=i[1])&&t.push(new Jt(r,l,o,a,c)),(r=i[0])&&t.push(new Jt(r,s,o,l,c))}return this}function HJ(e){var t=[],n=[],i;for(this._root&&t.push(new Jt(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,u=i.x1,l=i.y1,c=(o+u)/2,f=(a+l)/2;(s=r[0])&&t.push(new Jt(s,o,a,c,f)),(s=r[1])&&t.push(new Jt(s,c,a,u,f)),(s=r[2])&&t.push(new Jt(s,o,f,c,l)),(s=r[3])&&t.push(new Jt(s,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function GJ(e){return e[0]}function YJ(e){return arguments.length?(this._x=e,this):this._x}function VJ(e){return e[1]}function XJ(e){return arguments.length?(this._y=e,this):this._y}function wA(e,t,n){var i=new AA(t??GJ,n??VJ,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function AA(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function CC(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var sn=wA.prototype=AA.prototype;sn.copy=function(){var e=new AA(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=CC(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=CC(i));return e};sn.add=NJ;sn.addAll=jJ;sn.cover=RJ;sn.data=BJ;sn.extent=PJ;sn.find=zJ;sn.remove=LJ;sn.removeAll=IJ;sn.root=UJ;sn.size=qJ;sn.visit=WJ;sn.visitAfter=HJ;sn.x=YJ;sn.y=XJ;function Qt(e){return function(){return e}}function Fs(e){return(e()-.5)*1e-6}function KJ(e){return e.x+e.vx}function JJ(e){return e.y+e.vy}function QJ(e){var t,n,i,r=1,s=1;typeof e!="function"&&(e=Qt(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,g,p,m,y=0;y<s;++y)for(f=wA(t,KJ,JJ).visitAfter(a),l=0;l<c;++l)d=t[l],p=n[d.index],m=p*p,h=d.x+d.vx,g=d.y+d.vy,f.visit(b);function b(v,x,A,E,w){var $=v.data,S=v.r,_=p+S;if($){if($.index>d.index){var C=h-$.x-$.vx,M=g-$.y-$.vy,F=C*C+M*M;F<_*_&&(C===0&&(C=Fs(i),F+=C*C),M===0&&(M=Fs(i),F+=M*M),F=(_-(F=Math.sqrt(F)))/F*r,d.vx+=(C*=F)*(_=(S*=S)/(m+S)),d.vy+=(M*=F)*_,$.vx-=C*(_=1-_),$.vy-=M*_)}return}return x>h+_||E<h-_||A>g+_||w<g-_}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,i=c,u()},o.iterations=function(l){return arguments.length?(s=+l,o):s},o.strength=function(l){return arguments.length?(r=+l,o):r},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:Qt(+l),u(),o):e},o}function ZJ(e){return e.index}function kC(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function eQ(e){var t=ZJ,n=f,i,r=Qt(30),s,o,a,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function d(m){for(var y=0,b=e.length;y<c;++y)for(var v=0,x,A,E,w,$,S,_;v<b;++v)x=e[v],A=x.source,E=x.target,w=E.x+E.vx-A.x-A.vx||Fs(l),$=E.y+E.vy-A.y-A.vy||Fs(l),S=Math.sqrt(w*w+$*$),S=(S-s[v])/S*m*i[v],w*=S,$*=S,E.vx-=w*(_=u[v]),E.vy-=$*_,A.vx+=w*(_=1-_),A.vy+=$*_}function h(){if(o){var m,y=o.length,b=e.length,v=new Map(o.map((A,E)=>[t(A,E,o),A])),x;for(m=0,a=new Array(y);m<b;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=kC(v,x.source)),typeof x.target!="object"&&(x.target=kC(v,x.target)),a[x.source.index]=(a[x.source.index]||0)+1,a[x.target.index]=(a[x.target.index]||0)+1;for(m=0,u=new Array(b);m<b;++m)x=e[m],u[m]=a[x.source.index]/(a[x.source.index]+a[x.target.index]);i=new Array(b),g(),s=new Array(b),p()}}function g(){if(o)for(var m=0,y=e.length;m<y;++m)i[m]=+n(e[m],m,e)}function p(){if(o)for(var m=0,y=e.length;m<y;++m)s[m]=+r(e[m],m,e)}return d.initialize=function(m,y){o=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Qt(+m),g(),d):n},d.distance=function(m){return arguments.length?(r=typeof m=="function"?m:Qt(+m),p(),d):r},d}var tQ={value:()=>{}};function g4(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new og(n)}function og(e){this._=e}function nQ(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}og.prototype=g4.prototype={constructor:og,on:function(e,t){var n=this._,i=nQ(e+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(e=i[s]).type)&&(r=iQ(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=FC(n[r],e.name,t);else if(t==null)for(r in n)n[r]=FC(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new og(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function iQ(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function FC(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=tQ,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var Wu=0,Mc=0,oc=0,p4=1e3,D0,Tc,M0=0,wa=0,mm=0,Df=typeof performance=="object"&&performance.now?performance:Date,m4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function EA(){return wa||(m4(rQ),wa=Df.now()+mm)}function rQ(){wa=0}function T0(){this._call=this._time=this._next=null}T0.prototype=y4.prototype={constructor:T0,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?EA():+n)+(t==null?0:+t),!this._next&&Tc!==this&&(Tc?Tc._next=this:D0=this,Tc=this),this._call=e,this._time=n,yv()},stop:function(){this._call&&(this._call=null,this._time=1/0,yv())}};function y4(e,t,n){var i=new T0;return i.restart(e,t,n),i}function sQ(){EA(),++Wu;for(var e=D0,t;e;)(t=wa-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Wu}function OC(){wa=(M0=Df.now())+mm,Wu=Mc=0;try{sQ()}finally{Wu=0,aQ(),wa=0}}function oQ(){var e=Df.now(),t=e-M0;t>p4&&(mm-=t,M0=e)}function aQ(){for(var e,t=D0,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:D0=n);Tc=e,yv(i)}function yv(e){if(!Wu){Mc&&(Mc=clearTimeout(Mc));var t=e-wa;t>24?(e<1/0&&(Mc=setTimeout(OC,e-Df.now()-mm)),oc&&(oc=clearInterval(oc))):(oc||(M0=Df.now(),oc=setInterval(oQ,p4)),Wu=1,m4(OC))}}function uQ(e,t,n){var i=new T0,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=a==null?EA():+a,i._restart(function u(l){l+=r,i._restart(u,r+=o,a),s(l)},o,a)},i.restart(e,t,n),i)}const lQ=1664525,cQ=1013904223,DC=4294967296;function fQ(){let e=1;return()=>(e=(lQ*e+cQ)%DC)/DC}function dQ(e){return e.x}function hQ(e){return e.y}var gQ=10,pQ=Math.PI*(3-Math.sqrt(5));function mQ(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,u=y4(f),l=g4("tick","end"),c=fQ();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(p){var m,y=e.length,b;p===void 0&&(p=1);for(var v=0;v<p;++v)for(n+=(s-n)*r,a.forEach(function(x){x(n)}),m=0;m<y;++m)b=e[m],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function h(){for(var p=0,m=e.length,y;p<m;++p){if(y=e[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var b=gQ*Math.sqrt(.5+p),v=p*pQ;y.x=b*Math.cos(v),y.y=b*Math.sin(v)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(e,c),p}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),a.forEach(g),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(i=+p,t):i},alphaDecay:function(p){return arguments.length?(r=+p,t):+r},alphaTarget:function(p){return arguments.length?(s=+p,t):s},velocityDecay:function(p){return arguments.length?(o=1-p,t):1-o},randomSource:function(p){return arguments.length?(c=p,a.forEach(g),t):c},force:function(p,m){return arguments.length>1?(m==null?a.delete(p):a.set(p,g(m)),t):a.get(p)},find:function(p,m,y){var b=0,v=e.length,x,A,E,w,$;for(y==null?y=1/0:y*=y,b=0;b<v;++b)w=e[b],x=p-w.x,A=m-w.y,E=x*x+A*A,E<y&&($=w,y=E);return $},on:function(p,m){return arguments.length>1?(l.on(p,m),t):l.on(p)}}}function yQ(){var e,t,n,i,r=Qt(-30),s,o=1,a=1/0,u=.81;function l(h){var g,p=e.length,m=wA(e,dQ,hQ).visitAfter(f);for(i=h,g=0;g<p;++g)t=e[g],m.visit(d)}function c(){if(e){var h,g=e.length,p;for(s=new Array(g),h=0;h<g;++h)p=e[h],s[p.index]=+r(p,h,e)}}function f(h){var g=0,p,m,y=0,b,v,x;if(h.length){for(b=v=x=0;x<4;++x)(p=h[x])&&(m=Math.abs(p.value))&&(g+=p.value,y+=m,b+=m*p.x,v+=m*p.y);h.x=b/y,h.y=v/y}else{p=h,p.x=p.data.x,p.y=p.data.y;do g+=s[p.data.index];while(p=p.next)}h.value=g}function d(h,g,p,m){if(!h.value)return!0;var y=h.x-t.x,b=h.y-t.y,v=m-g,x=y*y+b*b;if(v*v/u<x)return x<a&&(y===0&&(y=Fs(n),x+=y*y),b===0&&(b=Fs(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)),t.vx+=y*h.value*i/x,t.vy+=b*h.value*i/x),!0;if(h.length||x>=a)return;(h.data!==t||h.next)&&(y===0&&(y=Fs(n),x+=y*y),b===0&&(b=Fs(n),x+=b*b),x<o&&(x=Math.sqrt(o*x)));do h.data!==t&&(v=s[h.data.index]*i/x,t.vx+=y*v,t.vy+=b*v);while(h=h.next)}return l.initialize=function(h,g){e=h,n=g,c()},l.strength=function(h){return arguments.length?(r=typeof h=="function"?h:Qt(+h),c(),l):r},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function bQ(e){var t=Qt(.1),n,i,r;typeof e!="function"&&(e=Qt(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*a}function o(){if(n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Qt(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:Qt(+a),o(),s):e},s}function vQ(e){var t=Qt(.1),n,i,r;typeof e!="function"&&(e=Qt(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*a}function o(){if(n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Qt(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:Qt(+a),o(),s):e},s}const MC={center:TJ,collide:QJ,nbody:yQ,link:eQ,x:bQ,y:vQ},Nc="forces",bv=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],xQ=["static","iterations"],b4=["x","y","vx","vy"];function $A(e){D.call(this,null,e)}$A.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:b4}]};MJ($A,D,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(bv),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&v4(n,e,0,t)):(this.value=n=AQ(t.source,e),n.on("tick",wQ(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(xQ)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==Nc||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,s=i.length,o;r<s;++r)if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(b4)}});function wQ(e,t){return()=>e.touch(t).run()}function AQ(e,t){const n=mQ(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),v4(n,t,!0).on("end",()=>s=!0)}function v4(e,t,n,i){var r=kJ(t.forces),s,o,a,u;for(s=0,o=bv.length;s<o;++s)a=bv[s],a!==Nc&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)u=Nc+s,a=n||t.modified(Nc,s)?$Q(r[s]):i&&EQ(r[s],i)?e.force(u):null,a&&e.force(u,a);for(o=e.numForces||0;s<o;++s)e.force(Nc+s,null);return e.numForces=r.length,e}function EQ(e,t){var n,i;for(n in e)if(xA(i=e[n])&&t.modified(wJ(i)))return 1;return 0}function $Q(e){var t,n;DJ(MC,e.force)||sg("Unrecognized force: "+e.force),t=MC[e.force]();for(n in e)xA(t[n])&&_Q(t[n],e[n],e);return t}function _Q(e,t,n){e(xA(t)?i=>t(i,n):t)}const SQ=Object.freeze(Object.defineProperty({__proto__:null,force:$A},Symbol.toStringTag,{value:"Module"}));function $l(e,t,n){return e.fields=t||[],e.fname=n,e}function CQ(e){return e.length===1?kQ(e[0]):FQ(e)}const kQ=e=>function(t){return t[e]},FQ=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Gi(e){throw Error(e)}function OQ(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Gi("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Gi("Access path missing closing bracket: "+e),i&&Gi("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function DQ(e,t,n){const i=OQ(e);return e=i.length===1?i[0]:e,$l((n&&n.get||CQ)(i),[e],t||e)}DQ("id");$l(e=>e,[],"identity");$l(()=>0,[],"zero");const MQ=$l(()=>1,[],"one"),TQ=$l(()=>!0,[],"true");$l(()=>!1,[],"false");var NQ=Array.isArray;function jQ(e){return e!=null?NQ(e)?e:[e]:[]}function RQ(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const BQ=Object.prototype.hasOwnProperty;function x4(e,t){return BQ.call(e,t)}function go(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),RQ(i,n)}function PQ(e,t){return e.parent===t.parent?1:2}function zQ(e){return e.reduce(LQ,0)/e.length}function LQ(e,t){return e+t.x}function IQ(e){return 1+e.reduce(UQ,0)}function UQ(e,t){return Math.max(e,t.y)}function qQ(e){for(var t;t=e.children;)e=t[0];return e}function WQ(e){for(var t;t=e.children;)e=t[t.length-1];return e}function HQ(){var e=PQ,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(d){var h=d.children;h?(d.x=zQ(h),d.y=IQ(h)):(d.x=o?a+=e(d,o):0,d.y=0,o=d)});var u=qQ(s),l=WQ(s),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return s.eachAfter(i?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function GQ(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function YQ(){return this.eachAfter(GQ)}function VQ(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function XQ(e,t){for(var n=this,i=[n],r,s,o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function KQ(e,t){for(var n=this,i=[n],r=[],s,o,a,u=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function JQ(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function QQ(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function ZQ(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function eZ(e){for(var t=this,n=tZ(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function tZ(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function nZ(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function iZ(){return Array.from(this)}function rZ(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function sZ(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*oZ(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function _A(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=lZ)):t===void 0&&(t=uZ);for(var n=new Hu(e),i,r=[n],s,o,a,u;i=r.pop();)if((o=t(i.data))&&(u=(o=Array.from(o)).length))for(i.children=o,a=u-1;a>=0;--a)r.push(s=o[a]=new Hu(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(w4)}function aZ(){return _A(this).eachBefore(cZ)}function uZ(e){return e.children}function lZ(e){return Array.isArray(e)?e[1]:null}function cZ(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function w4(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Hu(e){this.data=e,this.depth=this.height=0,this.parent=null}Hu.prototype=_A.prototype={constructor:Hu,count:YQ,each:VQ,eachAfter:KQ,eachBefore:XQ,find:JQ,sum:QQ,sort:ZQ,path:eZ,ancestors:nZ,descendants:iZ,leaves:rZ,links:sZ,copy:aZ,[Symbol.iterator]:oZ};function ag(e){return e==null?null:A4(e)}function A4(e){if(typeof e!="function")throw new Error;return e}function Vo(){return 0}function uu(e){return function(){return e}}const fZ=1664525,dZ=1013904223,TC=4294967296;function hZ(){let e=1;return()=>(e=(fZ*e+dZ)%TC)/TC}function gZ(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pZ(e,t){let n=e.length,i,r;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}function mZ(e,t){for(var n=0,i=(e=pZ(Array.from(e),t)).length,r=[],s,o;n<i;)s=e[n],o&&E4(o,s)?++n:(o=bZ(r=yZ(r,s)),n=0);return o}function yZ(e,t){var n,i;if(ay(t,e))return[t];for(n=0;n<e.length;++n)if(Eh(t,e[n])&&ay(jc(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(Eh(jc(e[n],e[i]),t)&&Eh(jc(e[n],t),e[i])&&Eh(jc(e[i],t),e[n])&&ay($4(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function Eh(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function E4(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function ay(e,t){for(var n=0;n<t.length;++n)if(!E4(e,t[n]))return!1;return!0}function bZ(e){switch(e.length){case 1:return vZ(e[0]);case 2:return jc(e[0],e[1]);case 3:return $4(e[0],e[1],e[2])}}function vZ(e){return{x:e.x,y:e.y,r:e.r}}function jc(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,u=s-n,l=o-i,c=a-r,f=Math.sqrt(u*u+l*l);return{x:(n+s+u/f*c)/2,y:(i+o+l/f*c)/2,r:(f+r+a)/2}}function $4(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-o,h=i-l,g=r-a,p=r-c,m=u-s,y=f-s,b=i*i+r*r-s*s,v=b-o*o-a*a+u*u,x=b-l*l-c*c+f*f,A=h*g-d*p,E=(g*x-p*v)/(A*2)-i,w=(p*m-g*y)/A,$=(h*v-d*x)/(A*2)-r,S=(d*y-h*m)/A,_=w*w+S*S-1,C=2*(s+E*w+$*S),M=E*E+$*$-s*s,F=-(Math.abs(_)>1e-6?(C+Math.sqrt(C*C-4*_*M))/(2*_):M/C);return{x:i+E+w*F,y:r+$+S*F,r:F}}function NC(e,t,n){var i=e.x-t.x,r,s,o=e.y-t.y,a,u,l=i*i+o*o;l?(s=t.r+n.r,s*=s,u=e.r+n.r,u*=u,s>u?(r=(l+u-s)/(2*l),a=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(l+s-u)/(2*l),a=Math.sqrt(Math.max(0,s/l-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function jC(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function RC(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function $h(e){this._=e,this.next=null,this.previous=null}function xZ(e,t){if(!(s=(e=gZ(e)).length))return 0;var n,i,r,s,o,a,u,l,c,f,d;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(i=e[1],n.x=-i.r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;NC(i,n,r=e[2]),n=new $h(n),i=new $h(i),r=new $h(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(u=3;u<s;++u){NC(n._,i._,r=e[u]),r=new $h(r),l=i.next,c=n.previous,f=i._.r,d=n._.r;do if(f<=d){if(jC(l._,r._)){i=l,n.next=i,i.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(jC(c._,r._)){n=c,n.next=i,i.previous=n,--u;continue e}d+=c._.r,c=c.previous}while(l!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,o=RC(n);(r=r.next)!==i;)(a=RC(r))<o&&(n=r,o=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=mZ(n,t),u=0;u<s;++u)n=e[u],n.x-=r.x,n.y-=r.y;return r.r}function wZ(e){return Math.sqrt(e.value)}function AZ(){var e=null,t=1,n=1,i=Vo;function r(s){const o=hZ();return s.x=t/2,s.y=n/2,e?s.eachBefore(BC(e)).eachAfter(uy(i,.5,o)).eachBefore(PC(1)):s.eachBefore(BC(wZ)).eachAfter(uy(Vo,1,o)).eachAfter(uy(i,s.r/Math.min(t,n),o)).eachBefore(PC(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=ag(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i=typeof s=="function"?s:uu(+s),r):i},r}function BC(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function uy(e,t,n){return function(i){if(r=i.children){var r,s,o=r.length,a=e(i)*t||0,u;if(a)for(s=0;s<o;++s)r[s].r+=a;if(u=xZ(r,n),a)for(s=0;s<o;++s)r[s].r-=a;i.r=u+a}}}function PC(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function _4(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Cd(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(i-t)/e.value;++a<u;)o=s[a],o.y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*l}function EZ(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),i&&o.eachBefore(_4),o}function s(o,a){return function(u){u.children&&Cd(u,u.x0,o*(u.depth+1)/a,u.x1,o*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r}var $Z={depth:-1},zC={},ly={};function _Z(e){return e.id}function SZ(e){return e.parentId}function LC(){var e=_Z,t=SZ,n;function i(r){var s=Array.from(r),o=e,a=t,u,l,c,f,d,h,g,p,m=new Map;if(n!=null){const y=s.map((x,A)=>CZ(n(x,A,r))),b=y.map(IC),v=new Set(y).add("");for(const x of b)v.has(x)||(v.add(x),y.push(x),b.push(IC(x)),s.push(ly));o=(x,A)=>y[A],a=(x,A)=>b[A]}for(c=0,u=s.length;c<u;++c)l=s[c],h=s[c]=new Hu(l),(g=o(l,c,r))!=null&&(g+="")&&(p=h.id=g,m.set(p,m.has(p)?zC:h)),(g=a(l,c,r))!=null&&(g+="")&&(h.parent=g);for(c=0;c<u;++c)if(h=s[c],g=h.parent){if(d=m.get(g),!d)throw new Error("missing: "+g);if(d===zC)throw new Error("ambiguous: "+g);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===ly&&f.children.length===1;)f=f.children[0],--u;for(let y=s.length-1;y>=0&&(h=s[y],h.data===ly);--y)h.data=null}if(f.parent=$Z,f.eachBefore(function(y){y.depth=y.parent.depth+1,--u}).eachBefore(w4),f.parent=null,u>0)throw new Error("cycle");return f}return i.id=function(r){return arguments.length?(e=ag(r),i):e},i.parentId=function(r){return arguments.length?(t=ag(r),i):t},i.path=function(r){return arguments.length?(n=ag(r),i):n},i}function CZ(e){e=`${e}`;let t=e.length;return vv(e,t-1)&&!vv(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function IC(e){let t=e.length;if(t<2)return"";for(;--t>1&&!vv(e,t););return e.slice(0,t)}function vv(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function kZ(e,t){return e.parent===t.parent?1:2}function cy(e){var t=e.children;return t?t[0]:e.t}function fy(e){var t=e.children;return t?t[t.length-1]:e.t}function FZ(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function OZ(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function DZ(e,t,n){return e.a.parent===t.parent?e.a:n}function ug(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}ug.prototype=Object.create(Hu.prototype);function MZ(e){for(var t=new ug(e,0),n,i=[t],r,s,o,a;n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new ug(s[o],o)),r.parent=n;return(t.parent=new ug(null,0)).children=[t],t}function TZ(){var e=kZ,t=1,n=1,i=null;function r(l){var c=MZ(l);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(b){b.x<f.x&&(f=b),b.x>d.x&&(d=b),b.depth>h.depth&&(h=b)});var g=f===d?1:e(f,d)/2,p=g-f.x,m=t/(d.x+g+p),y=n/(h.depth||1);l.eachBefore(function(b){b.x=(b.x+p)*m,b.y=b.depth*y})}return l}function s(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){OZ(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,g=c,p=d.parent.children[0],m=d.m,y=h.m,b=g.m,v=p.m,x;g=fy(g),d=cy(d),g&&d;)p=cy(p),h=fy(h),h.a=l,x=g.z+b-d.z-m+e(g._,d._),x>0&&(FZ(DZ(g,l,f),l,x),m+=x,y+=x),b+=g.m,m+=d.m,v+=p.m,y+=h.m;g&&!fy(h)&&(h.t=g,h.m+=b-y),d&&!cy(p)&&(p.t=d,p.m+=m-v,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function ym(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(r-n)/e.value;++a<u;)o=s[a],o.x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*l}var S4=(1+Math.sqrt(5))/2;function C4(e,t,n,i,r,s){for(var o=[],a=t.children,u,l,c=0,f=0,d=a.length,h,g,p=t.value,m,y,b,v,x,A,E;c<d;){h=r-n,g=s-i;do m=a[f++].value;while(!m&&f<d);for(y=b=m,A=Math.max(g/h,h/g)/(p*e),E=m*m*A,x=Math.max(b/E,E/y);f<d;++f){if(m+=l=a[f].value,l<y&&(y=l),l>b&&(b=l),E=m*m*A,v=Math.max(b/E,E/y),v>x){m-=l;break}x=v}o.push(u={value:m,dice:h<g,children:a.slice(c,f)}),u.dice?Cd(u,n,i,r,p?i+=g*m/p:s):ym(u,n,i,p?n+=h*m/p:r,s),p-=m,c=f}return o}const k4=function e(t){function n(i,r,s,o,a){C4(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(S4);function NZ(){var e=k4,t=!1,n=1,i=1,r=[0],s=Vo,o=Vo,a=Vo,u=Vo,l=Vo;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(_4),d}function f(d){var h=r[d.depth],g=d.x0+h,p=d.y0+h,m=d.x1-h,y=d.y1-h;m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),d.x0=g,d.y0=p,d.x1=m,d.y1=y,d.children&&(h=r[d.depth+1]=s(d)/2,g+=l(d)-h,p+=o(d)-h,m-=a(d)-h,y-=u(d)-h,m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),e(d,g,p,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=A4(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:uu(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:uu(+d),c):o},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:uu(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:uu(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:uu(+d),c):l},c}function jZ(e,t,n,i,r){var s=e.children,o,a=s.length,u,l=new Array(a+1);for(l[0]=u=o=0;o<a;++o)l[o+1]=u+=s[o].value;c(0,a,e.value,t,n,i,r);function c(f,d,h,g,p,m,y){if(f>=d-1){var b=s[f];b.x0=g,b.y0=p,b.x1=m,b.y1=y;return}for(var v=l[f],x=h/2+v,A=f+1,E=d-1;A<E;){var w=A+E>>>1;l[w]<x?A=w+1:E=w}x-l[A-1]<l[A]-x&&f+1<A&&--A;var $=l[A]-v,S=h-$;if(m-g>y-p){var _=h?(g*S+m*$)/h:m;c(f,A,$,g,p,_,y),c(A,d,S,_,p,m,y)}else{var C=h?(p*S+y*$)/h:y;c(f,A,$,g,p,m,C),c(A,d,S,g,C,m,y)}}}function RZ(e,t,n,i,r){(e.depth&1?ym:Cd)(e,t,n,i,r)}const BZ=function e(t){function n(i,r,s,o,a){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,g=u.length,p=i.value;++d<g;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Cd(l,r,s,o,p?s+=(a-s)*l.value/p:a):ym(l,r,s,p?r+=(o-r)*l.value/p:o,a),p-=l.value}else i._squarify=u=C4(t,i,r,s,o,a),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(S4);function xv(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function SA(e){D.call(this,null,e)}SA.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const PZ=e=>e.values;go(SA,D,{transform(e,t){t.source||Gi("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&Op(o.data)&&r.rem.push(o.data)}),this.value=s=_A({values:jQ(e.keys).reduce((o,a)=>(o.key(a),o),zZ()).entries(r.source)},PZ),n&&s.each(o=>{o.children&&(o=we(o.data),r.add.push(o),r.source.push(o))}),xv(s,V,V)),r.source.root=s,r}});function zZ(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=a(d=r[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],s);return l}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function is(e){D.call(this,null,e)}const LZ=(e,t)=>e.parent===t.parent?1:2;go(is,D,{transform(e,t){(!t.source||!t.source.root)&&Gi(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(ja(e.sort,o=>o.data)),IZ(n,this.params,e),n.separation&&n.separation(e.separation!==!1?LZ:MQ);try{this.value=n(r)}catch(o){Gi(o)}return r.each(o=>UZ(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function IZ(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}function UZ(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}const wv=["x","y","r","depth","children"];function CA(e){is.call(this,e)}CA.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:wv.length,default:wv}]};go(CA,is,{layout:AZ,params:["radius","size","padding"],fields:wv});const Av=["x0","y0","x1","y1","depth","children"];function kA(e){is.call(this,e)}kA.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Av.length,default:Av}]};go(kA,is,{layout:EZ,params:["size","round","padding"],fields:Av});function FA(e){D.call(this,null,e)}FA.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};go(FA,D,{transform(e,t){t.source||Gi("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?xv(LC().id(e.key).parentId(e.parentKey)(r.source),e.key,TQ):xv(LC()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const UC={tidy:TZ,cluster:HQ},Ev=["x","y","depth","children"];function OA(e){is.call(this,e)}OA.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:Ev.length,default:Ev}]};go(OA,is,{layout(e){const t=e||"tidy";if(x4(UC,t))return UC[t]();Gi("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:Ev});function DA(e){D.call(this,[],e)}DA.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};go(DA,D,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||Gi("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[V(o)]=1),i.each(o=>{const a=o.data,u=o.parent&&o.parent.data;u&&s[V(a)]&&s[V(u)]&&r.add.push(we({source:u,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[V(o)]=1),n.forEach(o=>{(s[V(o.source)]||s[V(o.target)])&&r.mod.push(o)})),r}});const qC={binary:jZ,dice:Cd,slice:ym,slicedice:RZ,squarify:k4,resquarify:BZ},$v=["x0","y0","x1","y1","depth","children"];function MA(e){is.call(this,e)}MA.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:$v.length,default:$v}]};go(MA,is,{layout(){const e=NZ();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{x4(qC,t)?e.tile(qC[t]):Gi("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:$v});const qZ=Object.freeze(Object.defineProperty({__proto__:null,nest:SA,pack:CA,partition:kA,stratify:FA,tree:OA,treelinks:DA,treemap:MA},Symbol.toStringTag,{value:"Module"}));function _l(e,t,n){return e.fields=t||[],e.fname=n,e}function wu(e){return e==null?null:e.fname}function WZ(e){return e.length===1?HZ(e[0]):GZ(e)}const HZ=e=>function(t){return t[e]},GZ=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Kc(e){throw Error(e)}function YZ(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Kc("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Kc("Access path missing closing bracket: "+e),i&&Kc("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function VZ(e,t,n){const i=YZ(e);return e=i.length===1?i[0]:e,_l((n&&n.get||WZ)(i),[e],t||e)}VZ("id");_l(e=>e,[],"identity");_l(()=>0,[],"zero");_l(()=>1,[],"one");_l(()=>!0,[],"true");_l(()=>!1,[],"false");var XZ=Array.isArray;function qve(e){return e===Object(e)}function WC(e){return e!=null?XZ(e)?e:[e]:[]}function KZ(e){return typeof e=="function"}function JZ(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function QZ(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}const ZZ=Object.prototype.hasOwnProperty;function eee(e,t){return ZZ.call(e,t)}function TA(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),JZ(i,n)}function Wve(e){return typeof e=="string"}const dy=4278190080;function tee(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function nee(e,t,n,i,r){const s=e.width,o=e.height,a=i||r,u=Rs(s,o).getContext("2d"),l=Rs(s,o).getContext("2d"),c=a&&Rs(s,o).getContext("2d");n.forEach($=>lg(u,$,!1)),lg(l,t,!1),a&&lg(c,t,!0);const f=hy(u,s,o),d=hy(l,s,o),h=a&&hy(c,s,o),g=e.bitmap(),p=a&&e.bitmap();let m,y,b,v,x,A,E,w;for(y=0;y<o;++y)for(m=0;m<s;++m)x=y*s+m,A=f[x]&dy,w=d[x]&dy,E=a&&h[x]&dy,(A||E||w)&&(b=e(m),v=e(y),!r&&(A||w)&&g.set(b,v),a&&(A||E)&&p.set(b,v));return[g,p]}function hy(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function lg(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(s=>lg(e,s.items,n))}):Pn[i].draw(e,{items:n?t.map(iee):t})}function iee(e){const t=Dp(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const Sr=5,qt=31,Mf=32,vs=new Uint32Array(Mf+1),li=new Uint32Array(Mf+1);li[0]=0;vs[0]=~li[0];for(let e=1;e<=Mf;++e)li[e]=li[e-1]<<1|1,vs[e]=~li[e];function ree(e,t){const n=new Uint32Array(~~((e*t+Mf)/Mf));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>Sr]&1<<(a&qt)},set:(s,o)=>{const a=o*e+s;i(a>>>Sr,1<<(a&qt))},clear:(s,o)=>{const a=o*e+s;r(a>>>Sr,~(1<<(a&qt)))},getRange:(s,o,a,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+s,f=l*e+a,d=c>>>Sr,h=f>>>Sr,d===h){if(n[d]&vs[c&qt]&li[(f&qt)+1])return!0}else{if(n[d]&vs[c&qt]||n[h]&li[(f&qt)+1])return!0;for(let g=d+1;g<h;++g)if(n[g])return!0}return!1},setRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>Sr,d=c>>>Sr,f===d)i(f,vs[l&qt]&li[(c&qt)+1]);else for(i(f,vs[l&qt]),i(d,li[(c&qt)+1]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>Sr,d=c>>>Sr,f===d)r(f,li[l&qt]|vs[(c&qt)+1]);else for(r(f,li[l&qt]),r(d,vs[(c&qt)+1]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(s,o,a,u)=>s<0||o<0||u>=t||a>=e}}function see(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>ree(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}function oee(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,u=a.length,l=o.datum.fontSize,c=bi.width(o.datum,o.datum.text);let f=0,d,h,g,p,m,y,b;for(let v=0;v<u;++v)d=a[v].x,g=a[v].y,h=a[v].x2===void 0?d:a[v].x2,p=a[v].y2===void 0?g:a[v].y2,m=(d+h)/2,y=(g+p)/2,b=Math.abs(h-d+p-g),b>=f&&(f=b,o.x=m,o.y=y);return m=c/2,y=l/2,d=o.x-m,h=o.x+m,g=o.y-y,p=o.y+y,o.align="center",d<0&&h<=r?o.align="left":0<=d&&r<h&&(o.align="right"),o.baseline="middle",g<0&&p<=s?o.baseline="top":0<=g&&s<p&&(o.baseline="bottom"),!0}}function N0(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function Os(e,t,n,i,r,s,o,a){const u=r*s/(i*2),l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),d=e(n+s);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function aee(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1];function u(l,c,f,d,h){const g=e.invert(l),p=e.invert(c);let m=f,y=s,b;if(!N0(g,p,d,h,r,s)&&!Os(e,g,p,h,d,m,o,a)&&!Os(e,g,p,h,d,h,o,null)){for(;y-m>=1;)b=(m+y)/2,Os(e,g,p,h,d,b,o,a)?y=b:m=b;if(m>f)return[g,p,m,!0]}}return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,h=bi.width(l.datum,l.datum.text);let g=n?d:0,p=!1,m=!1,y=0,b,v,x,A,E,w,$,S,_,C,M,F,O,k,j,B,I;for(let q=0;q<f;++q){for(b=c[q].x,x=c[q].y,v=c[q].x2===void 0?b:c[q].x2,A=c[q].y2===void 0?x:c[q].y2,b>v&&(I=b,b=v,v=I),x>A&&(I=x,x=A,A=I),_=e(b),M=e(v),C=~~((_+M)/2),F=e(x),k=e(A),O=~~((F+k)/2),$=C;$>=_;--$)for(S=O;S>=F;--S)B=u($,S,g,h,d),B&&([l.x,l.y,g,p]=B);for($=C;$<=M;++$)for(S=O;S<=k;++S)B=u($,S,g,h,d),B&&([l.x,l.y,g,p]=B);!p&&!n&&(j=Math.abs(v-b+A-x),E=(b+v)/2,w=(x+A)/2,j>=y&&!N0(E,w,h,d,r,s)&&!Os(e,E,w,d,h,d,o,null)&&(y=j,l.x=E,l.y=w,m=!0))}return p||m?(E=h/2,w=d/2,o.setRange(e(l.x-E),e(l.y-w),e(l.x+E),e(l.y+w)),l.align="center",l.baseline="middle",!0):!1}}const uee=[-1,-1,1,1],lee=[-1,1,-1,1];function cee(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,h=bi.width(l.datum,l.datum.text),g=[];let p=n?d:0,m=!1,y=!1,b=0,v,x,A,E,w,$,S,_,C,M,F,O;for(let k=0;k<f;++k){for(v=c[k].x,A=c[k].y,x=c[k].x2===void 0?v:c[k].x2,E=c[k].y2===void 0?A:c[k].y2,g.push([e((v+x)/2),e((A+E)/2)]);g.length;)if([S,_]=g.pop(),!(o.get(S,_)||a.get(S,_)||u.get(S,_))){u.set(S,_);for(let j=0;j<4;++j)w=S+uee[j],$=_+lee[j],u.outOfBounds(w,$,w,$)||g.push([w,$]);if(w=e.invert(S),$=e.invert(_),C=p,M=s,!N0(w,$,h,d,r,s)&&!Os(e,w,$,d,h,C,o,a)&&!Os(e,w,$,d,h,d,o,null)){for(;M-C>=1;)F=(C+M)/2,Os(e,w,$,d,h,F,o,a)?M=F:C=F;C>p&&(l.x=w,l.y=$,p=C,m=!0)}}!m&&!n&&(O=Math.abs(x-v+E-A),w=(v+x)/2,$=(A+E)/2,O>=b&&!N0(w,$,h,d,r,s)&&!Os(e,w,$,d,h,d,o,null)&&(b=O,l.x=w,l.y=$,y=!0))}return m||y?(w=h/2,$=d/2,o.setRange(e(l.x-w),e(l.y-$),e(l.x+w),e(l.y+$)),l.align="center",l.baseline="middle",!0):!1}}const fee=["right","center","left"],dee=["bottom","middle","top"];function hee(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],u=i.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>r||c[3]>s)return!1;let d=l.textWidth??0,h,g,p,m,y,b,v,x,A,E,w,$,S,_,C;for(let M=0;M<u;++M){if(h=(n[M]&3)-1,g=(n[M]>>>2&3)-1,p=h===0&&g===0||i[M]<0,m=h&&g?Math.SQRT1_2:1,y=i[M]<0?-1:1,b=c[1+h]+i[M]*h*m,w=c[4+g]+y*f*g/2+i[M]*g*m,x=w-f/2,A=w+f/2,$=e(b),_=e(x),C=e(A),!d)if(HC($,$,_,C,o,a,b,b,x,A,c,p))d=bi.width(l.datum,l.datum.text);else continue;if(E=b+y*d*h/2,b=E-d/2,v=E+d/2,$=e(b),S=e(v),HC($,S,_,C,o,a,b,v,x,A,c,p))return l.x=h?h*y<0?v:b:E,l.y=g?g*y<0?A:x:w,l.align=fee[h*y+1],l.baseline=dee[g*y+1],o.setRange($,_,S,C),!0}return!1}}function HC(e,t,n,i,r,s,o,a,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&s||r).getRange(e,n,t,i))}const gy=0,py=4,my=8,yy=0,by=1,vy=2,gee={"top-left":gy+yy,top:gy+by,"top-right":gy+vy,left:py+yy,middle:py+by,right:py+vy,"bottom-left":my+yy,bottom:my+by,"bottom-right":my+vy},pee={naive:oee,"reduced-search":aee,floodfill:cee};function mee(e,t,n,i,r,s,o,a,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=yee(i,f),h=bee(r,f),g=vee(e[0].datum),p=g==="group"&&e[0].datum.items[u].marktype,m=p==="area",y=xee(g,p,a,u),b=l===null||l===1/0,v=m&&c==="naive";let x=-1,A=-1;const E=e.map(_=>{const C=b?bi.width(_,_.text):void 0;return x=Math.max(x,C),A=Math.max(A,_.fontSize),{datum:_,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(_),textWidth:C}});l=l===null||l===1/0?Math.max(x,A)+Math.max(...i):l;const w=see(t[0],t[1],l);let $;if(!v){n&&E.sort((M,F)=>n(M.datum,F.datum));let _=!1;for(let M=0;M<h.length&&!_;++M)_=h[M]===5||d[M]<0;const C=(g&&o||m)&&e.map(M=>M.datum);$=s.length||C?nee(w,C||[],s,_,m):tee(w,o&&E)}const S=m?pee[c](w,$,o,u):hee(w,$,h,d);return E.forEach(_=>_.opacity=+S(_)),E}function yee(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function bee(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=gee[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function vee(e){return e&&e.mark&&e.mark.marktype}function xee(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>r(s.datum):t==="line"?s=>{const o=s.datum.items[i].items;return r(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}const _v=["x","y","opacity","align","baseline"],F4=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function NA(e){D.call(this,null,e)}NA.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:F4},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:_v.length,default:_v}]};TA(NA,D,{transform(e,t){function n(s){const o=e[s];return KZ(o)&&t.modified(o.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&Kc("Size parameter should be specified as a [width, height] array.");const r=e.as||_v;return mee(t.materialize(t.SOURCE).source||[],e.size,e.sort,WC(e.offset==null?1:e.offset),WC(e.anchor||F4),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}});const wee=Object.freeze(Object.defineProperty({__proto__:null,label:NA},Symbol.toStringTag,{value:"Module"}));function O4(e,t){var n=[],i=function(c){return c(a)},r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function jA(e){D.call(this,null,e)}jA.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};TA(jA,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=O4(i,e.groupby),s=(e.groupby||[]).map(wu),o=s.length,a=e.as||[wu(e.x),wu(e.y)],u=[];r.forEach(l=>{FD(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[s[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(we(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const Sv={constant:o2,linear:a2,log:_D,exp:SD,pow:CD,quad:u2,poly:kD},Aee=(e,t)=>e==="poly"?t:e==="quad"?2:1;function RA(e){D.call(this,null,e)}RA.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Sv)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};TA(RA,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=O4(i,e.groupby),s=(e.groupby||[]).map(wu),o=e.method||"linear",a=e.order==null?3:e.order,u=Aee(o,a),l=e.as||[wu(e.x),wu(e.y)],c=Sv[o],f=[];let d=e.extent;eee(Sv,o)||Kc("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const p=c(h,e.x,e.y,a);if(e.params){f.push(we({keys:h.dims,coef:p.coef,rSquared:p.rSquared}));return}const m=d||QZ(h,e.x),y=b=>{const v={};for(let x=0;x<s.length;++x)v[s[x]]=h.dims[x];v[l[0]]=b[0],v[l[1]]=b[1],f.push(we(v))};o==="linear"||o==="constant"?m.forEach(b=>y([b,p.predict(b)])):Pp(p.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const Eee=Object.freeze(Object.defineProperty({__proto__:null,loess:jA,regression:RA},Symbol.toStringTag,{value:"Module"}));function Sl(e,t,n){return e.fields=t||[],e.fname=n,e}function $ee(e){return e.length===1?_ee(e[0]):See(e)}const _ee=e=>function(t){return t[e]},See=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function xy(e){throw Error(e)}function Cee(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||xy("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&xy("Access path missing closing bracket: "+e),i&&xy("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function kee(e,t,n){const i=Cee(e);return e=i.length===1?i[0]:e,Sl((n&&n.get||$ee)(i),[e],t||e)}kee("id");Sl(e=>e,[],"identity");Sl(()=>0,[],"zero");Sl(()=>1,[],"one");Sl(()=>!0,[],"true");Sl(()=>!1,[],"false");function Fee(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function Oee(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Fee(i,n)}const Ur=11102230246251565e-32,Ct=134217729,Dee=(3+8*Ur)*Ur;function wy(e,t,n,i,r){let s,o,a,u,l=t[0],c=i[0],f=0,d=0;c>l==c>-l?(s=l,l=t[++f]):(s=c,c=i[++d]);let h=0;if(f<e&&d<n)for(c>l==c>-l?(o=l+s,a=s-(o-l),l=t[++f]):(o=c+s,a=s-(o-c),c=i[++d]),s=o,a!==0&&(r[h++]=a);f<e&&d<n;)c>l==c>-l?(o=s+l,u=o-s,a=s-(o-u)+(l-u),l=t[++f]):(o=s+c,u=o-s,a=s-(o-u)+(c-u),c=i[++d]),s=o,a!==0&&(r[h++]=a);for(;f<e;)o=s+l,u=o-s,a=s-(o-u)+(l-u),l=t[++f],s=o,a!==0&&(r[h++]=a);for(;d<n;)o=s+c,u=o-s,a=s-(o-u)+(c-u),c=i[++d],s=o,a!==0&&(r[h++]=a);return(s!==0||h===0)&&(r[h++]=s),h}function Mee(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function kd(e){return new Float64Array(e)}const Tee=(3+16*Ur)*Ur,Nee=(2+12*Ur)*Ur,jee=(9+64*Ur)*Ur*Ur,ru=kd(4),GC=kd(8),YC=kd(12),VC=kd(16),Wt=kd(4);function Ree(e,t,n,i,r,s,o){let a,u,l,c,f,d,h,g,p,m,y,b,v,x,A,E,w,$;const S=e-r,_=n-r,C=t-s,M=i-s;x=S*M,d=Ct*S,h=d-(d-S),g=S-h,d=Ct*M,p=d-(d-M),m=M-p,A=g*m-(x-h*p-g*p-h*m),E=C*_,d=Ct*C,h=d-(d-C),g=C-h,d=Ct*_,p=d-(d-_),m=_-p,w=g*m-(E-h*p-g*p-h*m),y=A-w,f=A-y,ru[0]=A-(y+f)+(f-w),b=x+y,f=b-x,v=x-(b-f)+(y-f),y=v-E,f=v-y,ru[1]=v-(y+f)+(f-E),$=b+y,f=$-b,ru[2]=b-($-f)+(y-f),ru[3]=$;let F=Mee(4,ru),O=Nee*o;if(F>=O||-F>=O||(f=e-S,a=e-(S+f)+(f-r),f=n-_,l=n-(_+f)+(f-r),f=t-C,u=t-(C+f)+(f-s),f=i-M,c=i-(M+f)+(f-s),a===0&&u===0&&l===0&&c===0)||(O=jee*o+Dee*Math.abs(F),F+=S*c+M*a-(C*l+_*u),F>=O||-F>=O))return F;x=a*M,d=Ct*a,h=d-(d-a),g=a-h,d=Ct*M,p=d-(d-M),m=M-p,A=g*m-(x-h*p-g*p-h*m),E=u*_,d=Ct*u,h=d-(d-u),g=u-h,d=Ct*_,p=d-(d-_),m=_-p,w=g*m-(E-h*p-g*p-h*m),y=A-w,f=A-y,Wt[0]=A-(y+f)+(f-w),b=x+y,f=b-x,v=x-(b-f)+(y-f),y=v-E,f=v-y,Wt[1]=v-(y+f)+(f-E),$=b+y,f=$-b,Wt[2]=b-($-f)+(y-f),Wt[3]=$;const k=wy(4,ru,4,Wt,GC);x=S*c,d=Ct*S,h=d-(d-S),g=S-h,d=Ct*c,p=d-(d-c),m=c-p,A=g*m-(x-h*p-g*p-h*m),E=C*l,d=Ct*C,h=d-(d-C),g=C-h,d=Ct*l,p=d-(d-l),m=l-p,w=g*m-(E-h*p-g*p-h*m),y=A-w,f=A-y,Wt[0]=A-(y+f)+(f-w),b=x+y,f=b-x,v=x-(b-f)+(y-f),y=v-E,f=v-y,Wt[1]=v-(y+f)+(f-E),$=b+y,f=$-b,Wt[2]=b-($-f)+(y-f),Wt[3]=$;const j=wy(k,GC,4,Wt,YC);x=a*c,d=Ct*a,h=d-(d-a),g=a-h,d=Ct*c,p=d-(d-c),m=c-p,A=g*m-(x-h*p-g*p-h*m),E=u*l,d=Ct*u,h=d-(d-u),g=u-h,d=Ct*l,p=d-(d-l),m=l-p,w=g*m-(E-h*p-g*p-h*m),y=A-w,f=A-y,Wt[0]=A-(y+f)+(f-w),b=x+y,f=b-x,v=x-(b-f)+(y-f),y=v-E,f=v-y,Wt[1]=v-(y+f)+(f-E),$=b+y,f=$-b,Wt[2]=b-($-f)+(y-f),Wt[3]=$;const B=wy(j,YC,4,Wt,VC);return VC[B-1]}function _h(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),u=o-a;if(o===0||a===0||o>0!=a>0)return u;const l=Math.abs(o+a);return Math.abs(u)>=Tee*l?u:-Ree(e,t,n,i,r,s,l)}const XC=Math.pow(2,-52),Sh=new Uint32Array(512);class j0{static from(t,n=Iee,i=Uee){const r=t.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new j0(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let _=0;_<o;_++){const C=t[2*_],M=t[2*_+1];C<a&&(a=C),M<u&&(u=M),C>l&&(l=C),M>c&&(c=M),this._ids[_]=_}const f=(a+l)/2,d=(u+c)/2;let h=1/0,g,p,m;for(let _=0;_<o;_++){const C=Ay(f,d,t[2*_],t[2*_+1]);C<h&&(g=_,h=C)}const y=t[2*g],b=t[2*g+1];h=1/0;for(let _=0;_<o;_++){if(_===g)continue;const C=Ay(y,b,t[2*_],t[2*_+1]);C<h&&C>0&&(p=_,h=C)}let v=t[2*p],x=t[2*p+1],A=1/0;for(let _=0;_<o;_++){if(_===g||_===p)continue;const C=zee(y,b,v,x,t[2*_],t[2*_+1]);C<A&&(m=_,A=C)}let E=t[2*m],w=t[2*m+1];if(A===1/0){for(let M=0;M<o;M++)this._dists[M]=t[2*M]-t[0]||t[2*M+1]-t[1];gu(this._ids,this._dists,0,o-1);const _=new Uint32Array(o);let C=0;for(let M=0,F=-1/0;M<o;M++){const O=this._ids[M];this._dists[O]>F&&(_[C++]=O,F=this._dists[O])}this.hull=_.subarray(0,C),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(_h(y,b,v,x,E,w)<0){const _=p,C=v,M=x;p=m,v=E,x=w,m=_,E=C,w=M}const $=Lee(y,b,v,x,E,w);this._cx=$.x,this._cy=$.y;for(let _=0;_<o;_++)this._dists[_]=Ay(t[2*_],t[2*_+1],$.x,$.y);gu(this._ids,this._dists,0,o-1),this._hullStart=g;let S=3;i[g]=n[m]=p,i[p]=n[g]=m,i[m]=n[p]=g,r[g]=0,r[p]=1,r[m]=2,s.fill(-1),s[this._hashKey(y,b)]=g,s[this._hashKey(v,x)]=p,s[this._hashKey(E,w)]=m,this.trianglesLen=0,this._addTriangle(g,p,m,-1,-1,-1);for(let _=0,C,M;_<this._ids.length;_++){const F=this._ids[_],O=t[2*F],k=t[2*F+1];if(_>0&&Math.abs(O-C)<=XC&&Math.abs(k-M)<=XC||(C=O,M=k,F===g||F===p||F===m))continue;let j=0;for(let Pe=0,tt=this._hashKey(O,k);Pe<this._hashSize&&(j=s[(tt+Pe)%this._hashSize],!(j!==-1&&j!==i[j]));Pe++);j=n[j];let B=j,I;for(;I=i[B],_h(O,k,t[2*B],t[2*B+1],t[2*I],t[2*I+1])>=0;)if(B=I,B===j){B=-1;break}if(B===-1)continue;let q=this._addTriangle(B,F,i[B],-1,-1,r[B]);r[F]=this._legalize(q+2),r[B]=q,S++;let ue=i[B];for(;I=i[ue],_h(O,k,t[2*ue],t[2*ue+1],t[2*I],t[2*I+1])<0;)q=this._addTriangle(ue,F,I,r[F],-1,r[ue]),r[F]=this._legalize(q+2),i[ue]=ue,S--,ue=I;if(B===j)for(;I=n[B],_h(O,k,t[2*I],t[2*I+1],t[2*B],t[2*B+1])<0;)q=this._addTriangle(I,F,B,-1,r[B],r[I]),this._legalize(q+2),r[I]=q,i[B]=B,S--,B=I;this._hullStart=n[F]=B,i[B]=n[ue]=F,i[F]=ue,s[this._hashKey(O,k)]=F,s[this._hashKey(t[2*B],t[2*B+1])]=B}this.hull=new Uint32Array(S);for(let _=0,C=this._hullStart;_<S;_++)this.hull[_]=C,C=i[C];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Bee(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],u=t-t%3;if(o=u+(t+2)%3,a===-1){if(s===0)break;t=Sh[--s];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[o],h=n[t],g=n[c],p=n[f];if(Pee(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*g],r[2*g+1],r[2*p],r[2*p+1])){n[t]=p,n[a]=d;const y=i[f];if(y===-1){let v=this._hullStart;do{if(this._hullTri[v]===f){this._hullTri[v]=t;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(t,y),this._link(a,i[o]),this._link(o,f);const b=l+(a+1)%3;s<Sh.length&&(Sh[s++]=b)}else{if(s===0)break;t=Sh[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function Bee(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Ay(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function Pee(e,t,n,i,r,s,o,a){const u=e-o,l=t-a,c=n-o,f=i-a,d=r-o,h=s-a,g=u*u+l*l,p=c*c+f*f,m=d*d+h*h;return u*(f*m-p*h)-l*(c*m-p*d)+g*(c*h-f*d)<0}function zee(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=(l*c-a*f)*d,g=(o*f-u*c)*d;return h*h+g*g}function Lee(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=e+(l*c-a*f)*d,g=t+(o*f-u*c)*d;return{x:h,y:g}}function gu(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const r=n+i>>1;let s=n+1,o=i;ac(e,r,s),t[e[n]]>t[e[i]]&&ac(e,n,i),t[e[s]]>t[e[i]]&&ac(e,s,i),t[e[n]]>t[e[s]]&&ac(e,n,s);const a=e[s],u=t[a];for(;;){do s++;while(t[e[s]]<u);do o--;while(t[e[o]]>u);if(o<s)break;ac(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(gu(e,t,s,i),gu(e,t,n,o-1)):(gu(e,t,n,o-1),gu(e,t,s,i))}}function ac(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function Iee(e){return e[0]}function Uee(e){return e[1]}const KC=1e-6;class Qo{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>KC||Math.abs(this._y1-s)>KC)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class Cv{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let qee=class{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let p=0,m=0,y=i.length,b,v;p<y;p+=3,m+=2){const x=i[p]*2,A=i[p+1]*2,E=i[p+2]*2,w=t[x],$=t[x+1],S=t[A],_=t[A+1],C=t[E],M=t[E+1],F=S-w,O=_-$,k=C-w,j=M-$,B=(F*j-O*k)*2;if(Math.abs(B)<1e-9){if(s===void 0){s=o=0;for(const q of n)s+=t[q*2],o+=t[q*2+1];s/=n.length,o/=n.length}const I=1e9*Math.sign((s-w)*j-(o-$)*k);b=(w+C)/2-I*j,v=($+M)/2+I*k}else{const I=1/B,q=F*F+O*O,ue=k*k+j*j;b=w+(j*q-O*ue)*I,v=$+(F*ue-k*q)*I}a[m]=b,a[m+1]=v}let u=n[n.length-1],l,c=u*4,f,d=t[2*u],h,g=t[2*u+1];r.fill(0);for(let p=0;p<n.length;++p)u=n[p],l=c,f=d,h=g,c=u*4,d=t[2*u],g=t[2*u+1],r[l+2]=r[c]=h-g,r[l+3]=r[c+1]=d-f}render(t){const n=t==null?t=new Qo:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=Math.floor(c/3)*2,g=Math.floor(d/3)*2,p=o[h],m=o[h+1],y=o[g],b=o[g+1];this._renderSegment(p,m,y,b,t)}let u,l=s[s.length-1];for(let c=0;c<s.length;++c){u=l,l=s[c];const f=Math.floor(r[l]/3)*2,d=o[f],h=o[f+1],g=u*4,p=this._project(d,h,a[g+2],a[g+3]);p&&this._renderSegment(d,h,p[0],p[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Qo:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new Qo:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new Cv;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),u=this._regioncode(i,r);a===0&&u===0?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,u))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,u=r.length;a<u;a+=2)if(n[s]===r[a]&&n[s+1]===r[a+1]&&n[(s+2)%o]===r[(a+u-2)%u]&&n[(s+3)%o]===r[(a+u-1)%u]){yield i;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(o===-1)return null;const a=[];let u=o;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,s[u]!==t)break;u=r[u]}while(u!==o&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,s,o,a=n[i-2],u=n[i-1],l,c=this._regioncode(a,u),f,d=0;for(let h=0;h<i;h+=2)if(s=a,o=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,r?r.push(a,u):r=[a,u];else{let g,p,m,y,b;if(l===0){if((g=this._clipSegment(s,o,a,u,l,c))===null)continue;[p,m,y,b]=g}else{if((g=this._clipSegment(a,u,s,o,c,l))===null)continue;[y,b,p,m]=g,f=d,d=this._edgecode(p,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(p,m):r=[p,m]}f=d,d=this._edgecode(y,b),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,b):r=[y,b]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){const a=s<o;for(a&&([t,n,i,r,s,o]=[i,r,t,n,o,s]);;){if(s===0&&o===0)return a?[i,r,t,n]:[t,n,i,r];if(s&o)return null;let u,l,c=s||o;c&8?(u=t+(i-t)*(this.ymax-n)/(r-n),l=this.ymax):c&4?(u=t+(i-t)*(this.ymin-n)/(r-n),l=this.ymin):c&2?(l=n+(r-n)*(this.xmax-t)/(i-t),u=this.xmax):(l=n+(r-n)*(this.xmin-t)/(i-t),u=this.xmin),s?(t=u,n=l,s=this._regioncode(t,n)):(i=u,r=l,o=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,o){let a=Array.from(n),u;if((u=this._project(a[0],a[1],i,r))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(t,n,i,r){let s=1/0,o,a,u;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(u=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(u=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,u=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,u=n+(s=o)*r)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}};const Wee=2*Math.PI,su=Math.pow;function Hee(e){return e[0]}function Gee(e){return e[1]}function Yee(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function Vee(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class BA{static from(t,n=Hee,i=Gee,r){return new BA("length"in t?Xee(t,n,i,r):Float64Array.from(Kee(t,n,i,r)))}constructor(t){this._delaunator=new j0(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Yee(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const g=Vee(n[2*d],n[2*d+1],f);n[2*d]=g[0],n[2*d+1]=g[1]}this._delaunator=new j0(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=s[u%3===2?u-2:u+1];(i[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=r.length;u<l;++u)a[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new qee(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3===2?l-2:l+1,o[l]!==t)return;if(l=s[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=su(n-l[t*2],2)+su(i-l[t*2+1],2);const d=r[t];let h=d;do{let g=u[h];const p=su(n-l[g*2],2)+su(i-l[g*2+1],2);if(p<f&&(f=p,c=g),h=h%3===2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=s[(o[t]+1)%s.length],h!==g&&su(n-l[h*2],2)+su(i-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new Qo:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u<o)continue;const l=s[o]*2,c=s[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new Qo:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],u=r[s+1];t.moveTo(a+n,u),t.arc(a,u,n,0,Wee)}return i&&i.value()}renderHull(t){const n=t==null?t=new Qo:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const u=2*i[a];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new Cv;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new Qo:void 0,{points:r,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,u=s[t+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new Cv;return this.renderTriangle(t,n),n.value()}}function Xee(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=e[o];s[o*2]=t.call(i,a,o,e),s[o*2+1]=n.call(i,a,o,e)}return s}function*Kee(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}function PA(e){D.call(this,null,e)}PA.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Jee=[-1e5,-1e5,1e5,1e5];Oee(PA,D,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:Jee;const s=this.value=BA.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const u=s.cellPolygon(o);i[o][n]=u?Qee(u):null}return t.reflow(e.modified()).modifies(n)}});function Qee(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}const Zee=Object.freeze(Object.defineProperty({__proto__:null,voronoi:PA},Symbol.toStringTag,{value:"Module"}));function Cl(e,t,n){return e.fields=t||[],e.fname=n,e}function ete(e){return e.length===1?tte(e[0]):nte(e)}const tte=e=>function(t){return t[e]},nte=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function cg(e){throw Error(e)}function ite(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||cg("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&cg("Access path missing closing bracket: "+e),i&&cg("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function rte(e,t,n){const i=ite(e);return e=i.length===1?i[0]:e,Cl((n&&n.get||ete)(i),[e],t||e)}rte("id");Cl(e=>e,[],"identity");Cl(()=>0,[],"zero");Cl(()=>1,[],"one");Cl(()=>!0,[],"true");Cl(()=>!1,[],"false");function kv(e){return typeof e=="function"}function ste(e){return kv(e)?e:()=>e}function ote(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function ate(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function ute(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),ote(i,n)}var Ey=Math.PI/180,Rc=64,fg=2048;function lte(){var e=[256,256],t,n,i,r,s,o,a,u=D4,l=[],c=Math.random,f={};f.layout=function(){for(var g=d(Rs()),p=pte((e[0]>>5)*e[1]),m=null,y=l.length,b=-1,v=[],x=l.map(E=>({text:t(E),font:n(E),style:r(E),weight:s(E),rotate:o(E),size:~~(i(E)+1e-14),padding:a(E),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:E})).sort((E,w)=>w.size-E.size);++b<y;){var A=x[b];A.x=e[0]*(c()+.5)>>1,A.y=e[1]*(c()+.5)>>1,cte(g,A,x,b),A.hasText&&h(p,A,m)&&(v.push(A),m?dte(m,A):m=[{x:A.x+A.x0,y:A.y+A.y0},{x:A.x+A.x1,y:A.y+A.y1}],A.x-=e[0]>>1,A.y-=e[1]>>1)}return v};function d(g){g.width=g.height=1;var p=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(Rc<<5)/p,g.height=fg/p;var m=g.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:p}}function h(g,p,m){for(var y=p.x,b=p.y,v=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),A=c()<.5?1:-1,E=-A,w,$,S;(w=x(E+=A))&&($=~~w[0],S=~~w[1],!(Math.min(Math.abs($),Math.abs(S))>=v));)if(p.x=y+$,p.y=b+S,!(p.x+p.x0<0||p.y+p.y0<0||p.x+p.x1>e[0]||p.y+p.y1>e[1])&&(!m||!fte(p,g,e[0]))&&(!m||hte(p,m))){for(var _=p.sprite,C=p.width>>5,M=e[0]>>5,F=p.x-(C<<4),O=F&127,k=32-O,j=p.y1-p.y0,B=(p.y+p.y0)*M+(F>>5),I,q=0;q<j;q++){I=0;for(var ue=0;ue<=C;ue++)g[B+ue]|=I<<k|(ue<C?(I=_[q*C+ue])>>>O:0);B+=M}return p.sprite=null,!0}return!1}return f.words=function(g){return arguments.length?(l=g,f):l},f.size=function(g){return arguments.length?(e=[+g[0],+g[1]],f):e},f.font=function(g){return arguments.length?(n=Fo(g),f):n},f.fontStyle=function(g){return arguments.length?(r=Fo(g),f):r},f.fontWeight=function(g){return arguments.length?(s=Fo(g),f):s},f.rotate=function(g){return arguments.length?(o=Fo(g),f):o},f.text=function(g){return arguments.length?(t=Fo(g),f):t},f.spiral=function(g){return arguments.length?(u=mte[g]||g,f):u},f.fontSize=function(g){return arguments.length?(i=Fo(g),f):i},f.padding=function(g){return arguments.length?(a=Fo(g),f):a},f.random=function(g){return arguments.length?(c=g,f):c},f}function cte(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(Rc<<5)/s,fg/s);var o=0,a=0,u=0,l=n.length,c,f,d,h,g;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var p=Math.sin(t.rotate*Ey),m=Math.cos(t.rotate*Ey),y=c*m,b=c*p,v=d*m,x=d*p;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,d=~~Math.max(Math.abs(b+v),Math.abs(b-v))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=Rc<<5&&(o=0,a+=u,u=0),a+d>=fg)break;r.translate((o+(c>>1))/s,(a+(d>>1))/s),t.rotate&&r.rotate(t.rotate*Ey),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var A=r.getImageData(0,0,(Rc<<5)/s,fg/s).data,E=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)E[h]=0;if(o=t.xoff,o==null)return;a=t.yoff;var w=0,$=-1;for(g=0;g<d;g++){for(h=0;h<c;h++){var S=f*g+(h>>5),_=A[(a+g)*(Rc<<5)+(o+h)<<2]?1<<31-h%32:0;E[S]|=_,w|=_}w?$=g:(t.y0++,d--,g--,a++)}t.y1=t.y0+$,t.sprite=E.slice(0,(t.y1-t.y0)*f)}}}function fte(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=s&127,a=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(s>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<a|(d<r?(c=i[f*r+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function dte(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function hte(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function D4(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function gte(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function pte(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Fo(e){return typeof e=="function"?e:function(){return e}}var mte={archimedean:D4,rectangular:gte};const M4=["x","y","font","fontSize","fontStyle","fontWeight","angle"],yte=["text","font","rotate","fontSize","fontStyle","fontWeight"];function zA(e){D.call(this,lte(),e)}zA.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:M4}]};ute(zA,D,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&cg("Wordcloud size dimensions must be non-zero.");function n(g){const p=e[g];return kv(p)&&t.modified(p.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||yte.some(n)))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||M4;let a=e.fontSize||14,u;if(kv(a)?u=e.fontSizeRange:a=ste(a),u){const g=a,p=ve("sqrt")().domain(ate(r,g)).range(u);a=m=>p(g(m))}r.forEach(g=>{g[o[0]]=NaN,g[o[1]]=NaN,g[o[3]]=0});const l=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Kn).layout(),c=s.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let g=0,p,m;g<h;++g)p=l[g],m=p.datum,m[o[0]]=p.x+f,m[o[1]]=p.y+d,m[o[2]]=p.font,m[o[3]]=p.size,m[o[4]]=p.style,m[o[5]]=p.weight,m[o[6]]=p.rotate;return t.reflow(i).modifies(o)}});const bte=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:zA},Symbol.toStringTag,{value:"Module"}));function kl(e,t,n){return e.fields=t||[],e.fname=n,e}function vte(e){return e.length===1?xte(e[0]):wte(e)}const xte=e=>function(t){return t[e]},wte=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function $y(e){throw Error(e)}function Ate(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||$y("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&$y("Access path missing closing bracket: "+e),i&&$y("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Ete(e,t,n){const i=Ate(e);return e=i.length===1?i[0]:e,kl((n&&n.get||vte)(i),[e],t||e)}Ete("id");kl(e=>e,[],"identity");kl(()=>0,[],"zero");kl(()=>1,[],"one");kl(()=>!0,[],"true");kl(()=>!1,[],"false");function $te(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function T4(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),$te(i,n)}const _te=e=>new Uint8Array(e),Ste=e=>new Uint16Array(e),Jc=e=>new Uint32Array(e);function Cte(){let e=8,t=[],n=Jc(0),i=Ch(0,e),r=Ch(0,e);return{data:()=>t,seen:()=>n=kte(n,t.length),add(s){for(let o=0,a=t.length,u=s.length,l;o<u;++o)l=s[o],l._index=a++,t.push(l)},remove(s,o){const a=t.length,u=Array(a-s),l=t;let c,f,d;for(f=0;!o[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){const a=i.length;(s>a||o>e)&&(e=Math.max(o,e),i=Ch(s,e,i),r=Ch(s,e))}}}function kte(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Ch(e,t,n){const i=(t<257?_te:t<65537?Ste:Jc)(e);return n&&i.set(n),i}function JC(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),u=r.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)s[u[d]]|=i;for(d=c;d<f;++d)s[u[d]]|=i;return o}}}function QC(){let e=Jc(0),t=[],n=0;function i(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=Jc(f);let h=Array(f),g,p,m;for(m=0;m<f;++m)h[m]=a(u[m]),d[m]=m;if(h=Fte(h,d),c)g=t,p=e,t=Array(c+f),e=Jc(c+f),Ote(l,g,p,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function r(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function s(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function o(a,u){let l;return u?l=u.length:(u=t,l=n),[GB(u,a[0],0,l),kg(u,a[1],0,l)]}return{insert:i,remove:r,bisect:o,reindex:s,index:()=>e,size:()=>n}}function Fte(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),XB(e,t)}function Ote(e,t,n,i,r,s,o,a,u){let l=0,c=0,f;for(f=0;l<i&&c<o;++f)t[l]<r[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=r[c],u[f]=s[c++]+e);for(;l<i;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)a[f]=r[c],u[f]=s[c]+e}function LA(e){D.call(this,Cte(),e),this._indices=null,this._dims=null}LA.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};T4(LA,D,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let a=0,u,l;for(;a<o;++a)u=n[a].fname,l=r[u]||(r[u]=QC()),s.push(JC(l,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=r.length,g={};let p,m,y,b,v,x,A,E,w;if(l.set(u),t.rem.length&&(v=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(x={},b=t.mod,A=0,E=b.length;A<E;++A)x[b[A]._index]=1;for(A=0;A<h;++A)w=i[A],(!o[A]||e.modified("fields",A)||t.modified(w.fields))&&(y=w.fname,(p=g[y])||(s[y]=m=QC(),g[y]=p=m.insert(w,t.source,0)),o[A]=JC(m,A,r[A]).onAdd(p,u));for(A=0,E=a.data().length;A<E;++A)v[A]||(l[A]!==u[A]?f.push(A):x[A]&&u[A]!==c&&d.push(A));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,u={},l=n.add,c=r.size()+i.length,f=s.length;let d=r.size(),h,g,p;r.resize(c,f),r.add(i);const m=r.curr(),y=r.prev(),b=r.all();for(h=0;h<f;++h)g=a[h].fname,p=u[g]||(u[g]=o[g].insert(a[h],i,d)),s[h].onAdd(p,m);for(;d<c;++d)y[d]=b,m[d]!==b&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,u,l;for(a=0,u=o.length;a<u;++a)l=o[a]._index,r[l]!==s&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),u={},l=n.rem,c=t.rem;let f,d,h,g;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=g=s[h],s[h]=a,g!==a&&l.push(h);for(h in i)i[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let a=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,a=0;l<o;++l)e.modified("query",l)&&(a|=i[l].one,this.incrementAll(i[l],r[l],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],g=l[1],p=e.one;let m,y,b;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)b=u[m],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=p;else if(f>h)for(m=h,y=Math.min(f,g);m<y;++m)b=u[m],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=p;if(d>g)for(m=Math.max(f,g),y=d;m<y;++m)b=u[m],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=p;else if(d<g)for(m=Math.max(h,d),y=g;m<y;++m)b=u[m],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=p;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,s=r.curr(),o=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let g,p,m;if(l<f)for(g=l,p=Math.min(f,c);g<p;++g)m=o[g],s[m]^=h,n.push(m);else if(l>f)for(g=f,p=Math.min(l,d);g<p;++g)m=o[g],s[m]^=h,i.push(m);if(c>d)for(g=Math.max(l,d),p=c;g<p;++g)m=o[g],s[m]^=h,n.push(m);else if(c<d)for(g=Math.max(f,c),p=d;g<p;++g)m=o[g],s[m]^=h,i.push(m);e.range=t.slice()}});function IA(e){D.call(this,null,e)}IA.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};T4(IA,D,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(!(r&n))return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),u=i.prev(),l=c=>a[c]&n?null:o[c];return s.filter(s.MOD,l),r&r-1?(s.filter(s.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?o[c]:null}),s.filter(s.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(s.filter(s.ADD,l),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>l(c._index))}});const Dte=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:LA,resolvefilter:IA},Symbol.toStringTag,{value:"Module"}));function Fl(e,t,n){return e.fields=t||[],e.fname=n,e}function Mte(e){return e.length===1?Tte(e[0]):Nte(e)}const Tte=e=>function(t){return t[e]},Nte=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Yi(e){throw Error(e)}function jte(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Yi("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Yi("Access path missing closing bracket: "+e),i&&Yi("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Rte(e,t,n){const i=jte(e);return e=i.length===1?i[0]:e,Fl((n&&n.get||Mte)(i),[e],t||e)}Rte("id");Fl(e=>e,[],"identity");Fl(()=>0,[],"zero");Fl(()=>1,[],"one");const Bte=Fl(()=>!0,[],"true");Fl(()=>!1,[],"false");var za=Array.isArray;function Fd(e){return e===Object(e)}function Pte(e){return e!=null?za(e)?e:[e]:[]}function zte(e){return typeof e=="function"}function ZC(e){return zte(e)?e:()=>e}function Lte(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function R0(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const Ite=Object.prototype.hasOwnProperty;function UA(e,t){return Ite.call(e,t)}function Ute(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),R0(i,n)}function N4(e){return Object.prototype.toString.call(e)==="[object Date]"}function B0(e){return typeof e=="string"}function j4(e){return za(e)?"["+e.map(j4)+"]":Fd(e)||B0(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function qte(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function Ol(e,t,n){return e.fields=t||[],e.fname=n,e}function Wte(e){return e.length===1?Hte(e[0]):Gte(e)}const Hte=e=>function(t){return t[e]},Gte=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Ls(e){throw Error(e)}function Yte(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Ls("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Ls("Access path missing closing bracket: "+e),i&&Ls("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function R4(e,t,n){const i=Yte(e);return e=i.length===1?i[0]:e,Ol((n&&n.get||Wte)(i),[e],t||e)}R4("id");const qA=Ol(e=>e,[],"identity");Ol(()=>0,[],"zero");Ol(()=>1,[],"one");const B4=Ol(()=>!0,[],"true");Ol(()=>!1,[],"false");var Qr=Array.isArray;function P0(e){return e===Object(e)}function Zs(e){return e[e.length-1]}function WA(e){return e==null||e===""?null:+e}const P4=e=>t=>e*Math.exp(t),z4=e=>t=>Math.log(e*t),L4=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),I4=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,z0=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function bm(e,t,n,i){const r=n(e[0]),s=n(Zs(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function Vte(e,t){return bm(e,t,WA,qA)}function Xte(e,t){var n=Math.sign(e[0]);return bm(e,t,z4(n),P4(n))}function Kte(e,t,n){return bm(e,t,z0(n),z0(1/n))}function Jte(e,t,n){return bm(e,t,L4(n),I4(n))}function vm(e,t,n,i,r){const s=i(e[0]),o=i(Zs(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function Qte(e,t,n){return vm(e,t,n,WA,qA)}function Zte(e,t,n){const i=Math.sign(e[0]);return vm(e,t,n,z4(i),P4(i))}function ene(e,t,n,i){return vm(e,t,n,z0(i),z0(1/i))}function tne(e,t,n,i){return vm(e,t,n,L4(i),I4(i))}function nne(e){return 1+~~(new Date(e).getMonth()/3)}function ine(e){return 1+~~(new Date(e).getUTCMonth()/3)}function L0(e){return e!=null?Qr(e)?e:[e]:[]}function rne(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function U4(e){return typeof e=="function"}function HA(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function sne(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}const one=Object.prototype.hasOwnProperty;function xm(e,t){return one.call(e,t)}function ane(e,t,n,i,r,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=Zs(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?i:c<=o?r:s}function une(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function lne(e){return typeof e=="boolean"}function q4(e){return Object.prototype.toString.call(e)==="[object Date]"}function W4(e){return typeof e=="number"}function cne(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Od(e){return typeof e=="string"}function fne(e,t){const n=e[0],i=Zs(e),r=+t;return r?r===1?i:n+r*(i-n):n}function kh(e,t){let n="";for(;--t>=0;)n+=e;return n}function dne(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:i==="left"?kh(r,o)+s:i==="center"?kh(r,~~(o/2))+s+kh(r,Math.ceil(o/2)):s+kh(r,o)}function hne(e){return e&&Zs(e)-e[0]||0}function Tf(e){return Qr(e)?"["+e.map(Tf)+"]":P0(e)||Od(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function gne(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const pne=e=>W4(e)||q4(e)?e:Date.parse(e);function mne(e,t){return t=t||pne,e==null||e===""?null:t(e)}function yne(e){return e==null||e===""?null:e+""}function bne(e,t,n,i){const r=i??"…",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:n==="left"?r+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function Dl(e,t,n){return e.fields=t||[],e.fname=n,e}function vne(e){return e.length===1?xne(e[0]):wne(e)}const xne=e=>function(t){return t[e]},wne=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function mi(e){throw Error(e)}function Ane(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||mi("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&mi("Access path missing closing bracket: "+e),i&&mi("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Ene(e,t,n){const i=Ane(e);return e=i.length===1?i[0]:e,Dl((n&&n.get||vne)(i),[e],t||e)}Ene("id");Dl(e=>e,[],"identity");Dl(()=>0,[],"zero");Dl(()=>1,[],"one");Dl(()=>!0,[],"true");Dl(()=>!1,[],"false");function ek(e){return typeof e=="function"}const $ne=Object.prototype.hasOwnProperty;function Fh(e,t){return $ne.call(e,t)}function _ne(e){return typeof e=="string"}function tk(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}const Sne="RawCode",Aa="Literal",Cne="Property",kne="Identifier",Fne="ArrayExpression",One="BinaryExpression",H4="CallExpression",Dne="ConditionalExpression",Mne="LogicalExpression",Tne="MemberExpression",Nne="ObjectExpression",jne="UnaryExpression";function Si(e){this.type=e}Si.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=Rne(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function Rne(e){switch(e.type){case Fne:return e.elements;case One:case Mne:return[e.left,e.right];case H4:return[e.callee].concat(e.arguments);case Dne:return[e.test,e.consequent,e.alternate];case Tne:return[e.object,e.property];case Nne:return e.properties;case Cne:return[e.key,e.value];case jne:return[e.argument];case kne:case Aa:case Sne:default:return[]}}var hr,H,T,Pt,$e,wm=1,Dd=2,Ea=3,po=4,Am=5,La=6,ln=7,Md=8,Bne=9;hr={};hr[wm]="Boolean";hr[Dd]="<end>";hr[Ea]="Identifier";hr[po]="Keyword";hr[Am]="Null";hr[La]="Numeric";hr[ln]="Punctuator";hr[Md]="String";hr[Bne]="RegularExpression";var Pne="ArrayExpression",zne="BinaryExpression",Lne="CallExpression",Ine="ConditionalExpression",G4="Identifier",Une="Literal",qne="LogicalExpression",Wne="MemberExpression",Hne="ObjectExpression",Gne="Property",Yne="UnaryExpression",ht="Unexpected token %0",Vne="Unexpected number",Xne="Unexpected string",Kne="Unexpected identifier",Jne="Unexpected reserved word",Qne="Unexpected end of input",Fv="Invalid regular expression",_y="Invalid regular expression: missing /",Y4="Octal literals are not allowed in strict mode.",Zne="Duplicate data property in object literal not allowed in strict mode",xt="ILLEGAL",Nf="Disabled.",eie=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),tie=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Em(e,t){if(!e)throw new Error("ASSERT: "+t)}function Or(e){return e>=48&&e<=57}function GA(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Qc(e){return"01234567".indexOf(e)>=0}function nie(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function jf(e){return e===10||e===13||e===8232||e===8233}function Td(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&eie.test(String.fromCharCode(e))}function I0(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&tie.test(String.fromCharCode(e))}const iie={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function V4(){for(;T<Pt;){const e=H.charCodeAt(T);if(nie(e)||jf(e))++T;else break}}function Ov(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)T<Pt&&GA(H[T])?(i=H[T++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):ye({},ht,xt);return String.fromCharCode(r)}function rie(){var e,t,n,i;for(e=H[T],t=0,e==="}"&&ye({},ht,xt);T<Pt&&(e=H[T++],!!GA(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&ye({},ht,xt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function X4(){var e,t;for(e=H.charCodeAt(T++),t=String.fromCharCode(e),e===92&&(H.charCodeAt(T)!==117&&ye({},ht,xt),++T,e=Ov("u"),(!e||e==="\\"||!Td(e.charCodeAt(0)))&&ye({},ht,xt),t=e);T<Pt&&(e=H.charCodeAt(T),!!I0(e));)++T,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),H.charCodeAt(T)!==117&&ye({},ht,xt),++T,e=Ov("u"),(!e||e==="\\"||!I0(e.charCodeAt(0)))&&ye({},ht,xt),t+=e);return t}function sie(){var e,t;for(e=T++;T<Pt;){if(t=H.charCodeAt(T),t===92)return T=e,X4();if(I0(t))++T;else break}return H.slice(e,T)}function oie(){var e,t,n;return e=T,t=H.charCodeAt(T)===92?X4():sie(),t.length===1?n=Ea:iie.hasOwnProperty(t)?n=po:t==="null"?n=Am:t==="true"||t==="false"?n=wm:n=Ea,{type:n,value:t,start:e,end:T}}function Sy(){var e=T,t=H.charCodeAt(T),n,i=H[T],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++T,{type:ln,value:String.fromCharCode(t),start:e,end:T};default:if(n=H.charCodeAt(T+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return T+=2,{type:ln,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:T};case 33:case 61:return T+=2,H.charCodeAt(T)===61&&++T,{type:ln,value:H.slice(e,T),start:e,end:T}}}if(o=H.substr(T,4),o===">>>=")return T+=4,{type:ln,value:o,start:e,end:T};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return T+=3,{type:ln,value:s,start:e,end:T};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return T+=2,{type:ln,value:r,start:e,end:T};if(r==="//"&&ye({},ht,xt),"<>=!+-*%&|^/".indexOf(i)>=0)return++T,{type:ln,value:i,start:e,end:T};ye({},ht,xt)}function aie(e){let t="";for(;T<Pt&&GA(H[T]);)t+=H[T++];return t.length===0&&ye({},ht,xt),Td(H.charCodeAt(T))&&ye({},ht,xt),{type:La,value:parseInt("0x"+t,16),start:e,end:T}}function uie(e){let t="0"+H[T++];for(;T<Pt&&Qc(H[T]);)t+=H[T++];return(Td(H.charCodeAt(T))||Or(H.charCodeAt(T)))&&ye({},ht,xt),{type:La,value:parseInt(t,8),octal:!0,start:e,end:T}}function nk(){var e,t,n;if(n=H[T],Em(Or(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=T,e="",n!=="."){if(e=H[T++],n=H[T],e==="0"){if(n==="x"||n==="X")return++T,aie(t);if(Qc(n))return uie(t);n&&Or(n.charCodeAt(0))&&ye({},ht,xt)}for(;Or(H.charCodeAt(T));)e+=H[T++];n=H[T]}if(n==="."){for(e+=H[T++];Or(H.charCodeAt(T));)e+=H[T++];n=H[T]}if(n==="e"||n==="E")if(e+=H[T++],n=H[T],(n==="+"||n==="-")&&(e+=H[T++]),Or(H.charCodeAt(T)))for(;Or(H.charCodeAt(T));)e+=H[T++];else ye({},ht,xt);return Td(H.charCodeAt(T))&&ye({},ht,xt),{type:La,value:parseFloat(e),start:t,end:T}}function lie(){var e="",t,n,i,r,s=!1;for(t=H[T],Em(t==="'"||t==='"',"String literal must starts with a quote"),n=T,++T;T<Pt;)if(i=H[T++],i===t){t="";break}else if(i==="\\")if(i=H[T++],!i||!jf(i.charCodeAt(0)))switch(i){case"u":case"x":H[T]==="{"?(++T,e+=rie()):e+=Ov(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Qc(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),T<Pt&&Qc(H[T])&&(s=!0,r=r*8+"01234567".indexOf(H[T++]),"0123".indexOf(i)>=0&&T<Pt&&Qc(H[T])&&(r=r*8+"01234567".indexOf(H[T++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&H[T]===`
`&&++T;else{if(jf(i.charCodeAt(0)))break;e+=i}return t!==""&&ye({},ht,xt),{type:Md,value:e,octal:s,start:n,end:T}}function cie(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";ye({},Fv)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{ye({},Fv)}try{return new RegExp(e,t)}catch{return null}}function fie(){var e,t,n,i,r;for(e=H[T],Em(e==="/","Regular expression literal must start with a slash"),t=H[T++],n=!1,i=!1;T<Pt;)if(e=H[T++],t+=e,e==="\\")e=H[T++],jf(e.charCodeAt(0))&&ye({},_y),t+=e;else if(jf(e.charCodeAt(0)))ye({},_y);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||ye({},_y),r=t.substr(1,t.length-2),{value:r,literal:t}}function die(){var e,t,n;for(t="",n="";T<Pt&&(e=H[T],!!I0(e.charCodeAt(0)));)++T,e==="\\"&&T<Pt?ye({},ht,xt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&ye({},Fv,n),{value:n,literal:t}}function hie(){var e,t,n,i;return $e=null,V4(),e=T,t=fie(),n=die(),i=cie(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:T}}function gie(e){return e.type===Ea||e.type===po||e.type===wm||e.type===Am}function K4(){if(V4(),T>=Pt)return{type:Dd,start:T,end:T};const e=H.charCodeAt(T);return Td(e)?oie():e===40||e===41||e===59?Sy():e===39||e===34?lie():e===46?Or(H.charCodeAt(T+1))?nk():Sy():Or(e)?nk():Sy()}function gn(){const e=$e;return T=e.end,$e=K4(),T=e.end,e}function J4(){const e=T;$e=K4(),T=e}function pie(e){const t=new Si(Pne);return t.elements=e,t}function ik(e,t,n){const i=new Si(e==="||"||e==="&&"?qne:zne);return i.operator=e,i.left=t,i.right=n,i}function mie(e,t){const n=new Si(Lne);return n.callee=e,n.arguments=t,n}function yie(e,t,n){const i=new Si(Ine);return i.test=e,i.consequent=t,i.alternate=n,i}function YA(e){const t=new Si(G4);return t.name=e,t}function Bc(e){const t=new Si(Une);return t.value=e.value,t.raw=H.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function rk(e,t,n){const i=new Si(Wne);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function bie(e){const t=new Si(Hne);return t.properties=e,t}function sk(e,t,n){const i=new Si(Gne);return i.key=t,i.value=n,i.kind=e,i}function vie(e,t){const n=new Si(Yne);return n.operator=e,n.argument=t,n.prefix=!0,n}function ye(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(Em(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=T,n.description=r,n}function $m(e){e.type===Dd&&ye(e,Qne),e.type===La&&ye(e,Vne),e.type===Md&&ye(e,Xne),e.type===Ea&&ye(e,Kne),e.type===po&&ye(e,Jne),ye(e,ht,e.value)}function zt(e){const t=gn();(t.type!==ln||t.value!==e)&&$m(t)}function Te(e){return $e.type===ln&&$e.value===e}function Cy(e){return $e.type===po&&$e.value===e}function xie(){const e=[];for(T=$e.start,zt("[");!Te("]");)Te(",")?(gn(),e.push(null)):(e.push($a()),Te("]")||zt(","));return gn(),pie(e)}function ok(){T=$e.start;const e=gn();return e.type===Md||e.type===La?(e.octal&&ye(e,Y4),Bc(e)):YA(e.value)}function wie(){var e,t,n,i;if(T=$e.start,e=$e,e.type===Ea)return n=ok(),zt(":"),i=$a(),sk("init",n,i);if(e.type===Dd||e.type===ln)$m(e);else return t=ok(),zt(":"),i=$a(),sk("init",t,i)}function Aie(){var e=[],t,n,i,r={},s=String;for(T=$e.start,zt("{");!Te("}");)t=wie(),t.key.type===G4?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?ye({},Zne):r[i]=!0,e.push(t),Te("}")||zt(",");return zt("}"),bie(e)}function Eie(){zt("(");const e=VA();return zt(")"),e}const $ie={if:1};function _ie(){var e,t,n;if(Te("("))return Eie();if(Te("["))return xie();if(Te("{"))return Aie();if(e=$e.type,T=$e.start,e===Ea||$ie[$e.value])n=YA(gn().value);else if(e===Md||e===La)$e.octal&&ye($e,Y4),n=Bc(gn());else{if(e===po)throw new Error(Nf);e===wm?(t=gn(),t.value=t.value==="true",n=Bc(t)):e===Am?(t=gn(),t.value=null,n=Bc(t)):Te("/")||Te("/=")?(n=Bc(hie()),J4()):$m(gn())}return n}function Sie(){const e=[];if(zt("("),!Te(")"))for(;T<Pt&&(e.push($a()),!Te(")"));)zt(",");return zt(")"),e}function Cie(){T=$e.start;const e=gn();return gie(e)||$m(e),YA(e.value)}function kie(){return zt("."),Cie()}function Fie(){zt("[");const e=VA();return zt("]"),e}function Oie(){var e,t,n;for(e=_ie();;)if(Te("."))n=kie(),e=rk(".",e,n);else if(Te("("))t=Sie(),e=mie(e,t);else if(Te("["))n=Fie(),e=rk("[",e,n);else break;return e}function ak(){const e=Oie();if($e.type===ln&&(Te("++")||Te("--")))throw new Error(Nf);return e}function dg(){var e,t;if($e.type!==ln&&$e.type!==po)t=ak();else{if(Te("++")||Te("--"))throw new Error(Nf);if(Te("+")||Te("-")||Te("~")||Te("!"))e=gn(),t=dg(),t=vie(e.value,t);else{if(Cy("delete")||Cy("void")||Cy("typeof"))throw new Error(Nf);t=ak()}}return t}function uk(e){let t=0;if(e.type!==ln&&e.type!==po)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Die(){var e,t,n,i,r,s,o,a,u,l;if(e=$e,u=dg(),i=$e,r=uk(i),r===0)return u;for(i.prec=r,gn(),t=[e,$e],o=dg(),s=[u,i,o];(r=uk($e))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=ik(a,u,o),s.push(n);i=gn(),i.prec=r,s.push(i),t.push($e),n=dg(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=ik(s[l-1].value,s[l-2],n),l-=2;return n}function $a(){var e,t,n;return e=Die(),Te("?")&&(gn(),t=$a(),zt(":"),n=$a(),e=yie(e,t,n)),e}function VA(){const e=$a();if(Te(","))throw new Error(Nf);return e}function Q4(e){H=e,T=0,Pt=H.length,$e=null,J4();const t=VA();if($e.type!==Dd)throw new Error("Unexpect token after expression.");return t}var Z4={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function eT(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&mi("Missing arguments to clamp function."),o.length>3&&mi("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&mi("Missing arguments to if function."),o.length>3&&mi("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Mie(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function tT(e){e=e||{};const t=e.allowed?tk(e.allowed):{},n=e.forbidden?tk(e.forbidden):{},i=e.constants||Z4,r=(e.functions||eT)(f),s=e.globalvar,o=e.fieldvar,a=ek(s)?s:g=>`${s}["${g}"]`;let u={},l={},c=0;function f(g){if(_ne(g))return g;const p=d[g.type];return p==null&&mi("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return c>0?p:Fh(n,p)?mi("Illegal identifier: "+p):Fh(i,p)?i[p]:Fh(t,p)?p:(u[p]=1,a(p))},MemberExpression:g=>{const p=!g.computed,m=f(g.object);p&&(c+=1);const y=f(g.property);return m===o&&(l[Mie(y)]=1),p&&(c-=1),m+(p?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&mi("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,y=Fh(r,p)&&r[p];return y||mi("Unrecognized function: "+p),ek(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(f).join(",")+"]",BinaryExpression:g=>"("+f(g.left)+" "+g.operator+" "+f(g.right)+")",UnaryExpression:g=>"("+g.operator+f(g.argument)+")",ConditionalExpression:g=>"("+f(g.test)+"?"+f(g.consequent)+":"+f(g.alternate)+")",LogicalExpression:g=>"("+f(g.left)+g.operator+f(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(f).join(",")+"}",Property:g=>{c+=1;const p=f(g.key);return c-=1,p+":"+f(g.value)}};function h(g){const p={code:f(g),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},p}return h.functions=r,h.constants=i,h}function ky(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Tie(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Nie(e){let t,n,i;e.length!==2?(t=ky,n=(a,u)=>ky(e(a),u),i=(a,u)=>e(a)-u):(t=e===ky||e===Tie?e:jie,n=e,i=e);function r(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){const f=r(a,u,l,c-1);return f>l&&i(a[f-1],u)>-i(a[f],u)?f-1:f}return{left:r,center:o,right:s}}function jie(){return 0}function Rie(e,...t){e=new Fg(e),t=t.map(Bie);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e}function Bie(e){return e instanceof Fg?e:new Fg(e)}function Pie(...e){const t=new Fg;for(const n of e)for(const i of n)t.add(i);return t}function Ml(e,t,n){return e.fields=t||[],e.fname=n,e}function zie(e){return e.length===1?Lie(e[0]):Iie(e)}const Lie=e=>function(t){return t[e]},Iie=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function hg(e){throw Error(e)}function Uie(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||hg("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&hg("Access path missing closing bracket: "+e),i&&hg("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Rf(e,t,n){const i=Uie(e);return e=i.length===1?i[0]:e,Ml((n&&n.get||zie)(i),[e],t||e)}Rf("id");Ml(e=>e,[],"identity");Ml(()=>0,[],"zero");Ml(()=>1,[],"one");Ml(()=>!0,[],"true");Ml(()=>!1,[],"false");var nT=Array.isArray;function qie(e){return e[e.length-1]}function Zo(e){return e==null||e===""?null:+e}function lk(e){return e!=null?nT(e)?e:[e]:[]}function Wie(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const Hie=Object.prototype.hasOwnProperty;function ck(e,t){return Hie.call(e,t)}function Oh(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function Fy(e){return Object.prototype.toString.call(e)==="[object Date]"}const XA="intersect",fk="union",Gie="vlMulti",Yie="vlPoint",dk="or",Vie="and",Bi="_vgsid_",Bf=Rf(Bi),Xie="E",Kie="R",Jie="R-E",Qie="R-LE",Zie="R-RE",U0="index:unit";function hk(e,t){for(var n=t.fields,i=t.values,r=n.length,s=0,o,a;s<r;++s)if(a=n[s],a.getter=Rf.getter||Rf(a.field),o=a.getter(e),Fy(o)&&(o=Zo(o)),Fy(i[s])&&(i[s]=Zo(i[s])),Fy(i[s][0])&&(i[s]=i[s].map(Zo)),a.type===Xie){if(nT(i[s])?i[s].indexOf(o)<0:o!==i[s])return!1}else if(a.type===Kie){if(!Oh(o,i[s]))return!1}else if(a.type===Zie){if(!Oh(o,i[s],!0,!1))return!1}else if(a.type===Jie){if(!Oh(o,i[s],!1,!1))return!1}else if(a.type===Qie&&!Oh(o,i[s],!1,!0))return!1;return!0}function ere(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],s=i?i[U0]&&i[U0].value:void 0,o=n===XA,a=r.length,u=0,l,c,f,d,h;u<a;++u)if(l=r[u],s&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=hk(t,l),c[d]=h?-1:++f,h&&s.size===1)return!0;if(!h&&f===s.get(d).count)return!1}else if(h=hk(t,l),o^h)return h;return a&&o}const iT=Nie(Bf),tre=iT.left,nre=iT.right;function ire(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[U0]&&i[U0].value:void 0,o=n===XA,a=Bf(t),u=tre(r,a);if(u===r.length||Bf(r[u])!==a)return!1;if(s&&o){if(s.size===1)return!0;if(nre(r,a)-u<s.size)return!1}return!0}function rre(e,t){return e.map(n=>Wie(t.fields?{values:t.fields.map(i=>(i.getter||(i.getter=Rf(i.field)))(n.datum))}:{[Bi]:Bf(n.datum)},t))}function sre(e,t,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],o={},a={},u={},l,c,f,d,h,g,p,m,y,b,v=s.length,x=0,A,E;x<v;++x)if(l=s[x],d=l.unit,c=l.fields,f=l.values,c&&f){for(A=0,E=c.length;A<E;++A)h=c[A],p=o[h.field]||(o[h.field]={}),m=p[d]||(p[d]=[]),u[h.field]=y=h.type.charAt(0),b=Oy[`${y}_union`],p[d]=b(m,lk(f[A]));n&&(m=a[d]||(a[d]=[]),m.push(lk(f).reduce((w,$,S)=>(w[c[S].field]=$,w),{})))}else h=Bi,g=Bf(l),p=o[h]||(o[h]={}),m=p[d]||(p[d]=[]),m.push(g),n&&(m=a[d]||(a[d]=[]),m.push({[Bi]:g}));if(t=t||fk,o[Bi]?o[Bi]=Oy[`${Bi}_${t}`](...Object.values(o[Bi])):Object.keys(o).forEach(w=>{o[w]=Object.keys(o[w]).map($=>o[w][$]).reduce(($,S)=>$===void 0?S:Oy[`${u[w]}_${t}`]($,S))}),s=Object.keys(a),n&&s.length){const w=i?Yie:Gie;o[w]=t===fk?{[dk]:s.reduce(($,S)=>($.push(...a[S]),$),[])}:{[Vie]:s.map($=>({[dk]:a[$]}))}}return o}var Oy={[`${Bi}_union`]:Pie,[`${Bi}_intersect`]:Rie,E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Zo(t[0]),i=Zo(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=Zo(t[0]),i=Zo(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const ore=":",are="@";function KA(e,t,n,i){t[0].type!==Aa&&hg("First argument to selection functions must be a string literal.");const r=t[0].value,s=t.length>=2&&qie(t).value,o="unit",a=are+o,u=ore+r;s===XA&&!ck(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),ck(i,u)||(i[u]=n.getData(r).tuplesRef())}function rT(e){const t=this.context.data[e];return t?t.values.value:[]}function ure(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function lre(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(B4).insert(t)),1}function cre(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const Nd=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},fre=Nd("format"),sT=Nd("timeFormat"),dre=Nd("utcFormat"),hre=Nd("timeParse"),gre=Nd("utcParse"),Dh=new Date(2e3,0,1);function _m(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Dh.setYear(2e3),Dh.setMonth(e),Dh.setDate(t),sT.call(this,Dh,n))}function pre(e){return _m.call(this,e,1,"%B")}function mre(e){return _m.call(this,e,1,"%b")}function yre(e){return _m.call(this,0,2+e,"%A")}function bre(e){return _m.call(this,0,2+e,"%a")}const vre=":",xre="@",Dv="%",oT="$";function JA(e,t,n,i){t[0].type!==Aa&&Ls("First argument to data functions must be a string literal.");const r=t[0].value,s=vre+r;if(!xm(s,i))try{i[s]=n.getData(r).tuplesRef()}catch{}}function wre(e,t,n,i){t[0].type!==Aa&&Ls("First argument to indata must be a string literal."),t[1].type!==Aa&&Ls("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o=xre+s;xm(o,i)||(i[o]=n.getData(r).indataRef(n,s))}function bn(e,t,n,i){if(t[0].type===Aa)gk(n,i,t[0].value);else for(e in n.scales)gk(n,i,e)}function gk(e,t,n){const i=Dv+n;if(!xm(t,i))try{t[i]=e.scaleRef(n)}catch{}}function rs(e,t){if(U4(e))return e;if(Od(e)){const n=t.scales[e];return n&&UW(n.value)?n.value:void 0}}function Are(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=bn,n._range=bn,n._scale=bn;const i=r=>"_["+(r.type===Aa?Tf(Dv+r.value):Tf(Dv)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function QA(e,t){return function(n,i,r){if(n){const s=rs(n,(r||this).context);return s&&s.path[e](i)}else return t(i)}}const Ere=QA("area",PX),$re=QA("bounds",UX),_re=QA("centroid",VX);function Sre(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function ZA(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function Cre(){return ZA(this.context.dataflow,"warn",arguments)}function kre(){return ZA(this.context.dataflow,"info",arguments)}function Fre(){return ZA(this.context.dataflow,"debug",arguments)}function Dy(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Mv(e){const t=Ys(e),n=Dy(t.r),i=Dy(t.g),r=Dy(t.b);return .2126*n+.7152*i+.0722*r}function Ore(e,t){const n=Mv(e),i=Mv(t),r=Math.max(n,i),s=Math.min(n,i);return(r+.05)/(s+.05)}function Dre(){const e=[].slice.call(arguments);return e.unshift({}),HA(...e)}function aT(e,t){return e===t||e!==e&&t!==t?!0:Qr(e)?Qr(t)&&e.length===t.length?Mre(e,t):!1:P0(e)&&P0(t)?uT(e,t):!1}function Mre(e,t){for(let n=0,i=e.length;n<i;++n)if(!aT(e[n],t[n]))return!1;return!0}function uT(e,t){for(const n in e)if(!aT(e[n],t[n]))return!1;return!0}function pk(e){return t=>uT(e,t)}function Tre(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],u=a.input,l=o.stamp();let c=a.changes,f,d;if(o._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(a.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{a.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?B4:Qr(n)||Op(n)?n:pk(n),c.remove(f)),t&&c.insert(t),i&&(f=pk(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in s)c.modify(r,d,s[d]);return 1}function Nre(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.hypot(n,i)}function jre(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const mk={};function Rre(e,t){const n=mk[t]||(mk[t]=R4(t));return Qr(e)?e.map(n):n(e)}function eE(e){return Qr(e)||ArrayBuffer.isView(e)?e:null}function tE(e){return eE(e)||(Od(e)?e:null)}function Bre(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return eE(e).join(...n)}function Pre(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return tE(e).indexOf(...n)}function zre(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return tE(e).lastIndexOf(...n)}function Lre(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return tE(e).slice(...n)}function Ire(e,t,n){return U4(n)&&Ls("Function argument passed to replace."),String(e).replace(t,n)}function Ure(e){return eE(e).slice().reverse()}function qre(e,t,n){return iw(e||0,t||0,n||0)}function Wre(e,t){const n=rs(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Hre(e,t){const n=rs(e,(t||this).context);return n?n.copy():void 0}function Gre(e,t){const n=rs(e,(t||this).context);return n?n.domain():[]}function Yre(e,t,n){const i=rs(e,(n||this).context);return i?Qr(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function Vre(e,t){const n=rs(e,(t||this).context);return n&&n.range?n.range():[]}function Xre(e,t,n){const i=rs(e,(n||this).context);return i?i(t):void 0}function Kre(e,t,n,i,r){e=rs(e,(r||this).context);const s=zM(t,n);let o=e.domain(),a=o[0],u=Zs(o),l=qA;return u-a?l=CM(e,a,u):e=(e.interpolator?ve("sequential")().interpolator(e.interpolator()):ve("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(o=e.ticks(+i||15),a!==o[0]&&o.unshift(a),u!==Zs(o)&&o.push(u)),o.forEach(c=>s.stop(l(c),e(c))),s}function Jre(e,t,n){const i=rs(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function Qre(e){let t=null;return function(n){return n?Ef(n,t=t||Bu(e)):e}}const lT=e=>e.data;function cT(e,t){const n=rT.call(t,e);return n.root&&n.root.lookup||{}}function Zre(e,t,n){const i=cT(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(lT):void 0}function ese(e,t){const n=cT(e,this)[t];return n?n.ancestors().map(lT):void 0}const fT=()=>typeof window<"u"&&window||null;function tse(){const e=fT();return e?e.screen:{}}function nse(){const e=fT();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function ise(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function dT(e,t,n){if(!e)return[];const[i,r]=e,s=new Je().set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return F6(o,s,rse(t))}function rse(e){let t=null;if(e){const n=L0(e.marktype),i=L0(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}function sse(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=L0(e);const r=e[e.length-1];return r===void 0||Math.hypot(r[0]-t,r[1]-n)>i?[...e,[t,n]]:e}function ose(e){return L0(e).reduce((t,n,i)=>{let[r,s]=n;return t+=i==0?`M ${r},${s} `:i===e.length-1?" Z":`L ${r},${s} `},"")}function ase(e,t,n){const{x:i,y:r,mark:s}=n,o=new Je().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[u,l]of t)u<o.x1&&(o.x1=u),u>o.x2&&(o.x2=u),l<o.y1&&(o.y1=l),l>o.y2&&(o.y2=l);return o.translate(i,r),dT([[o.x1,o.y1],[o.x2,o.y2]],e,s).filter(u=>use(u.x,u.y,t))}function use(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[o,a]=n[s],[u,l]=n[r];l>t!=a>t&&e<(o-u)*(t-l)/(a-l)+u&&i++}return i&1}const Pf={random(){return Kn()},cumulativeNormal:jp,cumulativeLogNormal:e2,cumulativeUniform:r2,densityNormal:Xx,densityLogNormal:Zx,densityUniform:i2,quantileNormal:Rp,quantileLogNormal:t2,quantileUniform:s2,sampleNormal:Np,sampleLogNormal:Qx,sampleUniform:n2,isArray:Qr,isBoolean:lne,isDate:q4,isDefined(e){return e!==void 0},isNumber:W4,isObject:P0,isRegExp:cne,isString:Od,isTuple:Op,isValid(e){return e!=null&&e===e},toBoolean:gne,toDate(e){return mne(e)},toNumber:WA,toString:yne,indexof:Pre,join:Bre,lastindexof:zre,replace:Ire,reverse:Ure,slice:Lre,flush:ane,lerp:fne,merge:Dre,pad:dne,peek:Zs,pluck:Rre,span:hne,inrange:une,truncate:bne,rgb:Ys,lab:qg,hcl:Wg,hsl:Ig,luminance:Mv,contrast:Ore,sequence:Tn,format:fre,utcFormat:dre,utcParse:gre,utcOffset:F3,utcSequence:M3,timeFormat:sT,timeParse:hre,timeOffset:k3,timeSequence:D3,timeUnitSpecifier:y3,monthFormat:pre,monthAbbrevFormat:mre,dayFormat:yre,dayAbbrevFormat:bre,quarter:nne,utcquarter:ine,week:v3,utcweek:A3,dayofyear:b3,utcdayofyear:w3,warn:Cre,info:kre,debug:Fre,extent(e){return sne(e)},inScope:Sre,intersect:dT,clampRange:rne,pinchDistance:Nre,pinchAngle:jre,screen:tse,containerSize:ise,windowSize:nse,bandspace:qre,setdata:lre,pathShape:Qre,panLinear:Vte,panLog:Xte,panPow:Kte,panSymlog:Jte,zoomLinear:Qte,zoomLog:Zte,zoomPow:ene,zoomSymlog:tne,encode:cre,modify:Tre,lassoAppend:sse,lassoPath:ose,intersectLasso:ase},lse=["view","item","group","xy","x","y"],cse="event.vega.",hT="this.",nE={},gT={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${Tf(oT+e)}]`,functions:fse,constants:Z4,visitors:nE},Tv=tT(gT);function fse(e){const t=eT(e);lse.forEach(n=>t[n]=cse+n);for(const n in Pf)t[n]=hT+n;return HA(t,Are(e,Pf,nE)),t}function et(e,t,n){return arguments.length===1?Pf[e]:(Pf[e]=t,n&&(nE[e]=n),Tv&&(Tv.functions[e]=hT+e),this)}et("bandwidth",Wre,bn);et("copy",Hre,bn);et("domain",Gre,bn);et("range",Vre,bn);et("invert",Yre,bn);et("scale",Xre,bn);et("gradient",Kre,bn);et("geoArea",Ere,bn);et("geoBounds",$re,bn);et("geoCentroid",_re,bn);et("geoShape",Jre,bn);et("indata",ure,wre);et("data",rT,JA);et("treePath",Zre,JA);et("treeAncestors",ese,JA);et("vlSelectionTest",ere,KA);et("vlSelectionIdTest",ire,KA);et("vlSelectionResolve",sre,KA);et("vlSelectionTuples",rre);function nr(e,t){const n={};let i;try{e=Od(e)?e:Tf(e)+"",i=Q4(e)}catch{Ls("Expression parse error: "+e)}i.visit(s=>{if(s.type!==H4)return;const o=s.callee.name,a=gT.visitors[o];a&&a(o,s.arguments,t,n)});const r=Tv(i);return r.globals.forEach(s=>{const o=oT+s;!xm(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:HA({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function gr(e,t,n){return e.fields=t||[],e.fname=n,e}function dse(e){return e==null?null:e.fields}function pT(e){return e.length===1?hse(e[0]):gse(e)}const hse=e=>function(t){return t[e]},gse=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function la(e){throw Error(e)}function mT(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||la("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&la("Access path missing closing bracket: "+e),i&&la("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function iE(e,t,n){const i=mT(e);return e=i.length===1?i[0]:e,gr((n&&n.get||pT)(i),[e],t||e)}iE("id");gr(e=>e,[],"identity");gr(()=>0,[],"zero");gr(()=>1,[],"one");const pse=gr(()=>!0,[],"true");gr(()=>!1,[],"false");var rE=Array.isArray;function sE(e){return e===Object(e)}function zf(e){return e!=null?rE(e)?e:[e]:[]}function mse(e){return typeof e=="function"}const yse="descending";function bse(e,t,n){n=n||{},t=zf(t)||[];const i=[],r=[],s={},o=n.comparator||vse;return zf(e).forEach((a,u)=>{a!=null&&(i.push(t[u]===yse?-1:1),r.push(a=mse(a)?a:iE(a,null,n)),(dse(a)||[]).forEach(l=>s[l]=1))}),r.length===0?null:gr(o(r,i),Object.keys(s))}const yT=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),vse=(e,t)=>e.length===1?xse(e[0],t[0]):wse(e,t,e.length),xse=(e,t)=>function(n,i){return yT(e(n),e(i))*t},wse=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=yT(s(i),s(r));return o*t[a]}),Ase=Object.prototype.hasOwnProperty;function Ese(e,t){return Ase.call(e,t)}function $se(e){return typeof e=="string"}function _se(e,t,n){e&&(e=t?zf(e).map(a=>a.replace(/\\(.)/g,"$1")):zf(e));const i=e&&e.length,r=n&&n.get||pT,s=a=>r(t?[a]:mT(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<i;)l+="|"+a[c](u);return l}}return gr(o,e,"key")}function Nv(e){return rE(e)?"["+e.map(Nv)+"]":sE(e)||$se(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function bT(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function Sse(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const Cse=bT(["rule"]),yk=bT(["group","image","rect"]);function kse(e,t){let n="";return Cse[t]||(e.x2&&(e.x?(yk[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(yk[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function oE(e){return(e+"").toLowerCase()}function Fse(e){return oE(e)==="operator"}function Ose(e){return oE(e)==="collect"}function uc(e,t,n){n.endsWith(";")||(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function Dse(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${i}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${i} : `}var Mse={operator:(e,t)=>uc(e,["_"],t.code),parameter:(e,t)=>uc(e,["datum","_"],t.code),event:(e,t)=>uc(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return uc(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+Nv(s)+"]";r+=`$=${i[s].code};if(${o}!==$)${o}=$,m=1;`}return r+=kse(i,n),r+="return m;",uc(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map(Nv).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=(s,o)=>{const a=t[o];let u,l;return s.path?(u=`a${s.path}`,l=`b${s.path}`):((n=n||{})["f"+o]=s,u=`this.f${o}(a)`,l=`this.f${o}(b)`),Dse(u,l,-a,a)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function Tse(e){const t=this;Fse(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Nse(e){const t=this;if(e.params){const n=t.get(e.id);n||la("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function jse(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=rE(r)?r.map(s=>bk(s,n,t)):bk(r,n,t)}return t}function bk(e,t,n){if(!e||!sE(e))return e;for(let i=0,r=vk.length,s;i<r;++i)if(s=vk[i],Ese(e,s.key))return s.parse(e,t,n);return e}var vk=[{key:"$ref",parse:Rse},{key:"$key",parse:Pse},{key:"$expr",parse:Bse},{key:"$field",parse:zse},{key:"$encode",parse:Ise},{key:"$compare",parse:Lse},{key:"$context",parse:Use},{key:"$subflow",parse:qse},{key:"$tupleid",parse:Wse}];function Rse(e,t){return t.get(e.$ref)||la("Operator not defined: "+e.$ref)}function Bse(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code;return t.fn[i]||(t.fn[i]=gr(t.parameterExpression(e.$expr),e.$fields))}function Pse(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=_se(e.$key,e.$flat,t.expr.codegen))}function zse(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=iE(e.$field,e.$name,t.expr.codegen))}function Lse(e,t){const n="c:"+e.$compare+"_"+e.$order,i=zf(e.$compare).map(r=>r&&r.$tupleid?V:r);return t.fn[n]||(t.fn[n]=bse(i,e.$order,t.expr.codegen))}function Ise(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=gr(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}function Use(e,t){return t}function qse(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(s),a.detachSubflow=()=>t.detach(o),a}}function Wse(){return V}function Hse(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(s=>t.get(s)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&la("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function Gse(e){var t=this,n=sE(n=e.source)?n.$ref:n,i=t.get(n),r=null,s=e.update,o=void 0;i||la("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)}const Yse={skip:!0};function Vse(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function Xse(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],Yse)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(pse).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}function vT(e,t,n,i){return new xT(e,t,n,i)}function xT(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Mse,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function xk(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}xT.prototype=xk.prototype={fork(){const e=new xk(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),Ose(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[oE(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Sse,parseOperator:Tse,parseOperatorParameters:Nse,parseParameters:jse,parseStream:Hse,parseUpdate:Gse,getState:Vse,setState:Xse};function Kse(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),wT(t,e.description()))}function wT(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Jse(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const My="default";function Qse(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:My,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,s=r?B0(r)?r:r.user:My,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return B0(i)||(r=i.item,i=i.user),jv(e,i&&i!==My?i:r||i),r},{cursor:t})}function jv(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function q0(e,t){var n=e._runtime.data;return UA(n,t)||Yi("Unrecognized data set: "+t),n[t]}function Zse(e,t){return arguments.length<2?q0(this,e).values.value:Sm.call(this,e,Ra().remove(Bte).insert(t))}function Sm(e,t){sD(t)||Yi("Second argument to changes must be a changeset.");const n=q0(this,e);return n.modified=!0,this.pulse(n.input,t)}function eoe(e,t){return Sm.call(this,e,Ra().insert(t))}function toe(e,t){return Sm.call(this,e,Ra().remove(t))}function AT(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function ET(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Cm(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function noe(e){var t=Cm(e),n=AT(e),i=ET(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}function ioe(e,t,n){var i=e._renderer,r=i&&i.canvas(),s,o,a;return r&&(a=Cm(e),o=t.changedTouches?t.changedTouches[0]:t,s=lm(o,r),s[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=roe(e,n,s),t}function roe(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(o){var a=i,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;B0(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:ZC(e),item:ZC(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}const wk="view",soe="timer",ooe="window",aoe={trap:!1};function uoe(e){const t=R0({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{za(i[s])&&(i[s]=qte(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function $T(e,t,n,i){e._eventListeners.push({type:n,sources:Pte(t),handler:i})}function loe(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function Mh(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||Fd(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function coe(e,t,n){var i=this,r=new Tp(n),s=function(l,c){i.runAsync(null,()=>{e===wk&&loe(i,t)&&l.preventDefault(),r.receive(ioe(i,l,c))})},o;if(e===soe)Mh(i,"timer",t)&&i.timer(s,t);else if(e===wk)Mh(i,"view",t)&&i.addEventListener(t,s,aoe);else if(e===ooe?Mh(i,"window",t)&&typeof window<"u"&&(o=[window]):typeof document<"u"&&Mh(i,"selector",t)&&(o=Array.from(document.querySelectorAll(e))),!o)i.warn("Can not resolve event source: "+e);else{for(var a=0,u=o.length;a<u;++a)o[a].addEventListener(t,s);$T(i,o,t,s)}return r}function Ak(e){return e.item}function Ek(e){return e.item.mark.source}function $k(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function foe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",Ak),Ek,$k(e)),this.on(this.events("view","mouseout",Ak),Ek,$k(t)),this}function doe(){var e=this._tooltip,t=this._timers,n=this._eventListeners,i,r,s;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(s=n[i],r=s.sources.length;--r>=0;)s.sources[r].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this}function Nn(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const hoe="vega-bind",goe="vega-bind-name",poe="vega-bind-radio";function moe(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=Lte(i.debounce,r.update))),(i.input==null&&i.element?yoe:voe)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function yoe(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),$T(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(boe(r))}}function boe(e){return typeof Event<"u"?new Event(e):{type:e}}function voe(e,t,n,i){const r=i.signal(n.signal),s=Nn("div",{class:hoe}),o=n.input==="radio"?s:s.appendChild(Nn("label"));o.appendChild(Nn("span",{class:goe},n.name||n.signal)),t.appendChild(s);let a=xoe;switch(n.input){case"checkbox":a=woe;break;case"select":a=Aoe;break;case"radio":a=Eoe;break;case"range":a=$oe;break}a(e,o,n,r)}function xoe(e,t,n,i){const r=Nn("input");for(const s in n)s!=="signal"&&s!=="element"&&r.setAttribute(s==="input"?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function woe(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=Nn("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function Aoe(e,t,n,i){const r=Nn("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const u={value:o};W0(o,i)&&(u.selected=!0),r.appendChild(Nn("option",u,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,u=n.options.length;a<u;++a)if(W0(n.options[a],o)){r.selectedIndex=a;return}}}function Eoe(e,t,n,i){const r=Nn("span",{class:poe}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const u={type:"radio",name:n.signal,value:o};W0(o,i)&&(u.checked=!0);const l=Nn("input",u);l.addEventListener("change",()=>e.update(o));const c=Nn("label",{},(s[a]||o)+"");return c.prepend(l),r.appendChild(c),l}),e.set=o=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)W0(a[l].value,o)&&(a[l].checked=!0)}}function $oe(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||qs(s,r,100),a=Nn("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const u=Nn("span",{},+i);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function W0(e,t){return e===t||e+""==t+""}function _T(e,t,n,i,r,s){return t=t||new i(e.loader()),t.initialize(n,AT(e),ET(e),Cm(e),r,s).background(e.background())}function aE(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function _oe(e,t,n,i){const r=new i(e.loader(),aE(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Cm(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}function Soe(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=cm(i);e=n._el=e?Ty(n,e,!0):null,Kse(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||Ed,a=e?s.renderer:s.headless;return n._renderer=a?_T(n,n._renderer,e,a):null,n._handler=_oe(n,n._handler,e,o),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=Ty(n,t,!0):e.appendChild(Nn("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=Ty(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{moe(n,u.element||t,u)})),n}function Ty(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const lc=e=>+e||0,Coe=e=>({top:e,bottom:e,left:e,right:e});function _k(e){return Fd(e)?{top:lc(e.top),bottom:lc(e.bottom),left:lc(e.left),right:lc(e.right)}:Coe(lc(e))}async function uE(e,t,n,i){const r=cm(t),s=r&&r.headless;return s||Yi("Unrecognized renderer type: "+t),await e.runAsync(),_T(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}async function koe(e,t){e!==Ss.Canvas&&e!==Ss.SVG&&e!==Ss.PNG&&Yi("Unrecognized image type: "+e);const n=await uE(this,e,t);return e===Ss.SVG?Foe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Foe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Ooe(e,t){return(await uE(this,Ss.Canvas,e,t)).canvas()}async function Doe(e){return(await uE(this,Ss.SVG,e)).svg()}function Moe(e,t,n){return vT(e,Ou,Pf,n).parse(t)}function Toe(e){var t=this._runtime.scales;return UA(t,e)||Yi("Unrecognized scale or projection: "+e),t[e].value}var ST="width",CT="height",lE="padding",Sk={skip:!0};function kT(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===lE?i.left+i.right:0)}function FT(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===lE?i.top+i.bottom:0)}function Noe(e){var t=e._signals,n=t[ST],i=t[CT],r=t[lE];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=kT(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=FT(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}function joe(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(ST,n,Sk),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal(CT,i,Sk),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(u=>u.resize())},!1,1)}function Roe(e){return this._runtime.getState(e||{data:Boe,signals:Poe,recurse:!0})}function Boe(e,t){return t.modified&&za(t.input.value)&&e.indexOf("_:vega:_")}function Poe(e,t){return!(e==="parent"||t instanceof Ou.proxy)}function zoe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Loe(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(uQ(n,t))}function Ioe(e,t,n,i){const r=e.element();r&&r.setAttribute("title",Uoe(i))}function Uoe(e){return e==null?"":za(e)?OT(e):Fd(e)&&!N4(e)?qoe(e):e+""}function qoe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(za(n)?OT(n):DT(n))}).join(`
`)}function OT(e){return"["+e.map(DT).join(", ")+"]"}function DT(e){return za(e)?"[…]":Fd(e)&&!N4(e)?"{…}":e}function MT(e,t){const n=this;if(t=t||{},yu.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=R0({},e.locale,t.locale);n.locale(X3(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Ss.Canvas,n._scenegraph=new Tw;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Ioe,n._redraw=!0,n._handler=new Ed().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=uoe(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=Moe(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:R0({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=kT(n,n._width),n._viewHeight=FT(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Noe(n),Jse(n),Qse(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function Th(e,t){return UA(e._signals,t)?e._signals[t]:Yi("Unrecognized signal name: "+j4(t))}function TT(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function Ck(e,t,n,i){let r=TT(n,i);return r||(r=aE(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function kk(e,t,n){const i=TT(t,n);return i&&t._targets.remove(i),e}Ute(MT,yu,{async evaluate(e,t,n){if(await yu.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,noe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Gh(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&wT(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=Th(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",_k(e)):_k(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(cm(e)||Yi("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(yu.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Th(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:joe,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=aE(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,s;--i>=0;)if(s=n[i].type,r=n[i].handler,e===s&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return Ck(this,e,Th(this,e),t)},removeSignalListener(e,t){return kk(this,Th(this,e),t)},addDataListener(e,t){return Ck(this,e,q0(this,e).values,t)},removeDataListener(e,t){return kk(this,q0(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=jv(this,null);this._globalCursor=!!e,t&&jv(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Loe,events:coe,finalize:doe,hover:foe,data:Zse,change:Sm,insert:eoe,remove:toe,scale:Toe,initialize:Soe,toImageURL:koe,toCanvas:Ooe,toSVG:Doe,getState:Roe,setState:zoe});function Tl(e,t,n){return e.fields=t||[],e.fname=n,e}function Woe(e){return e.length===1?Hoe(e[0]):Goe(e)}const Hoe=e=>function(t){return t[e]},Goe=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function re(e){throw Error(e)}function NT(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||re("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&re("Access path missing closing bracket: "+e),i&&re("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Yoe(e,t,n){const i=NT(e);return e=i.length===1?i[0]:e,Tl((n&&n.get||Woe)(i),[e],t||e)}Yoe("id");Tl(e=>e,[],"identity");Tl(()=>0,[],"zero");Tl(()=>1,[],"one");Tl(()=>!0,[],"true");Tl(()=>!1,[],"false");var gt=Array.isArray;function De(e){return e===Object(e)}const Fk=e=>e!=="__proto__";function Voe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const s in r)if(s==="signals")i.signals=Xoe(i.signals,r.signals);else{const o=s==="legend"?{layout:1}:s==="style"?!0:null;jT(i,s,r[s],o)}return i},{})}function jT(e,t,n,i){if(!Fk(t))return;let r,s;if(De(n)&&!gt(n)){s=De(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?jT(s,r,n[r]):Fk(r)&&(s[r]=n[r])}else e[t]=n}function Xoe(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function Zc(e){return e[e.length-1]}function Dt(e){return e!=null?gt(e)?e:[e]:[]}function Ge(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}const Koe=Object.prototype.hasOwnProperty;function Dn(e,t){return Koe.call(e,t)}function $i(e){return typeof e=="string"}function ie(e){return gt(e)?"["+e.map(ie)+"]":De(e)||$i(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}const Joe="view",H0="[",G0="]",RT="{",BT="}",Qoe=":",PT=",",Zoe="@",eae=">",tae=/[[\]{}]/,nae={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let zT,LT;function iae(e,t,n){return zT=t||Joe,LT=n||nae,IT(e.trim()).map(Rv)}function rae(e){return LT[e]}function ef(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function IT(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=ef(e,r,PT,H0+RT,G0+BT),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function Rv(e){return e[0]==="["?sae(e):oae(e)}function sae(e){const t=e.length;let n=1,i;if(n=ef(e,n,G0,H0,G0),n===t)throw"Empty between selector: "+e;if(i=IT(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==eae)throw"Expected '>' after between selector: "+e;i=i.map(Rv);const r=Rv(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function oae(e){const t={source:zT},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===BT){if(a=e.lastIndexOf(RT),a>=0){try{i=aae(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===Zoe&&(r=++a),u=ef(e,a,Qoe),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=ef(e,a,H0),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=ef(e,a,G0),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==H0)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||tae.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):rae(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function aae(e){const t=e.split(PT);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function uae(e){return De(e)?e:{type:e||"pad"}}const cc=e=>+e||0,lae=e=>({top:e,bottom:e,left:e,right:e});function cae(e){return De(e)?e.signal?e:{top:cc(e.top),bottom:cc(e.bottom),left:cc(e.left),right:cc(e.right)}:lae(cc(e))}const pt=e=>De(e)&&!gt(e)?Ge({},e):{value:e};function Ok(e,t,n,i){return n!=null?(De(n)&&!gt(n)||gt(n)&&n.length&&De(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function $t(e,t,n){for(const i in t)Ok(e,i,t[i]);for(const i in n)Ok(e,i,n[i],"update")}function Nl(e,t,n){for(const i in t)n&&Dn(n,i)||(e[i]=Ge(e[i]||{},t[i]));return e}function lu(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const cE="mark",fE="frame",dE="scope",fae="axis",dae="axis-domain",hae="axis-grid",gae="axis-label",pae="axis-tick",mae="axis-title",yae="legend",bae="legend-band",vae="legend-entry",xae="legend-gradient",UT="legend-label",wae="legend-symbol",Aae="legend-title",Eae="title",$ae="title-text",_ae="title-subtitle";function Sae(e,t,n,i,r){const s={},o={};let a,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!lu(u,e)&&Ny(s,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===fE?r.group:n===cE?Ge({},r.mark,r[t]):null;for(u in c)l=lu(u,e)||(u==="fill"||u==="stroke")&&(lu("fill",e)||lu("stroke",e)),l||Ny(s,u,c[u]);Dt(i).forEach(f=>{const d=r.style&&r.style[f];for(const h in d)lu(h,e)||Ny(s,h,d[h])}),e=Ge({},e);for(u in s)c=s[u],c.signal?(a=a||{})[u]=c:o[u]=c;return e.enter=Ge(o,e.enter),a&&(e.update=Ge(a,e.update)),e}function Ny(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const qT=e=>$i(e)?ie(e):e.signal?`(${e.signal})`:WT(e);function km(e){if(e.gradient!=null)return kae(e);let t=e.signal?`(${e.signal})`:e.color?Cae(e.color):e.field!=null?WT(e.field):e.value!==void 0?ie(e.value):void 0;return e.scale!=null&&(t=Fae(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${gg(e.exponent)})`),e.mult!=null&&(t+=`*${gg(e.mult)}`),e.offset!=null&&(t+=`+${gg(e.offset)}`),e.round&&(t=`round(${t})`),t}const Nh=(e,t,n,i)=>`(${e}(${[t,n,i].map(km).join(",")})+'')`;function Cae(e){return e.c?Nh("hcl",e.h,e.c,e.l):e.h||e.s?Nh("hsl",e.h,e.s,e.l):e.l||e.a?Nh("lab",e.l,e.a,e.b):e.r||e.g||e.b?Nh("rgb",e.r,e.g,e.b):null}function kae(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ie(n));for(;t.length&&Zc(t)==null;)t.pop();return t.unshift(qT(e.gradient)),`gradient(${t.join(",")})`}function gg(e){return De(e)?"("+km(e)+")":e}function WT(e){return HT(De(e)?e:{datum:e})}function HT(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):re("Invalid field reference: "+ie(e));return e.signal||(i=$i(i)?NT(i).map(ie).join("]["):HT(i)),t+"["+i+"]"}function Fae(e,t){const n=qT(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+gg(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Oae(e){let t="";return e.forEach(n=>{const i=km(n);t+=n.test?`(${n.test})?${i}:`:i}),Zc(t)===":"&&(t+="null"),t}function GT(e,t,n,i,r,s){const o={};s=s||{},s.encoders={$encode:o},e=Sae(e,t,n,i,r.config);for(const a in e)o[a]=Dae(e[a],t,s,r);return s}function Dae(e,t,n,i){const r={},s={};for(const o in e)e[o]!=null&&(r[o]=Tae(Mae(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function Mae(e){return gt(e)?Oae(e):km(e)}function Tae(e,t,n,i){const r=nr(e,t);return r.$fields.forEach(s=>i[s]=1),Ge(n,r.$params),r.$expr}const Nae="outer",jae=["value","update","init","react","bind"];function Dk(e,t){re(e+' for "outer" push: '+ie(t))}function YT(e,t){const n=e.name;if(e.push===Nae)t.signals[n]||Dk("No prior signal definition",n),jae.forEach(i=>{e[i]!==void 0&&Dk("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function Bv(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function Fm(e,t,n,i){return new Bv(e,t,n,i)}function Y0(e,t){return Fm("operator",e,t)}function Y(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Lf(e,t){return t?{$field:e,$name:t}:{$field:e}}const Pv=Lf("key");function Mk(e,t){return{$compare:e,$order:t}}function Rae(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const Bae="ascending",Pae="descending";function zae(e){return De(e)?(e.order===Pae?"-":"+")+Om(e.op,e.field):""}function Om(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const hE="scope",zv="view";function st(e){return e&&e.signal}function Lae(e){return e&&e.expr}function pg(e){if(st(e))return!0;if(De(e)){for(const t in e)if(pg(e[t]))return!0}return!1}function ai(e,t){return e??t}function ca(e){return e&&e.signal||e}const Tk="timer";function If(e,t){return(e.merge?Uae:e.stream?qae:e.type?Wae:re("Invalid stream specification: "+ie(e)))(e,t)}function Iae(e){return e===hE?zv:e||zv}function Uae(e,t){const n=e.merge.map(r=>If(r,t)),i=gE({merge:n},e,t);return t.addStream(i).id}function qae(e,t){const n=If(e.stream,t),i=gE({stream:n},e,t);return t.addStream(i).id}function Wae(e,t){let n;e.type===Tk?(n=t.event(Tk,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Iae(e.source),e.type);const i=gE({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function gE(e,t,n){let i=t.between;return i&&(i.length!==2&&re('Stream "between" parameter must have 2 entries: '+ie(t)),e.between=[If(i[0],n),If(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(Hae(t.marktype,t.markname,t.markrole)),t.source===hE&&i.push("inScope(event.item)"),i.length&&(e.filter=nr("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function Hae(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const Gae={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Yae(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||re("Signal update missing events specification."),$i(s)&&(s=iae(s,t.isSubscope()?hE:zv)),s=Dt(s).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[Xae(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),i!=null&&(o&&re("Signal encode and update are mutually exclusive."),o="encode(item(),"+ie(i)+")"),r.update=$i(o)?nr(o,t):o.expr!=null?nr(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:Gae,$params:{$value:t.signalRef(o.signal)}}:re("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(u=>t.addUpdate(Ge(Vae(u,t),r)))}function Vae(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):If(e,t)}}function Xae(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Kae(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?re("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=nr(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>Yae(r,t,n.id))}const Se=e=>(t,n,i)=>Fm(e,n,t||void 0,i),VT=Se("aggregate"),Jae=Se("axisticks"),XT=Se("bound"),Ci=Se("collect"),Nk=Se("compare"),Qae=Se("datajoin"),KT=Se("encode"),Zae=Se("expression"),eue=Se("facet"),tue=Se("field"),nue=Se("key"),iue=Se("legendentries"),rue=Se("load"),sue=Se("mark"),oue=Se("multiextent"),aue=Se("multivalues"),uue=Se("overlap"),lue=Se("params"),JT=Se("prefacet"),cue=Se("projection"),fue=Se("proxy"),due=Se("relay"),QT=Se("render"),hue=Se("scale"),Ia=Se("sieve"),gue=Se("sortitems"),ZT=Se("viewlayout"),pue=Se("values");let mue=0;const e9={min:"min",max:"max",count:"sum"};function yue(e,t){const n=e.type||"linear";wM(n)||re("Unrecognized scale type: "+ie(n)),t.addScale(e.name,{type:n,domain:void 0})}function bue(e,t){const n=t.getScale(e.name).params;let i;n.domain=t9(e.domain,e,t),e.range!=null&&(n.range=i9(e,t,n)),e.interpolate!=null&&kue(e.interpolate,n),e.nice!=null&&(n.nice=Cue(e.nice)),e.bins!=null&&(n.bins=Sue(e.bins,t));for(i in e)Dn(n,i)||i==="name"||(n[i]=Hn(e[i],t))}function Hn(e,t){return De(e)?e.signal?t.signalRef(e.signal):re("Unsupported object: "+ie(e)):e}function mg(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Hn(n,t))}function Dm(e){re("Can not find data set: "+ie(e))}function t9(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&re("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(gt(e)?vue:e.fields?wue:xue)(e,t,n)}function vue(e,t,n){return e.map(i=>Hn(i,n))}function xue(e,t,n){const i=n.getData(e.data);return i||Dm(e.data),Ru(t.type)?i.valuesRef(n,e.field,n9(e.sort,!1)):$M(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function wue(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=$i(o)?{data:i,field:o}:gt(o)||o.signal?Aue(o,n):o,s.push(o),s),[]);return(Ru(t.type)?Eue:$M(t.type)?$ue:_ue)(e,n,r)}function Aue(e,t){const n="_:vega:_"+mue++,i=Ci({});if(gt(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+ie(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Ia({})]),{data:n,field:"data"}}function Eue(e,t,n){const i=n9(e.sort,!0);let r,s;const o=n.map(l=>{const c=t.getData(l.data);return c||Dm(l.data),c.countsRef(t,l.field,i)}),a={groupby:Pv,pulse:o};i&&(r=i.op||"count",s=i.field?Om(r,i.field):"count",a.ops=[e9[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(VT(a));const u=t.add(Ci({pulse:Y(r)}));return s=t.add(pue({field:Pv,sort:t.sortRef(i),pulse:Y(u)})),Y(s)}function n9(e,t){return e&&(!e.field&&!e.op?De(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?re("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!e9[e.op]&&re("Multiple domain scales can not be sorted using "+e.op)),e}function $ue(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||Dm(r.data),s.domainRef(t,r.field)});return Y(t.add(aue({values:i})))}function _ue(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||Dm(r.data),s.extentRef(t,r.field)});return Y(t.add(oue({extents:i})))}function Sue(e,t){return e.signal||gt(e)?mg(e,t):t.objectProperty(e)}function Cue(e){return De(e)?{interval:Hn(e.interval),step:Hn(e.step)}:Hn(e)}function kue(e,t){t.interpolate=Hn(e.type||e),e.gamma!=null&&(t.interpolateGamma=Hn(e.gamma))}function i9(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if($i(r)){if(i&&Dn(i,r))return e=Ge({},e,{range:i[r]}),i9(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Ru(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:re("Unrecognized scale range value: "+ie(r))}else if(r.scheme){n.scheme=gt(r.scheme)?mg(r.scheme,t):Hn(r.scheme,t),r.extent&&(n.schemeExtent=mg(r.extent,t)),r.count&&(n.schemeCount=Hn(r.count,t));return}else if(r.step){n.rangeStep=Hn(r.step,t);return}else{if(Ru(e.type)&&!gt(r))return t9(r,e,t);gt(r)||re("Unsupported range type: "+ie(r))}return r.map(s=>(gt(s)?mg:Hn)(s,t))}function Fue(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=Lv(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=Lv(n[r],r,t));t.addProjection(e.name,i)}function Lv(e,t,n){return gt(e)?e.map(i=>Lv(i,t,n)):De(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:re("Unsupported parameter object: "+ie(e)):e}const ki="top",jl="left",Rl="right",eo="bottom",r9="center",Oue="vertical",Due="start",Mue="middle",Tue="end",Iv="index",pE="label",Nue="offset",Gu="perc",jue="perc2",Yn="value",jd="guide-label",mE="guide-title",Rue="group-title",Bue="group-subtitle",jk="symbol",yg="gradient",Uv="discrete",qv="size",Pue="shape",zue="fill",Lue="stroke",Iue="strokeWidth",Uue="strokeDash",que="opacity",yE=[qv,Pue,zue,Lue,Iue,Uue,que],Rd={name:1,style:1,interactive:1},ge={value:0},Vn={value:1},Mm="group",s9="rect",bE="rule",Wue="symbol",Ua="text";function Uf(e){return e.type=Mm,e.interactive=e.interactive||!1,e}function _n(e,t){const n=(i,r)=>ai(e[i],ai(t[i],r));return n.isVertical=i=>Oue===ai(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>ai(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>ai(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>ai(e.columns,ai(t.columns,+n.isVertical(!0))),n}function o9(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Hue(e,t,n){const i=t.config.style[n];return i&&i[e]}function Tm(e,t,n){return`item.anchor === '${Due}' ? ${e} : item.anchor === '${Tue}' ? ${t} : ${n}`}const vE=Tm(ie(jl),ie(Rl),ie(r9));function Gue(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},De(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function a9(e,t){return t?e?De(e)?Object.assign({},e,{offset:a9(e.offset,t)}):{value:e,offset:t}:t:e}function zn(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Nl(e.encode,t,Rd)):e.interactive=!1,e}function Yue(e,t,n,i){const r=_n(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let u,l,c,f,d;s?(l=[0,1],c=[0,0],f=o,d=a):(l=[0,0],c=[1,0],f=a,d=o);const h={enter:u={opacity:ge,x:ge,y:ge,width:pt(f),height:pt(d)},update:Ge({},u,{opacity:Vn,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:ge}};return $t(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),zn({type:s9,role:xae,encode:h},i)}function Vue(e,t,n,i,r){const s=_n(e,n),o=s.isVertical(),a=s.gradientThickness(),u=s.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const g={opacity:ge,fill:{scale:t,field:Yn}};g[l]={signal:h+"datum."+Gu,mult:u},g[c]=ge,g[f]={signal:h+"datum."+jue,mult:u},g[d]=pt(a);const p={enter:g,update:Ge({},g,{opacity:Vn}),exit:{opacity:ge}};return $t(p,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),zn({type:s9,role:bae,key:Yn,from:r,encode:p},i)}const Xue=`datum.${Gu}<=0?"${jl}":datum.${Gu}>=1?"${Rl}":"${r9}"`,Kue=`datum.${Gu}<=0?"${eo}":datum.${Gu}>=1?"${ki}":"${Mue}"`;function Rk(e,t,n,i){const r=_n(e,t),s=r.isVertical(),o=pt(r.gradientThickness()),a=r.gradientLength();let u=r("labelOverlap"),l,c,f,d,h="";const g={enter:l={opacity:ge},update:c={opacity:Vn,text:{field:pE}},exit:{opacity:ge}};return $t(g,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:ai(e.labelLimit,t.gradientLabelLimit)}),s?(l.align={value:"left"},l.baseline=c.baseline={signal:Kue},f="y",d="x",h="1-"):(l.align=c.align={signal:Xue},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+Gu,mult:a},l[d]=c[d]=o,o.offset=ai(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+Iv}:void 0,zn({type:Ua,role:UT,style:jd,key:Yn,from:i,encode:g,overlap:u},n)}function Jue(e,t,n,i,r){const s=_n(e,t),o=n.entries,a=!!(o&&o.interactive),u=o?o.name:void 0,l=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},d=`(${r}) ? datum.${Nue} : datum.${qv}`,h=l?pt(l):{field:qv},g=`datum.${Iv}`,p=`max(1, ${r})`;let m,y,b,v,x;h.mult=.5,m={enter:y={opacity:ge,x:{signal:d,mult:.5,offset:c},y:h},update:b={opacity:Vn,x:y.x,y:y.y},exit:{opacity:ge}};let A=null,E=null;e.fill||(A=t.symbolBaseFillColor,E=t.symbolBaseStrokeColor),$t(m,{fill:s("symbolFillColor",A),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",E),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),yE.forEach(_=>{e[_]&&(b[_]=y[_]={scale:e[_],field:Yn})});const w=zn({type:Wue,role:wae,key:Yn,from:f,clip:l?!0:void 0,encode:m},n.symbols),$=pt(c);$.offset=s("labelOffset"),m={enter:y={opacity:ge,x:{signal:d,offset:$},y:h},update:b={opacity:Vn,text:{field:pE},x:y.x,y:y.y},exit:{opacity:ge}},$t(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const S=zn({type:Ua,role:UT,style:jd,key:Yn,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:ge,height:l?pt(l):ge,opacity:ge},exit:{opacity:ge},update:b={opacity:Vn,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(v=`ceil(item.mark.items.length / ${p})`,b.row.signal=`${g}%${v}`,b.column.signal=`floor(${g} / ${v})`,x={field:["row",g]}):(b.row.signal=`floor(${g} / ${p})`,b.column.signal=`${g} % ${p}`,x={field:g}),b.column.signal=`(${r})?${b.column.signal}:${g}`,i={facet:{data:i,name:"value",groupby:Iv}},Uf({role:dE,from:i,encode:Nl(m,o,Rd),marks:[w,S],name:u,interactive:a,sort:x})}function Que(e,t){const n=_n(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const xE='item.orient === "left"',wE='item.orient === "right"',Nm=`(${xE} || ${wE})`,Zue=`datum.vgrad && ${Nm}`,ele=Tm('"top"','"bottom"','"middle"'),tle=Tm('"right"','"left"','"center"'),nle=`datum.vgrad && ${wE} ? (${tle}) : (${Nm} && !(datum.vgrad && ${xE})) ? "left" : ${vE}`,ile=`item._anchor || (${Nm} ? "middle" : "start")`,rle=`${Zue} ? (${xE} ? -90 : 90) : 0`,sle=`${Nm} ? (datum.vgrad ? (${wE} ? "bottom" : "top") : ${ele}) : "top"`;function ole(e,t,n,i){const r=_n(e,t),s={enter:{opacity:ge},update:{opacity:Vn,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:ge}};return $t(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:ile},angle:{signal:rle},align:{signal:nle},baseline:{signal:sle},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),zn({type:Ua,role:Aae,style:mE,from:i,encode:s},n)}function ale(e,t){let n;return De(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Bk(e.path)+")":e.sphere&&(n="geoShape("+Bk(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Bk(e){return De(e)&&e.signal?e.signal:ie(e)}function u9(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===Mm?dE:t||cE}function ule(e){return{marktype:e.type,name:e.name||void 0,role:e.role||u9(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function lle(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function AE(e,t){const n=uD(e.type);n||re("Unrecognized transform type: "+ie(e.type));const i=Fm(n.type.toLowerCase(),null,l9(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function l9(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=cle(o,t,n)}return i}function cle(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return fle(e,t,n);if(r===void 0){e.required&&re("Missing required "+ie(t.type)+" parameter: "+ie(e.name));return}else{if(i==="param")return dle(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!st(r)?r.map(s=>Pk(e,s,n)):Pk(e,r,n)}function Pk(e,t,n){const i=e.type;if(st(t))return Lk(i)?re("Expression references can not be signals."):jy(i)?n.fieldRef(t):Ik(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||jy(i);return r&&hle(t)?n.exprRef(t.expr,t.as):r&&gle(t)?Lf(t.field,t.as):Lk(i)?nr(t,n):ple(i)?Y(n.getData(t).values):jy(i)?Lf(t):Ik(i)?n.compareRef(t):t}}function fle(e,t,n){return $i(t.from)||re('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function dle(e,t,n){const i=t[e.name];return e.array?(gt(i)||re("Expected an array of sub-parameters. Instead: "+ie(i)),i.map(r=>zk(e,r,n))):zk(e,i,n)}function zk(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||re("Unsupported parameter: "+ie(t));const s=Ge(l9(r,t,n),r.key);return Y(n.add(lue(s)))}const hle=e=>e&&e.expr,gle=e=>e&&e.field,ple=e=>e==="data",Lk=e=>e==="expr",jy=e=>e==="field",Ik=e=>e==="compare";function mle(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||re("Only group marks can be faceted."),i.field!=null?o=a=bg(i,n):(e.data?a=Y(n.getData(e.data).aggregate):(s=AE(Ge({type:"aggregate",groupby:Dt(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=bg(i,n),o=a=Y(n.add(s))),r=n.keyRef(i.groupby,!0))):o=Y(n.add(Ci(null,[{}]))),o||(o=bg(e,n)),{key:r,pulse:o,parent:a}}function bg(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Y(t.getData(e.data).output)}function _a(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}_a.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=Y(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(o=t[a]);return new _a(e,s,r,i,o)};function c9(e){return $i(e)?e:null}function Uk(e,t,n){const i=Om(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function fc(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),u=zae(s);let l=c9(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const d=s?{field:Pv,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:Y(t.output)};u&&(d.sort=e.sortRef(s)),f=e.add(Fm(i,void 0,d)),o&&(t.index[r]=f),c=Y(f),l!=null&&(a[l]=c)}return c}_a.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=c9(t);let o,a,u;return s!=null&&(e=i.scope,o=r[s]),o?n&&n.field&&Uk(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:Y(i.output)},n&&n.field&&Uk(e,u,n),a=e.add(VT(u)),o=e.add(Ci({pulse:Y(a)})),o={agg:a,ref:Y(o)},s!=null&&(r[s]=o)),o.ref},tuplesRef(){return Y(this.values)},extentRef(e,t){return fc(e,this,"extent","extent",t,!1)},domainRef(e,t){return fc(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return fc(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return fc(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return fc(e,this,"indata","tupleindex",t,!0,!0)}};function yle(e,t,n){const i=e.from.facet,r=i.name,s=bg(i,t);let o;i.name||re("Facet must have a name: "+ie(i)),i.data||re("Facet must reference a data set: "+ie(i)),i.field?o=t.add(JT({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(eue({key:t.keyRef(i.groupby),group:Y(t.proxy(n.parent)),pulse:s})):re("Facet must specify groupby or field: "+ie(i));const a=t.fork(),u=a.add(Ci()),l=a.add(Ia({pulse:Y(u)}));a.addData(r,new _a(a,u,u,l)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}function ble(e,t,n){const i=t.add(JT({pulse:n.pulse})),r=t.fork();r.add(Ia()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function f9(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,u=t.add(Y0()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(f=>f??"null").join(",")+"),0)",c=nr(l,t);u.update=c.$expr,u.params=c.$params}function jm(e,t){const n=u9(e),i=e.type===Mm,r=e.from&&e.from.facet,s=e.overlap;let o=e.layout||n===dE||n===fE,a,u,l,c,f,d,h;const g=n===cE||o||r,p=mle(e.from,i,t);u=t.add(Qae({key:p.key||(e.key?Lf(e.key):void 0),pulse:p.pulse,clean:!i}));const m=Y(u);u=l=t.add(Ci({pulse:m})),u=t.add(sue({markdef:ule(e),interactive:lle(e.interactive,t),clip:ale(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Y(u)}));const y=Y(u);u=c=t.add(KT(GT(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(E=>{const w=AE(E,t),$=w.metadata;($.generates||$.changes)&&re("Mark transforms should not generate new data."),$.nomod||(c.params.mod=!0),w.params.pulse=Y(u),t.add(u=w)}),e.sort&&(u=t.add(gue({sort:t.compareRef(e.sort),pulse:Y(u)})));const b=Y(u);(r||o)&&(o=t.add(ZT({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:b})),d=Y(o));const v=t.add(XT({mark:y,pulse:d||b}));h=Y(v),i&&(g&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(b,d||h,m),r?yle(e,t,p):g?ble(e,t,p):t.parse(e),t.popState(),g&&(o&&a.push(o),a.push(v))),s&&(h=vle(s,h,t));const x=t.add(QT({pulse:h})),A=t.add(Ia({pulse:Y(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new _a(t,l,x,A)),e.on&&e.on.forEach(E=>{(E.insert||E.remove||E.toggle)&&re("Marks only support modify triggers."),f9(E,t,f)}))}function vle(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:st(s)?n.signalRef(s.signal):s,method:st(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=st(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return Y(n.add(uue(o)))}function xle(e,t){const n=t.config.legend,i=e.encode||{},r=_n(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,u=s.style,l={};let c=0,f,d,h;yE.forEach(v=>e[v]?(l[v]=e[v],c=c||e[v]):0),c||re("Missing valid scale for legend.");const g=wle(e,t.scaleType(c)),p={title:e.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&r.isVertical()},m=Y(t.add(Ci(null,[p]))),y={enter:{x:{value:0},y:{value:0}}},b=Y(t.add(iue(d={type:g,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===yg?(h=[Yue(e,c,n,i.gradient),Rk(e,n,i.labels,b)],d.count=d.count||t.signalRef(`max(2,2*floor((${ca(r.gradientLength())})/100))`)):g===Uv?h=[Vue(e,c,n,i.gradient,b),Rk(e,n,i.labels,b)]:(f=Que(e,n),h=[Jue(e,n,i,b,ca(f.columns))],d.size=$le(e,t,h[0].marks)),h=[Uf({role:vae,from:m,encode:y,marks:h,layout:f,interactive:a})],p.title&&h.push(ole(e,n,i.title,m)),jm(Uf({role:yae,from:m,encode:Nl(Ele(r,e,n),s,Rd),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:u}),t)}function wle(e,t){let n=e.type||jk;return!e.type&&Ale(e)===1&&(e.fill||e.stroke)&&(n=uw(t)?yg:Mb(t)?Uv:jk),n!==yg?n:Mb(t)?Uv:yg}function Ale(e){return yE.reduce((t,n)=>t+(e[n]?1:0),0)}function Ele(e,t,n){const i={enter:{},update:{}};return $t(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function $le(e,t,n){const i=ca(qk("size",e,n)),r=ca(qk("strokeWidth",e,n)),s=ca(_le(n[1].encode,t,jd));return nr(`max(ceil(sqrt(${i})+${r}),${s})`,t)}function qk(e,t,n){return t[e]?`scale("${t[e]}",datum)`:o9(e,n[0].encode)}function _le(e,t,n){return o9("fontSize",e)||Hue("fontSize",t,n)}const Sle=`item.orient==="${jl}"?-90:item.orient==="${Rl}"?90:0`;function Cle(e,t){e=$i(e)?{text:e}:e;const n=_n(e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,u=[],l={},c=Y(t.add(Ci(null,[l])));return u.push(Ole(e,n,kle(e),c)),e.subtitle&&u.push(Dle(e,n,i.subtitle,c)),jm(Uf({role:Eae,from:c,encode:Fle(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}function kle(e){const t=e.encode;return t&&t.title||Ge({name:e.name,interactive:e.interactive,style:e.style},t)}function Fle(e,t){const n={enter:{},update:{}};return $t(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:vE},angle:{signal:Sle},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Nl(n,t,Rd)}function Ole(e,t,n,i){const r={value:0},s=e.text,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return $t(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),zn({type:Ua,role:$ae,style:Rue,from:i,encode:o},n)}function Dle(e,t,n,i){const r={value:0},s=e.subtitle,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return $t(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),zn({type:Ua,role:_ae,style:Bue,from:i,encode:o},n)}function Mle(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(AE(i,t))}),e.on&&e.on.forEach(i=>{f9(i,t,e.name)}),t.addDataPipeline(e.name,Tle(e,t,n))}function Tle(e,t,n){const i=[];let r=null,s=!1,o=!1,a,u,l,c,f;for(e.values?st(e.values)||pg(e.format)?(i.push(Wk(t,e)),i.push(r=Oo())):i.push(r=Oo({$ingest:e.values,$format:e.format})):e.url?pg(e.url)||pg(e.format)?(i.push(Wk(t,e)),i.push(r=Oo())):i.push(r=Oo({$request:e.url,$format:e.format})):e.source&&(r=a=Dt(e.source).map(d=>Y(t.getData(d).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=Oo()),i.push(c),f.generates&&(o=!0),f.modifies&&!o&&(s=!0),f.source?r=c:f.changes&&(r=null);return a&&(l=a.length-1,i[0]=due({derive:s,pulse:l?a:a[0]}),(s||l)&&i.splice(1,0,Oo())),r||i.push(Oo()),i.push(Ia({})),i}function Oo(e){const t=Ci({},e);return t.metadata={source:!0},t}function Wk(e,t){return rue({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const d9=e=>e===eo||e===ki,Rm=(e,t,n)=>st(e)?Ble(e.signal,t,n):e===jl||e===ki?t:n,mt=(e,t,n)=>st(e)?jle(e.signal,t,n):d9(e)?t:n,vi=(e,t,n)=>st(e)?Rle(e.signal,t,n):d9(e)?n:t,h9=(e,t,n)=>st(e)?Ple(e.signal,t,n):e===ki?{value:t}:{value:n},Nle=(e,t,n)=>st(e)?zle(e.signal,t,n):e===Rl?{value:t}:{value:n},jle=(e,t,n)=>g9(`${e} === '${ki}' || ${e} === '${eo}'`,t,n),Rle=(e,t,n)=>g9(`${e} !== '${ki}' && ${e} !== '${eo}'`,t,n),Ble=(e,t,n)=>EE(`${e} === '${jl}' || ${e} === '${ki}'`,t,n),Ple=(e,t,n)=>EE(`${e} === '${ki}'`,t,n),zle=(e,t,n)=>EE(`${e} === '${Rl}'`,t,n),g9=(e,t,n)=>(t=t!=null?pt(t):t,n=n!=null?pt(n):n,Hk(t)&&Hk(n)?(t=t?t.signal||ie(t.value):null,n=n?n.signal||ie(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Ge({test:e},t)].concat(n||[])),Hk=e=>e==null||Object.keys(e).length===1,EE=(e,t,n)=>({signal:`${e} ? (${pu(t)}) : (${pu(n)})`}),Lle=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${jl}' ? (${pu(i)}) : `:"")+(n!=null?`${e} === '${eo}' ? (${pu(n)}) : `:"")+(r!=null?`${e} === '${Rl}' ? (${pu(r)}) : `:"")+(t!=null?`${e} === '${ki}' ? (${pu(t)}) : `:"")+"(null)"}),pu=e=>st(e)?e.signal:e==null?null:ie(e),Ile=(e,t)=>t===0?0:st(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},Au=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function ou(e,t,n,i){let r;if(t&&Dn(t,e))return t[e];if(Dn(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[mE][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[jd][r]}return null}function Gk(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function Ule(e,t){var n=t.config,i=n.style,r=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,a,u,l;if(st(o)){const f=Gk([n.axisX,n.axisY]),d=Gk([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=mt(o,ou(l,n.axisX,r,i),ou(l,n.axisY,r,i));u={};for(l of d)u[l]=Lle(o.signal,ou(l,n.axisTop,r,i),ou(l,n.axisBottom,r,i),ou(l,n.axisLeft,r,i),ou(l,n.axisRight,r,i))}else a=o===ki||o===eo?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||u||s?Ge({},r,a,u,s):r}function qle(e,t,n,i){const r=_n(e,t),s=e.orient;let o,a;const u={enter:o={opacity:ge},update:a={opacity:Vn},exit:{opacity:ge}};$t(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=Yk(e,0),c=Yk(e,1);return o.x=a.x=mt(s,l,ge),o.x2=a.x2=mt(s,c),o.y=a.y=vi(s,l,ge),o.y2=a.y2=vi(s,c),zn({type:bE,role:dae,from:i,encode:u},n)}function Yk(e,t){return{scale:e.scale,range:t}}function Wle(e,t,n,i,r){const s=_n(e,t),o=e.orient,a=e.gridScale,u=Rm(o,1,-1),l=Hle(e.offset,u);let c,f,d;const h={enter:c={opacity:ge},update:d={opacity:Vn},exit:f={opacity:ge}};$t(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const g={scale:e.scale,field:Yn,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},p=mt(o,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},y=a?{scale:a,range:1,mult:u,offset:l}:Ge(p,{mult:u,offset:l});return c.x=d.x=mt(o,g,m),c.y=d.y=vi(o,g,m),c.x2=d.x2=vi(o,y),c.y2=d.y2=mt(o,y),f.x=mt(o,g),f.y=vi(o,g),zn({type:bE,role:hae,key:Yn,from:i,encode:h},n)}function Hle(e,t){if(t!==1)if(!De(e))e=st(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=Ge({},e);for(;n.mult!=null;)if(De(n.mult))n=n.mult=Ge({},n.mult);else return n.mult=st(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Gle(e,t,n,i,r,s){const o=_n(e,t),a=e.orient,u=Rm(a,-1,1);let l,c,f;const d={enter:l={opacity:ge},update:f={opacity:Vn},exit:c={opacity:ge}};$t(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=pt(r);h.mult=u;const g={scale:e.scale,field:Yn,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return f.y=l.y=mt(a,ge,g),f.y2=l.y2=mt(a,h),c.x=mt(a,g),f.x=l.x=vi(a,ge,g),f.x2=l.x2=vi(a,h),c.y=vi(a,g),zn({type:bE,role:pae,key:Yn,from:i,encode:d},n)}function Ry(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function Yle(e,t,n,i,r,s){const o=_n(e,t),a=e.orient,u=e.scale,l=Rm(a,-1,1),c=ca(o("labelFlush")),f=ca(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let g=c===0||!!c,p;const m=pt(r);m.mult=l,m.offset=pt(o("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:Yn,band:.5,offset:a9(s.offset,o("labelOffset"))},b=mt(a,g?Ry(u,c,'"left"','"right"','"center"'):{value:"center"},Nle(a,"left","right")),v=mt(a,h9(a,"bottom","top"),g?Ry(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=Ry(u,c,`-(${f})`,f,0);g=g&&f;const A={opacity:ge,x:mt(a,y,m),y:vi(a,y,m)},E={enter:A,update:p={opacity:Vn,text:{field:pE},x:A.x,y:A.y,align:b,baseline:v},exit:{opacity:ge,x:A.x,y:A.y}};$t(E,{dx:!d&&g?mt(a,x):null,dy:!h&&g?vi(a,x):null}),$t(E,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const w=o("labelBound");let $=o("labelOverlap");return $=$||w?{separation:o("labelSeparation"),method:$,order:"datum.index",bound:w?{scale:u,orient:a,tolerance:w}:null}:void 0,p.align!==b&&(p.align=Au(p.align,b)),p.baseline!==v&&(p.baseline=Au(p.baseline,v)),zn({type:Ua,role:gae,style:jd,key:Yn,from:i,encode:E,overlap:$},n)}function Vle(e,t,n,i){const r=_n(e,t),s=e.orient,o=Rm(s,-1,1);let a,u;const l={enter:a={opacity:ge,anchor:pt(r("titleAnchor",null)),align:{signal:vE}},update:u=Ge({},a,{opacity:Vn,text:pt(e.title)}),exit:{opacity:ge}},c={signal:`lerp(range("${e.scale}"), ${Tm(0,1,.5)})`};return u.x=mt(s,c),u.y=vi(s,c),a.angle=mt(s,ge,Ile(o,90)),a.baseline=mt(s,h9(s,eo,ki),{value:eo}),u.angle=a.angle,u.baseline=a.baseline,$t(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),Xle(r,s,l,n),l.update.align=Au(l.update.align,a.align),l.update.angle=Au(l.update.angle,a.angle),l.update.baseline=Au(l.update.baseline,a.baseline),zn({type:Ua,role:mae,style:mE,from:i,encode:l},n)}function Xle(e,t,n,i){const r=(a,u)=>a!=null?(n.update[u]=Au(pt(a),n.update[u]),!1):!lu(u,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?pt(o):mt(t,pt(o),pt(s))}function Kle(e,t){const n=Ule(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,u=_n(e,n),l=Gue(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=Y(t.add(Ci({},[c]))),d=Y(t.add(Jae({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let g;return c.grid&&h.push(Wle(e,n,i.grid,d,l)),c.ticks&&(g=u("tickSize"),h.push(Gle(e,n,i.ticks,d,g,l))),c.labels&&(g=c.ticks?g:0,h.push(Yle(e,n,i.labels,d,g,l))),c.domain&&h.push(qle(e,n,i.domain,f)),c.title&&h.push(Vle(e,n,i.title,f)),jm(Uf({role:fae,from:f,encode:Nl(Jle(u,e),r,Rd),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:s,interactive:o,style:a}),t)}function Jle(e,t){const n={enter:{},update:{}};return $t(n,{orient:e("orient"),offset:e("offset")||0,position:ai(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function p9(e,t,n){const i=Dt(e.signals),r=Dt(e.scales);return n||i.forEach(s=>YT(s,t)),Dt(e.projections).forEach(s=>Fue(s,t)),r.forEach(s=>yue(s,t)),Dt(e.data).forEach(s=>Mle(s,t)),r.forEach(s=>bue(s,t)),(n||i).forEach(s=>Kae(s,t)),Dt(e.axes).forEach(s=>Kle(s,t)),Dt(e.marks).forEach(s=>jm(s,t)),Dt(e.legends).forEach(s=>xle(s,t)),e.title&&Cle(e.title,t),t.parseLambdas(),t}const Qle=e=>Nl({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Zle(e,t){const n=t.config,i=Y(t.root=t.add(Y0())),r=ece(e,n);r.forEach(l=>YT(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(Ci()),o=t.add(KT(GT(Qle(e.encode),Mm,fE,e.style,t,{pulse:Y(s)}))),a=t.add(ZT({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:Y(o)}));t.operators.pop(),t.pushState(Y(o),Y(a),null),p9(e,t,r),t.operators.push(a);let u=t.add(XT({mark:i,pulse:Y(a)}));return u=t.add(QT({pulse:Y(u)})),u=t.add(Ia({pulse:Y(u)})),t.addData("root",new _a(t,s,s,u)),t}function dc(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function ece(e,t){const n=o=>ai(e[o],t[o]),i=[dc("background",n("background")),dc("autosize",uae(n("autosize"))),dc("padding",cae(n("padding"))),dc("width",n("width")||0),dc("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return Dt(e.signals).forEach(o=>{Dn(r,o.name)?o=Ge(r[o.name],o):i.push(o),s[o.name]=o}),Dt(t.signals).forEach(o=>{!Dn(s,o.name)&&!Dn(r,o.name)&&i.push(o)}),i}function m9(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Vk(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}m9.prototype=Vk.prototype={parse(e){return p9(e,this)},fork(){return new Vk(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof Bv?Y(e):e;return this.add(fue({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(Y(this.add(Ia({pulse:e})))),this._parent.push(t),this._lookup.push(n?Y(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Zc(this._parent)},encode(){return Zc(this._encode)},lookup(){return Zc(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if($i(e))return Lf(e,t);e.signal||re("Unsupported field reference: "+ie(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=Y(this.add(tue(r)))}return i},compareRef(e){let t=!1;const n=s=>st(s)?(t=!0,this.signalRef(s.signal)):Lae(s)?(t=!0,this.exprRef(s.expr)):s,i=Dt(e.field).map(n),r=Dt(e.order).map(n);return t?Y(this.add(Nk({fields:i,orders:r}))):Mk(i,r)},keyRef(e,t){let n=!1;const i=s=>st(s)?(n=!0,Y(r[s.signal])):s,r=this.signals;return e=Dt(e).map(i),n?Y(this.add(nue({fields:e,flat:t}))):Rae(e,t)},sortRef(e){if(!e)return e;const t=Om(e.op,e.field),n=e.order||Bae;return n.signal?Y(this.add(Nk({fields:t,orders:this.signalRef(n.signal)}))):Mk(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return Dn(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&re("Duplicate signal name: "+ie(e));const n=t instanceof Bv?t:this.add(Y0(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||re("Unrecognized signal name: "+ie(e)),this.signals[e]},signalRef(e){return this.signals[e]?Y(this.signals[e]):(Dn(this.lambdas,e)||(this.lambdas[e]=this.add(Y0(null))),Y(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=nr(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!De(e)?e:this.signalRef(e.signal||$E(e))},exprRef(e,t){const n={expr:nr(e,this)};return t&&(n.expr.$name=t),Y(this.add(Zae(n)))},addBinding(e,t){this.bindings||re("Nested signals do not support binding: "+ie(e)),this.bindings.push(Ge({signal:e},t))},addScaleProj(e,t){Dn(this.scales,e)&&re("Duplicate scale or projection name: "+ie(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,hue(t))},addProjection(e,t){this.addScaleProj(e,cue(t))},getScale(e){return this.scales[e]||re("Unrecognized scale name: "+ie(e)),this.scales[e]},scaleRef(e){return Y(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Dn(this.data,e)&&re("Duplicate data set name: "+ie(e)),this.data[e]=t},getData(e){return this.data[e]||re("Undefined data set name: "+ie(e)),this.data[e]},addDataPipeline(e,t){return Dn(this.data,e)&&re("Duplicate data set name: "+ie(e)),this.addData(e,_a.fromEntries(this,t))}};function $E(e){return(gt(e)?tce:nce)(e)}function tce(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(De(r)?r.signal||$E(r):ie(r))}return n+"]"}function nce(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+ie(i)+":"+(De(r)?r.signal||$E(r):ie(r));return t+"}"}function ice(){const e="sans-serif",i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function rce(e,t,n){return De(e)||re("Input Vega specification must be an object."),t=Voe(ice(),t,e.config),Zle(e,new m9(t,n)).toRuntime()}const sce="view",V0="[",X0="]",y9="{",b9="}",oce=":",v9=",",ace="@",uce=">",lce=/[[\]{}]/,cce={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let x9,w9;function fce(e,t,n){return x9=t||sce,w9=n||cce,A9(e.trim()).map(Wv)}function dce(e){return w9[e]}function tf(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function A9(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=tf(e,r,v9,V0+y9,X0+b9),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function Wv(e){return e[0]==="["?hce(e):gce(e)}function hce(e){const t=e.length;let n=1,i;if(n=tf(e,n,X0,V0,X0),n===t)throw"Empty between selector: "+e;if(i=A9(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==uce)throw"Expected '>' after between selector: "+e;i=i.map(Wv);const r=Wv(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function gce(e){const t={source:x9},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===b9){if(a=e.lastIndexOf(y9),a>=0){try{i=pce(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===ace&&(r=++a),u=tf(e,a,oce),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=tf(e,a,V0),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=tf(e,a,X0),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==V0)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||lce.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):dce(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function pce(e){const t=e.split(v9);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}var mce="5.25.0";$x(Ou,AU,CV,_X,xJ,SQ,wee,qZ,Eee,Zee,bte,Dte);const Gve=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Je,CanvasHandler:Ed,CanvasRenderer:t0,DATE:xn,DAY:Tt,DAYOFYEAR:Zi,Dataflow:yu,Debug:TO,Error:OO,EventStream:Tp,Gradient:zM,GroupItem:nm,HOURS:Rn,Handler:Js,Info:MO,Item:tm,MILLISECONDS:Ai,MINUTES:Bn,MONTH:Bt,Marks:Pn,MultiPulse:Ix,None:FO,Operator:ke,Parameters:Mp,Pulse:js,QUARTER:vn,RenderType:Ss,Renderer:cr,ResourceLoader:yw,SECONDS:Xn,SVGHandler:jw,SVGRenderer:Iw,SVGStringRenderer:Uw,Scenegraph:Tw,TIME_UNITS:Dx,Transform:D,View:MT,WEEK:it,Warn:DO,YEAR:At,accessor:es,accessorFields:CO,accessorName:rR,array:cf,ascending:Ex,bandwidthNRD:Vx,bin:bD,bootstrapCI:vD,boundClip:T6,boundContext:vd,boundItem:zb,boundMark:r6,boundStroke:ts,changeset:Ra,clampRange:SR,codegenExpression:tT,compare:kR,constant:MR,cumulativeLogNormal:e2,cumulativeNormal:jp,cumulativeUniform:r2,dayofyear:b3,debounce:TR,defaultLocale:Rx,definition:uD,densityLogNormal:Zx,densityNormal:Xx,densityUniform:i2,domChild:hn,domClear:fi,domCreate:$s,domFind:Nw,dotbin:xD,error:Wh,expressionFunction:et,extend:$x,extent:NR,extentIndex:jR,falsy:fR,fastmap:BR,field:vx,flush:PR,font:am,fontFamily:Ad,fontSize:lr,format:Hh,formatLocale:Ng,formats:zx,hasOwnProperty:qo,id:aR,identity:xx,inferType:J3,inferTypes:Q3,ingest:we,inherits:zR,inrange:LR,interpolate:lw,interpolateColors:Zp,interpolateRange:_M,intersect:F6,intersectBoxLine:fu,intersectPath:bw,intersectPoint:vw,intersectRule:YM,isArray:bp,isBoolean:IR,isDate:PO,isFunction:wp,isIterable:UR,isNumber:zO,isObject:_g,isRegExp:qR,isString:LO,isTuple:Op,key:WR,lerp:HR,lineHeight:Xs,loader:kp,locale:X3,logger:hR,lruCache:YR,markup:Lw,merge:VR,mergeConfig:gR,multiLineOffset:Ow,one:lR,pad:XR,panLinear:mR,panLog:yR,panPow:bR,panSymlog:vR,parse:rce,parseExpression:Q4,parseSelector:fce,path:Lp,pathCurves:gw,pathEqual:N6,pathParse:Bu,pathRectangle:UM,pathRender:Ef,pathSymbols:IM,pathTrail:qM,peek:nl,point:lm,projection:lA,quantileLogNormal:t2,quantileNormal:Rp,quantileUniform:s2,quantiles:Gx,quantizeInterpolator:SM,quarter:$R,quartiles:Yx,get random(){return Kn},randomInteger:SI,randomKDE:Jx,randomLCG:_I,randomLogNormal:AD,randomMixture:ED,randomNormal:Kx,randomUniform:$D,read:tD,regressionConstant:o2,regressionExp:SD,regressionLinear:a2,regressionLoess:FD,regressionLog:_D,regressionPoly:kD,regressionPow:CD,regressionQuad:u2,renderModule:cm,repeat:bc,resetDefaultLocale:aL,resetSVGClipId:HM,resetSVGDefIds:PY,responseType:eD,runtimeContext:vT,sampleCurve:Pp,sampleLogNormal:Qx,sampleNormal:Np,sampleUniform:n2,scale:ve,sceneEqual:qw,sceneFromJSON:o6,scenePickVisit:Xg,sceneToJSON:s6,sceneVisit:Ei,sceneZOrder:xw,scheme:cw,serializeXML:w6,setRandom:EI,span:KR,splitAccessPath:bx,stringValue:IO,textMetrics:bi,timeBin:j3,timeFloor:_3,timeFormatLocale:gf,timeInterval:ul,timeOffset:k3,timeSequence:D3,timeUnitSpecifier:y3,timeUnits:Mx,toBoolean:JR,toDate:ZR,toNumber:Ax,toSet:tB,toString:eB,transform:lD,transforms:Ou,truncate:nB,truthy:cR,tupleid:V,typeParsers:xb,utcFloor:S3,utcInterval:ll,utcOffset:F3,utcSequence:M3,utcdayofyear:w3,utcquarter:_R,utcweek:A3,version:mce,visitArray:iB,week:v3,writeConfig:wx,zero:uR,zoomLinear:xR,zoomLog:wR,zoomPow:AR,zoomSymlog:ER},Symbol.toStringTag,{value:"Module"})),yce="vega-lite",bce='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',vce="4.13.1",xce=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],wce="https://vega.github.io/vega-lite/",Ace="Vega-Lite is a concise high-level language for interactive visualization.",Ece="build/vega-lite.js",$ce="build/vega-lite.min.js",_ce="build/vega-lite.min.js",Sce="build/src/index",Cce="build/src/index.d.ts",kce={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},Fce={test:"test"},Oce={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},Dce={type:"git",url:"https://github.com/vega/vega-lite.git"},Mce="BSD-3-Clause",Tce={url:"https://github.com/vega/vega-lite/issues"},Nce={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},jce={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},Rce={vega:"^5.12.1"},Bce={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1},Pce={name:yce,author:bce,version:vce,collaborators:xce,homepage:wce,description:Ace,main:Ece,unpkg:$ce,jsdelivr:_ce,module:Sce,types:Cce,bin:kce,directories:Fce,scripts:Oce,repository:Dce,license:Mce,bugs:Tce,devDependencies:Nce,dependencies:jce,peerDependencies:Rce,jest:Bce};function Bl(e,t,n){return e.fields=t||[],e.fname=n,e}function zce(e){return e.length===1?Lce(e[0]):Ice(e)}const Lce=e=>function(t){return t[e]},Ice=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function By(e){throw Error(e)}function qa(e){var t=[],n=null,i=0,r=e.length,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<r;++a)if(u=e[a],u==="\\")s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(u===n)l(),n=null,i=-1;else{if(n)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,n=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||By("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&By("Access path missing closing bracket: "+e),n&&By("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Uce(e,t,n){const i=qa(e);return e=i.length===1?i[0]:e,Bl((n&&n.get||zce)(i),[e],t||e)}var Bd=[];Uce("id");var qce=Bl(function(e){return e},Bd,"identity");Bl(function(){return 0},Bd,"zero");Bl(function(){return 1},Bd,"one");Bl(function(){return!0},Bd,"true");Bl(function(){return!1},Bd,"false");function jh(e,t,n){var i=[t].concat([].slice.call(n));console[e].apply(console,i)}var Wce=0,Hce=1,E9=2,Gce=3,Yce=4;function Vce(e,t){var n=e||Wce;return{level:function(i){return arguments.length?(n=+i,this):n},error:function(){return n>=Hce&&jh(t||"error","ERROR",arguments),this},warn:function(){return n>=E9&&jh(t||"warn","WARN",arguments),this},info:function(){return n>=Gce&&jh(t||"log","INFO",arguments),this},debug:function(){return n>=Yce&&jh(t||"log","DEBUG",arguments),this}}}const Q=Array.isArray;function yt(e){return e===Object(e)}const Xk=e=>e!=="__proto__";function $9(...e){return e.reduce((t,n)=>{for(var i in n)if(i==="signals")t.signals=Xce(t.signals,n.signals);else{var r=i==="legend"?{layout:1}:i==="style"?!0:null;_E(t,i,n[i],r)}return t},{})}function _E(e,t,n,i){if(Xk(t)){var r,s;if(yt(n)&&!Q(n)){s=yt(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?_E(s,r,n[r]):Xk(r)&&(s[r]=n[r])}else e[t]=n}}function Xce(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function Xe(e){return e!=null?Q(e)?e:[e]:[]}function Kce(e){return typeof e=="function"}const Jce=Object.prototype.hasOwnProperty;function ea(e,t){return Jce.call(e,t)}function Pd(e){return typeof e=="boolean"}function Qe(e){return typeof e=="number"}function ce(e){return typeof e=="string"}function pe(e){return Q(e)?"["+e.map(pe)+"]":yt(e)||ce(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Wa(e){for(var t={},n=0,i=e.length;n<i;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function X(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var _9={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var i;try{i=Map}catch{i=function(){}}var r;try{r=Set}catch{r=function(){}}var s;try{s=Promise}catch{s=function(){}}function o(d,h,g,p,m){typeof h=="object"&&(g=h.depth,p=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],b=[],v=typeof Buffer<"u";typeof h>"u"&&(h=!0),typeof g>"u"&&(g=1/0);function x(A,E){if(A===null)return null;if(E===0)return A;var w,$;if(typeof A!="object")return A;if(n(A,i))w=new i;else if(n(A,r))w=new r;else if(n(A,s))w=new s(function(B,I){A.then(function(q){B(x(q,E-1))},function(q){I(x(q,E-1))})});else if(o.__isArray(A))w=[];else if(o.__isRegExp(A))w=new RegExp(A.source,f(A)),A.lastIndex&&(w.lastIndex=A.lastIndex);else if(o.__isDate(A))w=new Date(A.getTime());else{if(v&&Buffer.isBuffer(A))return Buffer.allocUnsafe?w=Buffer.allocUnsafe(A.length):w=new Buffer(A.length),A.copy(w),w;n(A,Error)?w=Object.create(A):typeof p>"u"?($=Object.getPrototypeOf(A),w=Object.create($)):(w=Object.create(p),$=p)}if(h){var S=y.indexOf(A);if(S!=-1)return b[S];y.push(A),b.push(w)}n(A,i)&&A.forEach(function(B,I){var q=x(I,E-1),ue=x(B,E-1);w.set(q,ue)}),n(A,r)&&A.forEach(function(B){var I=x(B,E-1);w.add(I)});for(var _ in A){var C;$&&(C=Object.getOwnPropertyDescriptor($,_)),!(C&&C.set==null)&&(w[_]=x(A[_],E-1))}if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(A),_=0;_<M.length;_++){var F=M[_],O=Object.getOwnPropertyDescriptor(A,F);O&&!O.enumerable&&!m||(w[F]=x(A[F],E-1),O.enumerable||Object.defineProperty(w,F,{enumerable:!1}))}if(m)for(var k=Object.getOwnPropertyNames(A),_=0;_<k.length;_++){var j=k[_],O=Object.getOwnPropertyDescriptor(A,j);O&&O.enumerable||(w[j]=x(A[j],E-1),Object.defineProperty(w,j,{enumerable:!1}))}return w}return x(d,g)}o.clonePrototype=function(h){if(h===null)return null;var g=function(){};return g.prototype=h,new g};function a(d){return Object.prototype.toString.call(d)}o.__objToStr=a;function u(d){return typeof d=="object"&&a(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&a(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&a(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(_9);var Qce=_9.exports;const Zce=yp(Qce);var efe=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,r,s;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;r--!==0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(s=Object.keys(t),i=s.length,i!==Object.keys(n).length)return!1;for(r=i;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[r]))return!1;for(r=i;r--!==0;){var o=s[r];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n};const tfe=yp(efe);var nfe=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.cmp&&function(s){return function(o){return function(a,u){var l={key:a,value:o[a]},c={key:u,value:o[u]};return s(l,c)}}}(t.cmp),r=[];return function s(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var a,u;if(Array.isArray(o)){for(u="[",a=0;a<o.length;a++)a&&(u+=","),u+=s(o[a])||"null";return u+"]"}if(o===null)return"null";if(r.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=r.push(o)-1,c=Object.keys(o).sort(i&&i(o));for(u="",a=0;a<c.length;a++){var f=c[a],d=s(o[f]);d&&(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return r.splice(l,1),"{"+u+"}"}}(e)};const qf=yp(nfe);function SE(e){return!!e.or}function CE(e){return!!e.and}function kE(e){return!!e.not}function vg(e,t){if(kE(e))vg(e.not,t);else if(CE(e))for(const n of e.and)vg(n,t);else if(SE(e))for(const n of e.or)vg(n,t);else t(e)}function xg(e,t){return kE(e)?{not:xg(e.not,t)}:CE(e)?{and:e.and.map(n=>xg(n,t))}:SE(e)?{or:e.or.map(n=>xg(n,t))}:t(e)}const zd=tfe,fe=Zce;function Wf(e,t){const n={};for(const i of t)ea(e,i)&&(n[i]=e[i]);return n}function qr(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>qf(e)).join(",")})`};const Re=qf;function me(e){if(Qe(e))return e;const t=ce(e)?e:qf(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function Kk(e){return e===!1||e===null}function ee(e,t){return e.indexOf(t)>-1}function Hf(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function S9(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function ife(e,...t){for(const n of t)rfe(e,n??{});return e}function rfe(e,t){for(const n of z(t))_E(e,n,t[n],!0)}function Ds(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function sfe(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function C9(e,t){for(const n of e)if(t.has(n))return!0;return!1}function Jk(e){const t=new Set;for(const n of e){const r=qa(n).map((o,a)=>a===0?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function k9(e,t){return e===void 0||t===void 0?!0:C9(Jk(e),Jk(t))}function Fe(e){return z(e).length===0}const z=Object.keys,Is=Object.values;function F9(e){const t=[];for(const n in e)ea(e,n)&&t.push({key:n,value:e[n]});return t}function K0(e){return e===!0||e===!1}function Be(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function nf(e,t){return kE(e)?"!("+nf(e.not,t)+")":CE(e)?"("+e.and.map(n=>nf(n,t)).join(") && (")+")":SE(e)?"("+e.or.map(n=>nf(n,t)).join(") || (")+")":t(e)}function Hv(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Hv(e[n],t)&&delete e[n],Fe(e)}function Bm(e){return e.charAt(0).toUpperCase()+e.substr(1)}function O9(e,t="datum"){const n=qa(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(pe).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function ofe(e,t="datum"){return`${t}[${pe(qa(e).join("."))}]`}function afe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function to(e){return`${qa(e).map(afe).join("\\.")}`}function Yu(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function D9(e){return`${qa(e).join(".")}`}function Gf(e){return e?qa(e).length:0}function Ze(...e){for(const t of e)if(t!==void 0)return t}let ufe=42;function lfe(e){const t=++ufe;return e?String(e)+t:t}function cfe(e){return ffe(e)?e:`__${e}`}function ffe(e){return e.indexOf("__")===0}function J0(e){if(e!==void 0)return(e%360+360)%360}function FE(e){return Qe(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const Qk={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function OE(e){return e&&e.condition}const M9=["domain","grid","labels","ticks","title"],dfe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},T9={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},hfe=Object.assign(Object.assign({},T9),{style:1,labelExpr:1,encoding:1});function Zk(e){return!!hfe[e]}const on={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},N9=on.arc,Pm=on.area,zm=on.bar,gfe=on.image,Lm=on.line,Im=on.point,pfe=on.rect,Q0=on.rule,j9=on.text,DE=on.tick,mfe=on.trail,ME=on.circle,TE=on.square,R9=on.geoshape;function Ha(e){return ee(["line","area","trail"],e)}function eF(e){return ee(["rect","bar","image","arc"],e)}const B9=z(on);function ir(e){return e.type}Wa(B9);const yfe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],bfe=["fill","fillOpacity"],vfe=[...yfe,...bfe],xfe={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},tF=z(xfe),wfe={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},Afe={color:"#4c78a8",invalid:"filter",timeUnitBand:1},Efe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},P9=5,$fe={binSpacing:1,continuousBandSize:P9,timeUnitBandPosition:.5},_fe={binSpacing:0,continuousBandSize:P9,timeUnitBandPosition:.5},Sfe={thickness:1};function Cfe(e){return ir(e)?e.type:e}function ss(e){return"mark"in e}class Um{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return ss(t)?Cfe(t.mark)===this.name:!1}}const kfe={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Ffe={count:1,min:1,max:1};function no(e){return!!e&&!!e.argmin}function Ga(e){return!!e&&!!e.argmax}function NE(e){return ce(e)&&!!kfe[e]}const Ofe=["count","valid","missing","distinct"];function z9(e){return ce(e)&&ee(Ofe,e)}function Dfe(e){return ce(e)&&ee(["min","max"],e)}const Mfe=["count","sum","distinct","valid","missing"],Tfe=["mean","average","median","q1","q3","min","max"],Nfe=Wa(Tfe),Wr="row",Hr="column",qm="facet",Le="x",ot="y",Fi="x2",pr="y2",mr="radius",os="radius2",Oi="theta",as="theta2",yr="latitude",br="longitude",Di="latitude2",Qn="longitude2",An="color",vr="fill",xr="stroke",En="shape",us="size",Ya="angle",ls="opacity",mo="fillOpacity",yo="strokeOpacity",bo="strokeWidth",vo="strokeDash",Ld="text",Id="order",Ud="detail",Wm="key",Sa="tooltip",Hm="href",Gm="url",Ym="description",jfe={x:1,y:1,x2:1,y2:1},L9={theta:1,theta2:1,radius:1,radius2:1};function I9(e){return e in L9}const jE={longitude:1,longitude2:1,latitude:1,latitude2:1};function Rfe(e){switch(e){case yr:return"y";case Di:return"y2";case br:return"x";case Qn:return"x2"}}function Bfe(e){return e in jE}const Pfe=z(jE),U9=Object.assign(Object.assign(Object.assign(Object.assign({},jfe),L9),jE),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Eu(e){return e===An||e===vr||e===xr}const q9={row:1,column:1,facet:1},Gn=z(q9),RE=Object.assign(Object.assign({},U9),q9),W9=z(RE),zfe=X(RE,["order","detail","tooltip"]),Lfe=X(zfe,["row","column","facet"]);function Ife(e){return!!Lfe[e]}function H9(e){return!!RE[e]}const Ufe=[Fi,pr,Di,Qn,as,os];function G9(e){return Va(e)!==e}function Va(e){switch(e){case Fi:return Le;case pr:return ot;case Di:return yr;case Qn:return br;case as:return Oi;case os:return mr}return e}function io(e){if(I9(e))switch(e){case Oi:return"startAngle";case as:return"endAngle";case mr:return"outerRadius";case os:return"innerRadius"}return e}function wr(e){switch(e){case Le:return Fi;case ot:return pr;case yr:return Di;case br:return Qn;case Oi:return as;case mr:return os}}function Ar(e){switch(e){case Le:case Fi:return"width";case ot:case pr:return"height"}}function qfe(e){switch(e){case Le:return"xOffset";case ot:return"yOffset";case Fi:return"x2Offset";case pr:return"y2Offset";case Oi:return"thetaOffset";case mr:return"radiusOffset";case as:return"theta2Offset";case os:return"radius2Offset"}}const BE=X(U9,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Wfe=z(BE),xo={x:1,y:1},Zn=z(xo);function rr(e){return e in xo}const PE={theta:1,radius:1},Hfe=z(PE);function Vm(e){return e==="width"?Le:ot}const Y9=X(BE,["text","tooltip","href","url","description","detail","key","order"]),Gfe=z(Y9);function Yfe(e){return!!BE[e]}function Vfe(e){switch(e){case An:case vr:case xr:case us:case En:case ls:case bo:case vo:return!0;case mo:case yo:case Ya:return!1}}const V9=Object.assign(Object.assign(Object.assign({},xo),PE),Y9),Xm=z(V9);function wo(e){return!!V9[e]}function Xfe(e,t){return Jfe(e)[t]}const X9={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},Kfe=X(X9,["geoshape"]);function Jfe(e){switch(e){case An:case vr:case xr:case Ym:case Ud:case Wm:case Sa:case Hm:case Id:case ls:case mo:case yo:case bo:case qm:case Wr:case Hr:return X9;case Le:case ot:case yr:case br:return Kfe;case Fi:case pr:case Di:case Qn:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case us:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case vo:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case En:return{point:"always",geoshape:"always"};case Ld:return{text:"always"};case Ya:return{point:"always",square:"always",text:"always"};case Gm:return{image:"always"};case Oi:return{text:"always",arc:"always"};case mr:return{text:"always",arc:"always"};case as:case os:return{arc:"always"}}}function wg(e){switch(e){case Le:case ot:case Oi:case mr:case us:case Ya:case bo:case ls:case mo:case yo:case Fi:case pr:case as:case os:return;case qm:case Wr:case Hr:case En:case vo:case Ld:case Sa:case Hm:case Gm:case Ym:return"discrete";case An:case vr:case xr:return"flexible";case yr:case br:case Di:case Qn:case Ud:case Wm:case Id:return}}function K9(e){return Pd(e)&&(e=n1(e,void 0)),"bin"+z(e).map(t=>Km(e[t])?Be(`_${t}_${Object.entries(e[t])}`):Be(`_${t}_${e[t]}`)).join("")}function Me(e){return e===!0||qd(e)&&!e.binned}function Kt(e){return e==="binned"||qd(e)&&e.binned===!0}function qd(e){return yt(e)}function Km(e){return e==null?void 0:e.selection}function nF(e){switch(e){case Wr:case Hr:case us:case An:case vr:case xr:case bo:case ls:case mo:case yo:case En:return 6;case vo:return 4;default:return 10}}function zE(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Qfe='Autosize "fit" only works for single views and layered views.';function iF(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function rF(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function sF(e){return e?`Dropping "fit-${e}" because spec has discrete ${Ar(e)}.`:'Dropping "fit" because spec has discrete size.'}function oF(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Zfe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function ede(e){return`The "nearest" transform is not supported for ${e} marks.`}function J9(e){return`Selection not supported for ${e} yet.`}function tde(e){return`Cannot find a selection named "${e}".`}const nde="Scale bindings are currently only supported for scales with unbinned, continuous domains.",ide="Legend bindings are only supported for selections over an individual field or encoding channel.";function rde(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function sde(e){return`Unknown repeated value "${e}".`}function aF(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const ode="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function ade(e){return`Unrecognized parse "${e}".`}function uF(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function ude(e){return`Ignoring an invalid transform: ${Re(e)}.`}const lde='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function lF(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function cde(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function fde(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Re(t)} is overridden by a child projection ${Re(n)}.`}const dde="Arc marks uses theta channel rather than angle, replacing angle with theta.";function hde(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Re(n)}}.`}function Q9(e){return`Invalid field type "${e}".`}function gde(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function pde(e){return`Invalid aggregation operator "${e}".`}function mde(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function Z9(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function Gv(e,t){return`Dropping ${Re(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const yde="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Jm(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function bde(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function vde(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function xde(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Py(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function wde(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Ade(e,t){return`Specified orient "${e}" overridden with "${t}".`}const Ede=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function $de(e){return`Cannot use the scale property "${e}" with non-color channel.`}function _de(e){return`Using unaggregated domain with raw field has no effect (${Re(e)}).`}function Sde(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Cde(e){return`Unaggregated domain is currently unsupported for log scale (${Re(e)}).`}function kde(e){return`Cannot apply size to non-oriented mark "${e}".`}function Fde(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function Ode(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function eN(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function tN(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Dde(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Re(n)} and ${Re(i)}). Using ${Re(n)}.`}function Mde(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Re(n)} and ${Re(i)}). Using the union of the two domains.`}function Tde(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Nde(e){return`Dropping sort property ${Re(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const cF="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",jde="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Rde="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Bde="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function Pde(e){return`Cannot stack "${e}" if there is already "${e}2".`}function zde(e){return`Cannot stack non-linear scale (${e}).`}function Lde(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function Z0(e,t){return`Invalid ${e}: ${Re(t)}.`}function Ide(e){return`Dropping day from datetime ${Re(e)} as day cannot be combined with other units.`}function Ude(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function qde(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Wde(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function Hde(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function fF(e){return`1D error band does not support ${e}.`}function nN(e){return`Channel ${e} is required for "binned" bin.`}function Gde(e){return`Domain for ${e} is required for threshold scale.`}const iN=Vce(E9);let Vu=iN;function Yde(e){return Vu=e,Vu}function Vde(){return Vu=iN,Vu}function R(...e){Vu.warn(...e)}function Xde(...e){Vu.debug(...e)}function Pl(e){if(e&&yt(e)){for(const t of IE)if(t in e)return!0}return!1}const rN=["january","february","march","april","may","june","july","august","september","october","november","december"],Kde=rN.map(e=>e.substr(0,3)),sN=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Jde=sN.map(e=>e.substr(0,3));function Qde(e){if(FE(e)&&(e=+e),Qe(e))return e>4&&R(Z0("quarter",e)),e-1;throw new Error(Z0("quarter",e))}function Zde(e){if(FE(e)&&(e=+e),Qe(e))return e-1;{const t=e.toLowerCase(),n=rN.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Kde.indexOf(i);if(r!==-1)return r;throw new Error(Z0("month",e))}}function ehe(e){if(FE(e)&&(e=+e),Qe(e))return e%7;{const t=e.toLowerCase(),n=sN.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Jde.indexOf(i);if(r!==-1)return r;throw new Error(Z0("day",e))}}function LE(e,t){const n=[];if(t&&e.day!==void 0&&z(e).length>1&&(R(Ide(e)),e=fe(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?Zde(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?Qde(e.quarter):e.quarter;n.push(Qe(i)?i*3:i+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?ehe(e.day):e.day;n.push(Qe(i)?i+1:i+"+1")}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r>"u"?0:r)}return n}function Yf(e){const n=LE(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function the(e){const n=LE(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function nhe(e){const t=LE(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const oN={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},IE=z(oN);function ihe(e){return!!oN[e]}function UE(e){return e.startsWith("utc")}function rhe(e){return e.substr(3)}const she={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function qE(e){const t=[];for(const n of IE)aN(e,n)&&t.push(n);return t}function aN(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function ohe(e,t,{end:n}={end:!1}){const i=O9(t),r=UE(e)?"utc":"";function s(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let o;const a={};for(const u of IE)aN(e,u)&&(a[u]=s(u),o=u);return n&&(a[o]+="+1"),the(a)}function uN(e){if(!e)return;const t=qE(e);return`timeUnitSpecifier(${qf(t)}, ${qf(she)})`}function ahe(e,t,n){if(!e)return;const i=uN(e);return`${n||UE(e)?"utc":"time"}Format(${t}, ${i})`}function rn(e){if(!e)return;let t;return ce(e)?t={unit:e}:yt(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),UE(t.unit)&&(t.utc=!0,t.unit=rhe(t.unit)),t}function uhe(e){const t=rn(e),{utc:n}=t,i=X(t,["utc"]);return i.unit?(n?"utc":"")+z(i).map(r=>Be(`${r==="unit"?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+z(i).map(r=>Be(`_${r}_${i[r]}`)).join("")}function te(e){return e&&!!e.signal}function Ao(e){return!!e.step}function lhe(e){return Q(e)?!1:"fields"in e&&!("data"in e)}function che(e){return Q(e)?!1:"fields"in e&&"data"in e}function Ms(e){return Q(e)?!1:"field"in e&&"data"in e}const fhe={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},dhe=z(fhe),hhe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},zy=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function ghe(e){return e==null?void 0:e.selection}function WE(e){return e&&!!e.field&&e.equal!==void 0}function lN(e){return e&&!!e.field&&e.lt!==void 0}function cN(e){return e&&!!e.field&&e.lte!==void 0}function fN(e){return e&&!!e.field&&e.gt!==void 0}function dN(e){return e&&!!e.field&&e.gte!==void 0}function HE(e){if(e&&e.field){if(Q(e.range)&&e.range.length===2)return!0;if(te(e.range))return!0}return!1}function GE(e){return e&&!!e.field&&(Q(e.oneOf)||Q(e.in))}function phe(e){return e&&!!e.field&&e.valid!==void 0}function hN(e){return GE(e)||WE(e)||HE(e)||lN(e)||fN(e)||cN(e)||dN(e)}function ji(e,t){return a$(e,{timeUnit:t,wrapTime:!0})}function mhe(e,t){return e.map(n=>ji(n,t))}function gN(e,t=!0){var n;const{field:i}=e,r=(n=rn(e.timeUnit))===null||n===void 0?void 0:n.unit,s=r?"time("+ohe(r,i)+")":L(e,{expr:"datum"});if(WE(e))return s+"==="+ji(e.equal,r);if(lN(e)){const o=e.lt;return`${s}<${ji(o,r)}`}else if(fN(e)){const o=e.gt;return`${s}>${ji(o,r)}`}else if(cN(e)){const o=e.lte;return`${s}<=${ji(o,r)}`}else if(dN(e)){const o=e.gte;return`${s}>=${ji(o,r)}`}else{if(GE(e))return`indexof([${mhe(e.oneOf,r).join(",")}], ${s}) !== -1`;if(phe(e))return YE(s,e.valid);if(HE(e)){const{range:o}=e,a=te(o)?{signal:`${o.signal}[0]`}:o[0],u=te(o)?{signal:`${o.signal}[1]`}:o[1];if(a!==null&&u!==null&&t)return"inrange("+s+", ["+ji(a,r)+", "+ji(u,r)+"])";const l=[];return a!==null&&l.push(`${s} >= ${ji(a,r)}`),u!==null&&l.push(`${s} <= ${ji(u,r)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function YE(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function yhe(e){var t;return hN(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=rn(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const zl={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},Ca=zl.quantitative,VE=zl.ordinal,Xu=zl.temporal,XE=zl.nominal,Ll=zl.geojson,bhe=z(zl);function vhe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Ca:return"quantitative";case"t":case Xu:return"temporal";case"o":case VE:return"ordinal";case"n":case XE:return"nominal";case Ll:return"geojson"}}const Ke={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},Yv={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},xhe=z(Yv);function whe(e,t){const n=Yv[e],i=Yv[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const Ahe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function dF(e){return Ahe[e]}const pN=["linear","log","pow","sqrt","symlog","time","utc"],Ehe=Wa(pN),$he=["linear","log","pow","sqrt","symlog"],_he=Wa($he);function She(e){return e in _he}const Che=["quantile","quantize","threshold"],khe=Wa(Che),Fhe=pN.concat(["quantile","quantize","threshold","sequential","identity"]),Ohe=Wa(Fhe),Dhe=["ordinal","bin-ordinal","point","band"],Mhe=Wa(Dhe);function $n(e){return e in Mhe}function ei(e){return e in Ohe}function yi(e){return e in Ehe}function ep(e){return e in khe}const The={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function Nhe(e){return!ce(e)&&!!e.name}function mN(e){return e==null?void 0:e.selection}function jhe(e){return e&&e.unionWith}const Rhe={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},Bhe=X(Rhe,["type","domain","range","scheme"]),Phe=z(Bhe);zhe();function yN(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!ee(["point","band","identity"],e);case"bins":return!ee(["point","band","identity","ordinal"],e);case"round":return yi(e)||e==="band"||e==="point";case"padding":return yi(e)||ee(["point","band"],e);case"paddingOuter":case"align":return ee(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return yi(e);case"nice":return yi(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return ei(e)&&!ee(["log","time","utc","threshold","quantile"],e)}}function bN(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Eu(e)?void 0:$de(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function vN(e,t){return ee([VE,XE],t)?e===void 0||$n(e):t===Xu?ee([Ke.TIME,Ke.UTC,void 0],e):t===Ca?ee([Ke.LOG,Ke.POW,Ke.SQRT,Ke.SYMLOG,Ke.QUANTILE,Ke.QUANTIZE,Ke.THRESHOLD,Ke.LINEAR,void 0],e):!0}function xN(e,t){if(!wo(e))return!1;switch(e){case Le:case ot:case Oi:case mr:return yi(t)||ee(["band","point"],t);case us:case bo:case ls:case mo:case yo:case Ya:return yi(t)||ep(t)||ee(["band","point","ordinal"],t);case An:case vr:case xr:return t!=="band";case vo:return t==="ordinal"||ep(t);case En:return t==="ordinal"}}function zhe(){var e;const t={};for(const n of W9)for(const i of bhe)for(const r of xhe){const s=Lhe(n,i);xN(n,r)&&vN(r,i)&&(t[s]=(e=t[s])!==null&&e!==void 0?e:[],t[s].push(r))}return t}function Lhe(e,t){return e+"_"+t}function KE(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:s}=e,o=AN(e);return U(n)&&!z9(n.aggregate)&&r&&yi(r.get("type"))&&r.get("zero")===!1?wN({fieldDef:n,channel:t,markDef:i,ref:o,config:s}):o}function wN({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return Ha(n.type)||Ee("invalid",n,r)===null?i:[Ihe(e,t),i]}function Ihe(e,t){const n=JE(e,!0),r=Va(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function JE(e,t=!0){return YE(ce(e)?e:L(e,{expr:"datum"}),!t)}function Uhe(e){const{datum:t}=e;return Pl(t)?Yf(t):`${JSON.stringify(t)}`}function fa(e,t,n,i){const r={};if(t&&(r.scale=t),Eo(e)){const{datum:s}=e;Pl(s)?r.signal=Yf(s):te(s)?r.signal=s.signal:r.value=s}else r.field=L(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function tp({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,band:s=.5}){const o=0<s&&s<1?"datum":void 0,a=L(t,{expr:o,suffix:r}),u=n!==void 0?L(n,{expr:o}):L(t,{suffix:"end",expr:o}),l={};if(s===0||s===1){l.scale=e;const c=s===0?a:u;l.field=c}else{const c=`${s} * ${a} + ${1-s} * ${u}`;l.signal=`scale("${e}", ${c})`}return i&&(l.offset=i),l}function AN({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l,band:c}){var f;if(t){if(ne(t)){if(Ln(t)){c=c??Hd({channel:e,fieldDef:t,fieldDef2:n,markDef:i,stack:a,config:r,isMidPoint:!0});const{bin:h,timeUnit:g,type:p}=t;if(Me(h)||c&&g&&p===Xu)return a&&a.impute?fa(t,s,{binSuffix:"mid"},{offset:u}):c?tp({scaleName:s,fieldOrDatumDef:t,band:c,offset:u}):fa(t,s,Gd(t,e)?{binSuffix:"range"}:{},{offset:u});if(Kt(h)){if(U(n))return tp({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:u});R(nN(e===Le?Fi:pr))}}const d=o==null?void 0:o.get("type");return fa(t,s,$n(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c??t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Zr(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},rf(e,d)),h)}}return Kce(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function rf(e,t){return ee(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:ee(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Ve(t)}function ka(e){return e&&e!=="number"&&e!=="time"}function EN(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const qhe=" – ";function QE({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){var o,a;if(ka(n))return ZE({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const u=$N(e,i,r);if(i1(e)){const l=Hhe(u,U(e)?(o=rn(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,s.timeFormat,r$(e)&&((a=e.scale)===null||a===void 0?void 0:a.type)===Ke.UTC);return l?{signal:l}:void 0}if(t=CN(xs(e),t,s),U(e)&&Me(e.bin)){const l=L(e,{expr:i,binSuffix:"end"});return{signal:Qm(u,l,t,n,s)}}else return t||xs(e)==="quantitative"?{signal:`${kN(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function $N(e,t,n){return U(e)?n?`${L(e,{expr:t,suffix:"end"})}-${L(e,{expr:t,suffix:"start"})}`:L(e,{expr:t}):Uhe(e)}function ZE({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){if(o=o??$N(e,i,r),U(e)&&Me(e.bin)){const a=L(e,{expr:i,binSuffix:"end"});return{signal:Qm(o,a,t,n,s)}}return{signal:EN(n,o,t)}}function _N(e,t,n,i,r,s){var o;if(!ka(i)){if(i1(e)){const a=U(e)?(o=rn(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return Whe(n,a,r,s)}return CN(t,n,r)}}function SN(e,t,n){if(e&&(te(e)||e==="number"||e==="time"))return e;if(i1(t)&&n!=="time"&&n!=="utc")return"time"}function CN(e,t,n){if(ce(t))return t;if(e===Ca)return n.numberFormat}function Whe(e,t,n,i){return e||(t?{signal:uN(t)}:i?void 0:n.timeFormat)}function kN(e,t){return`format(${e}, "${t||""}")`}function hF(e,t,n,i){var r;return ka(n)?EN(n,e,t):kN(e,(r=ce(t)?t:void 0)!==null&&r!==void 0?r:i.numberFormat)}function Qm(e,t,n,i,r){const s=hF(e,n,i,r),o=hF(t,n,i,r);return`${YE(e,!1)} ? "null" : ${s} + "${qhe}" + ${o}`}function Hhe(e,t,n,i,r){return!t||n?(n=ce(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):ahe(t,e,r)}const Zm="min",Ghe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function gF(e){return e in Ghe}function FN(e){return!!e&&!!e.encoding}function Vi(e){return!!e&&(e.op==="count"||!!e.field)}function ON(e){return!!e&&Q(e)}function Wd(e){return"row"in e||"column"in e}function e$(e){return!!e&&"header"in e}function e1(e){return"facet"in e}function Yhe(e){return e.selection}function Vhe(e){return e&&!ce(e)&&"repeat"in e}function pF(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function DN(e){return Ln(e)&&"sort"in e}function Hd({channel:e,fieldDef:t,fieldDef2:n,markDef:i,stack:r,config:s,isMidPoint:o}){if(ne(t)&&t.band!==void 0)return t.band;if(U(t)){const{timeUnit:a,bin:u}=t;if(a&&!n)return o?Fa("timeUnitBandPosition",i,s):eF(i.type)?Fa("timeUnitBand",i,s):0;if(Me(u))return eF(i.type)&&!o?1:.5}if((r==null?void 0:r.fieldChannel)===e&&o)return .5}function t$(e,t,n,i,r,s){return Me(t.bin)||t.timeUnit&&Ln(t)&&t.type==="temporal"?!!Hd({channel:e,fieldDef:t,fieldDef2:n,stack:i,markDef:r,config:s}):!1}function n$(e){return!!e&&"condition"in e}function t1(e){const t=e&&e.condition;return!!t&&!Q(t)&&U(t)}function i$(e){const t=e&&e.condition;return!!t&&!Q(t)&&ne(t)}function Xhe(e){const t=e&&e.condition;return!!t&&(Q(t)||Zr(t))}function U(e){return!!e&&(!!e.field||e.aggregate==="count")}function xs(e){return e&&e.type}function Eo(e){return!!e&&"datum"in e}function Ii(e){return Ln(e)&&jN(e)||Vv(e)}function Vv(e){return Eo(e)&&Qe(e.datum)}function ne(e){return U(e)||Eo(e)}function Ln(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Zr(e){return e&&"value"in e&&"value"in e}function r$(e){return!!e&&("scale"in e||"sort"in e)}function s$(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function MN(e){return!!e&&"legend"in e}function TN(e){return!!e&&("format"in e||"formatType"in e)}function Khe(e){return"op"in e}function L(e,t={}){var n,i,r;let s=e.field;const o=t.prefix;let a=t.suffix,u="";if(Jhe(e))s=cfe("count");else{let l;if(!t.nofn)if(Khe(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Me(c)?(l=K9(c),a=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((i=t.suffix)!==null&&i!==void 0?i:"")):f?Ga(f)?(u=`["${s}"]`,s=`argmax_${f.argmax}`):no(f)?(u=`["${s}"]`,s=`argmin_${f.argmin}`):l=String(f):d&&(l=uhe(d),a=(!ee(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((r=t.suffix)!==null&&r!==void 0?r:""))}l&&(s=s?`${l}_${s}`:l)}return a&&(s=`${s}_${a}`),o&&(s=`${o}_${s}`),t.forAs?D9(s):t.expr?ofe(s,t.expr)+u:to(s)+u}function NN(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return U(e)&&!!e.bin;case"temporal":return!1}throw new Error(Q9(e.type))}function jN(e){return!NN(e)}function Jhe(e){return e.aggregate==="count"}function Qhe(e,t){var n;const{field:i,bin:r,timeUnit:s,aggregate:o}=e;if(o==="count")return t.countTitle;if(Me(r))return`${i} (binned)`;if(s){const a=(n=rn(s))===null||n===void 0?void 0:n.unit;if(a)return`${i} (${qE(a).join("-")})`}else if(o)return Ga(o)?`${i} for max ${o.argmax}`:no(o)?`${i} for min ${o.argmin}`:`${Bm(o)} of ${i}`;return i}function Zhe(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(Ga(t))return`${r} for argmax(${t.argmax})`;if(no(t))return`${r} for argmin(${t.argmin})`;const s=rn(i),o=t||(s==null?void 0:s.unit)||(s==null?void 0:s.maxbins)&&"timeunit"||Me(n)&&"bin";return o?o.toUpperCase()+"("+r+")":r}const RN=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Zhe(e);default:return Qhe(e,t)}};let BN=RN;function PN(e){BN=e}function ege(){PN(RN)}function da(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,s;const a=((r=o$(e))!==null&&r!==void 0?r:{}).title;if(!U(e))return a;const u=e,l=i?zN(u,t):void 0;return n?Ze(a,u.title,l):(s=a??u.title)!==null&&s!==void 0?s:l}function o$(e){if(s$(e)&&e.axis)return e.axis;if(MN(e)&&e.legend)return e.legend;if(e$(e)&&e.header)return e.header}function zN(e,t){return BN(e,t)}function np(e){var t;if(TN(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}else{const n=(t=o$(e))!==null&&t!==void 0?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function tge(e,t){if(e.timeUnit)return"temporal";if(Me(e.bin))return"quantitative";switch(wg(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function sr(e){if(U(e))return e;if(t1(e))return e.condition}function rt(e){if(ne(e))return e;if(i$(e))return e.condition}function Xv(e,t,n){if(ce(e)||Qe(e)||Pd(e)){const i=ce(e)?"string":Qe(e)?"number":"boolean";return R(hde(t,i,e)),{value:e}}return ne(e)?ip(e,t,n):i$(e)?Object.assign(Object.assign({},e),{condition:ip(e.condition,t,n)}):e}function ip(e,t,n){if(TN(e)){const{format:i,formatType:r}=e,s=X(e,["format","formatType"]);if(ka(r)&&!n.customFormatTypes)return R(lF(t)),ip(s,t,n)}else{const i=s$(e)?"axis":MN(e)?"legend":e$(e)?"header":null;if(i&&e[i]){const r=e[i],{format:s,formatType:o}=r,a=X(r,["format","formatType"]);if(ka(o)&&!n.customFormatTypes)return R(lF(t)),ip(Object.assign(Object.assign({},e),{[i]:a}),t,n)}}return U(e)?LN(e,t):nge(e)}function nge(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Qe(n)?"quantitative":ce(n)?"nominal":Pl(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function LN(e,t){const{aggregate:n,timeUnit:i,bin:r,field:s}=e,o=Object.assign({},e);if(n&&!NE(n)&&!Ga(n)&&!no(n)&&(R(pde(n)),delete o.aggregate),i&&(o.timeUnit=rn(i)),s&&(o.field=`${s}`),Me(r)&&(o.bin=n1(r,t)),Kt(r)&&!rr(t)&&R(`Channel ${t} should not be used with "binned" bin.`),Ln(o)){const{type:a}=o,u=vhe(a);a!==u&&(o.type=u),a!=="quantitative"&&z9(n)&&(R(gde(a,n)),o.type="quantitative")}else if(!G9(t)){const a=tge(o,t);R(mde(t,a)),o.type=a}if(Ln(o)){const{compatible:a,warning:u}=ige(o,t);a||R(u)}if(DN(o)&&ce(o.sort)){const{sort:a}=o;if(gF(a))return Object.assign(Object.assign({},o),{sort:{encoding:a}});const u=a.substr(1);if(a.charAt(0)==="-"&&gF(u))return Object.assign(Object.assign({},o),{sort:{encoding:u,order:"descending"}})}if(e$(o)){const{header:a}=o,{orient:u}=a,l=X(a,["orient"]);if(u)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},l),{labelOrient:a.labelOrient||u,titleOrient:a.titleOrient||u})})}return o}function n1(e,t){return Pd(e)?{maxbins:nF(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:nF(t)}):e}const Do={compatible:!0};function ige(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Wr:case Hr:case qm:return jN(e)?{compatible:!1,warning:vde(t)}:Do;case Le:case ot:case An:case vr:case xr:case Ld:case Ud:case Wm:case Sa:case Hm:case Gm:case Ya:case Oi:case mr:case Ym:return Do;case br:case Qn:case yr:case Di:return n!==Ca?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Do;case ls:case mo:case yo:case bo:case us:case as:case os:case Fi:case pr:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Do;case vo:return ee(["ordinal","nominal"],e.type)?Do:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case En:return ee(["ordinal","nominal","geojson"],e.type)?Do:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case Id:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Do}}function i1(e){const{formatType:t}=np(e);return t==="time"||!t&&rge(e)}function rge(e){return e&&(e.type==="temporal"||U(e)&&!!e.timeUnit)}function a$(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var s;const o=t&&((s=rn(t))===null||s===void 0?void 0:s.unit);let a=o||n==="temporal",u;return te(e)?u=e.signal:Pl(e)?(a=!0,u=Yf(e)):(ce(e)||Qe(e))&&a&&(u=`datetime(${JSON.stringify(e)})`,ihe(o)&&(Qe(e)&&e<1e4||ce(e)&&isNaN(Date.parse(e)))&&(u=Yf({[o]:e}))),u?i&&a?`time(${u})`:u:r?void 0:JSON.stringify(e)}function IN(e,t){const{type:n}=e;return t.map(i=>{const r=a$(i,{timeUnit:U(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return r!==void 0?{signal:r}:i})}function Gd(e,t){return Me(e.bin)?wo(t)&&ee(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function UN(e){const{anchor:t,frame:n,offset:i,orient:r,color:s,subtitleColor:o,subtitleFont:a,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=e,h=X(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),g=Object.assign(Object.assign({},h),s?{fill:s}:{}),p=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),a?{subtitleFont:a}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),y=Wf(g,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:g,subtitleMarkConfig:y,nonMark:p,subtitle:m}}function ws(e){return ce(e)||Q(e)&&ce(e[0])}function Ve(e){return te(e)?e:e!==void 0?{value:e}:void 0}function mF(e){return te(e)?e.signal:pe(e.value)}function Vf(e){return te(e)?e.signal:e==null?null:pe(e)}function sge(e,t,n){for(const i of n){const r=Fa(i,t.markDef,t.config);r!==void 0&&(e[i]=Ve(r))}return e}function qN(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Ee(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&t[r]!==void 0?t[r]:t[e]!==void 0?t[e]:s&&(!r||r===e)?void 0:Fa(e,t,n,i)}function Fa(e,t,n,{vgChannel:i}={}){return Ze(i?rp(e,t,n.style):void 0,rp(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function rp(e,t,n){return WN(e,qN(t),n)}function WN(e,t,n){t=Xe(t);let i;for(const r of t){const s=n[r];s&&s[e]!==void 0&&(i=s[e])}return i}function HN(e,t){return Xe(e).reduce((n,i)=>{var r;return n.field.push(L(i,t)),n.order.push((r=i.sort)!==null&&r!==void 0?r:"ascending"),n},{field:[],order:[]})}function GN(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(zd(r,i))return;n.push(i)}),n}function YN(e,t){return zd(e,t)||!t?e:e?[...Xe(e),...Xe(t)].join(", "):t}function VN(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((ws(n)||te(n))&&(ws(i)||te(i)))return{explicit:e.explicit,value:YN(n,i)};if(ws(n)||te(n))return{explicit:e.explicit,value:n};if(ws(i)||te(i))return{explicit:e.explicit,value:i};if(!ws(n)&&!te(n)&&!ws(i)&&!te(i))return{explicit:e.explicit,value:GN(n,i)};throw new Error("It should never reach here")}function ha(e,t){const n=e&&e[t];return n?Q(n)?Hf(n,i=>!!i.field):U(n)||t1(n):!1}function u$(e){return Hf(W9,t=>{if(ha(e,t)){const n=e[t];if(Q(n))return Hf(n,i=>!!i.aggregate);{const i=sr(n);return i&&!!i.aggregate}}return!1})}function l$(e,t){const n=[],i=[],r=[],s=[],o={};return c$(e,(a,u)=>{if(U(a)){const{field:l,aggregate:c,bin:f,timeUnit:d}=a,h=X(a,["field","aggregate","bin","timeUnit"]);if(c||d||f){const g=o$(a),p=g&&g.title;let m=L(a,{forAs:!0});const y=Object.assign(Object.assign(Object.assign({},p?[]:{title:da(a,t,{allowDisabling:!0})}),h),{field:m});if(c){let b;if(Ga(c)?(b="argmax",m=L({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):no(c)?(b="argmin",m=L({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(b=c),b){const v={op:b,as:m};l&&(v.field=l),s.push(v)}}else if(n.push(m),Ln(a)&&Me(f)){if(i.push({bin:f,field:l,as:m}),n.push(L(a,{binSuffix:"end"})),Gd(a,u)&&n.push(L(a,{binSuffix:"range"})),rr(u)){const b={field:m+"_end"};o[u+"2"]=b}y.bin="binned",G9(u)||(y.type=Ca)}else if(d){r.push({timeUnit:d,field:l,as:m});const b=Ln(a)&&a.type!==Xu&&"time";b&&(u===Ld||u===Sa?y.formatType=b:Yfe(u)?y.legend=Object.assign({formatType:b},y.legend):rr(u)&&(y.axis=Object.assign({formatType:b},y.axis)))}o[u]=y}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function oge(e,t,n){const i=Xfe(t,n);if(i){if(i==="binned"){const r=e[t===Fi?Le:ot];return!!(U(r)&&U(e[t])&&Kt(r.bin))}}else return!1;return!0}function age(e,t,n){const i=t.type;return z(e).reduce((r,s)=>{if(!H9(s))return R(bde(s)),r;const o=e[s];if(s==="angle"&&i==="arc"&&!e.theta&&(R(dde),s=Oi),!oge(e,s,i))return R(Jm(s,i)),r;if(s===us&&i==="line"){const a=sr(e[s]);if(a!=null&&a.aggregate)return R(yde),r}if(s===An&&(t.filled?"fill"in e:"stroke"in e))return R(Z9("encoding",{fill:"fill"in e,stroke:"stroke"in e})),r;if(s===Ud||s===Id&&!Q(o)&&!Zr(o)||s===Sa&&Q(o))o&&(r[s]=Xe(o).reduce((a,u)=>(U(u)?a.push(LN(u,s)):R(Gv(u,s)),a),[]));else{if(s===Sa&&o===null)r[s]=null;else if(!U(o)&&!Eo(o)&&!Zr(o)&&!n$(o)&&!te(o))return R(Gv(o,s)),r;r[s]=Xv(o,s,n)}return r},{})}function uge(e){const t=[];for(const n of z(e))if(ha(e,n)){const i=e[n],r=Xe(i);for(const s of r)U(s)?t.push(s):t1(s)&&t.push(s.condition)}return t}function c$(e,t,n){if(e)for(const i of z(e)){const r=e[i];if(Q(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function XN(e,t,n,i){return e?z(e).reduce((r,s)=>{const o=e[s];return Q(o)?o.reduce((a,u)=>t.call(i,a,u,s),r):t.call(i,r,o,s)},n):n}function KN(e,t){return z(t).reduce((n,i)=>{switch(i){case Le:case ot:case Hm:case Ym:case Gm:case Fi:case pr:case Oi:case as:case mr:case os:case yr:case br:case Di:case Qn:case Ld:case En:case Ya:case Sa:return n;case Id:if(e==="line"||e==="trail")return n;case Ud:case Wm:{const r=t[i];if(Q(r)||U(r))for(const s of Xe(r))s.aggregate||n.push(L(s,{}));return n}case us:if(e==="trail")return n;case An:case vr:case xr:case ls:case mo:case yo:case vo:case bo:{const r=sr(t[i]);return r&&!r.aggregate&&n.push(L(r,{})),n}}},[])}function lge(e){const{tooltip:t}=e,n=X(e,["tooltip"]);if(!t)return{filteredEncoding:e};let i,r;if(Q(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return Q(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function Kv(e,t,n,i=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:s,titlePrefix:o})=>{const a=i?` of ${t.field}`:"";return{field:s+t.field,type:t.type,title:te(o)?{signal:o+`"${escape(a)}"`}:o+a}}),...uge(n)]}}function JN(e){const{axis:t,title:n,field:i}=e;return t&&t.title!==void 0?void 0:Ze(n,i)}function f$(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,aria:f,extraEncoding:d={}})=>{const h=JN(n);return QN(e,a,r,f,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},h!==void 0?{title:h}:{}),s!==void 0?{scale:s}:{}),o!==void 0?{axis:o}:{})},ce(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),i),d)})}}function QN(e,t,n,i,r){const{clip:s,color:o,opacity:a}=e,u=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),s?{clip:s}:{}),o?{color:o}:{}),a?{opacity:a}:{}),ir(r.mark)?r.mark:{type:r.mark}),{style:`${u}-${t}`}),Pd(e[t])?{}:e[t]),i===!1?{aria:i}:{})})]:[]}function ZN(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",s=i[r],o=i[r+"2"],a=i[r+"Error"],u=i[r+"Error2"];return{continuousAxisChannelDef:Rh(s,n),continuousAxisChannelDef2:Rh(o,n),continuousAxisChannelDefError:Rh(a,n),continuousAxisChannelDefError2:Rh(u,n),continuousAxis:r}}function Rh(e,t){if(e&&e.aggregate){const{aggregate:n}=e,i=X(e,["aggregate"]);return n!==t&&R(Wde(n,t)),i}else return e}function e7(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(Ii(r)){if(Ii(s)){const o=U(r)&&r.aggregate,a=U(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return ir(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(Ii(s))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const sp="boxplot",cge=["box","median","outliers","rule","ticks"],fge=new Um(sp,n7);function t7(e){return Qe(e)?"tukey":e}function n7(e,{config:t}){var n,i;const{mark:r,encoding:s,selection:o,projection:a}=e,u=X(e,["mark","encoding","selection","projection"]),l=ir(r)?r:{type:r};o&&R(J9("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Ee("size",l,t),d=t7(c),{transform:h,continuousAxisChannelDef:g,continuousAxis:p,groupby:m,aggregate:y,encodingWithoutContinuousAxis:b,ticksOrient:v,boxOrient:x,customTooltipWithoutAggregatedField:A}=dge(e,c,t),{color:E,size:w}=b,$=X(b,["color","size"]),S=q=>f$(l,p,g,q,t.boxplot),_=S($),C=S(b),M=S(Object.assign(Object.assign({},$),w?{size:w}:{})),F=Kv([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],g,b),O={type:"tick",color:"black",opacity:1,orient:v,invalid:null},k=d==="min-max"?F:Kv([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,b),j=[..._({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:k}),..._({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:k}),..._({partName:"ticks",mark:O,positionPrefix:"lower_whisker",aria:!1,extraEncoding:k}),..._({partName:"ticks",mark:O,positionPrefix:"upper_whisker",aria:!1,extraEncoding:k})],B=[...d!=="tukey"?j:[],...C({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:F}),...M({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},yt(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:v,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:F})];let I;if(d!=="min-max"){const q=`datum["lower_box_${g.field}"]`,ue=`datum["upper_box_${g.field}"]`,Pe=`(${ue} - ${q})`,tt=`${q} - ${c} * ${Pe}`,lt=`${ue} + ${c} * ${Pe}`,Ut=`datum["${g.field}"]`,Ie={joinaggregate:i7(g.field),groupby:m};let ii;d==="tukey"&&(ii={transform:[{filter:`(${tt} <= ${Ut}) && (${Ut} <= ${lt})`},{aggregate:[{op:"min",field:g.field,as:"lower_whisker_"+g.field},{op:"max",field:g.field,as:"upper_whisker_"+g.field},{op:"min",field:"lower_box_"+g.field,as:"lower_box_"+g.field},{op:"max",field:"upper_box_"+g.field,as:"upper_box_"+g.field},...y],groupby:m}],layer:j});const _o=X($,["tooltip"]),{scale:ds,axis:W}=g,se=JN(g),oe=QN(l,"outliers",t.boxplot,!0,{transform:[{filter:`(${Ut} < ${tt}) || (${Ut} > ${lt})`}],mark:"point",encoding:Object.assign(Object.assign({[p]:Object.assign(Object.assign(Object.assign({field:g.field,type:g.type},se!==void 0?{title:se}:{}),ds!==void 0?{scale:ds}:{}),W!==void 0?{axis:W}:{})},_o),A?{tooltip:A}:{})})[0];oe&&ii?I={transform:[Ie],layer:[oe,ii]}:oe?(I=oe,I.transform.unshift(Ie)):ii&&(I=ii,I.transform.unshift(Ie))}return I?Object.assign(Object.assign({},u),{layer:[I,{transform:h,layer:B}]}):Object.assign(Object.assign({},u),{transform:((i=u.transform)!==null&&i!==void 0?i:[]).concat(h),layer:B})}function i7(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function dge(e,t,n){const i=e7(e,sp),{continuousAxisChannelDef:r,continuousAxis:s}=ZN(e,i,sp),o=r.field,a=t7(t),u=[...i7(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:(a==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(a==="min-max"?"upper_whisker_":"max_")+o}],l=a==="min-max"||a==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:"iqr_"+o},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:"upper_whisker_"+o},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:"lower_whisker_"+o}],c=e.encoding,f=s;c[f];const d=X(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:g}=lge(d),{bins:p,timeUnits:m,aggregate:y,groupby:b,encoding:v}=l$(g,n),x=i==="vertical"?"horizontal":"vertical",A=i;return{transform:[...p,...m,{aggregate:[...y,...u],groupby:b},...l],groupby:b,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:v,ticksOrient:x,boxOrient:A,customTooltipWithoutAggregatedField:h}}const d$="errorbar",hge=["ticks","rule"],gge=new Um(d$,r7);function r7(e,{config:t}){const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:u,tooltipEncoding:l}=s7(e,d$,t),c=f$(a,r,i,s,t.errorbar),f={type:"tick",orient:o},d=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function pge(e,t){const{encoding:n}=e;if(mge(n))return{orient:e7(e,t),inputType:"raw"};const i=yge(n),r=bge(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(ne(a)&&ne(u))throw new Error(`${t} cannot have both x2 and y2`);if(ne(a)){if(Ii(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(ne(u)){if(Ii(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(ne(u)&&!ne(a))throw new Error(`${t} cannot have xError2 without xError`);if(ne(c)&&!ne(l))throw new Error(`${t} cannot have yError2 without yError`);if(ne(a)&&ne(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ne(a)){if(Ii(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(ne(l)){if(Ii(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function mge(e){return(ne(e.x)||ne(e.y))&&!ne(e.x2)&&!ne(e.y2)&&!ne(e.xError)&&!ne(e.xError2)&&!ne(e.yError)&&!ne(e.yError2)}function yge(e){return ne(e.x2)||ne(e.y2)}function bge(e){return ne(e.xError)||ne(e.xError2)||ne(e.yError)||ne(e.yError2)}function s7(e,t,n){var i;const{mark:r,encoding:s,selection:o,projection:a}=e,u=X(e,["mark","encoding","selection","projection"]),l=ir(r)?r:{type:r};o&&R(J9(t));const{orient:c,inputType:f}=pge(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:g,continuousAxisChannelDefError2:p,continuousAxis:m}=ZN(e,c,t),{errorBarSpecificAggregate:y,postAggregateCalculates:b,tooltipSummary:v,tooltipTitleWithFieldName:x}=vge(l,d,h,g,p,f,t,n),A=s,E=m;A[E];const w=m==="x"?"x2":"y2";A[w];const $=m==="x"?"xError":"yError";A[$];const S=m==="x"?"xError2":"yError2";A[S];const _=X(A,[typeof E=="symbol"?E:E+"",typeof w=="symbol"?w:w+"",typeof $=="symbol"?$:$+"",typeof S=="symbol"?S:S+""]),{bins:C,timeUnits:M,aggregate:F,groupby:O,encoding:k}=l$(_,n),j=[...F,...y],B=f!=="raw"?[]:O,I=Kv(v,d,k,x);return{transform:[...(i=u.transform)!==null&&i!==void 0?i:[],...C,...M,...j.length===0?[]:[{aggregate:j,groupby:B}],...b],groupby:B,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:k,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:I}}function vge(e,t,n,i,r,s,o,a){let u=[],l=[];const c=t.field;let f,d=!1;if(s==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,g=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(g==="iqr")&&R(qde(h,g,o)),g==="stderr"||g==="stdev")u=[{op:g,field:c,as:"extent_"+c},{op:h,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:Bm(h)},{fieldPrefix:"upper_",titlePrefix:yF(h,g,"+")},{fieldPrefix:"lower_",titlePrefix:yF(h,g,"-")}],d=!0;else{e.center&&e.extent&&R(Hde(e.extent,o));let p,m,y;g==="ci"?(p="mean",m="ci0",y="ci1"):(p="median",m="q1",y="q3"),u=[{op:m,field:c,as:"lower_"+c},{op:y,field:c,as:"upper_"+c},{op:p,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:da({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:da({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:da({field:c,aggregate:p,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&R(Ude(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:"upper_"+c}],r?l.push({calculate:`datum["${c}"] + datum["${r.field}"]`,as:"lower_"+c}):l.push({calculate:`datum["${c}"] - datum["${i.field}"]`,as:"lower_"+c}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Yu(Yu(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function yF(e,t,n){return Bm(e)+" "+n+" "+t}const h$="errorband",xge=["band","borders"],wge=new Um(h$,o7);function o7(e,{config:t}){const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:u}=s7(e,h$,t),l=o,c=f$(l,r,i,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),g),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),g)):l.interpolate?R(fF("interpolate")):l.tension&&R(fF("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const a7={};function g$(e,t,n){const i=new Um(e,t);a7[e]={normalizer:i,parts:n}}function Age(){return z(a7)}g$(sp,n7,cge);g$(d$,r7,hge);g$(h$,o7,xge);const Ege=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],u7=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],$ge={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},_ge={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Sge={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Ku="_vgsid_",Cge={single:{on:"click",fields:[Ku],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[Ku],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function p$(e){return!!e&&(e==="legend"||!!e.legend)}function Ly(e){return p$(e)&&yt(e)}function kge(e){return r1(e)||y$(e)||m$(e)}function m$(e){return"concat"in e}function r1(e){return"vconcat"in e}function y$(e){return"hconcat"in e}function or(e){return yt(e)&&e.step!==void 0}function bF(e){return e.view||e.width||e.height}const vF=20,Fge={align:1,bounds:1,center:1,columns:1,spacing:1},Oge=z(Fge);function Dge(e,t,n){var i,r;const s=n[t],o={},{spacing:a,columns:u}=s;a!==void 0&&(o.spacing=a),u!==void 0&&(e1(e)&&!Wd(e.facet)||m$(e))&&(o.columns=u),r1(e)&&(o.columns=1);for(const l of Oge)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=Qe(c)?c:{row:(i=c.row)!==null&&i!==void 0?i:a,column:(r=c.column)!==null&&r!==void 0?r:a}}else o[l]=e[l];return o}function Jv(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function op(e,t){const n=Xf(e,t);return or(n)?n.step:b$}function Xf(e,t){var n;const i=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return Ze(i,{step:e.step})}const b$=20,Mge={continuousWidth:200,continuousHeight:200,step:b$},Tge={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Mge,mark:Afe,arc:{},area:{},bar:$fe,circle:{},geoshape:{},image:{},line:{},point:{},rect:_fe,rule:{color:"black"},square:{},text:{color:"black"},tick:Sfe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:The,projection:{},legend:_ge,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Cge,style:{},title:{},facet:{spacing:vF},concat:{spacing:vF}},Cr=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],xF={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},wF={blue:Cr[0],orange:Cr[1],red:Cr[2],teal:Cr[3],green:Cr[4],yellow:Cr[5],purple:Cr[6],pink:Cr[7],brown:Cr[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Nge(e={}){return{signals:[{name:"color",value:yt(e)?Object.assign(Object.assign({},wF),e):wF}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function jge(e){return{signals:[{name:"fontSize",value:yt(e)?Object.assign(Object.assign({},xF),e):xF}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Rge(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function l7(e={}){const{color:t,font:n,fontSize:i}=e,r=X(e,["color","font","fontSize"]);return $9({},Tge,n?Rge(n):{},t?Nge(t):{},i?jge(i):{},r||{})}const Bge=["view",...B9],Pge=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],zge=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},wfe);function Lge(e){e=fe(e);for(const t of Pge)delete e[t];if(e.axis)for(const t in e.axis)OE(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Ege)delete e.legend[t];if(e.mark){for(const t of tF)delete e.mark[t];e.mark.tooltip&&yt(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of Bge){for(const i of tF)delete e[t][i];const n=zge[t];if(n)for(const i of n)delete e[t][i];Uge(e,t)}for(const t of Age())delete e[t];Ige(e);for(const t in e)yt(e[t])&&Fe(e[t])&&delete e[t];return Fe(e)?void 0:e}function Ige(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=UN(e.title);Fe(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Fe(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Fe(i)?delete e.title:e.title=i}function Uge(e,t,n,i){const r=i?e[t][i]:e[t];t==="view"&&(n="cell");const s=Object.assign(Object.assign({},r),e.style[n??t]);Fe(s)||(e.style[n??t]=s),i||delete e[t]}function s1(e){return"layer"in e}function qge(e){return"repeat"in e}function Wge(e){return!Q(e.repeat)&&e.repeat.layer}class c7{map(t,n){return e1(t)?this.mapFacet(t,n):qge(t)?this.mapRepeat(t,n):y$(t)?this.mapHConcat(t,n):r1(t)?this.mapVConcat(t,n):m$(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(s1(t))return this.mapLayer(t,n);if(ss(t))return this.mapUnit(t,n);throw new Error(zE(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=X(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const Hge={zero:1,center:1,normalize:1};function Gge(e){return e in Hge}const Yge=new Set([N9,zm,Pm,Q0,Im,ME,TE,Lm,j9,DE]),Vge=new Set([zm,Pm,N9]);function AF(e,t){var n,i;const r=t==="x"?"y":"radius",s=e[t],o=e[r];if(U(s)&&U(o))if(xs(s)==="quantitative"&&xs(o)==="quantitative"){if(s.stack)return t;if(o.stack)return r;const a=U(s)&&!!s.aggregate,u=U(o)&&!!o.aggregate;if(a!==u)return a?t:r;{const l=(n=s.scale)===null||n===void 0?void 0:n.type,c=(i=o.scale)===null||i===void 0?void 0:i.type;if(l&&l!=="linear")return r;if(c&&c!=="linear")return t}}else{if(xs(s)==="quantitative")return t;if(xs(o)==="quantitative")return r}else{if(xs(s)==="quantitative")return t;if(xs(o)==="quantitative")return r}}function Xge(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function f7(e,t,n={}){const i=ir(e)?e.type:e;if(!Yge.has(i))return null;const r=AF(t,"x")||AF(t,"theta");if(!r)return null;const s=t[r],o=U(s)?L(s,{}):void 0;let a=Xge(r),u=t[a],l=U(u)?L(u,{}):void 0;l===o&&(l=void 0,u=void 0,a=void 0);const c=Wfe.reduce((d,h)=>{if(h!=="tooltip"&&ha(t,h)){const g=t[h];for(const p of Xe(g)){const m=sr(p);if(m.aggregate)continue;const y=L(m,{});(!y||y!==l)&&d.push({channel:h,fieldDef:m})}}return d},[]);let f;if(s.stack!==void 0?Pd(s.stack)?f=s.stack?"zero":null:f=s.stack:c.length>0&&Vge.has(i)&&(f="zero"),!f||!Gge(f)||u$(t)&&c.length===0)return null;if(s.scale&&s.scale.type&&s.scale.type!==Ke.LINEAR){if(n.disallowNonLinearStack)return null;R(zde(s.scale.type))}return ne(t[wr(r)])?(s.stack!==void 0&&R(Pde(r)),null):(U(s)&&s.aggregate&&!ee(Mfe,s.aggregate)&&R(Lde(s.aggregate)),{groupbyChannel:u?a:void 0,groupbyField:l,fieldChannel:r,impute:s.impute===null?!1:Ha(i),stackBy:c,offset:f})}function Kge(e){const t=X(e,["point","line"]);return z(t).length>1?t:t.type}function Jge(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:qr(e[t],["point","line"])}));return e}function Iy(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?yt(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?yt(t.point)?t.point:{}:void 0}function EF(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Qge{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(ss(t)){const{mark:i,encoding:r}=t,s=ir(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!Iy(s,n[s.type],r);case"area":return!!Iy(s,n[s.type],r)||!!EF(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{selection:s,projection:o,encoding:a,mark:u}=t,l=X(t,["selection","projection","encoding","mark"]),c=ir(u)?u:{type:u},f=Iy(c,r[c.type],a),d=c.type==="area"&&EF(c,r[c.type]),h=[Object.assign(Object.assign({},s?{selection:s}:{}),{mark:Kge(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:qr(a,["shape"])})],g=f7(c,a);let p=a;if(g){const{fieldChannel:m,offset:y}=g;p=Object.assign(Object.assign({},a),{[m]:Object.assign(Object.assign({},a[m]),y?{stack:y}:{})})}return d&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},Wf(c,["clip","interpolate","tension","tooltip"])),d),encoding:p})),f&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Wf(c,["clip","tooltip"])),f),encoding:p})),i(Object.assign(Object.assign({},l),{layer:h}),Object.assign(Object.assign({},n),{config:Jge(r)}))}}class Zge{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(ss(t)&&t.encoding)for(const i of Zn){const r=t.encoding[i];if(r&&ne(r)&&!((n=r==null?void 0:r.scale)===null||n===void 0)&&n.rangeStep)return!0}return!1}run(t){var n;const i={};let r=Object.assign({},t.encoding);for(const s of Zn){const o=Ar(s),a=r[s];if(a&&ne(a)&&!((n=a==null?void 0:a.scale)===null||n===void 0)&&n.rangeStep){const{scale:u}=a,l=X(a,["scale"]),c=u,f=X(c,["rangeStep"]);i[o]={step:u.rangeStep},R(Ede),r=Object.assign(Object.assign({},r),{[s]:Object.assign(Object.assign({},l),Fe(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},i),t),{encoding:r})}}function e0e(e,t){return t?Wd(e)?h7(e,t):d7(e,t):e}function Uy(e,t){return t?h7(e,t):e}function Qv(e,t,n){const i=t[e];if(Vhe(i)){if(i.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[i.repeat]});R(sde(i.repeat));return}return t}function d7(e,t){if(e=Qv("field",e,t),e!==void 0){if(e===null)return null;if(DN(e)&&Vi(e.sort)){const n=Qv("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function $F(e,t){if(U(e))return d7(e,t);{const n=Qv("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function _F(e,t){if(ne(e)){const n=$F(e,t);if(n)return n;if(n$(e))return{condition:e.condition}}else{if(i$(e)){const n=$F(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):X(e,["condition"])}return e}}function h7(e,t){const n={};for(const i in e)if(ea(e,i)){const r=e[i];if(Q(r))n[i]=r.map(s=>_F(s,t)).filter(s=>s);else{const s=_F(r,t);s!==void 0&&(n[i]=s)}}return n}class t0e{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(ss(t)){const{encoding:n,mark:i}=t;if(i==="line")for(const r of Ufe){const s=Va(r),o=n[s];if(n[r]&&(U(o)&&!Kt(o.bin)||Eo(o)))return!0}}return!1}run(t,n,i){const{encoding:r}=t;return R(wde(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class n0e extends c7{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[fge,gge,wge,new Qge,new t0e,new Zge]}map(t,n){if(ss(t)){const i=ha(t.encoding,Wr),r=ha(t.encoding,Hr),s=ha(t.encoding,qm);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=Object.assign(Object.assign({},t),{encoding:Uy(t.encoding,n.repeater)});if(i||r)return this.mapUnitWithParentEncodingOrProjection(s,n);const o=this.mapLayerOrUnit.bind(this);for(const a of this.nonFacetUnitNormalizers)if(a.hasMatchingType(s,n.config))return a.run(s,n,o);return s}mapRepeat(t,n){return Wge(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,s=X(t,["repeat","spec"]),{row:o,column:a,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:u},spec:r}}),n):Object.assign(Object.assign({},s),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=(r.name||"")+c+`child__layer_${Be(f)}`,g=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return g.name=h,g})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:s,data:o}=t,a=X(t,["repeat","spec","data"]);!Q(r)&&t.columns&&(t=qr(t,["columns"]),R(aF("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!Q(r)&&r.row||[l?l.row:null],d=!Q(r)&&r.column||[l?l.column:null],h=Q(r)&&r||[l?l.repeat:null];for(const p of h)for(const m of f)for(const y of d){const b={repeat:p,row:m,column:y,layer:l.layer},v=(s.name||"")+c+"child__"+(Q(r)?`${Be(p)}`:(r.row?`row_${Be(m)}`:"")+(r.column?`column_${Be(y)}`:"")),x=this.map(s,Object.assign(Object.assign({},n),{repeater:b,repeaterPrefix:v}));x.name=v,u.push(qr(x,["data"]))}const g=Q(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(i=s.data)!==null&&i!==void 0?i:o,align:"all"},a),{columns:g,concat:u})}mapFacet(t,n){const{facet:i}=t;return Wd(i)&&t.columns&&(t=qr(t,["columns"]),R(aF("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,u=CF({parentProjection:o,projection:r}),l=SF({parentEncoding:s,encoding:Uy(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:a})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:s,facet:o}=i,a=X(i,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,selection:h,encoding:g}=t,p=X(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:y}=this.getFacetMappingAndLayout({row:r,column:s,facet:o},n),b=Uy(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),y),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:b}),h?{selection:h}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:s,facet:o}=t;if(r||s){o&&R(xde([...r?[Wr]:[],...s?[Hr]:[]]));const a={},u={};for(const l of[Wr,Hr]){const c=t[l];if(c){const f=X(c,["align","center","spacing","columns"]);a[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&(u[d]=(i=u[d])!==null&&i!==void 0?i:{},u[d][l]=c[d])}}return{facetMapping:a,layout:u}}else{const{align:a,center:u,spacing:l,columns:c}=o,f=X(o,["align","center","spacing","columns"]);return{facetMapping:e0e(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,s=X(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=t,u=X(t,["encoding","projection"]),l=Object.assign(Object.assign({},s),{parentEncoding:SF({parentEncoding:i,encoding:o}),parentProjection:CF({parentProjection:r,projection:a})});return super.mapLayer(u,l)}}function SF(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const r=z(t).reduce((s,o)=>(n[o]&&s.push(o),s),[]);r.length>0&&R(cde(r))}const i=Object.assign(Object.assign({},t??{}),n??{});return Fe(i)?void 0:i}function CF(e){const{parentProjection:t,projection:n}=e;return t&&n&&R(fde({parentProjection:t,projection:n})),n??t}function g7(e,t){t===void 0&&(t=l7(e.config));const n=r0e(e,t),{width:i,height:r}=e,s=s0e(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const i0e=new n0e;function r0e(e,t={}){return i0e.map(e,{config:t})}function kF(e){return ce(e)?{type:e}:e??{}}function s0e(e,t,n){let{width:i,height:r}=t;const s=ss(e)||s1(e),o={};s?i=="container"&&r=="container"?(o.type="fit",o.contains="padding"):i=="container"?(o.type="fit-x",o.contains="padding"):r=="container"&&(o.type="fit-y",o.contains="padding"):(i=="container"&&(R(iF("width")),i=void 0),r=="container"&&(R(iF("height")),r=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?kF(n.autosize):{}),kF(e.autosize));if(a.type==="fit"&&!s&&(R(Qfe),a.type="pad"),i=="container"&&!(a.type=="fit"||a.type=="fit-x")&&R(rF("width")),r=="container"&&!(a.type=="fit"||a.type=="fit-y")&&R(rF("height")),!zd(a,{type:"pad"}))return a}function o0e(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function a0e(e){return e?`fit-${Vm(e)}`:"fit"}const u0e=["background","padding"];function FF(e){return u0e.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class cs{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new cs(fe(this.explicit),fe(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return Ze(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of z(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function ta(e){return{explicit:!0,value:e}}function kn(e){return{explicit:!1,value:e}}function p7(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:o1(t,n,i,r)}}function o1(e,t,n,i){return e.explicit&&t.explicit&&R(Dde(n,i,e.value,t.value)),e}function ro(e,t,n,i,r=o1){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:zd(e.value,t.value)?e:r(e,t,n,i)}class l0e extends cs{constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Kf(e){return"url"in e}function ap(e){return"values"in e}function m7(e){return"name"in e&&!Kf(e)&&!ap(e)&&!ga(e)}function ga(e){return e&&(y7(e)||b7(e)||v$(e))}function y7(e){return"sequence"in e}function b7(e){return"sphere"in e}function v$(e){return"graticule"in e}const Mt="main",up="raw";function v7(e){return"filter"in e}function c0e(e){return(e==null?void 0:e.stop)!==void 0}function f0e(e){return"lookup"in e}function d0e(e){return"data"in e}function h0e(e){return"selection"in e}function g0e(e){return"pivot"in e}function p0e(e){return"density"in e}function m0e(e){return"quantile"in e}function y0e(e){return"regression"in e}function b0e(e){return"loess"in e}function v0e(e){return"sample"in e}function x0e(e){return"window"in e}function w0e(e){return"joinaggregate"in e}function A0e(e){return"flatten"in e}function E0e(e){return"calculate"in e}function $0e(e){return"bin"in e}function _0e(e){return"impute"in e}function S0e(e){return"timeUnit"in e}function C0e(e){return"aggregate"in e}function k0e(e){return"stack"in e}function F0e(e){return"fold"in e}function O0e(e){return e.map(t=>v7(t)?{filter:xg(t.filter,yhe)}:t)}const D0e="view",lp="[",cp="]",x7="{",w7="}",M0e=":",A7=",",T0e="@",N0e=">",j0e=/[[\]{}]/,R0e={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let E7,$7;function Il(e,t,n){return E7=t||D0e,$7=n||R0e,_7(e.trim()).map(Zv)}function B0e(e){return $7[e]}function sf(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function _7(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=sf(e,r,A7,lp+x7,cp+w7),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function Zv(e){return e[0]==="["?P0e(e):z0e(e)}function P0e(e){const t=e.length;let n=1,i;if(n=sf(e,n,cp,lp,cp),n===t)throw"Empty between selector: "+e;if(i=_7(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==N0e)throw"Expected '>' after between selector: "+e;i=i.map(Zv);const r=Zv(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function z0e(e){const t={source:E7},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===w7){if(a=e.lastIndexOf(x7),a>=0){try{i=L0e(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===T0e&&(r=++a),u=sf(e,a,M0e),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=sf(e,a,lp),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=sf(e,a,cp),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==lp)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||j0e.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):B0e(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function L0e(e){const t=e.split(A7);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function Yd(e,t,n,i){const r=n$(t)&&t.condition,s=i(t);if(r){const a=Xe(r).map(u=>{const l=i(u),c=Yhe(u)?J7(e,u.selection):gp(e,u.test);return Object.assign({test:c},l)});return{[n]:[...a,...s!==void 0?[s]:[]]}}else return s!==void 0?{[n]:s}:{}}function x$(e,t="text"){const n=e.encoding[t];return Yd(e,n,t,i=>a1(i,e.config))}function a1(e,t,n="datum"){if(e){if(Zr(e))return Ve(e.value);if(ne(e)){const{format:i,formatType:r}=np(e);return QE({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function S7(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(Q(o))return{tooltip:OF({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return Yd(e,o,"tooltip",u=>{const l=a1(u,r,a);if(l)return l;if(u===null)return;let c=Ee("tooltip",i,r);if(c===!0&&(c={content:"encoding"}),ce(c))return{value:c};if(yt(c))return c.content==="encoding"?OF(n,s,r,t):{signal:a}})}}function C7(e,t,n,{reactiveGeom:i}={}){const r={},s=i?"datum.datum":"datum",o=[];function a(l,c){const f=Va(c),d=Ln(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=Xe(da(d,n,{allowDisabling:!1})).join(", ");let g;if(rr(c)){const p=c==="x"?"x2":"y2",m=sr(e[p]);if(Kt(d.bin)&&m){const y=L(d,{expr:s}),b=L(m,{expr:s}),{format:v,formatType:x}=np(d);g=Qm(y,b,v,x,n),r[p]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:y,formatType:b}=np(d);g=QE({fieldOrDatumDef:d,format:y,formatType:b,expr:s,config:n,normalizeStack:!0}).signal}}g=g??a1(d,n,s).signal,o.push({channel:c,key:h,value:g})}c$(e,(l,c)=>{U(l)?a(l,c):t1(l)&&a(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!r[l]&&!u[c]&&(u[pe(c)]=f);return u}function OF(e,t,n,{reactiveGeom:i}={}){const r=C7(e,t,n,{reactiveGeom:i}),s=F9(r).map(({key:o,value:a})=>`${o}: ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function I0e(e){const{markDef:t,config:n}=e,i=Ee("aria",t,n);return i===!1?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),U0e(e)),q0e(e))}function U0e(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=Ee("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:t in hhe?{}:{ariaRoleDescription:{value:t}}}function q0e(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return Yd(e,s,"description",u=>a1(u,e.config));const o=Ee("description",n,i);if(o!=null)return{description:Ve(o)};if(i.aria===!1)return{};const a=C7(t,r,i);if(!Fe(a))return{description:{signal:F9(a).map(({key:u,value:l})=>`${u} + ": " + (${l})`).join(' + "; " + ')}}}function ct(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:u}=n;a===void 0&&(u=u??Ee(e,i,s,{vgChannel:o,ignoreVgConfig:!0}),u!==void 0&&(a=Ve(u)));const l=r[e];return Yd(t,l,o??e,c=>AN({channel:e,channelDef:c,markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function k7(e,t={filled:void 0}){var n,i,r,s;const{markDef:o,encoding:a,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:Ee("filled",o,u),f=ee(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(r=(i=Ee(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&i!==void 0?i:u.mark[c===!0&&"color"])!==null&&r!==void 0?r:f,h=(s=Ee(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&s!==void 0?s:u.mark[c===!1&&"color"],g=c?"fill":"stroke",p=Object.assign(Object.assign({},d?{fill:Ve(d)}:{}),h?{stroke:Ve(h)}:{});return o.color&&(c?o.fill:o.stroke)&&R(Z9("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},p),ct("color",e,{vgChannel:g,defaultValue:c?d:h})),ct("fill",e,{defaultValue:a.fill?d:void 0})),ct("stroke",e,{defaultValue:a.stroke?h:void 0}))}function Jf(e,t){const n=qfe(e),i=t[n];if(i)return i}function Nt(e,t,{defaultPos:n,vgChannel:i,isMidPoint:r}){const{encoding:s,markDef:o,config:a,stack:u}=t,l=s[e],c=s[wr(e)],f=t.scaleName(e),d=t.getScaleComponent(e),h=Jf(e,o),g=w$({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),p=!l&&rr(e)&&(s.latitude||s.longitude)?{field:t.getName(e)}:W0e({channel:e,channelDef:l,channel2Def:c,markDef:o,config:a,isMidPoint:r,scaleName:f,scale:d,stack:u,offset:h,defaultRef:g});return p?{[i||e]:p}:void 0}function W0e(e){const{channel:t,channelDef:n,isMidPoint:i,scaleName:r,stack:s,offset:o,markDef:a,config:u}=e;if(ne(n)&&s&&t===s.fieldChannel){if(U(n)){const l=Hd({channel:t,fieldDef:n,isMidPoint:i,markDef:a,stack:s,config:u});if(l!==void 0)return tp({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:o})}return fa(n,r,{suffix:"end"},{offset:o})}return KE(e)}function w$({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=Va(n),u=io(n),l=Ee(n,s,o,{vgChannel:u});if(l!==void 0)return rf(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const c=r.get("type");if(!ee([Ke.LOG,Ke.TIME,Ke.UTC],c)){if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}}if(t==="zeroOrMin")return a==="y"?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Ar(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const H0e={left:"x",center:"xc",right:"x2"},G0e={top:"y",middle:"yc",bottom:"y2"};function F7(e,t,n,i="middle"){if(e==="radius"||e==="theta")return io(e);const s=Ee(e==="x"?"align":"baseline",t,n);return e==="x"?H0e[s||(i==="top"?"left":"center")]:G0e[s||i]}function fp(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?O7(e,t,{defaultPos:n,defaultPos2:i}):Nt(e,t,{defaultPos:n})}function O7(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=wr(e),a=Ar(e),u=Y0e(t,i,o),l=u[a]?F7(e,r,s):io(e);return Object.assign(Object.assign({},Nt(e,t,{defaultPos:n,vgChannel:l})),u)}function Y0e(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,u=Va(n),l=Ar(n),c=io(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),g=n in i||n in s?Jf(n,e.markDef):Jf(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude))return{[c]:{field:e.getName(n)}};const p=V0e({channel:n,channelDef:f,channel2Def:i[n],markDef:s,config:a,scaleName:d,scale:h,stack:o,offset:g,defaultRef:void 0});return p!==void 0?{[c]:p}:Bh(n,s)||Bh(n,{[n]:rp(n,s,a.style),[l]:rp(l,s,a.style)})||Bh(n,a[r])||Bh(n,a.mark)||{[c]:w$({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function V0e({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l}){return ne(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?fa(t,s,{suffix:"start"},{offset:u}):KE({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:u,defaultRef:l})}function Bh(e,t){const n=Ar(e),i=io(e);if(t[i]!==void 0)return{[i]:rf(e,t[i])};if(t[e]!==void 0)return{[i]:rf(e,t[e])};if(t[n])return{[n]:rf(e,t[n])}}function so(e,t,n){var i,r,s,o;const{config:a,encoding:u,markDef:l,stack:c}=e,f=wr(t),d=Ar(t),h=u[t],g=u[f],p=e.getScaleComponent(t),m=p?p.get("type"):void 0,y=e.scaleName(t),b=l.orient,v=(r=(i=u[d])!==null&&i!==void 0?i:u.size)!==null&&r!==void 0?r:Ee("size",l,a,{vgChannel:d}),x=n==="bar"&&(t==="x"?b==="vertical":b==="horizontal");if(U(h)&&(Me(h.bin)||Kt(h.bin)||h.timeUnit&&!g)&&!v&&!$n(m)){const A=Hd({channel:t,fieldDef:h,stack:c,markDef:l,config:a}),E=(s=e.component.axes[t])===null||s===void 0?void 0:s[0],w=(o=E==null?void 0:E.get("translate"))!==null&&o!==void 0?o:.5;return J0e({fieldDef:h,fieldDef2:g,channel:t,markDef:l,scaleName:y,band:A,axisTranslate:w,spacing:rr(t)?Ee("binSpacing",l,a):void 0,reverse:p.get("reverse"),config:a})}else return(ne(h)&&$n(m)||x)&&!g?K0e(n,h,t,e):O7(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function X0e(e,t,n,i,r,s){if(i){const u=i.get("type");if(u==="point"||u==="band"){if(r[e].discreteBandSize!==void 0)return{value:r[e].discreteBandSize};if(u===Ke.POINT){const l=i.get("range");return Ao(l)&&Qe(l.step)?{value:l.step-2}:{value:b$-2}}else return{scale:n,band:s}}else return{value:r[e].continuousBandSize}}const o=op(r.view,t),a=Ze(r[e].discreteBandSize,o-2);return a!==void 0?{value:a}:void 0}function K0e(e,t,n,i){var r;const{markDef:s,encoding:o,config:a,stack:u}=i,l=s.orient,c=i.scaleName(n),f=i.getScaleComponent(n),d=Ar(n),h=wr(n),g=l==="horizontal"&&n==="y"||l==="vertical"&&n==="x",p=Ee(g?"size":d,s,a,{vgChannel:d});let m;(o.size||p!==void 0)&&(g?m=ct("size",i,{vgChannel:d,defaultValue:p}):R(kde(s.type)));const y=(r=ne(t)?Hd({channel:n,fieldDef:t,markDef:s,stack:u,config:a}):void 0)!==null&&r!==void 0?r:1;m=m||{[d]:X0e(e,d,c,f,a,y)};const b=(f==null?void 0:f.get("type"))!=="band"||!("band"in m[d]),v=F7(n,s,a,b?"middle":"top"),x=Jf(n,s),A=KE({channel:n,channelDef:t,markDef:s,config:a,scaleName:c,scale:f,stack:u,offset:x,defaultRef:w$({model:i,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:b?.5:(1-y)/2});if(d)return Object.assign({[v]:A},m);{const E=io(h),w=m[d],$=x?Object.assign(Object.assign({},w),{offset:x}):w;return{[v]:A,[E]:Q(A)?[A[0],Object.assign(Object.assign({},A[1]),{offset:$})]:Object.assign(Object.assign({},A),{offset:$})}}}function hc(e,t,n,i,r){if(I9(e))return 0;const s=e==="x"||e==="y2"?-t/2:t/2;if(te(n)){const o=Vf(r);return{signal:`${n.signal} ? ${i-s}${o?"-"+o:""} : ${i+s}${o?"+"+o:""}`}}else{if(te(r)){const o=i+(n?-s:s);return{signal:`${o||""}${n?" - ":o?" + ":""}${r.signal}`}}return r=r||0,i+(n?-r-s:+r+s)}}function J0e({fieldDef:e,fieldDef2:t,channel:n,band:i,scaleName:r,markDef:s,spacing:o=0,axisTranslate:a,reverse:u,config:l}){const c=wr(n),f=io(n),d=io(c),h=Jf(n,s);if(Me(e.bin)||e.timeUnit)return{[d]:DF({channel:n,fieldDef:e,scaleName:r,markDef:s,band:(1-i)/2,offset:hc(c,o,u,a,h),config:l}),[f]:DF({channel:n,fieldDef:e,scaleName:r,markDef:s,band:1-(1-i)/2,offset:hc(n,o,u,a,h),config:l})};if(Kt(e.bin)){const g=fa(e,r,{},{offset:hc(c,o,u,a,h)});if(U(t))return{[d]:g,[f]:fa(t,r,{},{offset:hc(n,o,u,a,h)})};if(qd(e.bin)&&e.bin.step)return{[d]:g,[f]:{signal:`scale("${r}", ${L(e,{expr:"datum"})} + ${e.bin.step})`,offset:hc(n,o,u,a,h)}}}R(nN(c))}function DF({channel:e,fieldDef:t,scaleName:n,markDef:i,band:r,offset:s,config:o}){const a=tp({scaleName:n,fieldOrDatumDef:t,band:r,offset:s});return wN({fieldDef:t,channel:e,markDef:i,ref:a,config:o})}const Q0e=new Set(["aria"]);function ni(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?k7(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Z0e(e.markDef,t)),MF(e,"fill",n)),MF(e,"stroke",i)),ct("opacity",e)),ct("fillOpacity",e)),ct("strokeOpacity",e)),ct("strokeWidth",e)),ct("strokeDash",e)),S7(e)),x$(e,"href")),I0e(e))}function MF(e,t,n){const{config:i,mark:r,markDef:s}=e;if(Ee("invalid",s,i)==="hide"&&n&&!Ha(r)){const a=epe(e,{invalid:!0,channels:Xm});if(a)return{[t]:[{test:a,value:null},...Xe(n)]}}return n?{[t]:n}:{}}function Z0e(e,t){return dhe.reduce((n,i)=>(!Q0e.has(i)&&e[i]!==void 0&&t[i]!=="ignore"&&(n[i]=Ve(e[i])),n),{})}function epe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&ei(u)&&(s[l]=!0)}return s},{}),r=z(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>JE(o,t)).join(` ${s} `)}}function A$(e){const{config:t,markDef:n}=e;if(Ee("invalid",n,t)){const r=tpe(e,{channels:Zn});if(r)return{defined:{signal:r}}}return{}}function tpe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&ei(u)&&(s[l]=!0)}return s},{}),r=z(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>JE(o,t)).join(` ${s} `)}}function TF(e,t){if(t!==void 0)return{[e]:Ve(t)}}const qy="voronoi",D7={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(qy)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(Ha(s))return R(ede(s)),n;const o={name:e.getName(qy),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},S7(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?a=c:d.indexOf(qy)>=0&&(u=!0)}),u||n.splice(a+1,0,o),n}};class Ce{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class en extends Ce{constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${lfe()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class Xi extends Ce{constructor(t,n){super(t),this.formula=n}clone(){return new Xi(null,fe(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{const{field:a,timeUnit:u}=s,l=We(n)?n.encoding[wr(o)]:void 0,c=We(n)&&t$(o,s,l,n.stack,n.markDef,n.config);if(u){const f=L(s,{forAs:!0});r[me({as:f,field:a,timeUnit:u})]=Object.assign({as:f,field:a,timeUnit:u},c?{band:!0}:{})}return r},{});return Fe(i)?null:new Xi(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,s=X(i,["timeUnit"]),o=rn(r),a=Object.assign(Object.assign({},s),{timeUnit:o});return new Xi(t,{[me(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(Is(this.formula).map(t=>t.as))}dependentFields(){return new Set(Is(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${me(this.formula)}`}assemble(){const t=[];for(const n of Is(this.formula)){const{field:i,as:r,timeUnit:s}=n,o=rn(s),{unit:a,utc:u}=o,l=X(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:to(i),type:"timeunit"},a?{units:qE(a)}:{}),u?{timezone:"utc"}:{}),l),{as:[r,`${r}_end`]}))}return t}}const Vd="_tuple_fields";class npe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const ipe={has:()=>!0,parse:(e,t,n)=>{var i,r,s;const o=t.name,a=(i=t.project)!==null&&i!==void 0?i:t.project=new npe,u={},l={},c=new Set,f=(d,h)=>{const g=h==="visual"?d.channel:d.field;let p=Be(`${o}_${g}`);for(let m=1;c.has(p);m++)p=Be(`${o}_${g}_${m}`);return c.add(p),{[h]:p}};if(!n.fields&&!n.encodings){const d=e.config.selection[n.type];if(n.init)for(const h of Xe(n.init))for(const g of z(h))Ife(g)?(n.encodings||(n.encodings=[])).push(g):n.type==="interval"?(R('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(g);else n.encodings=d.encodings,n.fields=d.fields}for(const d of(r=n.fields)!==null&&r!==void 0?r:[]){const h={type:"E",field:d};h.signals=Object.assign({},f(h,"data")),a.items.push(h),a.hasField[d]=h}for(const d of(s=n.encodings)!==null&&s!==void 0?s:[]){const h=e.fieldDef(d);if(h){let g=h.field;if(h.aggregate){R(Zfe(d,h.aggregate));continue}else if(!g){R(oF(d));continue}if(h.timeUnit){g=e.vgField(d);const p={timeUnit:h.timeUnit,as:g,field:h.field};l[me(p)]=p}if(!u[g]){let p="E";if(t.type==="interval"){const y=e.getScaleComponent(d).get("type");ei(y)&&(p="R")}else h.bin&&(p="R-RE");const m={field:g,channel:d,type:p};m.signals=Object.assign(Object.assign({},f(m,"data")),f(m,"visual")),a.items.push(u[g]=m),a.hasField[g]=a.hasChannel[d]=u[g]}}else R(oF(d))}if(n.init){const d=h=>a.items.map(g=>h[g.channel]!==void 0?h[g.channel]:h[g.field]);if(n.type==="interval")t.init=d(n.init);else{const h=Xe(n.init);t.init=h.map(d)}}Fe(l)||(a.timeUnit=new Xi(null,l))},signals:(e,t,n)=>{const i=t.name+Vd;return n.filter(s=>s.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(s=>{const o=X(s,["signals","hasLegend"]);return o.field=to(o.field),o})})}},M7={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!p$(e.bind),parse:(e,t,n,i)=>{i.on||delete t.events,i.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=D7.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{var c,f;const d=Be(`${i}_${u.field}`);n.filter(g=>g.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:Ju(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${pe(u.field)}] : null`}]:[],bind:(f=(c=s[u.field])!==null&&c!==void 0?c:s[u.channel])!==null&&f!==void 0?f:s}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.filter(l=>l.name===i+ar)[0],o=i+Vd,a=r.items.map(l=>Be(`${i}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(s.update=`${u} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},dp="_toggle",T7={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+dp,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+ar,i=t.name+dp;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${Gr(e)}}, `)+`${i} ? ${n} : null`}},rpe={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=ce(n.clear)?Il(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(M7.has(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===Be(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);if(i(s,"[0, 0]"),s===-1){const o=n.findIndex(a=>a.name===r.signals.data);i(o,"null")}}else{let r=n.findIndex(s=>s.name===t.name+ar);i(r,"null"),T7.has(t)&&(r=n.findIndex(s=>s.name===t.name+dp),i(r,"false"))}return n}},oo={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!wo(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;if(!s||!ei(o)){R(nde);continue}const a={selection:t.name,field:i.field};s.set("selectionExtent",a,!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>n.filter(a=>a.name===o.signals.data).length===0);if(!e.parent||tx(e)||i.length===0)return n;const r=n.filter(o=>o.name===t.name)[0];let s=r.update;if(s.indexOf(U7)>=0)r.update=`{${i.map(o=>`${pe(o.field)}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${pe(o.field)}: ${o.signals.data}`;s.indexOf(a)<0&&(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!tx(e))for(const i of t.scales){const r=n.filter(s=>s.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function ex(e,t){return`domain(${pe(e.scaleName(t))})`}function tx(e){var t;return e.parent&&Gl(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:tx(e.parent.parent))}const N7={has:e=>{const t=e.resolve==="global"&&e.bind&&p$(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Ku;return t&&!n&&R(ide),t&&n},parse:(e,t,n,i)=>{var r;if(i.on||delete t.events,i.clear||delete t.clear,i.on||i.clear){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=Xe((r=u.filter)!==null&&r!==void 0?r:[]),u.filter.indexOf(a)<0&&u.filter.push(a)}const s=Ly(t.bind)?t.bind.legend:"click",o=ce(s)?Il(s,"view"):Xe(s);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=Ly(t.bind)&&t.bind.legend,s=o=>a=>{const u=fe(a);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${Be(o.field)}_legend`,u=`${i}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(d=>d.name===i+ar),o=i+Vd,a=r.items.filter(d=>d.hasLegend).map(d=>Be(`${i}_${Be(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(s.update=l,delete s.value,delete s.on);const c=n.find(d=>d.name===i+dp),f=Ly(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function spe(e,t,n){var i;const r=(i=e.fieldDef(t))===null||i===void 0?void 0:i.field;Xa(e,s=>{var o,a;const u=(o=s.project.hasField[r])!==null&&o!==void 0?o:s.project.hasChannel[t];if(u&&N7.has(s)){const l=(a=n.get("selections"))!==null&&a!==void 0?a:[];l.push(s.name),n.set("selections",l,!1),u.hasLegend=!0}})}const j7="_translate_anchor",R7="_translate_delta",ope={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=oo.has(t),s=i+j7,{x:o,y:a}=t.project.hasChannel;let u=Il(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+of,l))),n.push({name:s,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?", extent_x: "+(r?ex(e,Le):`slice(${o.signals.visual})`):"")+(a!==void 0?", extent_y: "+(r?ex(e,ot):`slice(${a.signals.visual})`):"")+"}"}]},{name:i+R7,value:{},on:[{events:u,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==void 0&&NF(e,t,o,"width",n),a!==void 0&&NF(e,t,a,"height",n),n}};function NF(e,t,n,i,r){var s;const o=t.name,a=o+j7,u=o+R7,l=n.channel,c=oo.has(t),f=r.filter(x=>x.name===n.signals[c?"data":"visual"])[0],d=e.getSizeSignalRef(i).signal,h=e.getScaleComponent(l),g=h.get("type"),p=c&&l===Le?"-":"",m=`${a}.extent_${l}`,y=`${p}${u}.${l} / `+(c?`${d}`:`span(${m})`),v=`${c?g==="log"?"panLog":g==="pow"?"panPow":"panLinear":"panLinear"}(${m}, ${y}`+(c&&g==="pow"?`, ${(s=h.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";f.on.push({events:{signal:u},update:c?v:`clampRange(${v}, 0, ${d})`})}const B7="_zoom_anchor",P7="_zoom_delta",ape={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=oo.has(t),s=i+P7,{x:o,y:a}=t.project.hasChannel,u=pe(e.scaleName(Le)),l=pe(e.scaleName(ot));let c=Il(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+of,f))),n.push({name:i+B7,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&jF(e,t,o,"width",n),a!==void 0&&jF(e,t,a,"height",n),n}};function jF(e,t,n,i,r){var s;const o=t.name,a=n.channel,u=oo.has(t),l=r.filter(b=>b.name===n.signals[u?"data":"visual"])[0],c=e.getSizeSignalRef(i).signal,f=e.getScaleComponent(a),d=f.get("type"),h=u?ex(e,a):l.name,g=o+P7,p=`${o}${B7}.${a}`,y=`${u?d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${p}, ${g}`+(u&&d==="pow"?`, ${(s=f.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";l.on.push({events:{signal:g},update:u?y:`clampRange(${y}, 0, ${c})`})}const upe=[ipe,T7,oo,N7,ope,ape,M7,D7,rpe];function u1(e,t){for(const n of upe)n.has(e)&&t(n)}function Ju(e,t=!0,n=qce){if(Q(e)){const i=e.map(r=>Ju(r,t,n));return t?`[${i.join(", ")}]`:i}else if(Pl(e))return n(t?Yf(e):nhe(e));return t?n(JSON.stringify(e)):e}function lpe(e,t){return Xa(e,(n,i)=>{const r=n.name;let s=i.modifyExpr(e,n);t.push(...i.signals(e,n)),u1(n,o=>{o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(s=o.modifyExpr(e,n,s))}),t.push({name:r+vpe,on:[{events:{signal:n.name+ar},update:`modify(${pe(n.name+Oa)}, ${s})`}]})}),E$(t)}function cpe(e,t){if(e.component.selection&&z(e.component.selection).length){const n=pe(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Il("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return E$(t)}function fpe(e,t){let n=!1;return Xa(e,(i,r)=>{const s=i.name,o=pe(s+Oa);if(t.filter(u=>u.name===s).length===0){const u=i.resolve==="global"?"union":i.resolve,l=i.type==="multi"?", true)":")";t.push({name:i.name,update:`${U7}(${o}, ${pe(u)}${l}`})}n=!0,r.topLevelSignals&&(t=r.topLevelSignals(e,i,t)),u1(i,u=>{u.topLevelSignals&&(t=u.topLevelSignals(e,i,t))})}),n&&t.filter(r=>r.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),E$(t)}function dpe(e,t){const n=[...t];return Xa(e,i=>{const r={name:i.name+Oa};if(i.init){const o=i.project.items.map(u=>X(u,["signals"])),a=i.init.map(u=>Ju(u,!1));r.values=i.type==="interval"?[{unit:Gr(e,{escape:!1}),fields:o,values:a}]:a.map(u=>({unit:Gr(e,{escape:!1}),fields:o,values:u}))}n.filter(o=>o.name===i.name+Oa).length||n.push(r)}),n}function z7(e,t){return Xa(e,(n,i)=>{t=i.marks?i.marks(e,n,t):t,u1(n,r=>{r.marks&&(t=r.marks(e,n,t))})}),t}function hpe(e,t){for(const n of e.children)We(n)&&(t=z7(n,t));return t}function gpe(e,t){const n=t.selection,i=e.getSelectionComponent(n,Be(n));return{signal:Q7(i,t)}}function E$(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const of="_brush",nx="_scale_trigger",ppe={signals:(e,t)=>{const n=t.name,i=n+Vd,r=oo.has(t),s=[],o=[],a=[];if(t.translate&&!r){const c=`!event.item || event.item.mark.name !== ${pe(n+of)}`;L7(t,(f,d)=>{var h;const g=Xe((h=d.between[0].filter)!==null&&h!==void 0?h:d.between[0].filter=[]);return g.indexOf(c)<0&&g.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==Le&&d!==ot){R("Interval selections only support x and y encoding channels.");return}const h=t.init?t.init[f]:null,g=mpe(e,t,c,h),p=c.signals.data,m=c.signals.visual,y=pe(e.scaleName(d)),b=e.getScaleComponent(d).get("type"),v=ei(b)?"+":"";s.push(...g),o.push(p),a.push({scaleName:e.scaleName(d),expr:`(!isArray(${p}) || (${v}invert(${y}, ${m})[0] === ${v}${p}[0] && ${v}invert(${y}, ${m})[1] === ${v}${p}[1]))`})}),r||s.push({name:n+nx,value:{},on:[{events:a.map(c=>({scale:c.scaleName})),update:a.map(c=>c.expr).join(" && ")+` ? ${n+nx} : {}`}]});const u=t.init,l=`unit: ${Gr(e)}, fields: ${i}, values`;return s.concat(Object.assign(Object.assign({name:n+ar},u?{init:`{${l}: ${Ju(u)}}`}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+` ? {${l}: [${o}]} : null`}]}))},modifyExpr:(e,t)=>t.name+ar+", "+(t.resolve==="global"?"true":`{unit: ${Gr(e)}}`),marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=r&&r.signals.visual,a=s&&s.signals.visual,u=`data(${pe(t.name+Oa)})`;if(oo.has(t))return n;const l={x:r!==void 0?{signal:`${o}[0]`}:{value:0},y:s!==void 0?{signal:`${a}[0]`}:{value:0},x2:r!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of z(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Gr(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,g=X(c,["fill","fillOpacity","cursor"]),p=z(g).reduce((m,y)=>(m[y]=[{test:[r!==void 0&&`${o}[0] !== ${o}[1]`,s!==void 0&&`${a}[0] !== ${a}[1]`].filter(b=>b).join(" && "),value:g[y]},{value:null}],m),{});return[{name:i+of+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:i+of,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),p)}}]}};function mpe(e,t,n,i){const r=n.channel,s=n.signals.visual,o=n.signals.data,a=oo.has(t),u=pe(e.scaleName(r)),l=e.getScaleComponent(r),c=l?l.get("type"):void 0,f=p=>`scale(${u}, ${p})`,d=e.getSizeSignalRef(r===Le?"width":"height").signal,h=`${r}(unit)`,g=L7(t,(p,m)=>[...p,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${s}[0], clamp(${h}, 0, ${d})]`}]);return g.push({events:{signal:t.name+nx},update:ei(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),a?[{name:o,on:[]}]:[Object.assign(Object.assign({name:s},i?{init:Ju(i,!0,f)}:{value:[]}),{on:g}),Object.assign(Object.assign({name:o},i?{init:Ju(i)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${u}, ${s})`}]})]}function L7(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(R(`${i} is not an ordered event stream for interval selections.`),n),[])}function I7(e,t){const n=t.name,i=n+Vd,r=t.project,s="(item().isVoronoi ? datum.datum : datum)",o=r.items.map(l=>{const c=e.fieldDef(l.channel);return c&&c.bin?`[${s}[${pe(e.vgField(l.channel,{}))}], ${s}[${pe(e.vgField(l.channel,{binSuffix:"end"}))}]]`:`${s}[${pe(l.field)}]`}).join(", "),a=`unit: ${Gr(e)}, fields: ${i}, values`,u=t.events;return[{name:n+ar,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${a}: [${o}]} : null`,force:!0}]:[]}]}const ype={signals:I7,modifyExpr:(e,t)=>t.name+ar+", "+(t.resolve==="global"?"null":`{unit: ${Gr(e)}}`)},bpe={signals:I7,modifyExpr:(e,t)=>t.name+ar+", "+(t.resolve==="global"?"true":`{unit: ${Gr(e)}}`)},Oa="_store",ar="_tuple",vpe="_modify",U7="vlSelectionResolve",xpe={single:bpe,multi:ype,interval:ppe};function Xa(e,t){const n=e.component.selection;if(n){for(const i of Is(n))if(t(i,xpe[i.type])===!0)break}}function wpe(e){let t=e.parent;for(;t&&!wi(t);)t=t.parent;return t}function Gr(e,{escape:t}={escape:!0}){let n=t?pe(e.name):e.name;const i=wpe(e);if(i){const{facet:r}=i;for(const s of Gn)r[s]&&(n+=` + '__facet_${s}_' + (facet[${pe(i.vgField(s))}])`)}return n}function $$(e){let t=!1;return Xa(e,n=>{t=t||n.project.items.some(i=>i.field===Ku)}),t}const Ape="RawCode",Epe="Literal",$pe="Property",_pe="Identifier",Spe="ArrayExpression",Cpe="BinaryExpression",kpe="CallExpression",Fpe="ConditionalExpression",Ope="LogicalExpression",Dpe="MemberExpression",Mpe="ObjectExpression",Tpe="UnaryExpression";function Mi(e){this.type=e}Mi.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=Npe(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function Npe(e){switch(e.type){case Spe:return e.elements;case Cpe:case Ope:return[e.left,e.right];case kpe:return[e.callee].concat(e.arguments);case Fpe:return[e.test,e.consequent,e.alternate];case Dpe:return[e.object,e.property];case Mpe:return e.properties;case $pe:return[e.key,e.value];case Tpe:return[e.argument];case _pe:case Epe:case Ape:default:return[]}}var Er,G,N,Lt,_e,l1=1,Xd=2,Da=3,$o=4,c1=5,Ka=6,cn=7,Kd=8,jpe=9;Er={};Er[l1]="Boolean";Er[Xd]="<end>";Er[Da]="Identifier";Er[$o]="Keyword";Er[c1]="Null";Er[Ka]="Numeric";Er[cn]="Punctuator";Er[Kd]="String";Er[jpe]="RegularExpression";var Rpe="ArrayExpression",Bpe="BinaryExpression",Ppe="CallExpression",zpe="ConditionalExpression",q7="Identifier",Lpe="Literal",Ipe="LogicalExpression",Upe="MemberExpression",qpe="ObjectExpression",Wpe="Property",Hpe="UnaryExpression",wt="Unexpected token %0",Gpe="Unexpected number",Ype="Unexpected string",Vpe="Unexpected identifier",Xpe="Unexpected reserved word",Kpe="Unexpected end of input",ix="Invalid regular expression",Wy="Invalid regular expression: missing /",W7="Octal literals are not allowed in strict mode.",Jpe="Duplicate data property in object literal not allowed in strict mode",jt="ILLEGAL",Qf="Disabled.",Qpe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Zpe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function f1(e,t){if(!e)throw new Error("ASSERT: "+t)}function Dr(e){return e>=48&&e<=57}function _$(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function af(e){return"01234567".indexOf(e)>=0}function eme(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Zf(e){return e===10||e===13||e===8232||e===8233}function Jd(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Qpe.test(String.fromCharCode(e))}function hp(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Zpe.test(String.fromCharCode(e))}var tme={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function H7(){for(var e;N<Lt&&(e=G.charCodeAt(N),eme(e)||Zf(e));)++N}function rx(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)N<Lt&&_$(G[N])?(i=G[N++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):xe({},wt,jt);return String.fromCharCode(r)}function nme(){var e,t,n,i;for(e=G[N],t=0,e==="}"&&xe({},wt,jt);N<Lt&&(e=G[N++],!!_$(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&xe({},wt,jt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function G7(){var e,t;for(e=G.charCodeAt(N++),t=String.fromCharCode(e),e===92&&(G.charCodeAt(N)!==117&&xe({},wt,jt),++N,e=rx("u"),(!e||e==="\\"||!Jd(e.charCodeAt(0)))&&xe({},wt,jt),t=e);N<Lt&&(e=G.charCodeAt(N),!!hp(e));)++N,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),G.charCodeAt(N)!==117&&xe({},wt,jt),++N,e=rx("u"),(!e||e==="\\"||!hp(e.charCodeAt(0)))&&xe({},wt,jt),t+=e);return t}function ime(){var e,t;for(e=N++;N<Lt;){if(t=G.charCodeAt(N),t===92)return N=e,G7();if(hp(t))++N;else break}return G.slice(e,N)}function rme(){var e,t,n;return e=N,t=G.charCodeAt(N)===92?G7():ime(),t.length===1?n=Da:tme.hasOwnProperty(t)?n=$o:t==="null"?n=c1:t==="true"||t==="false"?n=l1:n=Da,{type:n,value:t,start:e,end:N}}function Hy(){var e=N,t=G.charCodeAt(N),n,i=G[N],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++N,{type:cn,value:String.fromCharCode(t),start:e,end:N};default:if(n=G.charCodeAt(N+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return N+=2,{type:cn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:N};case 33:case 61:return N+=2,G.charCodeAt(N)===61&&++N,{type:cn,value:G.slice(e,N),start:e,end:N}}}if(o=G.substr(N,4),o===">>>=")return N+=4,{type:cn,value:o,start:e,end:N};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return N+=3,{type:cn,value:s,start:e,end:N};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return N+=2,{type:cn,value:r,start:e,end:N};if("<>=!+-*%&|^/".indexOf(i)>=0)return++N,{type:cn,value:i,start:e,end:N};xe({},wt,jt)}function sme(e){for(var t="";N<Lt&&_$(G[N]);)t+=G[N++];return t.length===0&&xe({},wt,jt),Jd(G.charCodeAt(N))&&xe({},wt,jt),{type:Ka,value:parseInt("0x"+t,16),start:e,end:N}}function ome(e){for(var t="0"+G[N++];N<Lt&&af(G[N]);)t+=G[N++];return(Jd(G.charCodeAt(N))||Dr(G.charCodeAt(N)))&&xe({},wt,jt),{type:Ka,value:parseInt(t,8),octal:!0,start:e,end:N}}function RF(){var e,t,n;if(n=G[N],f1(Dr(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=N,e="",n!=="."){if(e=G[N++],n=G[N],e==="0"){if(n==="x"||n==="X")return++N,sme(t);if(af(n))return ome(t);n&&Dr(n.charCodeAt(0))&&xe({},wt,jt)}for(;Dr(G.charCodeAt(N));)e+=G[N++];n=G[N]}if(n==="."){for(e+=G[N++];Dr(G.charCodeAt(N));)e+=G[N++];n=G[N]}if(n==="e"||n==="E")if(e+=G[N++],n=G[N],(n==="+"||n==="-")&&(e+=G[N++]),Dr(G.charCodeAt(N)))for(;Dr(G.charCodeAt(N));)e+=G[N++];else xe({},wt,jt);return Jd(G.charCodeAt(N))&&xe({},wt,jt),{type:Ka,value:parseFloat(e),start:t,end:N}}function ame(){var e="",t,n,i,r,s=!1;for(t=G[N],f1(t==="'"||t==='"',"String literal must starts with a quote"),n=N,++N;N<Lt;)if(i=G[N++],i===t){t="";break}else if(i==="\\")if(i=G[N++],!i||!Zf(i.charCodeAt(0)))switch(i){case"u":case"x":G[N]==="{"?(++N,e+=nme()):e+=rx(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:af(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),N<Lt&&af(G[N])&&(s=!0,r=r*8+"01234567".indexOf(G[N++]),"0123".indexOf(i)>=0&&N<Lt&&af(G[N])&&(r=r*8+"01234567".indexOf(G[N++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&G[N]===`
`&&++N;else{if(Zf(i.charCodeAt(0)))break;e+=i}return t!==""&&xe({},wt,jt),{type:Kd,value:e,octal:s,start:n,end:N}}function ume(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(i,r){if(parseInt(r,16)<=1114111)return"x";xe({},ix)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{xe({},ix)}try{return new RegExp(e,t)}catch{return null}}function lme(){var e,t,n,i,r;for(e=G[N],f1(e==="/","Regular expression literal must start with a slash"),t=G[N++],n=!1,i=!1;N<Lt;)if(e=G[N++],t+=e,e==="\\")e=G[N++],Zf(e.charCodeAt(0))&&xe({},Wy),t+=e;else if(Zf(e.charCodeAt(0)))xe({},Wy);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||xe({},Wy),r=t.substr(1,t.length-2),{value:r,literal:t}}function cme(){var e,t,n;for(t="",n="";N<Lt&&(e=G[N],!!hp(e.charCodeAt(0)));)++N,e==="\\"&&N<Lt?xe({},wt,jt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&xe({},ix,n),{value:n,literal:t}}function fme(){var e,t,n,i;return _e=null,H7(),e=N,t=lme(),n=cme(),i=ume(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:N}}function dme(e){return e.type===Da||e.type===$o||e.type===l1||e.type===c1}function Y7(){var e;return H7(),N>=Lt?{type:Xd,start:N,end:N}:(e=G.charCodeAt(N),Jd(e)?rme():e===40||e===41||e===59?Hy():e===39||e===34?ame():e===46?Dr(G.charCodeAt(N+1))?RF():Hy():Dr(e)?RF():Hy())}function pn(){var e;return e=_e,N=e.end,_e=Y7(),N=e.end,e}function V7(){var e;e=N,_e=Y7(),N=e}function hme(e){var t=new Mi(Rpe);return t.elements=e,t}function BF(e,t,n){var i=new Mi(e==="||"||e==="&&"?Ipe:Bpe);return i.operator=e,i.left=t,i.right=n,i}function gme(e,t){var n=new Mi(Ppe);return n.callee=e,n.arguments=t,n}function pme(e,t,n){var i=new Mi(zpe);return i.test=e,i.consequent=t,i.alternate=n,i}function S$(e){var t=new Mi(q7);return t.name=e,t}function Pc(e){var t=new Mi(Lpe);return t.value=e.value,t.raw=G.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function PF(e,t,n){var i=new Mi(Upe);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function mme(e){var t=new Mi(qpe);return t.properties=e,t}function zF(e,t,n){var i=new Mi(Wpe);return i.key=t,i.value=n,i.kind=e,i}function yme(e,t){var n=new Mi(Hpe);return n.operator=e,n.argument=t,n.prefix=!0,n}function xe(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,function(s,o){return f1(o<i.length,"Message reference must be in range"),i[o]});throw n=new Error(r),n.index=N,n.description=r,n}function d1(e){e.type===Xd&&xe(e,Kpe),e.type===Ka&&xe(e,Gpe),e.type===Kd&&xe(e,Ype),e.type===Da&&xe(e,Vpe),e.type===$o&&xe(e,Xpe),xe(e,wt,e.value)}function It(e){var t=pn();(t.type!==cn||t.value!==e)&&d1(t)}function Ne(e){return _e.type===cn&&_e.value===e}function Gy(e){return _e.type===$o&&_e.value===e}function bme(){var e=[];for(N=_e.start,It("[");!Ne("]");)Ne(",")?(pn(),e.push(null)):(e.push(Ma()),Ne("]")||It(","));return pn(),hme(e)}function LF(){var e;return N=_e.start,e=pn(),e.type===Kd||e.type===Ka?(e.octal&&xe(e,W7),Pc(e)):S$(e.value)}function vme(){var e,t,n,i;if(N=_e.start,e=_e,e.type===Da)return n=LF(),It(":"),i=Ma(),zF("init",n,i);if(e.type===Xd||e.type===cn)d1(e);else return t=LF(),It(":"),i=Ma(),zF("init",t,i)}function xme(){var e=[],t,n,i,r={},s=String;for(N=_e.start,It("{");!Ne("}");)t=vme(),t.key.type===q7?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?xe({},Jpe):r[i]=!0,e.push(t),Ne("}")||It(",");return It("}"),mme(e)}function wme(){var e;return It("("),e=C$(),It(")"),e}var Ame={if:1};function Eme(){var e,t,n;if(Ne("("))return wme();if(Ne("["))return bme();if(Ne("{"))return xme();if(e=_e.type,N=_e.start,e===Da||Ame[_e.value])n=S$(pn().value);else if(e===Kd||e===Ka)_e.octal&&xe(_e,W7),n=Pc(pn());else{if(e===$o)throw new Error(Qf);e===l1?(t=pn(),t.value=t.value==="true",n=Pc(t)):e===c1?(t=pn(),t.value=null,n=Pc(t)):Ne("/")||Ne("/=")?(n=Pc(fme()),V7()):d1(pn())}return n}function $me(){var e=[];if(It("("),!Ne(")"))for(;N<Lt&&(e.push(Ma()),!Ne(")"));)It(",");return It(")"),e}function _me(){var e;return N=_e.start,e=pn(),dme(e)||d1(e),S$(e.value)}function Sme(){return It("."),_me()}function Cme(){var e;return It("["),e=C$(),It("]"),e}function kme(){var e,t,n;for(e=Eme();;)if(Ne("."))n=Sme(),e=PF(".",e,n);else if(Ne("("))t=$me(),e=gme(e,t);else if(Ne("["))n=Cme(),e=PF("[",e,n);else break;return e}function IF(){var e=kme();if(_e.type===cn&&(Ne("++")||Ne("--")))throw new Error(Qf);return e}function Ag(){var e,t;if(_e.type!==cn&&_e.type!==$o)t=IF();else{if(Ne("++")||Ne("--"))throw new Error(Qf);if(Ne("+")||Ne("-")||Ne("~")||Ne("!"))e=pn(),t=Ag(),t=yme(e.value,t);else{if(Gy("delete")||Gy("void")||Gy("typeof"))throw new Error(Qf);t=IF()}}return t}function UF(e){var t=0;if(e.type!==cn&&e.type!==$o)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Fme(){var e,t,n,i,r,s,o,a,u,l;if(e=_e,u=Ag(),i=_e,r=UF(i),r===0)return u;for(i.prec=r,pn(),t=[e,_e],o=Ag(),s=[u,i,o];(r=UF(_e))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=BF(a,u,o),s.push(n);i=pn(),i.prec=r,s.push(i),t.push(_e),n=Ag(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=BF(s[l-1].value,s[l-2],n),l-=2;return n}function Ma(){var e,t,n;return e=Fme(),Ne("?")&&(pn(),t=Ma(),It(":"),n=Ma(),e=pme(e,t,n)),e}function C$(){var e=Ma();if(Ne(","))throw new Error(Qf);return e}function Ome(e){G=e,N=0,Lt=G.length,_e=null,V7();var t=C$();if(_e.type!==Xd)throw new Error("Unexpect token after expression.");return t}function Ul(e,t,n){return e.fields=t||[],e.fname=n,e}function Dme(e){return e.length===1?Mme(e[0]):Tme(e)}const Mme=e=>function(t){return t[e]},Tme=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Yy(e){throw Error(e)}function Nme(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||Yy("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&Yy("Access path missing closing bracket: "+e),i&&Yy("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function jme(e,t,n){const i=Nme(e);return e=i.length===1?i[0]:e,Ul((n&&n.get||Dme)(i),[e],t||e)}jme("id");Ul(e=>e,[],"identity");Ul(()=>0,[],"zero");Ul(()=>1,[],"one");Ul(()=>!0,[],"true");Ul(()=>!1,[],"false");function sx(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...sx(e.object)),t.push(...sx(e.property))),t)}function X7(e){return e.object.type==="MemberExpression"?X7(e.object):e.object.name==="datum"}function K7(e){const t=Ome(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&X7(i)&&n.add(sx(i).slice(1).join("."))}),n}class ql extends Ce{constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=gp(this.model,this.filter,this),this._dependentFields=K7(this.expr)}clone(){return new ql(null,this.model,fe(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Rme(e,t){var n;const i={},r=e.config.selection;for(const s of z(t??{})){const o=fe(t[s]),a=r[o.type],u=X(a,["fields","encodings"]);for(const f in u)f==="encodings"&&o.fields||f==="fields"&&o.encodings||(f==="mark"&&(o[f]=Object.assign(Object.assign({},u[f]),o[f])),(o[f]===void 0||o[f]===!0)&&(o[f]=(n=u[f])!==null&&n!==void 0?n:o[f]));const l=Be(s),c=i[l]=Object.assign(Object.assign({},o),{name:l,events:ce(o.on)?Il(o.on,"scope"):fe(o.on)});u1(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,o,t[s])})}return i}function J7(e,t,n,i="datum"){const r=[];function s(a){const u=Be(a),l=e.getSelectionComponent(u,a),c=pe(u+Oa);if(l.project.timeUnit){const f=n??e.component.data.raw,d=l.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return l.empty!=="none"&&r.push(c),`vlSelectionTest(${c}, ${i}`+(l.resolve==="global"?")":`, ${pe(l.resolve)})`)}const o=nf(t,s);return(r.length?"!("+r.map(a=>`length(data(${a}))`).join(" || ")+") || ":"")+`(${o})`}function Q7(e,t){const n=t.encoding;let i=t.field;if(!n&&!i)i=e.project.items[0].field,e.project.items.length>1&&R(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${pe(i)}.`);else if(n&&!i){const r=e.project.items.filter(s=>s.channel===n);!r.length||r.length>1?(i=e.project.items[0].field,R((r.length?"Multiple ":"No ")+`matching ${pe(n)} encoding found for selection ${pe(t.selection)}. Using "field": ${pe(i)}.`)):i=r[0].field}return`${e.name}[${pe(i)}]`}function Bme(e,t){Xa(e,n=>{const i=n.name,r=e.getName(`lookup_${i}`);e.component.data.outputNodes[r]=n.materialized=new en(new ql(t,e,{selection:i}),r,"lookup",e.component.data.outputNodeRefCounts)})}function gp(e,t,n){return nf(t,i=>ce(i)?i:ghe(i)?J7(e,i.selection,n):gN(i))}function Pme(e,t){if(e)return Q(e)&&!ws(e)?e.map(n=>zN(n,t)).join(", "):e}function Vy(e,t,n,i){var r,s,o;e.encode=(r=e.encode)!==null&&r!==void 0?r:{},e.encode[t]=(s=e.encode[t])!==null&&s!==void 0?s:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=i}function zc(e,t,n,i={header:!1}){var r,s;const o=e.combine(),{disable:a,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=o,h=X(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const g in h){const p=dfe[g],m=h[g];if(p&&p!==t&&p!=="both")delete h[g];else if(OE(m)){const{condition:y}=m,b=X(m,["condition"]),v=Xe(y),x=Qk[g];if(x){const{vgProp:A,part:E}=x,w=[...v.map($=>{const{test:S}=$,_=X($,["test"]);return Object.assign({test:gp(null,S)},_)}),b];Vy(h,E,A,w),delete h[g]}else if(x===null){const A={signal:v.map(E=>{const{test:w}=E,$=X(E,["test"]);return`${gp(null,w)} ? ${mF($)} : `}).join("")+mF(b)};h[g]=A}}else if(te(m)){const y=Qk[g];if(y){const{vgProp:b,part:v}=y;Vy(h,v,b,m),delete h[g]}}}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:g}=h.encode;h.encode=Object.assign({},g?{grid:g}:{}),Fe(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Ze(d,0)})}else{if(!i.header&&e.mainExtracted)return;if(c!==void 0){let p=c;!((s=(r=h.encode)===null||r===void 0?void 0:r.labels)===null||s===void 0)&&s.update&&te(h.encode.labels.update.text)&&(p=Yu(c,"datum.label",h.encode.labels.update.text.signal)),Vy(h,"labels","text",{signal:p})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const p of M9)e.hasAxisPart(p)||delete h.encode[p];Fe(h.encode)&&delete h.encode}const g=Pme(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},g?{title:g}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:Ze(d,0)})}}}function Z7(e){const{axes:t}=e.component,n=[];for(const i of Zn)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s=i==="x"?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}}return n}function zme(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>zc(r,"grid",t)),...i.map(r=>zc(r,"grid",t)),...n.map(r=>zc(r,"main",t)),...i.map(r=>zc(r,"main",t))].filter(r=>r)}const ej={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},tj={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Lme=z(ej),Ime=z(tj);function qF(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const s=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...z(o),...z(a)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${s}" ? ${Vf(o[c])} : ${Vf(a[c])}`};return l}return t[r]})])}function Ume(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:She(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",o=te(n)?"axisOrient":"axis"+Bm(n),a=[...r,...r.map(l=>s+l.substr(4))],u=["axis",o,s];return{vlOnlyAxisConfig:qF(a,i,e,n),vgAxisConfig:qF(u,i,e,n),axisConfigStyle:qme([...u,...a],i)}}function qme(e,t){var n;const i=[{}];for(const r of e){let s=(n=t[r])===null||n===void 0?void 0:n.style;if(s){s=Xe(s);for(const o of s)i.push(t.style[o])}}return Object.assign.apply(null,i)}function ox(e,t,n,i={}){var r;const s=WN(e,n,t.style);if(s!==void 0)return{configFrom:"style",configValue:s};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((r=i[o])===null||r===void 0?void 0:r[e])!==void 0)return{configFrom:o,configValue:i[o][e]};return{}}const WF={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return _N(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return SN(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return U(e)&&Kt(e.bin)?!1:(i=t.grid)!==null&&i!==void 0?i:Wme(n,e)},gridScale:({model:e,channel:t})=>Hme(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||ij(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||nj(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return(i=e.labelFlush)!==null&&i!==void 0?i:Yme(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return(i=e.labelOverlap)!==null&&i!==void 0?i:Vme(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var s;const o=e==="x"?"width":e==="y"?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return(s=n.tickCount)!==null&&s!==void 0?s:Kme({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=rj(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),s=n==="x"?"x2":"y2",o=t.fieldDef(s);return GN(r?[pF(r)]:[],U(o)?[pF(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Jme(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return(i=e.zindex)!==null&&i!==void 0?i:Qme(n,t)}};function Wme(e,t){return!$n(e)&&U(t)&&!Me(t==null?void 0:t.bin)}function Hme(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function Gme(e,t,n,i,r){const s=t==null?void 0:t.labelAngle;if(s!==void 0)return te(s)?s:J0(s);{const{configValue:o}=ox("labelAngle",e.config,t==null?void 0:t.style,r);return o!==void 0?J0(o):n===Le&&ee([XE,VE],i.type)?270:void 0}}function ax(e){return`(((${e.signal} % 360) + 360) % 360)`}function nj(e,t,n,i){if(e!==void 0)if(n==="x"){if(te(e)){const r=ax(e),s=te(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(te(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(te(e)){const r=ax(e),s=te(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(te(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function ij(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,s=i?"bottom":"left";if(te(e)){const o=ax(e),a=te(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${r?"("+o+" + 90)":o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180===0)return i?null:"center";if(te(t)){const o=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${o} "${s}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===s)?"left":"right"}function Yme(e,t){if(t==="x"&&ee(["quantitative","temporal"],e))return!0}function Vme(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function Xme(e){return e==="x"?"bottom":"left"}function Kme({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!$n(t)&&t!=="log"){if(U(e)){if(Me(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&ee(["month","hours","day","quarter"],(r=rn(e.timeUnit))===null||r===void 0?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function rj(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;if(s&&o)return YN(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function Jme(e,t){const n=e.values;if(Q(n))return IN(t,n);if(te(n))return n}function Qme(e,t){return e==="rect"&&NN(t)?1:0}class Qu extends Ce{constructor(t,n){super(t),this.transform=n,this._dependentFields=K7(this.transform.calculate)}clone(){return new Qu(null,fe(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(r$(i)&&ON(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,u=a.map((l,c)=>`${gN({field:s,timeUnit:o,equal:l})} ? ${c} : `).join("")+a.length;t=new Qu(t,{calculate:u,as:Zu(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${me(this.transform)}`}}function Zu(e,t,n){return L(e,Object.assign({prefix:t,suffix:"sort_index"},n??{}))}function h1(e,t){return ee(["top","bottom"],t)?"column":ee(["left","right"],t)||e==="row"?"row":"column"}function el(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return Ze(((t==null?void 0:t.header)||{})[e],r[e],n.header[e])}function g1(e,t,n,i){const r={};for(const s of e){const o=el(s,t,n,i);o!==void 0&&(r[s]=o)}return r}const k$=["row","column"],F$=["header","footer"];function Zme(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=g1(["titleAnchor","titleAngle","titleOrient"],r,i,t),u=h1(t,a),l=J0(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),oj(l,u)),sj(u,l,s)),aj(i,r,t,Lme,ej))}}function sj(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=ij(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function oj(e,t){const n=nj(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function e1e(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of F$)if(n[r])for(const s of n[r]){const o=n1e(e,t,r,n,s);o!=null&&i.push(o)}return i}function t1e(e,t){var n;const{sort:i}=e;return Vi(i)?{field:L(i,{expr:"datum"}),order:(n=i.order)!==null&&n!==void 0?n:"ascending"}:Q(i)?{field:Zu(e,t,{expr:"datum"}),order:"ascending"}:{field:L(e,{expr:"datum"}),order:i??"ascending"}}function ux(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:u}=g1(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),l=QE({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=h1(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?Yu(Yu(u,"datum.label",l),"datum.value",L(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),oj(s,c)),sj(c,s,o)),aj(n,e,t,Ime,tj))}function n1e(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:f}=g1(["labelOrient"],o,a,t);(t==="row"&&!ee(["top","bottom"],f)||t==="column"&&!ee(["left","right"],f))&&(s=ux(o,t,a))}const u=wi(e)&&!Wd(e.facet),l=r.axes,c=(l==null?void 0:l.length)>0;if(s||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:t1e(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const i1e={column:{start:0,end:1},row:{start:1,end:0}};function r1e(e,t){return i1e[t][e]}function s1e(e,t){const n={};for(const i of Gn){const r=e[i];if(r!=null&&r.facetFieldDef){const{titleAnchor:s,titleOrient:o}=g1(["titleAnchor","titleOrient"],r.facetFieldDef,t,i),a=h1(i,o),u=r1e(s,a);u!==void 0&&(n[a]=u)}}return Fe(n)?void 0:n}function aj(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=el(o,t,e,n);a!==void 0&&(s[r[o]]=a)}return s}function O$(e){return[...Ph(e,"width"),...Ph(e,"height"),...Ph(e,"childWidth"),...Ph(e,"childHeight")]}function Ph(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if($n(o)&&Ao(a)){const u=e.scaleName(n);return wi(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[HF(u,a)]:[HF(u,a),{name:r,update:uj(u,s,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",a=Jv(e.config.view,s?"width":"height"),u=`isFinite(${o}) ? ${o} : ${a}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function HF(e,t){return{name:e+"_step",value:t.step}}function uj(e,t,n){const i=t.get("type"),r=t.get("padding"),s=Ze(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o=i==="band"?o!==void 0?o:r:1,`bandspace(${n}, ${o}, ${s}) * ${e}_step`}function lj(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function cj(e,t){return z(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),Yd(t,r,i,s=>te(s)?s:{value:s.value}))},{})}function o1e(e,t){if(Gl(t)||wi(t))return"shared";if(j$(t))return rr(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function D$(e,t){const n=e.scale[t],i=rr(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&R(Tde(t)),"independent"):e[i][t]||"shared"}const a1e=Object.assign(Object.assign({},Sge),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),fj=z(a1e);class u1e extends cs{}const GF={symbols:l1e,gradient:c1e,labels:f1e,entries:d1e};function l1e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){var o,a,u,l,c;if(s!=="symbol")return;const{markDef:f,encoding:d,config:h,mark:g}=n,p=f.filled&&g!=="trail";let m=Object.assign(Object.assign({},sge({},n,vfe)),k7(n,{filled:p}));const y=(o=dj(d.opacity))!==null&&o!==void 0?o:f.opacity;if(m.fill){if(i==="fill"||p&&i===An)delete m.fill;else if(m.fill.field)r.get("symbolFillColor")?delete m.fill:(m.fill=Ve((a=h.legend.symbolBaseFillColor)!==null&&a!==void 0?a:"black"),m.fillOpacity=Ve(y??1));else if(Q(m.fill)){const b=(c=(l=lx((u=d.fill)!==null&&u!==void 0?u:d.color))!==null&&l!==void 0?l:f.fill)!==null&&c!==void 0?c:p&&f.color;b&&(m.fill=Ve(b))}}if(m.stroke){if(i==="stroke"||!p&&i===An)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(Q(m.stroke)){const b=Ze(lx(d.stroke||d.color),f.stroke,p?f.color:void 0);b&&(m.stroke={value:b})}}if(i!==ls){const b=U(t)&&gj(n,r,t);b?m.opacity=[Object.assign({test:b},Ve(y??1)),Ve(h.legend.unselectedOpacity)]:y&&(m.opacity=Ve(y))}return m=Object.assign(Object.assign({},m),e),Fe(m)?void 0:m}function c1e(e,{model:t,legendType:n}){if(n!=="gradient")return;let i={};const r=dj(t.encoding.opacity)||t.markDef.opacity;return r&&(i.opacity=Ve(r)),i=Object.assign(Object.assign({},i),e),Fe(i)?void 0:i}function f1e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=U(t)?gj(n,r,t):void 0,u=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=s,f=ka(c)?ZE({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Fe(d)?void 0:d}function d1e(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function dj(e){return hj(e,(t,n)=>Math.max(t,n.value))}function lx(e){return hj(e,(t,n)=>Ze(t,n.value))}function hj(e,t){if(Xhe(e))return Xe(e.condition).reduce(t,e.value);if(Zr(e))return e.value}function gj(e,t,n){const i=t.get("selections");if(!(i!=null&&i.length))return;const r=pe(n.field);return i.map(s=>`(!length(data(${pe(Be(s)+Oa)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const YF={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return _N(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return SN(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return(n=(t=i.gradientLength)!==null&&t!==void 0?t:r.gradientLength)!==null&&n!==void 0?n:v1e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return(r=(i=e.labelOverlap)!==null&&i!==void 0?i:t.labelOverlap)!==null&&r!==void 0?r:x1e(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return(r=e.symbolType)!==null&&r!==void 0?r:g1e(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>da(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Eu(n)&&yi(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>h1e(t,e)};function h1e(e,t){const n=e.values;if(Q(n))return IN(t,n);if(te(n))return n}function g1e(e,t,n,i){var r;if(t!=="shape"){const s=(r=lx(n))!==null&&r!==void 0?r:i;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function p1e(e){const{legend:t}=e;return Ze(t.type,m1e(e))}function m1e({channel:e,timeUnit:t,scaleType:n}){if(Eu(e)){if(ee(["quarter","month","day"],t))return"symbol";if(yi(n))return"gradient"}return"symbol"}function y1e({legendConfig:e,legendType:t,orient:n,legend:i}){var r,s;return(s=(r=i.direction)!==null&&r!==void 0?r:e[t?"gradientDirection":"symbolDirection"])!==null&&s!==void 0?s:b1e(n,t)}function b1e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function v1e({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(yi(r))return n==="horizontal"?i==="top"||i==="bottom"?VF(t,"width",o,s):o:VF(t,"height",u,a)}function VF(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function x1e(e){if(ee(["quantile","threshold","log"],e))return"greedy"}function pj(e){const t=We(e)?w1e(e):_1e(e);return e.component.legends=t,t}function w1e(e){const{encoding:t}=e,n={};for(const i of[An,...u7]){const r=rt(t[i]);!r||!e.getScaleComponent(i)||i===En&&U(r)&&r.type===Ll||(n[i]=$1e(e,i))}return n}function A1e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function E1e(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function $1e(e,t){var n,i,r;let s=e.legend(t);const{markDef:o,encoding:a,config:u}=e,l=u.legend,c=new u1e({},A1e(e,t));spe(e,t,c);const f=s!==void 0?!s:l.disable;if(c.set("disable",f,s!==void 0),f)return c;s=s||{};const d=e.getScaleComponent(t).get("type"),h=rt(a[t]),g=U(h)?(n=rn(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,p=s.orient||u.legend.orient||"right",m=p1e({legend:s,channel:t,timeUnit:g,scaleType:d}),y=y1e({legend:s,legendType:m,orient:p,legendConfig:l}),b={legend:s,channel:t,model:e,markDef:o,encoding:a,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:p,legendType:m,direction:y};for(const w of fj){const $=w in YF?YF[w](b):s[w];if($!==void 0){const S=E1e($,w,s,e.fieldDef(t));(S||u.legend[w]===void 0)&&c.set(w,$,S)}}const v=(i=s==null?void 0:s.encoding)!==null&&i!==void 0?i:{},x=c.get("selections"),A={},E={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const w of["labels","legend","title","symbols","gradient","entries"]){const $=cj((r=v[w])!==null&&r!==void 0?r:{},e),S=w in GF?GF[w]($,E):$;S!==void 0&&!Fe(S)&&(A[w]=Object.assign(Object.assign(Object.assign({},x!=null&&x.length&&U(h)?{name:`${Be(h.field)}_legend_${w}`}:{}),x!=null&&x.length?{interactive:!!x}:{}),{update:S}))}return Fe(A)||c.set("encode",A,!!(s!=null&&s.encoding)),c}function _1e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){pj(i);for(const r of z(i.component.legends))n.legend[r]=D$(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=mj(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of z(t))for(const r of e.children)r.component.legends[i]&&n.legend[i]==="shared"&&delete r.component.legends[i];return t}function mj(e,t){var n,i,r,s;if(!e)return t.clone();const o=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;let u=!1;for(const l of fj){const c=ro(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return S1e(f,d);case"title":return VN(f,d);case"type":return u=!0,kn("symbol")}return o1(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(!((i=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||i===void 0)&&i.gradient&&Hv(e.implicit,["encode","gradient"]),!((s=(r=e.explicit)===null||r===void 0?void 0:r.encode)===null||s===void 0)&&s.gradient&&Hv(e.explicit,["encode","gradient"])),e}function S1e(e,t){return t.value==="circle"?t:e}function XF(e,t,n,i){var r,s,o;e.encode=(r=e.encode)!==null&&r!==void 0?r:{},e.encode[t]=(s=e.encode[t])!==null&&s!==void 0?s:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=i}function yj(e){const t=e.component.legends,n={};for(const r of z(t)){const s=e.getScaleComponent(r),o=Re(s.get("domains"));if(n[o])for(const a of n[o])mj(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return Is(n).flat().map(r=>C1e(r,e.config)).filter(r=>r!==void 0)}function C1e(e,t){var n,i,r;const s=e.combine(),{disable:o,labelExpr:a,selections:u}=s,l=X(s,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),!((n=l.encode)===null||n===void 0)&&n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of u7)l[f]&&delete c[f]}if(l.title||delete l.title,a!==void 0){let c=a;!((r=(i=l.encode)===null||i===void 0?void 0:i.labels)===null||r===void 0)&&r.update&&te(l.encode.labels.update.text)&&(c=Yu(a,"datum.label",l.encode.labels.update.text.signal)),XF(l,"labels","text",{signal:c})}for(const c in l){const f=l[c];if(te(f)){const d=$ge[c];if(d){const{vgProp:h,part:g}=d;XF(l,g,h,f),delete l[c]}}}return l}}function k1e(e){return Gl(e)||j$(e)?F1e(e):bj(e)}function F1e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),bj(e))}function bj(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const u=te(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return ee(o,u)||o.push(u),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}else return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const O1e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class vj extends cs{constructor(t,n,i,r){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function xj(e){e.component.projection=We(e)?D1e(e):N1e(e)}function D1e(e){var t;if(e.hasProjection){const n=e.specifiedProjection,i=!(n&&(n.scale!=null||n.translate!=null)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=i?M1e(e):void 0;return new vj(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n??{}),r,s)}}function M1e(e){const t=[],{encoding:n}=e;for(const i of[[br,yr],[Qn,Di]])(rt(n[i[0]])||rt(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(En)&&e.typedFieldDef(En).type===Ll&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Mt)),t}function T1e(e,t){const n=S9(O1e,r=>!!(!ea(e.explicit,r)&&!ea(t.explicit,r)||ea(e.explicit,r)&&ea(t.explicit,r)&&Re(e.get(r))===Re(t.get(r))));if(Re(e.size)===Re(t.size)){if(n)return e;if(Re(e.explicit)===Re({}))return t;if(Re(t.explicit)===Re({}))return e}return null}function N1e(e){if(e.children.length===0)return;let t;for(const i of e.children)xj(i);const n=S9(e.children,i=>{const r=i.component.projection;if(r)if(t){const s=T1e(t,r);return s&&(t=s),!!s}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new vj(i,t.specifiedProjection,t.size,fe(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}function j1e(e,t,n,i){var r,s;if(Gd(t,n)){const o=We(e)?(s=(r=e.axis(n))!==null&&r!==void 0?r:e.legend(n))!==null&&s!==void 0?s:{}:{},a=L(t,{expr:"datum"}),u=L(t,{expr:"datum",binSuffix:"end"});return{formulaAs:L(t,{binSuffix:"range",forAs:!0}),formula:Qm(a,u,o.format,o.formatType,i)}}return{}}function wj(e,t){return`${K9(e)}_${t}`}function R1e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function M$(e,t,n){var i;const r=(i=n1(n,void 0))!==null&&i!==void 0?i:{},s=wj(r,t);return e.getName(`${s}_bins`)}function B1e(e){return"as"in e}function KF(e,t,n){let i,r;B1e(e)?i=ce(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[L(e,{forAs:!0}),L(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},n1(t,void 0)),o=wj(s,e.field),{signal:a,extentSignal:u}=R1e(n,o);if(Km(s.extent)){const c=s.extent,f=c.selection;r=Q7(n.getSelectionComponent(Be(f),f),c),delete s.extent}const l=Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[i]},a?{signal:a}:{}),u?{extentSignal:u}:{}),r?{span:r}:{});return{key:o,binComponent:l}}class Ki extends Ce{constructor(t,n){super(t),this.bins=n}clone(){return new Ki(null,fe(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(Ln(s)&&Me(s.bin)){const{key:a,binComponent:u}=KF(s,s.bin,n);r[a]=Object.assign(Object.assign(Object.assign({},u),r[a]),j1e(n,s,o,n.config))}return r},{});return Fe(i)?null:new Ki(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=KF(n,n.bin,i);return new Ki(t,{[r]:s})}merge(t,n){for(const i of z(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=Ds([...this.bins[i].as,...t.bins[i].as],me)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(Is(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Is(this.bins).map(t=>t.field))}hash(){return`Bin ${me(this.bins)}`}assemble(){return Is(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,s=t.bin,{extent:o}=s,a=X(s,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:to(t.field),as:i,signal:t.signal},Km(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!o&&t.extentSignal&&(n.push({type:"extent",field:to(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:L({field:i[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class tl extends Ce{constructor(t){super(null),t=t??{name:"source"};let n;if(ga(t)||(n=t.format?Object.assign({},qr(t.format,["parse"])):{}),ap(t))this._data={values:t.values};else if(Kf(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];ee(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else b7(t)?this._data={values:[{type:"Sphere"}]}:(m7(t)||ga(t))&&(this._data={});this._generator=ga(t),t.name&&(this._name=t.name),n&&!Fe(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function cx(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!cx(t.children))return!1}return!0}class Qd extends Ce{constructor(t,n){super(t),this.params=n}clone(){return new Qd(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${me(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Zd extends Ce{constructor(t,n){super(t),this.params=n}clone(){return new Zd(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${me(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function p1(e){return e instanceof tl||e instanceof Qd||e instanceof Zd}class Aj{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class fs extends Aj{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(p1(t))return!1;const n=t.parent,{continueFlag:i}=this.run(t);return i&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class T$ extends Aj{}function P1e(e,t,n,i){const r=We(i)?i.encoding[wr(t)]:void 0;if(Ln(n)&&We(i)&&t$(t,n,r,i.stack,i.markDef,i.config))e.add(L(n,{})),e.add(L(n,{suffix:"end"})),n.bin&&Gd(n,t)&&e.add(L(n,{binSuffix:"range"}));else if(Bfe(t)){const s=Rfe(t);e.add(i.getName(s))}else e.add(L(n));return e}function z1e(e,t){var n;for(const i of z(t)){const r=t[i];for(const s of z(r))i in e?e[i][s]=new Set([...(n=e[i][s])!==null&&n!==void 0?n:[],...r[s]]):e[i]={[s]:r[s]}}}class xi extends Ce{constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}clone(){return new xi(null,new Set(this.dimensions),fe(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return!i||(n.forEachFieldDef((o,a)=>{var u,l,c,f;const{aggregate:d,field:h}=o;if(d)if(d==="count")r["*"]=(u=r["*"])!==null&&u!==void 0?u:{},r["*"].count=new Set([L(o,{forAs:!0})]);else{if(no(d)||Ga(d)){const g=no(d)?"argmin":"argmax",p=d[g];r[p]=(l=r[p])!==null&&l!==void 0?l:{},r[p][g]=new Set([L({op:g,field:p},{forAs:!0})])}else r[h]=(c=r[h])!==null&&c!==void 0?c:{},r[h][d]=new Set([L(o,{forAs:!0})]);wo(a)&&n.scaleDomain(a)==="unaggregated"&&(r[h]=(f=r[h])!==null&&f!==void 0?f:{},r[h].min=new Set([L({field:h,aggregate:"min"},{forAs:!0})]),r[h].max=new Set([L({field:h,aggregate:"max"},{forAs:!0})]))}else P1e(s,a,o,n)}),s.size+z(r).length===0)?null:new xi(t,s,r)}static makeFromTransform(t,n){var i,r,s;const o=new Set,a={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?(a["*"]=(i=a["*"])!==null&&i!==void 0?i:{},a["*"].count=new Set([f||L(u,{forAs:!0})])):(a[c]=(r=a[c])!==null&&r!==void 0?r:{},a[c][l]=new Set([f||L(u,{forAs:!0})])))}for(const u of(s=n.groupby)!==null&&s!==void 0?s:[])o.add(u);return o.size+z(a).length===0?null:new xi(t,o,a)}merge(t){return sfe(this.dimensions,t.dimensions)?(z1e(this.measures,t.measures),!0):(Xde("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...z(this.measures)])}producedFields(){const t=new Set;for(const n of z(this.measures))for(const i of z(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${me({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of z(this.measures))for(const o of z(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push(s==="*"?null:to(s));return{type:"aggregate",groupby:[...this.dimensions].map(to),ops:t,fields:n,as:i}}}class Wl extends Ce{constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of Gn){const o=n.facet[s];if(o){const{bin:a,sort:u}=o;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[L(o),...Me(a)?[L(o,{binSuffix:"end"})]:[]]},Vi(u)?{sortField:u}:Q(u)?{sortIndexField:Zu(o,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Gn)this[n]&&(t+=` ${n.charAt(0)}:${me(this[n])}`);return t}get fields(){var t;const n=[];for(const i of Gn)!((t=this[i])===null||t===void 0)&&t.fields&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Gn)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Zn){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if($n(r)&&Ao(s)){const o=m1(this.childModel,n),a=N$(o);a?t[n]=a:R(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x"}[t],s=[],o=[],a=[];i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=Zm,field:f}=u;s.push(f),o.push(c),a.push(L(u,{forAs:!0}))}else l&&(s.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:o,as:a}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:s}=this.model.component,o=[],a={};for(const c of k$){for(const f of F$){const d=(n=s[c]&&s[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((i=h.axes)===null||i===void 0?void 0:i.length)>0){a[c]=!0;break}}if(a[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?r?{signal:`ceil(${f} / ${r})`}:1:r?{signal:`min(${f}, ${r})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=a;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const i=[];let r=null;const s=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:u}=this;if(o&&a&&(s.x||s.y)){r=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=s.x)!==null&&t!==void 0?t:[],(n=s.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Hr,Wr])this[l]&&i.push(this.assembleRowColumnHeaderData(l,r,s));if(u){const l=this.assembleFacetHeaderData(s);l&&i.push(...l)}return i}}function JF(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function L1e(e,t){const n=O9(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const i=JF(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.indexOf("utc:")===0){const i=JF(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return R(ade(t)),null}function I1e(e){const t={};return vg(e.filter,n=>{var i;if(hN(n)){let r=null;WE(n)?r=n.equal:HE(n)?r=n.range[0]:GE(n)&&(r=((i=n.oneOf)!==null&&i!==void 0?i:n.in)[0]),r&&(Pl(r)?t[n.field]="date":Qe(r)?t[n.field]="number":ce(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function U1e(e){const t={};function n(i){i1(i)?t[i.field]="date":i.type==="quantitative"&&Dfe(i.aggregate)?t[i.field]="number":Gf(i.field)>1?i.field in t||(t[i.field]="flatten"):r$(i)&&Vi(i.sort)&&Gf(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((We(e)||wi(e))&&e.forEachFieldDef((i,r)=>{if(Ln(i))n(i);else{const s=Va(r),o=e.fieldDef(s);n(Object.assign(Object.assign({},i),{type:o.type}))}}),We(e)){const{mark:i,markDef:r,encoding:s}=e;if(Ha(i)&&!e.encoding.order){const o=r.orient==="horizontal"?"y":"x",a=s[o];U(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function q1e(e){const t={};if(We(e)&&e.component.selection)for(const n of z(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&Gf(r.field)>1&&(t[r.field]="flatten")}return t}class Rt extends Ce{constructor(t,n){super(t),this._parse=n}clone(){return new Rt(null,fe(this._parse))}hash(){return`Parse ${me(this._parse)}`}static makeExplicit(t,n,i){let r={};const s=n.data;return!ga(s)&&s&&s.format&&s.format.parse&&(r=s.format.parse),this.makeWithAncestors(t,r,{},i)}static makeWithAncestors(t,n,i,r){for(const a of z(i)){const u=r.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===i[a]||u.value==="derived"||i[a]==="flatten"?delete i[a]:R(uF(a,i[a],u.value)))}for(const a of z(n)){const u=r.get(a);u!==void 0&&(u===n[a]?delete n[a]:R(uF(a,n[a],u)))}const s=new cs(n,i);r.copyAll(s);const o={};for(const a of z(s.combine())){const u=s.get(a);u!==null&&(o[a]=u)}return z(o).length===0||r.parseNothing?null:new Rt(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of z(this._parse)){const i=this._parse[n];Gf(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(z(this._parse))}dependentFields(){return new Set(z(this._parse))}assembleTransforms(t=!1){return z(this._parse).filter(n=>t?Gf(n)>1:!0).map(n=>{const i=L1e(n,this._parse[n]);return i?{type:"formula",expr:i,as:D9(n)}:null}).filter(n=>n!==null)}}class ao extends Ce{clone(){return new ao(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Ku])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Ku}}}class Ja extends Ce{constructor(t,n){super(t),this.transform=n}clone(){return new Ja(null,fe(this.transform))}addDimensions(t){this.transform.groupby=Ds(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:L(t)}hash(){return`JoinAggregateTransform ${me(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},r!==void 0?{groupby:r}:{})}}function W1e(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=L(i);return r&&t.push(r),t},[])}function H1e(e){return Q(e)&&e.every(t=>ce(t))&&e.length>1}class Yr extends Ce{constructor(t,n){super(t),this._stack=n}clone(){return new Yr(null,fe(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(Ze(f.order,"ascending"));const l={field:a,order:u};let c;return H1e(s)?c=s:ce(s)?c=[s,s+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new Yr(t,{stackField:i,groupby:r,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannel:s,fieldChannel:o,offset:a,impute:u}=i;let l;if(s){const h=r[s];l=sr(h)}const c=W1e(n),f=n.encoding.order;let d;return Q(f)||U(f)?d=HN(f):d=c.reduce((h,g)=>(h.field.push(g),h.order.push(o==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Yr(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${me(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:i}=this._stack;return t?t.bin?n?[L(t,{binSuffix:"mid"})]:[L(t,{}),L(t,{binSuffix:"end"})]:[L(t)]:i??[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:i,stackField:r,stackby:s,sort:o,offset:a,impute:u,as:l}=this._stack;if(u&&i){const{band:c=.5,bin:f}=i;f&&t.push({type:"formula",expr:`${c}*`+L(i,{expr:"datum"})+`+${1-c}*`+L(i,{expr:"datum",binSuffix:"end"}),as:L(i,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...s,...n],key:L(i,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:l,offset:a}),t}}class Hl extends Ce{constructor(t,n){super(t),this.transform=n}clone(){return new Hl(null,fe(this.transform))}addDimensions(t){this.transform.groupby=Ds(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(i.add,i),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>r!==void 0).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:L(t)}hash(){return`WindowTransform ${me(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],s=[];for(const d of this.transform.window)i.push(d.op),r.push(this.getDefaultName(d)),s.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&i.every(d=>NE(d)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},a!==void 0?{groupby:a}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:r,ops:i,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),a!==void 0?{groupby:a}:{}),o!==void 0?{frame:o}:{})}}class G1e extends fs{run(t){const n=t.parent;if(t instanceof Rt){if(p1(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof Rt)this.setMutated(),n.merge(t);else{if(k9(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class Y1e extends T${mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of z(i))i[r].length>1&&(this.setMutated(),this.mergeNodes(t,i[r]));for(const r of t.children)this.run(r);return this.mutatedFlag}}class V1e extends fs{run(t){return t instanceof en||t.numChildren()>0||t instanceof Wl?this.flags:(this.setMutated(),t.remove(),this.flags)}}class X1e extends fs{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof Xi){const n=t.producedFields();C9(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class K1e extends fs{run(t){this.setContinue();const i=t.parent.children.filter(s=>s instanceof Xi),r=i.pop();for(const s of i)this.setMutated(),r.merge(s);return this.flags}}function J1e(e){function t(n){if(!(n instanceof Wl)){const i=n.clone();if(i instanceof en){const r=dx+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof xi||i instanceof Yr||i instanceof Hl||i instanceof Ja)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function fx(e){if(e instanceof Wl)if(e.numChildren()===1&&!(e.children[0]instanceof en)){const t=e.children[0];(t instanceof xi||t instanceof Yr||t instanceof Hl||t instanceof Ja)&&t.addDimensions(e.fields),t.swapWithParent(),fx(e)}else{const t=e.model.component.data.main;Ej(t);const n=J1e(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(fx)}function Ej(e){if(e instanceof en&&e.type===Mt&&e.numChildren()===1){const t=e.children[0];t instanceof Wl||(t.swapWithParent(),Ej(e))}}class Q1e extends T${constructor(){super()}run(t){t instanceof en&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class Z1e extends T${constructor(t){super(),this.requiresSelectionId=t&&$$(t)}run(t){t instanceof ao&&(this.requiresSelectionId&&(p1(t.parent)||t.parent instanceof xi||t.parent instanceof Rt)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class eye extends fs{run(t){const n=t.parent,i=[...n.children],r=n.children.filter(s=>s instanceof Rt);if(n.numChildren()>1&&r.length>=1){const s={},o=new Set;for(const a of r){const u=a.parse;for(const l of z(u))l in s?s[l]!==u[l]&&o.add(l):s[l]=u[l]}for(const a of o)delete s[a];if(!Fe(s)){this.setMutated();const a=new Rt(n,s);for(const u of i){if(u instanceof Rt)for(const l of z(s))delete u.parse[l];n.removeChild(u),u.parent=a,u instanceof Rt&&z(u.parse).length===0&&u.remove()}}}return this.setContinue(),this.flags}}class tye extends fs{run(t){const n=t.parent,i=n.children.filter(s=>s instanceof xi),r={};for(const s of i){const o=me(s.groupBy);o in r||(r[o]=[]),r[o].push(s)}for(const s of z(r)){const o=r[s];if(o.length>1){const a=o.pop();for(const u of o)a.merge(u)&&(n.removeChild(u),u.parent=a,u.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class nye extends fs{constructor(t){super(),this.model=t}run(t){const n=t.parent,i=!(p1(n)||n instanceof ql||n instanceof Rt||n instanceof ao),r=[],s=[];for(const o of n.children)o instanceof Ki&&(i&&!k9(n.producedFields(),o.dependentFields())?r.push(o):s.push(o));if(r.length>0){const o=r.pop();for(const a of r)o.merge(a,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof Ki?n.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(s.length>1){const o=s.pop();for(const a of s)o.merge(a,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class iye extends fs{run(t){const n=t.parent,i=[...n.children];if(!Hf(i,a=>a instanceof en)||n.numChildren()<=1)return this.setContinue(),this.flags;const s=[];let o;for(const a of i)if(a instanceof en){let u=a;for(;u.numChildren()===1;){const l=u.children[0];if(l instanceof en)u=l;else break}s.push(...u.children),o?(n.removeChild(a),a.parent=o.parent,o.parent.removeChild(o),o.parent=u,this.setMutated()):o=u}else s.push(a);if(s.length){this.setMutated();for(const a of s)a.parent.removeChild(a),a.parent=o}return this.setContinue(),this.flags}}const dx="scale_",zh=5;function gs(e){const t=[];function n(i){if(i.numChildren()===0)t.push(i);else for(const r of i.children)n(r)}for(const i of e)n(i);return t}function rye(e){return e}function ri(e,t){return t.map(i=>{if(e instanceof fs){const r=e.optimizeNextFromLeaves(i);return e.reset(),r}else return e.run(i)}).some(rye)}function QF(e,t){let n=e.sources;const i=new Set;return i.add(ri(new Q1e,n)),i.add(ri(new Z1e(t),n)),n=n.filter(r=>r.numChildren()>0),i.add(ri(new V1e,gs(n))),n=n.filter(r=>r.numChildren()>0),i.add(ri(new G1e,gs(n))),i.add(ri(new nye(t),gs(n))),i.add(ri(new X1e,gs(n))),i.add(ri(new eye,gs(n))),i.add(ri(new tye,gs(n))),i.add(ri(new K1e,gs(n))),i.add(ri(new Y1e,n)),i.add(ri(new iye,gs(n))),e.sources=n,i.has(!0)}function sye(e,t){cx(e.sources);let n=0,i=0;for(let r=0;r<zh&&QF(e,t);r++)n++;e.sources.map(fx);for(let r=0;r<zh&&QF(e,t);r++)i++;cx(e.sources),Math.max(n,i)===zh&&R(`Maximum optimization runs(${zh}) reached.`)}class jn{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new jn(()=>t(n))}}function $j(e){We(e)?oye(e):aye(e)}function oye(e){const t=e.component.scales;for(const n of z(t)){const i=lye(e,n);if(t[n].setWithExplicit("domains",i),fye(e,n),e.component.data.isFaceted){let s=e;for(;!wi(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const a of i.value)Ms(a)&&(a.data=dx+a.data.replace(dx,""))}}}function aye(e){for(const n of e.children)$j(n);const t=e.component.scales;for(const n of z(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i===void 0?i=o.getWithExplicit("domains"):i=ro(i,o.getWithExplicit("domains"),"domains","scale",hx);const a=o.get("selectionExtent");r&&a&&r.selection!==a.selection&&R("The same selection must be used to override scale domains in a layered view."),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function uye(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:s}=ZF(t,n);if(!r){R(s);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=ZF(t,n);if(r)return"unaggregated"}return e}function lye(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=uye(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),t==="x"&&rt(i.x2)?rt(i.x)?ro(ms(n,r,e,"x"),ms(n,r,e,"x2"),"domain","scale",hx):ms(n,r,e,"x2"):t==="y"&&rt(i.y2)?rt(i.y)?ro(ms(n,r,e,"y"),ms(n,r,e,"y2"),"domain","scale",hx):ms(n,r,e,"y2"):ms(n,r,e,t)}function cye(e,t,n){return e.map(i=>({signal:`{data: ${a$(i,{timeUnit:n,type:t})}}`}))}function Xy(e,t,n){var i;const r=(i=rn(n))===null||i===void 0?void 0:i.unit;return t==="temporal"||r?cye(e,t,r):[e]}function ms(e,t,n,i){const{encoding:r}=n,s=rt(r[i]),{type:o}=s,a=s.timeUnit;if(jhe(t)){const f=ms(e,void 0,n,i),d=Xy(t.unionWith,o,a);return ta([...f.value,...d])}else{if(te(t))return ta([t]);if(t&&t!=="unaggregated"&&!mN(t))return ta(Xy(t,o,a))}const u=n.stack;if(u&&i===u.fieldChannel){if(u.offset==="normalize")return kn([[0,1]]);const f=n.requestDataName(Mt);return kn([{data:f,field:n.vgField(i,{suffix:"start"})},{data:f,field:n.vgField(i,{suffix:"end"})}])}const l=wo(i)&&U(s)?dye(n,i,e):void 0;if(Eo(s)){const f=Xy([s.datum],o,a);return kn(f)}const c=s;if(t==="unaggregated"){const f=n.requestDataName(Mt),{field:d}=s;return kn([{data:f,field:L({field:d,aggregate:"min"})},{data:f,field:L({field:d,aggregate:"max"})}])}else if(Me(c.bin)){if($n(e))return kn(e==="bin-ordinal"?[]:[{data:K0(l)?n.requestDataName(Mt):n.requestDataName(up),field:n.vgField(i,Gd(c,i)?{binSuffix:"range"}:{}),sort:l===!0||!yt(l)?{field:n.vgField(i,{}),op:"min"}:l}]);{const{bin:f}=c;if(Me(f)){const d=M$(n,c.field,f);return kn([new jn(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return kn([{data:n.requestDataName(Mt),field:n.vgField(i,{})}])}}else if(c.timeUnit&&ee(["time","utc"],e)&&t$(i,c,We(n)?n.encoding[wr(i)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(Mt);return kn([{data:f,field:n.vgField(i)},{data:f,field:n.vgField(i,{suffix:"end"})}])}else return kn(l?[{data:K0(l)?n.requestDataName(Mt):n.requestDataName(up),field:n.vgField(i),sort:l}]:[{data:n.requestDataName(Mt),field:n.vgField(i)}])}function Ky(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:n??(t?"sum":Zm)},i?{field:to(i)}:{}),r?{order:r}:{})}function fye(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,s=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=mN(r)&&r,a=qd(s)&&Km(s.extent)&&s.extent;(o||a)&&i.set("selectionExtent",o??a,!0)}function dye(e,t,n){if(!$n(n))return;const i=e.fieldDef(t),r=i.sort;if(ON(r))return{op:"min",field:Zu(i,t),order:"ascending"};const{stack:s}=e,o=s?[...s.groupbyField?[s.groupbyField]:[],...s.stackBy.map(a=>a.fieldDef.field)]:void 0;if(Vi(r)){const a=s&&!ee(o,r.field);return Ky(r,a)}else if(FN(r)){const{encoding:a,order:u}=r,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=s&&!ee(o,f);if(no(c)||Ga(c))return Ky({field:L(l),order:u},d);if(NE(c)||!c)return Ky({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(ee(["ascending",void 0],r))return!0}}function ZF(e,t){const{aggregate:n,type:i}=e;return n?ce(n)&&!Nfe[n]?{valid:!1,reason:Sde(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:Cde(e)}:{valid:!0}:{valid:!1,reason:_de(e)}}function hx(e,t,n,i){return e.explicit&&t.explicit&&R(Mde(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function hye(e){const t=Ds(e.map(o=>Ms(o)?X(o,["sort"]):o),me),n=Ds(e.map(o=>{if(Ms(o)){const a=o.sort;return a!==void 0&&!K0(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),me);if(t.length===0)return;if(t.length===1){const o=e[0];if(Ms(o)&&n.length>0){let a=n[0];if(n.length>1)R(cF),a=!0;else if(yt(a)&&"field"in a){const u=a.field;o.field===u&&(a=a.order?{order:a.order}:!0)}return Object.assign(Object.assign({},o),{sort:a})}return o}const i=Ds(n.map(o=>K0(o)||!("op"in o)||o.op in Ffe?o:(R(Nde(o)),!0)),me);let r;i.length===1?r=i[0]:i.length>1&&(R(cF),r=!0);const s=Ds(e.map(o=>Ms(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?Object.assign({data:s[0],fields:t.map(a=>a.field)},r?{sort:r}:{}):Object.assign({fields:t},r?{sort:r}:{})}function N$(e){if(Ms(e)&&ce(e.field))return e.field;if(lhe(e)){let t;for(const n of e.fields)if(Ms(n)&&ce(n.field)){if(!t)t=n.field;else if(t!==n.field)return R(jde),t}return R(Rde),t}else if(che(e)){R(Bde);const t=e.fields[0];return ce(t)?t:void 0}}function m1(e,t){const i=e.component.scales[t].get("domains").map(r=>(Ms(r)&&(r.data=e.lookupDataSource(r.data)),r));return hye(i)}function _j(e){return Gl(e)||j$(e)?e.children.reduce((t,n)=>t.concat(_j(n)),eO(e)):eO(e)}function eO(e){return z(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,domains:u,range:l,reverse:c}=r,f=X(r,["name","type","selectionExtent","domains","range","reverse"]),d=gye(r.range,s,n);let h;a&&(h=gpe(e,a));const g=m1(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:o},g?{domain:g}:{}),h?{domainRaw:h}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function gye(e,t,n){return rr(n)&&Ao(e)?{step:{signal:t+"_step"}}:e}class Sj extends cs{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:Hf(this.get("domains"),t=>Q(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const pye=["range","scheme"];function Cj(e){return e==="x"?"width":e==="y"?"height":void 0}function mye(e){const t=e.component.scales;for(const n of Xm){const i=t[n];if(!i)continue;const r=yye(n,e);i.setWithExplicit("range",r)}}function tO(e,t){const n=e.fieldDef(t);if(n&&n.bin&&Me(n.bin)){const i=M$(e,n.field,n.bin),r=Cj(t),s=e.getName(r);return new jn(()=>{const o=e.getSignalName(i),a=`(${o}.stop - ${o}.start) / ${o}.step`;return`${e.getSignalName(s)} / (${a})`})}}function yye(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const o of pye)if(n[o]!==void 0){const a=yN(s,o),u=bN(e,o);if(!a)R(eN(s,o,e));else if(u)R(u);else switch(o){case"range":return Q(n.range)&&rr(e)?ta(n.range.map(l=>{if(l==="width"||l==="height"){const c=t.getName(l),f=t.getSignalName.bind(t);return jn.fromName(f,c)}return l})):ta(n.range);case"scheme":return ta(bye(n[o]))}}if(e===Le||e===ot){const o=e===Le?"width":"height",a=i[o];if(or(a)){if($n(s))return ta({step:a.step});R(tN(o))}}return kn(vye(e,t))}function bye(e){return Nhe(e)?Object.assign({scheme:e.name},qr(e,["name"])):{scheme:e}}function vye(e,t){const{size:n,config:i,mark:r,encoding:s}=t,o=t.getSignalName.bind(t),{type:a}=rt(s[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case Le:case ot:{if(ee(["point","band"],l)){if(e===Le&&!n.width){const g=Xf(i.view,"width");if(or(g))return g}else if(e===ot&&!n.height){const g=Xf(i.view,"height");if(or(g))return g}}const d=Cj(e),h=t.getName(d);return e===ot&&ei(l)?[jn.fromName(o,h),0]:[0,jn.fromName(o,h)]}case us:{const d=t.component.scales[e].get("zero"),h=kj(r,d,i),g=Aye(r,n,t,i);return ep(l)?wye(h,g,xye(l,i,c,e)):[h,g]}case Oi:return[0,Math.PI*2];case Ya:return[0,360];case mr:return[0,new jn(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case bo:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case vo:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case En:return"symbol";case An:case vr:case xr:return l==="ordinal"?a==="nominal"?"category":"ordinal":f!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case ls:case mo:case yo:return[i.scale.minOpacity,i.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function xye(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&Q(n)?n.length+1:(R(Gde(i)),3)}}function wye(e,t,n){const i=()=>{const r=Vf(t),s=Vf(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return te(t)?new jn(i):{signal:i()}}function kj(e,t,n){if(t)return te(t)?{signal:`${t.signal} ? 0 : ${kj(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(Jm("size",e))}const nO=.95;function Aye(e,t,n,i){const r={x:tO(n,"x"),y:tO(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const s=iO(t,r,i.view);return Qe(s)?s-1:new jn(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=iO(t,r,i.view);return Qe(s)?Math.pow(nO*s,2):new jn(()=>`pow(${nO} * ${s.signal}, 2)`)}}throw new Error(Jm("size",e))}function iO(e,t,n){const i=or(e.width)?e.width.step:op(n,"width"),r=or(e.height)?e.height.step:op(n,"height");return t.x||t.y?new jn(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function Fj(e,t){We(e)?Eye(e,t):Dj(e,t)}function Eye(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of z(n)){const u=o[a],l=n[a],c=e.getScaleComponent(a),f=rt(r[a]),d=u[t],h=c.get("type"),g=c.get("padding"),p=c.get("paddingInner"),m=yN(h,t),y=bN(a,t);if(d!==void 0&&(m?y&&R(y):R(eN(h,t,a))),m&&y===void 0)if(d!==void 0)l.copyKeyFromObject(t,u);else{const b=t in rO?rO[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:g,scalePaddingInner:p,domain:u.domain,markDef:s,config:i}):i.scale[t];b!==void 0&&l.set(t,b,!1)}}}const rO={bins:({model:e,fieldOrDatumDef:t})=>U(t)?$ye(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>_ye(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>Sye(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>Cye(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:i})=>kye(e,t,n.type,i.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:i,scalePaddingInner:r,config:s})=>Fye(e,t,n,i.type,r,s.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=U(e)?e.sort:void 0;return Oye(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>Dye(e,t,n,i,r)};function Oj(e){We(e)?mye(e):Dj(e,"range")}function Dj(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?Oj(i):Fj(i,t);for(const i of z(n)){let r;for(const s of e.children){const o=s.component.scales[i];if(o){const a=o.getWithExplicit(t);r=ro(r,a,t,"scale",p7((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function $ye(e,t){const n=t.bin;if(Me(n)){const i=M$(e,t.field,n);return new jn(()=>e.getSignalName(i))}else if(Kt(n)&&qd(n)&&n.step!==void 0)return{step:n.step}}function _ye(e,t){if(ee([An,vr,xr],e)&&t!=="nominal")return"hcl"}function Sye(e,t,n){var i;if(!(!((i=sr(n))===null||i===void 0)&&i.bin||ee([Ke.TIME,Ke.UTC],e)))return t in xo?!0:void 0}function Cye(e,t,n,i,r,s){if(e in xo){if(yi(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=r;if(o==="bar"&&!(U(i)&&(i.bin||i.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===Ke.POINT)return n.pointPadding}}function kye(e,t,n,i){if(e===void 0&&t in xo){const{bandPaddingInner:r,barBandPaddingInner:s,rectBandPaddingInner:o}=i;return Ze(r,n==="bar"?s:o)}}function Fye(e,t,n,i,r,s){if(e===void 0&&t in xo&&n===Ke.BAND){const{bandPaddingOuter:o}=s;return Ze(o,te(r)?{signal:`${r.signal}/2`}:r/2)}}function Oye(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return ei(e)&&t==="descending"?te(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(ei(e)&&t==="descending")return!0}function Dye(e,t,n,i,r){if(!!n&&n!=="unaggregated"&&ei(r)){if(Q(n)){const o=n[0],a=n[n.length-1];if(o<=0&&a>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!ep(r))return!0;if(!(U(t)&&t.bin)&&ee([...Zn,...Hfe],e)){const{orient:o,type:a}=i;return!(ee(["bar","area","line","trail"],a)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function Mye(e,t,n,i){const r=Tye(t,n,i),{type:s}=e;return wo(t)?s!==void 0?xN(t,s)?U(n)&&!vN(s,n.type)?(R(Ode(s,r)),r):s:(R(Fde(t,s,r)),r):r:null}function Tye(e,t,n){var i;switch(t.type){case"nominal":case"ordinal":if(Eu(e)||wg(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&R(Py(e,"ordinal")),"ordinal";if(e in xo){if(ee(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in PE)return"band";return t.band!==void 0||s$(t)&&(!((i=t.axis)===null||i===void 0)&&i.tickBand)?"band":"point";case"temporal":return Eu(e)?"time":wg(e)==="discrete"?(R(Py(e,"temporal")),"ordinal"):U(t)&&t.timeUnit&&rn(t.timeUnit).utc?"utc":"time";case"quantitative":return Eu(e)?U(t)&&Me(t.bin)?"bin-ordinal":"linear":wg(e)==="discrete"?(R(Py(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(Q9(t.type))}function Nye(e,{ignoreRange:t}={}){Mj(e),$j(e);for(const n of Phe)Fj(e,n);t||Oj(e)}function Mj(e){We(e)?e.component.scales=jye(e):e.component.scales=Bye(e)}function jye(e){const{encoding:t,mark:n}=e;return Xm.reduce((i,r)=>{const s=rt(t[r]);if(s&&n===R9&&r===En&&s.type===Ll)return i;let o=s&&s.scale;if(s&&o!==null&&o!==!1){o=o??{};const a=Mye(o,r,s,n);i[r]=new Sj(e.scaleName(r+"",!0),{value:a,explicit:o.type===a})}return i},{})}const Rye=p7((e,t)=>dF(e)-dF(t));function Bye(e){var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const s of e.children){Mj(s);for(const o of z(s.component.scales))if(r.scale[o]=(t=r.scale[o])!==null&&t!==void 0?t:o1e(o,e),r.scale[o]==="shared"){const a=i[o],u=s.component.scales[o].getWithExplicit("type");a?whe(a.value,u.value)?i[o]=ro(a,u,"type","scale",Rye):(r.scale[o]="independent",delete i[o]):i[o]=u}}for(const s of z(i)){const o=e.scaleName(s,!0),a=i[s];n[s]=new Sj(o,a);for(const u of e.children){const l=u.component.scales[s];l&&(u.renameScale(l.get("name"),o),l.merged=!0)}}return n}class Jy{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function We(e){return(e==null?void 0:e.type)==="unit"}function wi(e){return(e==null?void 0:e.type)==="facet"}function j$(e){return(e==null?void 0:e.type)==="concat"}function Gl(e){return(e==null?void 0:e.type)==="layer"}class R${constructor(t,n,i,r,s,o,a){var u,l;this.type=n,this.parent=i,this.config=s,this.view=a,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=i,this.config=s,this.name=(u=t.name)!==null&&u!==void 0?u:r,this.title=ws(t.title)?{text:t.title}:t.title,this.scaleNameMap=i?i.scaleNameMap:new Jy,this.projectionNameMap=i?i.projectionNameMap:new Jy,this.signalNameMap=i?i.signalNameMap:new Jy,this.data=t.data,this.description=t.description,this.transforms=O0e((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:Dge(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:e1(t)||i&&i.component.data.isFaceted&&t.data===void 0},layoutSize:new cs,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?fe(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Nye(this)}parseProjection(){xj(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){pj(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=X(t,["style"]),i={};for(const r of z(n)){const s=n[r];s!==void 0&&(i[r]=Ve(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Ve(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{}):Fe(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=X(t,["spacing"]),{component:r,config:s}=this,o=s1e(r.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Gn)t[i].title&&n.push(Zme(this,i));for(const i of k$)n=n.concat(e1e(this,i));return n}assembleAxes(){return zme(this.component.axes,this.config)}assembleLegends(){return yj(this)}assembleProjections(){return k1e(this)}assembleTitle(){var t,n,i;const r=(t=this.title)!==null&&t!==void 0?t:{},{encoding:s}=r,o=X(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},UN(this.config.title).nonMark),o),s?{encode:{update:s}}:{});if(a.text)return ee(["unit","layer"],this.type)?ee(["middle",void 0],a.anchor)&&(a.frame=(n=a.frame)!==null&&n!==void 0?n:"group"):a.anchor=(i=a.anchor)!==null&&i!==void 0?i:"start",Fe(a)?void 0:a}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||wi(this.parent)?_j(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return Be((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const i=this.getName(t),r=this.component.data.outputNodeRefCounts;return r[i]=((n=r[i])!==null&&n!==void 0?n:0)+1,i}getSizeSignalRef(t){if(wi(this.parent)){const n=lj(t),i=Vm(n),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if($n(s)&&Ao(o)){const a=r.get("name"),u=m1(this,i),l=N$(u);if(l){const c=L({aggregate:"distinct",field:l},{expr:"datum"});return{signal:uj(a,r,c)}}else return R(`Unknown field for ${i}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(H9(t)&&wo(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(tde(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(i=>i.hasOrientSignalRef()))}}class Tj extends R${vgField(t,n={}){const i=this.fieldDef(t);if(i)return L(i,n)}reduceFieldDef(t,n){return XN(this.getMapping(),(i,r,s)=>{const o=sr(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){c$(this.getMapping(),(i,r)=>{const s=sr(i);s&&t(s,r)},n)}}class y1 extends Ce{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=fe(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"value",(s=o[1])!==null&&s!==void 0?s:"density"]}clone(){return new y1(null,fe(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${me(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=X(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class ed extends Ce{constructor(t,n){super(t),this.filter=n}clone(){return new ed(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:s}=n;if(Ee("invalid",s,i)!=="filter")return null;const a=n.reduceFieldDef((u,l,c)=>{const f=wo(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");ei(d)&&l.aggregate!=="count"&&!Ha(r)&&(u[l.field]=l)}return u},{});return z(a).length?new ed(t,a):null}dependentFields(){return new Set(z(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${me(this.filter)}`}assemble(){const t=z(this.filter).reduce((n,i)=>{const r=this.filter[i],s=L(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):r.type==="quantitative"&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class b1 extends Ce{constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>{var a;return(a=r[o])!==null&&a!==void 0?a:s})}clone(){return new b1(this.parent,fe(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${me(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class v1 extends Ce{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=fe(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"key",(s=o[1])!==null&&s!==void 0?s:"value"]}clone(){return new v1(null,fe(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${me(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class $u extends Ce{constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}clone(){return new $u(null,fe(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[br,yr],[Qn,Di]]){const s=r.map(o=>{const a=rt(n.encoding[o]);return U(a)?a.field:Eo(a)?{expr:`${a.datum}`}:Zr(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new $u(t,s,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(En)){const r=n.typedFieldDef(En);r.type===Ll&&(t=new $u(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(ce);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${me(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class td extends Ce{constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}clone(){return new td(null,this.projection,fe(this.fields),fe(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[br,yr],[Qn,Di]]){const r=i.map(o=>{const a=rt(n.encoding[o]);return U(a)?a.field:Eo(a)?{expr:`${a.datum}`}:Zr(a)?{expr:`${a.value}`}:void 0}),s=i[0]===Qn?"2":"";(r[0]||r[1])&&(t=new td(t,n.projectionName(),r,[n.getName("x"+s),n.getName("y"+s)]))}return t}dependentFields(){return new Set(this.fields.filter(ce))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${me(this.fields)} ${me(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class pa extends Ce{constructor(t,n){super(t),this.transform=n}clone(){return new pa(null,fe(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new pa(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(U(r)&&U(s)){const o=r.impute?r:s.impute?s:void 0;if(o===void 0)return;const a=r.impute?s:s.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=KN(n.mark,i);return new pa(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${me(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:c0e(i)?this.processSequence(i):i}:{}),{method:"value"}),s?{groupby:s}:{}),{value:!r||r==="value"?o:null});if(r&&r!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1},s?{groupby:s}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class x1 extends Ce{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=fe(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:n.on,(s=o[1])!==null&&s!==void 0?s:n.loess]}clone(){return new x1(null,fe(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${me(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=X(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class nd extends Ce{constructor(t,n,i){super(t),this.transform=n,this.secondary=i}clone(){return new nd(null,fe(this.transform),this.secondary)}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(d0e(o)){let u=Rj(o.data,s);u||(u=new tl(o.data),s.push(u));const l=n.getName(`lookup_${r}`);a=new en(u,l,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(h0e(o)){const u=o.selection;if(i=Object.assign({as:u},i),a=n.getSelectionComponent(Be(u),u).materialized,!a)throw new Error(rde(u))}return new nd(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Xe(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${me({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Xe(this.transform.as)}:{});else{let n=this.transform.as;ce(n)||(R(lde),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class w1 extends Ce{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=fe(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"prob",(s=o[1])!==null&&s!==void 0?s:"value"]}clone(){return new w1(null,fe(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${me(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=X(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}class A1 extends Ce{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=fe(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:n.on,(s=o[1])!==null&&s!==void 0?s:n.regression]}clone(){return new A1(null,fe(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${me(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=X(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class E1 extends Ce{constructor(t,n){super(t),this.transform=n}clone(){return new E1(null,fe(this.transform))}addDimensions(t){var n;this.transform.groupby=Ds(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${me(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},r!==void 0?{limit:r}:{}),s!==void 0?{op:s}:{}),i!==void 0?{groupby:i}:{})}}class $1 extends Ce{constructor(t,n){super(t),this.transform=n}clone(){return new $1(null,fe(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${me(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function Nj(e){let t=0;function n(i,r){var s;if(i instanceof tl&&!i.isGenerator&&!Kf(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof Rt&&(i.parent instanceof tl&&!r.source?(r.format=Object.assign(Object.assign({},(s=r.format)!==null&&s!==void 0?s:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof Wl){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source;for(const o of i.assemble())e.push(o);return}switch((i instanceof Qd||i instanceof Zd||i instanceof ed||i instanceof ql||i instanceof Qu||i instanceof td||i instanceof $u||i instanceof xi||i instanceof nd||i instanceof Hl||i instanceof Ja||i instanceof v1||i instanceof b1||i instanceof y1||i instanceof x1||i instanceof w1||i instanceof A1||i instanceof ao||i instanceof $1||i instanceof E1)&&r.transform.push(i.assemble()),(i instanceof Ki||i instanceof Xi||i instanceof pa||i instanceof Yr)&&r.transform.push(...i.assemble()),i instanceof en&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof en?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof en&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const a of i.children)n(a,{name:null,source:o,transform:[]});break}}}return n}function Pye(e){const t=[],n=Nj(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function zye(e,t){var n,i;const r=[],s=Nj(r);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();s(u,l)}for(const u of r)u.transform.length===0&&delete u.transform;let a=0;for(const[u,l]of r.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&r.splice(a++,0,r.splice(u,1)[0]);for(const u of r)for(const l of(i=u.transform)!==null&&i!==void 0?i:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of r)u.name in t&&(u.values=t[u.name]);return r}function Lye(e){return e==="top"||e==="left"||te(e)?"header":"footer"}function Iye(e){for(const t of Gn)Uye(e,t);sO(e,"x"),sO(e,"y")}function Uye(e,t){var n;const{facet:i,config:r,child:s,component:o}=e;if(e.channelHasField(t)){const a=i[t],u=el("title",null,r,t);let l=da(a,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});s.component.layoutHeaders[t].title&&(l=Q(l)?l.join(", "):l,l+=" / "+s.component.layoutHeaders[t].title,s.component.layoutHeaders[t].title=null);const c=el("labelOrient",a,r,t),f=(n=a.header)!==null&&n!==void 0?n:{},d=Ze(f.labels,r.header.labels,!0),h=ee(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:l,facetFieldDef:a,[h]:t==="facet"?[]:[jj(e,t,d)]}}}function jj(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function sO(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:s}=e.component;if(s.axis[t]=D$(s,t),s.axis[t]==="shared"){const o=t==="x"?"column":"row",a=r[o];for(const u of i.component.axes[t]){const l=Lye(u.get("orient"));a[l]=(n=a[l])!==null&&n!==void 0?n:[jj(e,o,!1)];const c=zc(u,"main",e.config,{header:!0});c&&a[l][0].axes.push(c),u.mainExtracted=!0}}}}function qye(e){B$(e),pp(e,"width"),pp(e,"height")}function Wye(e){B$(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";pp(e,t),pp(e,n)}function B$(e){for(const t of e.children)t.parseLayoutSize()}function pp(e,t){const n=lj(t),i=Vm(n),r=e.component.resolve,s=e.component.layoutSize;let o;for(const a of e.children){const u=a.component.layoutSize.getWithExplicit(n),l=r.scale[i];if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=ro(o,u,n,"")}else o=u}if(o){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,o)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function Hye(e){const{size:t,component:n}=e;for(const i of Zn){const r=Ar(i);if(t[r]){const s=t[r];n.layoutSize.set(r,or(s)?"step":s,!0)}else{const s=Gye(e,r);n.layoutSize.set(r,s,!1)}}}function Gye(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const s=r.get("type"),o=r.get("range");if($n(s)){const a=Xf(i.view,t);return Ao(o)||or(a)?"step":a}else return Jv(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return Jv(i.view,t);{const s=Xf(i.view,t);return or(s)?s.step:s}}}function gx(e,t,n){return L(t,Object.assign({suffix:`by_${L(e)}`},n??{}))}class uf extends Tj{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=I$(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet,r)}initFacet(t,n){return Wd(t)?XN(t,(i,r,s)=>ee([Wr,Hr],s)?r.field===void 0?(R(Gv(r,s)),i):(i[s]=Xv(r,s,n),i):(R(Jm(s,"facet")),i),{}):{facet:Xv(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=_1(this),this.child.parseData()}parseLayoutSize(){B$(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Iye(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const s of Gn)for(const o of F$){const a=this.component.layoutHeaders[s],u=a[o],{facetFieldDef:l}=a;if(l){const c=el("titleOrient",l,this.config,s);if(ee(["right","bottom"],c)){const f=h1(s,c);r.titleAnchor=(t=r.titleAnchor)!==null&&t!==void 0?t:{},r.titleAnchor[f]="end"}}if(u!=null&&u[0]){const c=s==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";s!=="facet"&&!this.child.component.layoutSize.get(c)&&(r[f]=(n=r[f])!==null&&n!==void 0?n:{},r[f][s]=.5),a.title&&(r.offset=(i=r.offset)!==null&&i!==void 0?i:{},r.offset[s==="row"?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof uf))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof uf?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:L(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof uf){if(this.child.channelHasField("column")){const r=L(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of Zn){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if($n(o)&&Ao(a)){const u=m1(this.child,r),l=N$(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):R(`Unknown field for ${r}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of Gn){const f=this.facet[c];if(f){u.push(L(f));const{bin:d,sort:h}=f;if(Me(d)&&u.push(L(f,{binSuffix:"end"})),Vi(h)){const{field:g,op:p=Zm}=h,m=gx(f,h);i&&r?(s.push(m),o.push("max"),a.push(m)):(s.push(g),o.push(p),a.push(m))}else if(Q(h)){const g=Zu(f,c);s.push(g),o.push("max"),a.push(g)}}}const l=!!i&&!!r;return Object.assign({name:t,data:n,groupby:u},l||s.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),s.length?{fields:s,ops:o,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?Vi(i.sort)?[gx(i,i.sort,{expr:"datum"})]:Q(i.sort)?[Zu(i,t,{expr:"datum"})]:[L(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(Vi(r)?r.order:!Q(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return ux(t.facet,"facet",n);const i={row:["top","bottom"],column:["left","right"]};for(const r of k$)if(t[r]){const s=el("labelOrient",t[r],n,r);if(ee(i[r],s))return ux(t[r],r,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=Pye(n),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Gn.map(u=>this.facetSortFields(u)).flat(),order:Gn.map(u=>this.facetSortOrder(u)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(cpe(this,[])))]}getMapping(){return this.facet}}function Yye(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(Vi(s.sort)){const{field:o,op:a=Zm}=s.sort;e=r=new Ja(e,{joinaggregate:[{op:a,field:o,as:gx(s,s.sort,{forAs:!0})}],groupby:[L(s)]})}return r}return null}function Rj(e,t){var n,i,r,s,o,a,u,l,c,f;for(const d of t){const h=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName)&&!(!((n=e.format)===null||n===void 0)&&n.mesh&&(!((i=h.format)===null||i===void 0)&&i.feature))&&!((!((r=e.format)===null||r===void 0)&&r.feature||!((s=h.format)===null||s===void 0)&&s.feature)&&((o=e.format)===null||o===void 0?void 0:o.feature)!==((a=h.format)===null||a===void 0?void 0:a.feature))&&!((!((u=e.format)===null||u===void 0)&&u.mesh||!((l=h.format)===null||l===void 0)&&l.mesh)&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=h.format)===null||f===void 0?void 0:f.mesh))){if(ap(e)&&ap(h)){if(zd(e.values,h.values))return d}else if(Kf(e)&&Kf(h)){if(e.url===h.url)return d}else if(m7(e)&&e.name===d.dataName)return d}}return null}function Vye(e,t){if(e.data||!e.parent){if(e.data===null){const i=new tl({values:[]});return t.push(i),i}const n=Rj(e.data,t);if(n)return ga(e.data)||(n.data.format=ife({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new tl(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Xye(e,t,n){var i,r;let s=0;for(const o of t.transforms){let a,u;if(E0e(o))u=e=new Qu(e,o),a="derived";else if(v7(o)){const l=I1e(o);u=e=(i=Rt.makeWithAncestors(e,{},l,n))!==null&&i!==void 0?i:e,e=new ql(e,t,o.filter)}else if($0e(o))u=e=Ki.makeFromTransform(e,o,t),a="number";else if(S0e(o))a="date",n.getWithExplicit(o.field).value===void 0&&(e=new Rt(e,{[o.field]:a}),n.set(o.field,a,!1)),u=e=Xi.makeFromTransform(e,o);else if(C0e(o))u=e=xi.makeFromTransform(e,o),a="number",$$(t)&&(e=new ao(e));else if(f0e(o))u=e=nd.make(e,t,o,s++),a="derived";else if(x0e(o))u=e=new Hl(e,o),a="number";else if(w0e(o))u=e=new Ja(e,o),a="number";else if(k0e(o))u=e=Yr.makeFromTransform(e,o),a="derived";else if(F0e(o))u=e=new v1(e,o),a="derived";else if(A0e(o))u=e=new b1(e,o),a="derived";else if(g0e(o))u=e=new E1(e,o),a="derived";else if(v0e(o))e=new $1(e,o);else if(_0e(o))u=e=pa.makeFromTransform(e,o),a="derived";else if(p0e(o))u=e=new y1(e,o),a="derived";else if(m0e(o))u=e=new w1(e,o),a="derived";else if(y0e(o))u=e=new A1(e,o),a="derived";else if(b0e(o))u=e=new x1(e,o),a="derived";else{R(ude(o));continue}if(u&&a!==void 0)for(const l of(r=u.producedFields())!==null&&r!==void 0?r:[])n.set(l,a,!1)}return e}function _1(e){var t,n,i,r,s,o,a,u,l,c;let f=Vye(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,g=e.parent?e.parent.component.data.ancestorParse.clone():new l0e,p=e.data;ga(p)?(y7(p)?f=new Zd(f,p.sequence):v$(p)&&(f=new Qd(f,p.graticule)),g.parseNothing=!0):((t=p==null?void 0:p.format)===null||t===void 0?void 0:t.parse)===null&&(g.parseNothing=!0),f=(n=Rt.makeExplicit(f,e,g))!==null&&n!==void 0?n:f,f=new ao(f);const m=e.parent&&Gl(e.parent);(We(e)||wi(e))&&m&&(f=(i=Ki.makeFromEncoding(f,e))!==null&&i!==void 0?i:f),e.transforms.length>0&&(f=Xye(f,e,g));const y=q1e(e),b=U1e(e);f=(r=Rt.makeWithAncestors(f,{},Object.assign(Object.assign({},y),b),g))!==null&&r!==void 0?r:f,We(e)&&(f=$u.parseAll(f,e),f=td.parseAll(f,e)),(We(e)||wi(e))&&(m||(f=(s=Ki.makeFromEncoding(f,e))!==null&&s!==void 0?s:f),f=(o=Xi.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=Qu.parseAllForSortIndex(f,e));const v=e.getName(up),x=new en(f,v,up,h);if(d[v]=x,f=x,We(e)){const $=xi.makeFromEncoding(f,e);$&&(f=$,$$(e)&&(f=new ao(f))),f=(a=pa.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=(u=Yr.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}We(e)&&(f=(l=ed.make(f,e))!==null&&l!==void 0?l:f);const A=e.getName(Mt),E=new en(f,A,Mt,h);d[A]=E,f=E,We(e)&&Bme(e,E);let w=null;if(wi(e)){const $=e.getName("facet");f=(c=Yye(f,e.facet))!==null&&c!==void 0?c:f,w=new Wl(f,e,$,E.getSource()),d[$]=w}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:x,main:E,facetRoot:w,ancestorParse:g})}class Kye extends R${constructor(t,n,i,r){var s,o,a,u;super(t,"concat",n,i,r,t.resolve),(((o=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||u===void 0?void 0:u.y)==="shared")&&R(ode),this.children=this.getChildren(t).map((l,c)=>I$(l,this,this.getName("concat_"+c),void 0,r))}parseData(){this.component.data=_1(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of z(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return r1(t)?t.vconcat:y$(t)?t.hconcat:t.concat}parseLayoutSize(){Wye(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=O$(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function Jye(e){return e===!1||e===null}const Qye=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},T9),{labelExpr:1,encode:1}),Bj=z(Qye);class P$ extends cs{constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new P$(fe(this.explicit),fe(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Jye(this.get(t))}hasOrientSignalRef(){return te(this.explicit.orient)}}function Zye(e,t,n){var i;const{encoding:r,config:s}=e,o=(i=rt(r[t]))!==null&&i!==void 0?i:rt(r[wr(t)]),a=e.axis(t)||{},{format:u,formatType:l}=a;return ka(l)?Object.assign({text:ZE({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:s})},n):n}function ebe(e){return Zn.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[abe(n,e)]),t),{})}const tbe={bottom:"top",top:"bottom",left:"right",right:"left"};function nbe(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const o of z(s.component.axes))i.axis[o]=D$(e.component.resolve,o),i.axis[o]==="shared"&&(n[o]=ibe(n[o],s.component.axes[o]),n[o]||(i.axis[o]="independent",delete n[o]))}for(const s of Zn){for(const o of e.children)if(o.component.axes[s]){if(i.axis[s]==="independent"){n[s]=((t=n[s])!==null&&t!==void 0?t:[]).concat(o.component.axes[s]);for(const a of o.component.axes[s]){const{value:u,explicit:l}=a.getWithExplicit("orient");if(!te(u)){if(r[u]>0&&!l){const c=tbe[u];r[u]>r[c]&&a.set("orient",c,!1)}r[u]++}}}delete o.component.axes[s]}if(i.axis[s]==="independent"&&n[s]&&n[s].length>1)for(const o of n[s])o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function ibe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=rbe(r,s)}}}else return t.map(n=>n.clone());return e}function rbe(e,t){for(const n of Bj){const i=ro(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return VN(r,s);case"gridScale":return{explicit:r.explicit,value:Ze(r.value,s.value)}}return o1(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function sbe(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(te(n.labelAngle)?n.labelAngle:J0(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===rj(i,r))return!0}return e===n[t]}const obe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function abe(e,t){var n,i,r;let s=t.axis(e);const o=new P$,a=rt(t.encoding[e]),{mark:u,config:l}=t,c=(s==null?void 0:s.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((i=l.axis)===null||i===void 0?void 0:i.orient)||Xme(e),f=t.getScaleComponent(e).get("type"),d=Ume(e,f,c,t.config),h=s!==void 0?!s:ox("disable",l,s==null?void 0:s.style,d).configValue;if(o.set("disable",h,s!==void 0),h)return o;s=s||{};const g=Gme(t,s,e,a,d),p={fieldOrDatumDef:a,axis:s,channel:e,model:t,scaleType:f,orient:c,labelAngle:g,mark:u,config:l};for(const b of Bj){const v=b in WF?WF[b](p):Zk(b)?s[b]:void 0,x=v!==void 0,A=sbe(v,b,s,t,e);if(x&&A)o.set(b,v,A);else{const{configValue:E=void 0,configFrom:w=void 0}=Zk(b)&&b!=="values"?ox(b,t.config,s.style,d):{},$=E!==void 0;x&&!$?o.set(b,v,A):(w!=="vgAxisConfig"||obe.has(b)&&$||OE(E)||te(E))&&o.set(b,E,!1)}}const m=(r=s.encoding)!==null&&r!==void 0?r:{},y=M9.reduce((b,v)=>{var x;if(!o.hasAxisPart(v))return b;const A=cj((x=m[v])!==null&&x!==void 0?x:{},t),E=v==="labels"?Zye(t,e,A):A;return E!==void 0&&!Fe(E)&&(b[v]={update:E}),b},{});return Fe(y)||o.set("encode",y,!!s.encoding||s.labelAngle!==void 0),o}function ube({encoding:e,size:t}){for(const n of Zn){const i=Ar(n);or(t[i])&&Ii(e[n])&&(delete t[i],R(tN(i)))}return t}function lbe(e,t,n,{graticule:i}){const r=ir(e)?Object.assign({},e):{type:e},s=Ee("orient",r,n);if(r.orient=hbe(r.type,t,s),s!==void 0&&s!==r.orient&&R(Ade(r.orient,s)),r.type==="bar"&&r.orient){const l=Ee("cornerRadiusEnd",r,n);if(l!==void 0){const c=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:Efe[r.orient];for(const f of c)r[f]=l;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}return Ee("opacity",r,n)===void 0&&(r.opacity=fbe(r.type,t)),r.filled===void 0&&(r.filled=i?!1:dbe(r,n)),Ee("cursor",r,n)===void 0&&(r.cursor=cbe(r,t,n)),r}function cbe(e,t,n){return t.href||e.href||Ee("href",e,n)?"pointer":e.cursor}function fbe(e,t){if(ee([Im,DE,ME,TE],e)&&!u$(t))return .7}function dbe(e,t){const n=Fa("filled",e,t),i=e.type;return Ze(n,i!==Im&&i!==Lm&&i!==Q0)}function hbe(e,t,n){switch(e){case Im:case ME:case TE:case j9:case pfe:case gfe:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case zm:if(U(i)&&(Kt(i.bin)||U(r)&&r.aggregate&&!i.aggregate))return"vertical";if(U(r)&&(Kt(r.bin)||U(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s&&(U(i)&&i.type===Ca&&!Me(i.bin)||Vv(i)))return"horizontal";if(!o&&(U(r)&&r.type===Ca&&!Me(r.bin)||Vv(r)))return"vertical"}case Q0:if(s&&!(U(i)&&Kt(i.bin))&&o&&!(U(r)&&Kt(r.bin)))return;case Pm:if(o)return U(r)&&Kt(r.bin)?"horizontal":"vertical";if(s)return U(i)&&Kt(i.bin)?"vertical":"horizontal";if(e===Q0){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case Lm:case DE:{const a=Ii(i),u=Ii(r);if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u){const l=i,c=r,f=l.type===Xu,d=c.type===Xu;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const gbe={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Nt("x",e,{defaultPos:"mid"})),Nt("y",e,{defaultPos:"mid"})),so(e,"radius","arc")),so(e,"theta","arc"))},pbe={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),fp("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),fp("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),A$(e))},mbe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),so(e,"x","bar")),so(e,"y","bar"))},ybe={vgMark:"shape",encodeEntry:e=>Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&U(n)&&n.type===Ll?{field:L(n,{expr:"datum"})}:{})]}},bbe={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),so(e,"x","image")),so(e,"y","image")),x$(e,"url"))},vbe={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Nt("x",e,{defaultPos:"mid"})),Nt("y",e,{defaultPos:"mid"})),ct("size",e,{vgChannel:"strokeWidth"})),A$(e))},xbe={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Nt("x",e,{defaultPos:"mid"})),Nt("y",e,{defaultPos:"mid"})),ct("size",e)),A$(e))};function z$(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Nt("x",e,{defaultPos:"mid"})),Nt("y",e,{defaultPos:"mid"})),ct("size",e)),ct("angle",e)),wbe(e,n,t))}function wbe(e,t,n){return n?{shape:{value:n}}:ct("shape",e)}const Abe={vgMark:"symbol",encodeEntry:e=>z$(e)},Ebe={vgMark:"symbol",encodeEntry:e=>z$(e,"circle")},$be={vgMark:"symbol",encodeEntry:e=>z$(e,"square")},_be={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),so(e,"x","rect")),so(e,"y","rect"))},Sbe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),fp("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),fp("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),ct("size",e,{vgChannel:"strokeWidth"}))}},Cbe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),Nt("x",e,{defaultPos:"mid"})),Nt("y",e,{defaultPos:"mid"})),x$(e)),ct("size",e,{vgChannel:"fontSize"})),ct("angle",e)),TF("align",kbe(e.markDef,n,t))),TF("baseline",Fbe(e.markDef,n,t))),Nt("radius",e,{defaultPos:null,isMidPoint:!0})),Nt("theta",e,{defaultPos:null,isMidPoint:!0}))}};function kbe(e,t,n){if(Ee("align",e,n)===void 0)return"center"}function Fbe(e,t,n){if(Ee("baseline",e,n)===void 0)return"middle"}const Obe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"width":"height",s=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ni(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Nt("x",e,{defaultPos:"mid",vgChannel:"xc"})),Nt("y",e,{defaultPos:"mid",vgChannel:"yc"})),ct("size",e,{defaultValue:Dbe(e),vgChannel:r})),{[s]:Ve(Ee("thickness",n,t))})}};function Dbe(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,s=r==="horizontal"?"width":"height",o=e.getScaleComponent(r==="horizontal"?"x":"y"),a=(t=Ee("size",i,n,{vgChannel:s}))!==null&&t!==void 0?t:n.tick.bandSize;if(a!==void 0)return a;{const u=o?o.get("range"):void 0;return u&&Ao(u)&&Qe(u.step)?u.step*3/4:op(n.view,s)*3/4}}const Lh={arc:gbe,area:pbe,bar:mbe,circle:Ebe,geoshape:ybe,image:bbe,line:vbe,point:Abe,rect:_be,rule:Sbe,square:$be,text:Cbe,tick:Obe,trail:xbe};function Mbe(e){return ee([Lm,Pm,mfe],e.mark)?Tbe(e):ee([zm],e.mark)?Nbe(e):mp(e)}const oO="faceted_path_";function Tbe(e){const t=KN(e.mark,e.encoding),n=mp(e,{fromPrefix:t.length>0?oO:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:oO+e.requestDataName(Mt),data:e.requestDataName(Mt),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const aO="stack_group_";function Nbe(e){const t=zy.some(n=>Ee(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=mp(e,{fromPrefix:aO}),i=e.scaleName(e.stack.fieldChannel),r=(f={})=>e.vgField(e.stack.fieldChannel,f),s=(f,d)=>{const h=[r({prefix:"min",suffix:"start",expr:d}),r({prefix:"max",suffix:"start",expr:d}),r({prefix:"min",suffix:"end",expr:d}),r({prefix:"max",suffix:"end",expr:d})];return`${f}(${h.map(g=>`scale('${i}',${g})`).join(",")})`};let o,a;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},Wf(n.encode.update,["y","yc","y2","height",...zy])),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},qr(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},Wf(n.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},qr(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of zy){const d=Fa(f,e.markDef,e.config);n.encode.update[f]?(o[f]=n.encode.update[f],delete n.encode.update[f]):d&&(o[f]=Ve(d)),d&&(n.encode.update[f]={value:0})}const u=e.fieldDef(e.stack.groupbyChannel),l=L(u)?[L(u)]:[];return(u!=null&&u.bin||u!=null&&u.timeUnit)&&l.push(L(u,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},f),{[d]:n.encode.update[d]});{const h=Fa(d,e.markDef,e.config);return h!==void 0?Object.assign(Object.assign({},f),{[d]:Ve(h)}):f}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Mt),name:aO+e.requestDataName(Mt),groupby:l,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[n]}]}]}else return mp(e)}function jbe(e){const{encoding:t,stack:n,mark:i,markDef:r,config:s}=e,o=t.order;if(!(!Q(o)&&Zr(o)&&Kk(o.value)||!o&&Kk(Ee("order",r,s)))){if((Q(o)||U(o))&&!n)return HN(o,{expr:"datum"});if(Ha(i)){const a=r.orient==="horizontal"?"y":"x",u=t[a];if(U(u)){const l=u.sort;if(Q(l))return{field:L(u,{prefix:a,suffix:"sort_index",expr:"datum"})};if(Vi(l))return{field:L({aggregate:u$(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})};if(FN(l)){const c=e.fieldDef(l.encoding);return{field:L(c,{expr:"datum"}),order:l.order}}else return l===null?void 0:{field:L(u,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function mp(e,t={fromPrefix:""}){const{mark:n,markDef:i,config:r}=e,s=Ze(i.clip,Rbe(e),Bbe(e)),o=qN(i),a=e.encoding.key,u=jbe(e),l=Pbe(e),c=Ee("aria",i,r),f=Lh[n].postEncodingTransform?Lh[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Lh[n].vgMark},s?{clip:!0}:{}),o?{style:o}:{}),a?{key:a.field}:{}),u?{sort:u}:{}),l||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(Mt)},encode:{update:Lh[n].encodeEntry(e)}}),f?{transform:f}:{})]}function Rbe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function Bbe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Pbe(e){if(!e.component.selection)return null;const t=z(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=z(i.component.selection).length,i=i.parent;return n?{interactive:t>0}:null}class Pj extends Tj{constructor(t,n,i,r={},s){var o,a;super(t,"unit",n,i,s,void 0,bF(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const u=ir(t.mark)?t.mark.type:t.mark;this.markDef=lbe(t.mark,(o=t.encoding)!==null&&o!==void 0?o:{},s,{graticule:t.data&&v$(t.data)});const l=this.encoding=age((a=t.encoding)!==null&&a!==void 0?a:{},this.markDef,s);this.size=ube({encoding:l,size:bF(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=f7(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===R9,i=t&&Pfe.some(r=>ne(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return Xm.reduce((i,r)=>{var s;const o=rt(n[r]);return o&&(i[r]=(s=o.scale)!==null&&s!==void 0?s:{}),i},{})}initAxes(t){return Zn.reduce((n,i)=>{const r=t[i];if(ne(r)||i===Le&&ne(t.x2)||i===ot&&ne(t.y2)){const s=ne(r)?r.axis:void 0;n[i]=s&&Object.assign({},s)}return n},{})}initLegend(t){return Gfe.reduce((n,i)=>{const r=rt(t[i]);if(r&&Vfe(i)){const s=r.legend;n[i]=s&&Object.assign({},s)}return n},{})}parseData(){this.component.data=_1(this)}parseLayoutSize(){Hye(this)}parseSelections(){this.component.selection=Rme(this,this.selection)}parseMarkGroup(){this.component.mark=Mbe(this)}parseAxesAndHeaders(){this.component.axes=ebe(this)}assembleSelectionTopLevelSignals(t){return fpe(this,t)}assembleSignals(){return[...Z7(this),...lpe(this,[])]}assembleSelectionData(t){return dpe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return O$(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!Gl(this.parent))&&(n=z7(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return ha(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return sr(n)}typedFieldDef(t){const n=this.fieldDef(t);return Ln(n)?n:null}}class L$ extends R${constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,u)=>{if(s1(a))return new L$(a,this,this.getName("layer_"+u),o,s);if(ss(a))return new Pj(a,this,this.getName("layer_"+u),o,s);throw new Error(zE(a))})}parseData(){this.component.data=_1(this);for(const t of this.children)t.parseData()}parseLayoutSize(){qye(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of z(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){nbe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),Z7(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),O$(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return hpe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),yj(this))}}function I$(e,t,n,i,r){if(e1(e))return new uf(e,t,n,r);if(s1(e))return new L$(e,t,n,i,r);if(ss(e))return new Pj(e,t,n,i,r);if(kge(e))return new Kye(e,t,n,r);throw new Error(zE(e))}function zbe(e,t={}){t.logger&&Yde(t.logger),t.fieldTitle&&PN(t.fieldTitle);try{const n=l7($9(t.config,e.config)),i=g7(e,n),r=I$(i,null,"",void 0,n);return r.parse(),sye(r.component.data,r),{spec:Ibe(r,Lbe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&Vde(),t.fieldTitle&&ege()}}function Lbe(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):ce(t)&&(t={type:t}),r&&s&&o0e(t.type)){if(r==="step"&&s==="step")R(sF()),t.type="pad";else if(r==="step"||s==="step"){const o=r==="step"?"width":"height";R(sF(Vm(o)));const a=o==="width"?"height":"width";t.type=a0e(a)}}return Object.assign(Object.assign(Object.assign({},z(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),FF(n)),FF(e))}function Ibe(e,t,n={},i){const r=e.config?Lge(e.config):void 0,s=[].concat(e.assembleSelectionData([]),zye(e.component.data,n)),o=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),a?{title:a}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:s}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),r?{config:r}:{}),i?{usermeta:i}:{})}class Ube extends c7{mapUnit(t,{config:n}){if(t.encoding){const{encoding:i,transform:r}=t,{bins:s,timeUnits:o,aggregate:a,groupby:u,encoding:l}=l$(i,n),c=[...r||[],...s,...o,...a.length===0?[]:[{aggregate:a,groupby:u}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:l})}else return t}}const qbe=new Ube;function Wbe(e,t){return qbe.map(e,{config:t})}const Hbe=Pce.version,Yve=Object.freeze(Object.defineProperty({__proto__:null,compile:zbe,extractTransforms:Wbe,normalize:g7,version:Hbe},Symbol.toStringTag,{value:"Module"}));function Vve(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var Gbe="vega-themes",Ybe="2.13.0",Vbe="Themes for stylized Vega and Vega-Lite visualizations.",Xbe=["vega","vega-lite","themes","style"],Kbe="BSD-3-Clause",Jbe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Qbe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Zbe="build/vega-themes.js",eve="build/vega-themes.module.js",tve="build/vega-themes.min.js",nve="build/vega-themes.min.js",ive="build/vega-themes.module.d.ts",rve={type:"git",url:"https://github.com/vega/vega-themes.git"},sve=["src","build"],ove={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},ave={"@babel/core":"^7.21.4","@babel/plugin-transform-runtime":"^7.21.4","@babel/preset-env":"^7.21.4","@babel/preset-typescript":"^7.21.4","@release-it/conventional-changelog":"^5.1.1","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.2","@rollup/plugin-terser":"^0.4.1","@typescript-eslint/eslint-plugin":"^5.59.0","@typescript-eslint/parser":"^5.59.0","browser-sync":"^2.29.1",concurrently:"^8.0.1",eslint:"^8.38.0","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^4.2.1","gh-pages":"^5.0.0",prettier:"^2.8.7","release-it":"^15.10.1",rollup:"^3.20.6","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.2.0",typescript:"^5.0.4",vega:"^5.24.0","vega-lite":"^5.7.1"},uve={vega:"*","vega-lite":"*"},lve={},cve={name:Gbe,version:Ybe,description:Vbe,keywords:Xbe,license:Kbe,author:Jbe,contributors:Qbe,main:Zbe,module:eve,unpkg:tve,jsdelivr:nve,types:ive,repository:rve,files:sve,scripts:ove,devDependencies:ave,peerDependencies:uve,dependencies:lve};const au="#fff",uO="#888",fve={background:"#333",view:{stroke:uO},title:{color:au,subtitleColor:au},style:{"guide-label":{fill:au},"guide-title":{fill:au}},axis:{domainColor:au,gridColor:uO,tickColor:au}},Mo="#4572a7",dve={background:"#fff",arc:{fill:Mo},area:{fill:Mo},line:{stroke:Mo,strokeWidth:2},path:{stroke:Mo},rect:{fill:Mo},shape:{stroke:Mo},symbol:{fill:Mo,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},To="#30a2da",Qy="#cbcbcb",hve="#999",gve="#333",lO="#f0f0f0",cO="#333",pve={arc:{fill:To},area:{fill:To},axis:{domainColor:Qy,grid:!0,gridColor:Qy,gridWidth:1,labelColor:hve,labelFontSize:10,titleColor:gve,tickColor:Qy,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:lO,group:{fill:lO},legend:{labelColor:cO,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:cO,titleFontSize:14,titlePadding:10},line:{stroke:To,strokeWidth:2},path:{stroke:To,strokeWidth:.5},rect:{fill:To},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:To},bar:{binSpacing:2,fill:To,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},No="#000",mve={group:{fill:"#e5e5e5"},arc:{fill:No},area:{fill:No},line:{stroke:No},path:{stroke:No},rect:{fill:No},shape:{stroke:No},symbol:{fill:No,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},yve=22,bve="normal",fO="Benton Gothic, sans-serif",dO=11.5,vve="normal",jo="#82c6df",Zy="Benton Gothic Bold, sans-serif",hO="normal",gO=13,gc={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},xve={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Zy,fontSize:yve,fontWeight:bve},arc:{fill:jo},area:{fill:jo},line:{stroke:jo,strokeWidth:2},path:{stroke:jo},rect:{fill:jo},shape:{stroke:jo},symbol:{fill:jo,size:30},axis:{labelFont:fO,labelFontSize:dO,labelFontWeight:vve,titleFont:Zy,titleFontSize:gO,titleFontWeight:hO},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:fO,labelFontSize:dO,symbolType:"square",titleFont:Zy,titleFontSize:gO,titleFontWeight:hO},range:{category:gc["category-6"],diverging:gc["fireandice-6"],heatmap:gc["fire-7"],ordinal:gc["fire-7"],ramp:gc["fire-7"]}},Ro="#ab5787",Ih="#979797",wve={background:"#f9f9f9",arc:{fill:Ro},area:{fill:Ro},line:{stroke:Ro},path:{stroke:Ro},rect:{fill:Ro},shape:{stroke:Ro},symbol:{fill:Ro,size:30},axis:{domainColor:Ih,domainWidth:.5,gridWidth:.2,labelColor:Ih,tickColor:Ih,tickWidth:.2,titleColor:Ih},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Bo="#3e5c69",Ave={background:"#fff",arc:{fill:Bo},area:{fill:Bo},line:{stroke:Bo},path:{stroke:Bo},rect:{fill:Bo},shape:{stroke:Bo},symbol:{fill:Bo},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Un="#1696d2",pO="#000000",Eve="#FFFFFF",Uh="Lato",eb="Lato",$ve="Lato",_ve="#DEDDDD",Sve=18,pc={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},Cve={background:Eve,title:{anchor:"start",fontSize:Sve,font:Uh},axisX:{domain:!0,domainColor:pO,domainWidth:1,grid:!1,labelFontSize:12,labelFont:eb,labelAngle:0,tickColor:pO,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Uh},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:_ve,gridWidth:1,labelFontSize:12,labelFont:eb,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Uh,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:eb,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Uh,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:pc["six-groups-cat-1"],diverging:pc["diverging-colors"],heatmap:pc["diverging-colors"],ordinal:pc["six-groups-seq"],ramp:pc["shades-blue"]},area:{fill:Un},rect:{fill:Un},line:{color:Un,stroke:Un,strokeWidth:5},trail:{color:Un,stroke:Un,strokeWidth:0,size:1},path:{stroke:Un,strokeWidth:.5},point:{filled:!0},text:{font:$ve,color:Un,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Un,stroke:null}},arc:{fill:Un},shape:{stroke:Un},symbol:{fill:Un,size:30}},Po="#3366CC",mO="#ccc",qh="Arial, sans-serif",kve={arc:{fill:Po},area:{fill:Po},path:{stroke:Po},rect:{fill:Po},shape:{stroke:Po},symbol:{stroke:Po},circle:{fill:Po},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:qh,fontSize:12},"guide-title":{font:qh,fontSize:12},"group-title":{font:qh,fontSize:12}},title:{font:qh,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:mO,tickColor:mO,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},U$=e=>e*(1/3+1),yO=U$(9),bO=U$(10),vO=U$(12),mc="Segoe UI",xO="wf_standard-font, helvetica, arial, sans-serif",wO="#252423",yc="#605E5C",AO="transparent",Fve="#C8C6C4",oi="#118DFF",Ove="#12239E",Dve="#E66C37",Mve="#6B007B",Tve="#E044A7",Nve="#744EC2",jve="#D9B300",Rve="#D64550",zj=oi,Lj="#DEEFFF",EO=[Lj,zj],Bve=[Lj,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",zj],Pve={view:{stroke:AO},background:AO,font:mc,header:{titleFont:xO,titleFontSize:vO,titleColor:wO,labelFont:mc,labelFontSize:bO,labelColor:yc},axis:{ticks:!1,grid:!1,domain:!1,labelColor:yc,labelFontSize:yO,titleFont:xO,titleColor:wO,titleFontSize:vO,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:Fve,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:oi},line:{stroke:oi,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:mc,fontSize:yO,fill:yc},arc:{fill:oi},area:{fill:oi,line:!0,opacity:.6},path:{stroke:oi},rect:{fill:oi},point:{fill:oi,filled:!0,size:75},shape:{stroke:oi},symbol:{fill:oi,strokeWidth:1.5,size:50},legend:{titleFont:mc,titleFontWeight:"bold",titleColor:yc,labelFont:mc,labelFontSize:bO,labelColor:yc,symbolType:"circle",symbolSize:75},range:{category:[oi,Ove,Dve,Mve,Tve,Nve,jve,Rve],diverging:EO,heatmap:EO,ordinal:Bve}},zve=cve.version,Xve=Object.freeze(Object.defineProperty({__proto__:null,dark:fve,excel:dve,fivethirtyeight:pve,ggplot2:mve,googlecharts:kve,latimes:xve,powerbi:Pve,quartz:wve,urbaninstitute:Cve,version:zve,vox:Ave},Symbol.toStringTag,{value:"Module"}));export{Yve as a,IR as b,px as c,_g as d,Vve as e,tfe as f,V2 as g,yW as h,LO as i,mW as j,tM as k,Af as l,gR as m,vW as n,xW as o,bW as p,XZ as q,Wve as r,Ive as s,Xve as t,qve as u,Gve as v,wx as w};
